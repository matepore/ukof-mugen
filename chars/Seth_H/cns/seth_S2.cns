;===============================================================
; ローリングアタック
;===============================================================
;---------------------------------------------------------
; 開始
;---------------------------------------------------------

[StateDef 1600]
type = S
movetype = A
physics = N
anim = 1600
velset = 0, 0
ctrl = 0
poweradd = 80*!var(6)

[State 1600, PlaySnd]
type = PlaySnd
trigger1 = AnimElemTime(1) = 4
value = s40, 1

[State 1600, Width]
type = Width
trigger1 = animelemTime(2) >= 0
value = 5, 5

[State 1600, VelSet]
type = VelSet
trigger1 = animelem = 2
x = 2.5
y = -7

[State 1600, VelSet]
type = VelAdd
trigger1 = animelemTime(2) > 0
y = 0.35

[State 1600, HitDef]
type = HitDef
trigger1 = AnimElem = 5
attr = S, SA
animtype = Hard
damage = 58, 8
guardflag = M
pausetime = 24, 24
getpower = 120*!var(6), 120*!var(6)
givepower = 30, 30
sparkno = s7010
sparkxy = 0,-70
guard.sparkno = S7030
hitsound = s1,4
guardsound = s2,1
ground.type = High
ground.slidetime = 17
ground.hittime = 19
ground.velocity = -4.8, -5.0	; -4.5
air.velocity = -5, -4.3
guard.velocity = -8	; -12
envshake.time = 20
envshake.ampl = -3
envshake.freq = 90
envshake.phase = -3
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
ground.cornerpush.veloff = 0
fall = 1
fall.recover = 1
fall.recovertime = 52	;38
yaccel = .45	;.55
id = IfElse(var(1)=0,1050,1);1+(var(1)=0)
;p2StateNo = 9900
nochainid = var(11)

[State 1600, StateTypeSet]
type = StateTypeSet
trigger1 = AnimElemTime(2) = 0
StateType = A

[State 1600, StateTypeSet]
type = null	; StateTypeSet
trigger1 = AnimElemTime(6) = 0
movetype = I

[State 1600, ChangeState]
type = ChangeState
trigger1 = Vel Y > 0 && Pos Y >= 0
value = 1431
ctrl = 0

;===============================================================
; コークスクリュー
;===============================================================
;---------------------------------------------------------
; 開始
;---------------------------------------------------------

[StateDef 1700]
type = S
movetype = A
physics = N
anim = 1700
velset = 0, 0
ctrl = 0
poweradd = 80*!var(6)

[State 1700, PlaySnd]
type = PlaySnd
trigger1 = AnimElemTime(1) = 0
value = s40, 1

[State 1700, PlayerPush]
type = PlayerPush
trigger1 = animelemTime(2) >= 0
trigger1 = animelemTime(7) < 0
value = 0
ignorehitpause = 1

[State 1700, VelSet]
type = VelSet
trigger1 = animelem = 2
x = 5.0

[State 1700, VelSet]
type = VelMul
trigger1 = animelemtime(7) > 0
x = 0.8

;フッ
[State 1100, PlaySnd]
type = null	; PlaySnd
trigger1 = time = 0
value = s9, 1

;オラァー！
[State 1700, PlaySnd]
type = PlaySnd
trigger1 = AnimElem = 10
value = s8, 4

;コークスクリュー
[State 1700, Explod]
type = explod
trigger1 = AnimElem = 10
postype = p1
anim = 7450
pos = 50, -78
sprpriority = 2	; 6
supermovetime = 0	;99999
;pausemovetime = 
PauseMoveTime = -1
persistent = 1
scale = 1,2
bindtime = 9999
ignorehitpause = 0

[State 1700, HitDef]
type = HitDef
trigger1 = AnimElemTime(10) = [0, 4]
attr = S, SA
animtype = Hard
damage = 17, 8
guardflag = M
pausetime = 4, 4
getpower = 60*!var(6), 60*!var(6)
givepower = 30, 30
sparkno = s8000
sparkxy = Random % 30 - 30, -50 - Random % 40
guard.sparkno = S8060
hitsound = s1,2
guardsound = s2,1
ground.type = High
ground.slidetime = 16
ground.hittime = 20
ground.velocity = 1	;-4.8
air.velocity = 1, 0	;-5, -4.3
guard.velocity = 1	; -12
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
ground.cornerpush.veloff = 0
air.fall = 1
fall.recover = 1
fall.recovertime = 999
yaccel = .45	;.55
;id = IfElse(var(1)=0,1700,1);1+(var(1)=0)
;p2StateNo = 9900
nochainid = var(11)

[State 1700, HitDef]
type = HitDef
trigger1 = AnimElemTime(10) = 5
attr = S, SA
animtype = Hard
damage = 66, 8
guardflag = M
pausetime = 12, 12
getpower = 60*!var(6), 60*!var(6)
givepower = 30, 30
sparkno = s8030
sparkxy = -20, -70
guard.sparkno = S8070
hitsound = s1,5
guardsound = s2,1
ground.type = High
ground.slidetime = 16
ground.hittime = 20
ground.velocity = 0	;-4.8
air.velocity = 0, 0	;-5, -4.3
guard.velocity = -8	; -12
envshake.time = 20
envshake.ampl = -3
envshake.freq = 90
envshake.phase = -3
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
ground.cornerpush.veloff = 0
fall = 1
fall.recover = 1
fall.recovertime = 999
yaccel = .45	;.55
id = IfElse(var(1)=0,1700,1);1+(var(1)=0)
;p2StateNo = 9900
nochainid = var(11)

[State 3600, TargetState]
type = TargetState
triggerall = NumTarget(1700)
triggerall = Target,MoveType = H && Target,StateNo >= 200 && !Target,ctrl
triggerall = AnimElemTime(10) >= 4 && AnimElemTime(11) <= 0
;trigger1 = Target,StateType = A
trigger1 = Target(1700),GetHitVar(guarded) = 0
value = 1701
id = 1700
persistent = 0
ignorehitpause = 1

[State 1700, StateTypeSet]
type = StateTypeSet
trigger1 = AnimElemTime(11) = 0
movetype = I

[State 650, VarSet]
type = VarSet
trigger1 = var(2) != 2
trigger1 = time = 0
var(2) = 1

[State 650, VarSet]
type = VarSet
trigger1 = var(3) != 2
trigger1 = time = 0
var(3) = 1

[State 1700, ChangeState]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;=====================================================================
; コークスクリュー_ノーマルヒット(相手側)
;=====================================================================
[Statedef 1701]
type    = A
movetype= H
physics = N
anim = 5030
velset = 0,0
poweradd = 0
ctrl = 0

; 相手がガードまたはヘルパーの場合に相手を元のステートに戻す処理
[State 651, SelfState]
type = SelfState
trigger1 = GetHitVar(Guarded)
trigger2 = IsHelper
value = PrevStateNo

[State 651, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA

[State 651, Turn]
type = Turn
trigger1 = Time = 0
trigger1 = P2Dist X < 0

[State 651, VelSet]
type = VelSet
trigger1 = HitShakeOver
x = -8
y = -6
persistent = 0

[State 651, ChangeState]
type = ChangeState
trigger1 = HitShakeOver
value = 9910

;===============================================================
; セスビジョン(弱)
;===============================================================
;---------------------------------------------------------
; 開始
;---------------------------------------------------------

[StateDef 1800]
type = S
movetype = I
physics = N
anim = 1800
velset = 0, 0
ctrl = 0
poweradd = 80*!var(6)

[State 1800, PlaySnd]
type = PlaySnd
trigger1 = AnimElemTime(3) = 0
value = s5, 1

[State 1800, NotHitBy]
type = NotHitBy
trigger1 = AnimElemTime(3) >= 0
trigger1 = AnimElemTime(8) < 0
value = SCA
time = 1
ignorehitpause = 1

[State 1800, PlayerPush]
type = PlayerPush
trigger1 = animelemTime(3) >= 0
trigger1 = animelemTime(8) < 0
value = 0
ignorehitpause = 1

[State 1800, VelSet]
type = VelSet
trigger1 = animelem = 3
x = 5

[State 1600, VelSet]
type = VelMul
trigger1 = animelemTime(8) >= 0
x = 0.8

[State 1600, StateTypeSet]
type = null	; StateTypeSet
trigger1 = AnimElemTime(2) = 0
StateType = A

[State 1800, ChangeState]
type = ChangeState
triggerall = AnimElemTime(7) >= 0 && AnimElemTime(8) <= 0
trigger1 = Helper(8990),var(0) = 310 || Helper(8990),var(0) = 1050 || Helper(8990),var(0) = 1060
value = 1850
ctrl = 0

[State 1800, ChangeState]
type = ChangeState
triggerall = AnimElemTime(7) >= 0 && AnimElemTime(8) <= 0
trigger1 = Helper(8990),var(0) = 1090
value = 1860
ctrl = 0

[State 1800, ChangeState]
type = ChangeState
triggerall = AnimElemTime(7) >= 0 && AnimElemTime(8) <= 0
trigger1 = Helper(8990),var(0) = 1830
value = 1870
ctrl = 0

[State 1600, ChangeState]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;===============================================================
; セスビジョン(強)
;===============================================================
;---------------------------------------------------------
; 開始
;---------------------------------------------------------

[StateDef 1810]
type = S
movetype = I
physics = N
anim = 1810
velset = 0, 0
ctrl = 0
poweradd = 80*!var(6)

[State 1800, PlaySnd]
type = PlaySnd
trigger1 = AnimElemTime(3) = 0
value = s5, 1

[State 1800, NotHitBy]
type = NotHitBy
trigger1 = AnimElemTime(3) >= 0
trigger1 = AnimElemTime(8) < 0
value = SCA
time = 1
ignorehitpause = 1

[State 1800, PlayerPush]
type = PlayerPush
trigger1 = animelemTime(3) >= 0
trigger1 = animelemTime(8) < 0
value = 0
ignorehitpause = 1

[State 1800, VelSet]
type = VelSet
trigger1 = animelem = 3
x = 7

[State 1600, VelSet]
type = VelMul
trigger1 = animelemTime(8) >= 0
x = 0.8

[State 1600, StateTypeSet]
type = null	; StateTypeSet
trigger1 = AnimElemTime(2) = 0
StateType = A

[State 1800, ChangeState]
type = ChangeState
triggerall = AnimElemTime(7) >= 0 && AnimElemTime(8) <= 0
trigger1 = Helper(8990),var(0) = 310 || Helper(8990),var(0) = 1050 || Helper(8990),var(0) = 1060
value = 1850
ctrl = 0

[State 1800, ChangeState]
type = ChangeState
triggerall = AnimElemTime(7) >= 0 && AnimElemTime(8) <= 0
trigger1 = Helper(8990),var(0) = 1090
value = 1860
ctrl = 0

[State 1800, ChangeState]
type = ChangeState
triggerall = AnimElemTime(7) >= 0 && AnimElemTime(8) <= 0
trigger1 = Helper(8990),var(0) = 1830
value = 1870
ctrl = 0

[State 1600, ChangeState]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;===============================================================
; スライディング(セスビジョン派生)
;===============================================================
;---------------------------------------------------------
; 開始
;---------------------------------------------------------

[StateDef 1850]
type = S
movetype = I
physics = N
anim = 1850
velset = 0, 0
ctrl = 0
poweradd = 80*!var(6)

[State 1810, PlayerPush]
type = PlayerPush
trigger1 = animelemTime(2) < 0
value = 0
ignorehitpause = 1

[State 1810, VelSet]
type = VelSet
trigger1 = animelem = 2
x = 5.0

[State 1810, VelSet]
type = VelMul
trigger1 = animelemtime(6) > 0
x = 0.7

[State 1810, StateTypeSet]
type = StateTypeSet
trigger1 = AnimElemTime(2) = 0
MoveType = A

[State 1810, HitDef]
type = HitDef
trigger1 = AnimElemTime(5) = 0
attr = C, SA
animtype = Hard
damage = 107, 8
guardflag = L
pausetime = 12, 12
getpower = 120*!var(6), 120*!var(6)
givepower = 30, 30
sparkno = s8020
sparkxy = -5,-8
guard.sparkno = S8070
hitsound = s1,3
guardsound = s2,1
ground.type = Low
ground.slidetime = 24
ground.hittime = 28
ground.velocity = 0
air.velocity = 0, 0
guard.velocity = -10	; -12
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
ground.cornerpush.veloff = 0
air.fall = 1
fall.recover = 1
fall.recovertime = 999
yaccel = .45	;.55
id = 1850	; IfElse(var(1)=0,1810,1);1+(var(1)=0)
;p2StateNo = 9900
nochainid = var(11)

[State 1810, TargetState]
type = TargetState
triggerall = NumTarget(1850)
triggerall = (Target,StateNo = [5000, 5099]) && Target,MoveType = H
triggerall = AnimElemTime(5) >= 0 && AnimElemTime(6) <= 0
trigger1 = Target(1850),GetHitVar(guarded) = 0
value = 1851
id = 1850
persistent = 0
ignorehitpause = 1

[State 1810, StateTypeSet]
type = StateTypeSet
trigger1 = AnimElemTime(7) = 0
movetype = I

[State 1810, VarSet]
type = VarSet
trigger1 = var(2) != 2
trigger1 = animelem = 2
var(2) = 1

[State 1810, VarSet]
type = VarSet
trigger1 = var(3) != 2
trigger1 = animelem = 2
var(3) = 1

[State 1810, ChangeState]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;=====================================================================
; スライディング(セスビジョン派生)_ノーマルヒット(相手側)
;=====================================================================
[Statedef 1851]
type = A
movetype = H
physics = N
anim = 5030
velset = 0,0
poweradd = 0
ctrl = 0

; 相手がガードまたはヘルパーの場合に相手を元のステートに戻す処理
[State 1811, SelfState]
type = SelfState
trigger1 = GetHitVar(Guarded)
trigger2 = IsHelper
value = PrevStateNo

[State 1811, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA

[State 1811, Turn]
type = Turn
trigger1 = Time = 0
trigger1 = P2Dist X < 0

[State 1811, VelSet]
type = VelSet
trigger1 = HitShakeOver
x = -6
y = -3
persistent = 0

[State 651, ChangeState]
type = ChangeState
trigger1 = HitShakeOver
value = 9910

;===============================================================
; ローリングキック
;===============================================================
;---------------------------------------------------------
; 開始
;---------------------------------------------------------

[StateDef 1860]
type = S
movetype = I
physics = N
anim = 1860
velset = 0, 0
ctrl = 0
poweradd = 80*!var(6)

[State 1820, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 1
movecamera = 1, 0

[State 1820, Turn]
type = turn
trigger1 = Time = 0
trigger1 = 0	; P2Dist X < -20

[State 1820, VelSet]
type = VelSet
trigger1 = animelem = 2
x = 2.0
y = -8

[State 1820, VelSet]
type = VelAdd
trigger1 = animelemTime(2) > 0
trigger1 = animelemTime(11) < 0
x = 0
y = 0.5

[State 1820, VelSet]
type = VelSet
trigger1 = animelem = 11
x = 0
y = 0

[State 1820, VelSet]
type = VelSet
trigger1 = animelemTime(12) = 0
x = 2.5
y = 8

;ハェー！
[State 1820, PlaySnd]
type = PlaySnd
trigger1 = AnimElem = 12
value = s8, 9

[State 1860, StateTypeSet]
type = StateTypeSet
trigger1 = AnimElemTime(2) = 0
MoveType = A
StateType = A

[State 1820, HitDef]
type = HitDef
trigger1 = AnimElem = 12
attr = A, SA
animtype = Hard
damage = 132, 8
guardflag = HA
pausetime = 12, 12
getpower = 120*!var(6), 120*!var(6)
givepower = 30, 30
sparkno = s8030
sparkxy = 0,-20	;-70
guard.sparkno = s8070
hitsound = s1,4
guardsound = s2,1
ground.type = High
ground.slidetime = 23
ground.hittime = 27
ground.velocity = -4.8, -5.0	; -4.5
air.velocity = -5, -4.3
guard.velocity = -9	; -12
envshake.time = 12
envshake.ampl = -3
envshake.freq = 60
envshake.phase = -3
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
ground.cornerpush.veloff = 0
fall = 1
fall.recover = 1
fall.recovertime = 999	;38
yaccel = .45	;.55
id = 1860	; IfElse(var(1)=0,1820,1);1+(var(1)=0)
;p2StateNo = 9900
nochainid = var(11)

[State 1820, TargetState]
type = TargetState
triggerall = NumTarget(1860)
triggerall = (Target,StateNo = [5000, 5099]) && Target,MoveType = H
triggerall = AnimElemTime(11) >= 0
trigger1 = Target(1860),GetHitVar(guarded) = 0
value = 651
id = 1860
persistent = 0
ignorehitpause = 1

[State 1820, VarSet]
type = VarSet
trigger1 = var(2) != 2
trigger1 = animelem = 2
var(2) = 1

[State 1820, VarSet]
type = VarSet
trigger1 = var(3) != 2
trigger1 = animelem = 2
var(3) = 1

[State 1820, ChangeState]
type = ChangeState
trigger1 = Vel Y > 0 && Pos Y >= 0
value = 1861
ctrl = 0

;---------------------------------------------------------
; 着地
;---------------------------------------------------------

[StateDef 1861]
type = S
movetype = I
physics = S
anim = 1861
velset = 0, 0

[State 1821, PlaySnd]
type = PlaySnd
trigger1 = Time = 0
value = s52, 0

[State 1821, PosSet]
type = PosSet
trigger1 = Time = 0
Y = 0

[State 1860, StateTypeSet]
type = StateTypeSet
trigger1 = AnimElemTime(2) = 0
MoveType = I

[State 1821, ChangeState]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;===============================================================
; フェイント
;===============================================================
;---------------------------------------------------------
; 開始
;---------------------------------------------------------
[StateDef 1870]
type = S
movetype = A
physics = N
anim = 1870
velset = 0, 0
ctrl = 0
poweradd = 0	; 80*!var(6)

[State 1830, PosAdd]
type = PosAdd
trigger1 = AnimElemTime(2) = 0
x = -40

;冗談だよ
[State 1830, PlaySnd]
type = PlaySnd
trigger1 = AnimElem = 2	; 5
value = s184, 1

[State 1830, ChangeState]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;===============================================================
; アッパーカット
;===============================================================
;---------------------------------------------------------
; 開始
;---------------------------------------------------------
[StateDef 1900]
type = S
movetype = A
physics = N
anim = 1900
velset = 0, 0
ctrl = 0
poweradd = 80*!var(6)

[State 1110, VarAdd]
type = VarAdd
triggerall = time = 0 && fvar(0) > 0 && var(6)
trigger1 = prevstateno = 210 || prevstateno = 240 || prevstateno = 440 || prevstateno = 300 || prevstateno = 340
trigger2 = var(9) = 0 && ((prevstateno = [200, 245]) || (prevstateno = [400, 440]) || (prevstateno = [300, 399]))
trigger3 = (prevstateno = [1000, 1049]) || (prevstateno = [1100, 1199]) || (prevstateno = [1200, 1299]) || (prevstateno = [1300, 1399]) || (prevstateno = [1400, 1421])
trigger4 = (prevstateno = [1500, 1599]) || (prevstateno = [1600, 1699]) || (prevstateno = [1700, 1799]) || (prevstateno = [1800, 1899]) || (prevstateno = [1900, 1999])
fvar(0) = -128
persistent = 0

[State 1110, VarSet]
type = VarSet
triggerall = time = 0 && var(6)
trigger1 = prevstateno = 210 || prevstateno = 240 || prevstateno = 440 || prevstateno = 300 || prevstateno = 340
trigger2 = var(9) = 0 && ((prevstateno = [200, 245]) || (prevstateno = [400, 440]) || (prevstateno = [300, 399]))
trigger3 = (prevstateno = [1000, 1049]) || (prevstateno = [1100, 1199]) || (prevstateno = [1200, 1299]) || (prevstateno = [1300, 1399]) || (prevstateno = [1400, 1421])
trigger4 = (prevstateno = [1500, 1599]) || (prevstateno = [1600, 1699]) || (prevstateno = [1700, 1799]) || (prevstateno = [1800, 1899]) || (prevstateno = [1900, 1999])
var(8) = 8
persistent = 0

;先行入力発動時の振り向き
[State 1110, Turn]
type = Turn
triggerall = Time = 0
trigger1 = P2Dist X < 0

; キャンセル受付時間の解除
[State 1100, VarSet]
type = VarSet
trigger1 = AnimElem = 10
var(9) = 0

; キャンセル受付時間の格納
[State 1100, VarSet]
type = VarSet
trigger1 = AnimElem = 9
var(9) = 3

[State 1110, NotHitBy]
type = NotHitBy
trigger1 = AnimElemTime(1) >= 0 && AnimElemTime(5) < 0
value = , AA, AT
time = 1
ignorehitpause = 1

;フッ
[State 1100, PlaySnd]
type = PlaySnd
trigger1 = time = 0
value = s9, 1	; s8, 0

[State 1100, PlaySnd]
type = PlaySnd
trigger1 =  AnimElem = 4
value = s5, 0

;砂埃
[State 1100, Explod]
type = explod
trigger1 = AnimElem = 4
postype = p1
pos = 60, 5
sprpriority = 1
anim = 7200
persistent = 1
ownpal = 1
removeongethit = 1
ignorehitpause = 0

[State 1110, HitDef]
type = HitDef
trigger1 = AnimElem = 5
attr = S, SA
animtype = Hard
damage = 116, 8
guardflag = M
hitflag = MAF
pausetime = 24, 24
getpower = 120*!var(6), 120*!var(6)
givepower = 30, 30
sparkno = s8030
guard.sparkno = s8070
sparkxy = -15,-70
hitsound = s1,5
guardsound = s2,1
ground.type = High
ground.slidetime = 16
ground.hittime = 22
ground.velocity = -2, -12.5
air.velocity = -2, -12.5
guard.velocity = -8
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
ground.cornerpush.veloff = 0
fall = 1
fall.recover = 1
fall.recovertime = 68	;38	;38
yaccel = .55
id = IfElse(var(1)=0,1110,1);1+(var(1)=0)
;p2StateNo = 9900
nochainid = var(11)

[State 1110, TargetState]
type = TargetState
triggerall = NumTarget(1114)
triggerall = NumTarget(1115) = 0
trigger1 = Target,MoveType = H && Target,StateNo >= 200 && !Target,ctrl
trigger1 = Target(1110),GetHitVar(guarded) = 0
value = 9920
id = 1114
ignorehitpause = 1
persistent = 0

[State 1110, TargetState]
type = TargetState
triggerall = NumTarget(1115)
trigger1 = Target,MoveType = H && Target,StateNo >= 200 && !Target,ctrl
trigger1 = Target(1110),GetHitVar(guarded) = 0
value = 9920
id = 1115
ignorehitpause = 1
persistent = 0

[State 1110, StateTypeSet]
type = StateTypeSet
trigger1 = AnimElemTime(6) = 0
movetype = I

[State 1110, ChangeState]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

