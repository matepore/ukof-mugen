;===========================================================================================================================
;Orochi Eagrose Version, original char by Orochi Herman, re-written by Eagrose
;CNS file part: Hyper Moves
;===========================================================================================================================
;---------------------------------------------------------------------------
; Mu ni Kaerou (DM)
[Statedef 2000]
type = S
movetype = I
ctrl = 0
anim = 2000
physics = S
velset = 0,0
poweradd = -1000
sprpriority = 2

[State 2000]
type = playerpush
trigger1 = 1
value = 0
ignorehitpause = 1

[State 2000] ;---- unused
type = VarSet
trigger1 = Time = 0
var(26) = 0

[State 2000, HitBy]
type = notHitBy
trigger1 = 1
value = SCA
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State 2000, HitBy] ;---- modified for balance
type = null;HitBy
trigger1 = 1
value = SCA, SA,HA,NP,SP,HP,ST,HT
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

;[State haha] ;---- Mu ni Kaerou movehit counter used for damage adjustment
;type = VarSet
;trigger1 = Time = 0
;var(13) = 0
;ignorehitpause = 1

[State 2000] ;---- unused
type = VarSet
trigger1 = Time = 0
var(16) = 1
ignorehitpause = 1

[State 2000, StopSnd9]
type = StopSnd
trigger1 = time = 0
channel = 9
ignorehitpause = 1

[State 2000, StopSnd10]
type = StopSnd
trigger1 = time = 0
channel = 10
ignorehitpause = 1

[State 2000] ;---- body palfx disable
type = VarSet
trigger1 = Time = [0,27]
var(27) = 0
ignorehitpause = 1

[State 2000] ;---- body palfx enable
type = VarSet
trigger1 = Time = 28
var(27) = 1
ignorehitpause = 1

[State 2000, 3]  ;damage adjustment for Mu ni Kaerou lv3 (Extend)
type = varset
trigger1 = time = 0
var(13) = 1

[State 2000]
type = AssertSpecial
trigger1 = Time = [0,27]
flag = nobg
flag2 = nofg
;supermovetime = -1

[State 2000, Afterimage]
type = NULL;Afterimage
;triggerall = var(18) = 0   ;Catalyst Stand Anim Only
triggerall = roundstate != 0
trigger1 = time = 0
trans = add
Paladd = 15,0,15
PalContrast =  250, 250, 250
PalBright = 0,0,0
time    =  -1
length  = 15
TimeGap = 1
FrameGap = 1

[State 2000, Helper0]
type = Helper
trigger1 = time = 0
helpertype = normal
name = "Mu ni Kaerou lv1 BG helper"
ID = 2005
pos = 0,0
postype = back
;facing = 1
stateno = 2005
keyctrl = 0
ownpal = 1
scale = 1,1
supermovetime = ifelse(fvar(6) = 1,43,99999)
persistent = 0

[State 2000] ;---- Mu ni Kaerou start voice snd
type = PlaySnd
trigger1 = AnimElem = 1,1
value = s1,6
channel = 0

;[State haha] ;---- unused
;type = VarSet
;trigger1 = AnimElem = 1
;fvar(5) = 0
;ignorehitpause = 1

[State 2000, poweradd] ;Super Cancel poweradd
type = poweradd
Triggerall = time = 0
trigger1 = prevstateno = 1200 ;神指中段
trigger2 = prevstateno = 1210 ;神指上段
trigger3 = prevstateno = 1220 ;神指下段
trigger4 = prevstateno = 1401
;trigger5 = prevstateno = 1000 ;天雷闪
;trigger6 = prevstateno = 1001
;trigger7 = prevstateno = 1002
;trigger8 = prevstateno = 1003
;trigger9 = prevstateno = 1004
;trigger10 = prevstateno = 1005
value = -1000
ignorehitpause = 1

[State 2000, Explod] ;Super Cancel Effect
type = Explod
triggerall = time = 0
trigger1 = prevstateno = 1200 ;神指中段
trigger2 = prevstateno = 1210 ;神指上段
trigger3 = prevstateno = 1220 ;神指下段
trigger4 = prevstateno = 1401
;trigger5 = prevstateno = 1000 ;天雷闪
;trigger6 = prevstateno = 1001
;trigger7 = prevstateno = 1002
;trigger8 = prevstateno = 1003
;trigger9 = prevstateno = 1004
;trigger10 = prevstateno = 1005
anim = 10300
pos = 0,75
postype = left
removetime = -2
bindtime = -1
pausemove = 1
supermove = 1
sprpriority = 9
ownpal = 1

[State 2000, Explod] ;Super Cancel Effect
type = Explod
triggerall = time = 0
trigger1 = prevstateno = 1200 ;神指中段
trigger2 = prevstateno = 1210 ;神指上段
trigger3 = prevstateno = 1220 ;神指下段
trigger4 = prevstateno = 1401
;trigger5 = prevstateno = 1000 ;天雷闪
;trigger6 = prevstateno = 1001
;trigger7 = prevstateno = 1002
;trigger8 = prevstateno = 1003
;trigger9 = prevstateno = 1004
;trigger10 = prevstateno = 1005
anim = 10301
pos = 0,73
postype = left
removetime = -2
bindtime = -1
pausemove = 1
supermove = 1
sprpriority = 8
trans = addalpha
alpha = 256, 135
ownpal = 1

[State 2000, Black]
type     = EnvColor
trigger1 = time = [0,27]
value    = 255 * (time = [1,4]),255 * (time = [1,4]),255 * (time = [1,4])
time     = 1
under    = 1
supermovetime = -1

[State 2000, SuperPause]
type = SuperPause
trigger1 = time = 0
time = 30
anim = -1
movetime = 30
darken = 0
unhittable = 1
p2defmul = 1

[State 2000, Waves] ;XI_supermove_lv1_background
type = Explod
trigger1 = time = 0
anim = 10201
pos = Ceil(2 * Const(size.xscale)),Ceil(-128 * Const(size.yscale))
postype = p1
sprpriority = -1
removetime  = -2
removeongethit = 1
persistent = 0
ownpal = 1
supermovetime = -1

[State 2000, Waves] ;XI_supermove_lv1_foreground
type = Explod
trigger1 = time = 10
anim = 10202
pos = Ceil(2 * Const(size.xscale)),Ceil(-128 * Const(size.yscale))
postype = p1
sprpriority = 3
removetime  = -2
removeongethit = 1
persistent = 0
ownpal = 1
supermovetime = -1

[State 2000] ;---- SuperMove Snd
type = PlaySnd
trigger1 = time = 0
value = s4,4

[State 2000] ;---- SuperMove Snd
type = PlaySnd
trigger1 = time = 18
value = s4,5

[State 2000, BGPalFX0]
type = Null;BGPalFX
trigger1 = Time = 32
time = 130
;color = 256
;invertall = 0
add = 0,0,0
mul = 256,256,256
sinadd = 256,256,256


[State 2000] ;---- Mu ni Kaerou lv1 voice Snd (using channel 0)
type = PlaySnd
trigger1 = AnimElem = 6, 5;14
value = s1,7
channel = 0

;[State haha] ;---- Mu ni Kaerou lv1 background Snd (using channel 9,10)
;type = PlaySnd
;trigger1 = AnimElem = 6, 13;5
;trigger2 = AnimElem = 6, 16;5
;value = s0,333
;channel = 9 + (AnimElemTime(6) = 16)
;abspan = 255 * IfElse(AnimElemTime(6) = 16, -1, 1)

[State 2000] ;Super Cancel from Shattering Mirror, targetlifeadd
type = targetlifeadd
triggerall = AnimTime = 0
trigger1 = prevstateno = 1200
trigger1 = target,StateNo = 1205
trigger2 = prevstateno = 1210
trigger2 = target,StateNo = 1205
trigger3 = prevstateno = 1220
trigger3 = target,StateNo = 1225
trigger4 = prevstateno = 1220
trigger4 = target,StateNo = 1226
trigger5 = prevstateno = 1401
trigger5 = target,StateNo = 1205
value = floor(-100*fvar(3))
kill = 0
absolute = 1

[State 2000] ;Super Cancel from Shattering Mirror, targetstate
type = targetstate
triggerall = AnimTime = 0
trigger1 = prevstateno = 1200
trigger1 = target,StateNo = 1205
trigger2 = prevstateno = 1210
trigger2 = target,StateNo = 1205
trigger3 = prevstateno = 1220
trigger3 = target,StateNo = 1225
trigger4 = prevstateno = 1220
trigger4 = target,StateNo = 1226
trigger5 = prevstateno = 1401
trigger5 = target,StateNo = 1205
value = 2003

[State 2000]
type = ChangeState
trigger1 = AnimTime = 0
value = 2001

;---------------------------------------------------------------------------
; Mu ni Kaerou lv1 progressing
[Statedef 2001]
type = S
movetype = A
physics = S
ctrl = 0
velset = 0,0
anim = 2001
sprpriority = 2

[State haha]
type = playerpush
trigger1 = 1
value = 0
ignorehitpause = 1

[State haha]
type = NotHitBy
trigger1 = time <= 1
value = SCA
time = 1
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State 0, Mu ni Kaerou lv1 hitdef helper]
type = Helper
TriggerAll = helper(2005),var(6) != 1 ; ---- not during time stop
trigger1 = Time = 2
trigger2 = Time = 9
trigger3 = Time = 17
trigger4 = Time = 25
trigger5 = Time = 33
trigger6 = Time = 41
trigger7 = Time = 49
trigger8 = Time = 57
helpertype = normal
name = "Mu ni Kaerou lv1 hitdef helper"
ID = 2004
pos = 0,0
postype = p1
stateno = 2004
keyctrl = 0
ownpal = 1
scale = 1,1
supermovetime = 0;99999
ignorehitpause = 1

[State , ProjectileNul] ;enemy Projectile nullifier
type = Projectile
TriggerAll = helper(2005),var(6) != 1 ; ---- not during time stop
trigger1 = Time = 2
trigger2 = Time = 9
trigger3 = Time = 17
trigger4 = Time = 25
trigger5 = Time = 33
trigger6 = Time = 41
trigger7 = Time = 49
trigger8 = Time = 57
attr = S,SP
hitflag = P
guardflag = N
animtype = Hard
priority = 7,hit
sparkno = -1
sparkxy = -999, -999
getpower = 0,0
givepower = 0,0
damage = 0, 0
pausetime = 0,0
projscale = Const(size.xscale), Const(size.yscale)
projpriority = 99999
projanim = 2006
projhitanim = 2006
projremanim = 2006
projcancelanim = 2006
;projscale = 1,1
;projremove = 1
projremovetime = 8;4
p2facing = 1
p2stateno = 2003

[State haha]
type = ChangeState
trigger1 = AnimTime = 0
;trigger2 = RoundState > 2
value = 2002

;---------------------------------------------------------------------------
; Mu ni Kaerou lv1 end
[Statedef 2002]
type = S
movetype = I
physics = S
ctrl = 0
velset = 0,0
anim = 2003
sprpriority = 2

[State haha] ;---- disabled for balance
type = playerpush
trigger1 = animelem = 1, >=0
trigger1 = animelem = 2, <0
value = 0
ignorehitpause = 1

[State 0, notHitBy] ;---- disabled for balance
type = null;notHitBy
trigger1 = animelem = 1, >=0
trigger1 = animelem = 2, <0
value = SCA, AA,AT,AP
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[state 0, 3]  ;damage adjustment for Mu ni Kaerou lv3 (Extend)
type = varset
trigger1 = animtime = 0
var(13) = 0

[State haha]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Mu ni Kaerou Victim State (stun)
[Statedef 2003]
type    = U
movetype= H
physics = N
velset = 0,0

[state haha]  ;target is ishelper, debug
type = nothitby
trigger1 = ishelper
value = SCA
time = -1
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State , RemoveExplod0]  ;target is ishelper, debug
type = RemoveExplod
triggerall = ishelper
trigger1 = 1
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[state haha] ;target is ishelper, debug
type = destroyself
triggerall = ishelper
trigger1 = time > 0
trigger1 = 1
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State , HitBy0]
type = HitBy
trigger1 = 1
value = SCA, NA, SA, HA, NP, SP, HP, NT, ST, HT
time = -1
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[state haha]
type = lifeset
trigger1 = life <= 1
value = 0
ignorehitpause = 1

[state haha]
type = lifeadd
trigger1 = life <= 1
value = -99999
absolute = 1
ignorehitpause = 1

[State 5000, 1] ;Anim for HIT_LIGHT to HIT_HARD
type = ChangeAnim
trigger1 = Time = 0
trigger1 = GetHitVar(animtype) != [3,5]
value = ifelse((GetHitVar(groundtype) = 1),5000,5010) + GetHitVar(animtype)

[State 5000, 2] ;Anim for HIT_BACK
type = ChangeAnim
trigger1 = Time = 0
trigger1 = GetHitVar(animtype) = [3,5]
value = 5030

[State 5000, 3] ;Anim for HIT_UP/HIT_DIAGUP (only if it exists)
type = ChangeAnim
trigger1 = Time = 0
trigger1 = (GetHitVar(animtype) = [4,5]) && (SelfAnimExist(5047 + GetHitVar(animtype)))
value = 5047 + GetHitVar(animtype) ;5051 - 4 + type

[State 5000, 4] ;Freeze anim
type = ChangeAnim
trigger1 = Time > 0
value = anim

[State 5000, 5] ;State type gets set to aerial if getting hit up
type = StateTypeSet
trigger1 = Time = 0
trigger1 = GetHitVar(yvel) != 0 || GetHitVar(fall)
trigger2 = Pos Y != 0
statetype = a

[State 5000, 7]
type = selfState ;changestate
trigger1 = HitShakeOver
value = 5030

[State 5000, FFB Light]
type = ForceFeedback
trigger1 = anim = 5000
trigger2 = anim = 5010
persistent = 0
time = 6
waveform = square

[State 5000, FFB Medium]
type = ForceFeedback
trigger1 = anim = 5001
trigger2 = anim = 5011
persistent = 0
time = 8
waveform = sinesquare
ampl = 110,-1,-.3

[State 5000, FFB Hard]
type = ForceFeedback
trigger1 = anim = 5012
trigger2 = anim = 5002
trigger3 = anim = 5030
persistent = 0
time = 15
waveform = sinesquare
ampl = 140

;---------------------------------------------------------------------------
; Mu ni Kaerou lv1 hitdef helper
[Statedef 2004]
type = S
movetype = A
physics = S
ctrl = 0
anim = 2007

[State 2004, Override]
type = HitOverride
trigger1 = 1
attr = SCA, NA,SA,HA,NT,ST,HT,NP,SP,HP,AA,AT,AP
slot = 0
stateno = 2502
time = -1
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[state haha]
type = playerpush
trigger1 = 1
value = 0
ignorehitpause = 1

[state haha]
type = nothitby
trigger1 = 1
value = SCA
time = -1
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State 0, hitdef];first hit main damage
type = hitdef
triggerall = animelem = 1
trigger1 = root,Time <= 51
trigger1 = root,Time = [2,4]
trigger1 = !parent,ishelper
trigger2 = parent,Time <= 51+40
trigger2 = parent,Time = [2+40,4+40]
trigger2 = parent,ishelper(2005)
;trigger1 = Time = 2
;trigger2 = Time = 9
;trigger3 = Time = 17
;trigger4 = Time = 25
;trigger5 = Time = 33
;trigger6 = Time = 41
;trigger7 = Time = 49
attr = A,HP
hitflag = MAFP ;D
guardflag = M;A
animtype = Hard
air.animtype = Up
priority = 7,hit
damage = floor(187*root,fvar(3)),floor(37*root,fvar(3))
;Ceil((300 * (1 + ((var(32) = [5,6]) * .34))) * fvar(2)), Ceil((10 * (1 + ((var(32) = [5,6]) * .34))) * fvar(2))
pausetime = 0,0
guard.pausetime = 0,0
sparkno = -1
guard.sparkno = -1
;sparkxy = 0,0
;hitsound = S0,2
;guardsound = S0,21
ground.type = High
ground.slidetime = 10
guard.slidetime = 20
ground.hittime = 25
ground.velocity = 0
guard.velocity = 0
air.velocity = -6,-6
airguard.velocity = 0,0
air.juggle = 0
;p2stateno = 5000 ;ifelse(var(25) = 1, 2003, 5000)
;p2getp1state = 0
fall.xvelocity = -3.27;272725105286
fall.yvelocity = -3.25;555985694885
fall.recover = 0
air.fall = 1
air.recover = 0
getpower = 0,0
givepower = 15, 15
p2facing = 1
palfx.time = 20
palfx.add = 50,50,50
palfx.mul = 250,250,250
palfx.sinadd = 150,150,150,10
palfx.invertall = 1

[State 0, hitdef]
type = hitdef
triggerall = animelem = 1
trigger1 = root,Time <= 51
trigger1 = root,Time >= 5
trigger1 = !parent,ishelper
trigger2 = parent,Time <= 51+40
trigger2 = parent,Time >= 5+40
trigger2 = parent,ishelper(2005)
;trigger1 = Time = 2
;trigger2 = Time = 9
;trigger3 = Time = 17
;trigger4 = Time = 25
;trigger5 = Time = 33
;trigger6 = Time = 41
;trigger7 = Time = 49
attr = A,HP
hitflag = MAFP ;D
guardflag = M;A
animtype = Hard
air.animtype = Up
priority = 7,hit
damage = floor(19*root,fvar(3)),floor(4*root,fvar(3))
;Ceil((300 * (1 + ((var(32) = [5,6]) * .34))) * fvar(2)), Ceil((10 * (1 + ((var(32) = [5,6]) * .34))) * fvar(2))
pausetime = 0,0
guard.pausetime = 0,0
sparkno = -1
guard.sparkno = -1
;sparkxy = 0,0
;hitsound = S0,2
;guardsound = S0,21
ground.type = High
ground.slidetime = 10
guard.slidetime = 20
ground.hittime = 25
ground.velocity = 0
guard.velocity = 0
air.velocity = -6,-6
airguard.velocity = 0,0
air.juggle = 0
;p2stateno = 5000 ;ifelse(var(25) = 1, 2003, 5000)
;p2getp1state = 0
fall.xvelocity = -3.27;272725105286
fall.yvelocity = -3.25;555985694885
fall.recover = 0
air.fall = 1
air.recover = 0
getpower = 0,0
givepower = 15, 15
p2facing = 1
palfx.time = 20
palfx.add = 50,50,50
palfx.mul = 250,250,250
palfx.sinadd = 150,150,150,10
palfx.invertall = 1

[State 0, hitdef] ;the last hit force enemy to fall
type = hitdef
triggerall = animelem = 1
trigger1 = root,Time > 51
trigger1 = !parent,ishelper
trigger2 = parent,Time > 51+40
trigger2 = parent,ishelper(2005)
;trigger1 = Time = 57
attr = A,HP
hitflag = MAFP ;D
guardflag = M
animtype = DiagUp
air.animtype = DiagUp
priority = 7,hit
damage = floor(50*root,fvar(3)),floor(10*root,fvar(3))
pausetime = 0,0
guard.pausetime = 0,0
sparkno = -1
guard.sparkno = -1
;sparkxy = 0,0
;hitsound = S0,2
;guardsound = S0,21
ground.type = High
ground.slidetime = 10
guard.slidetime = 20
ground.hittime = 25
ground.velocity = -6,-6
guard.velocity = 0
air.velocity = -6,-9
airguard.velocity = 0,0
air.juggle = 0
;p2getp1state = 0
;p2stateno = 5000 ;ifelse(var(25) = 1, 2003, 5000)
fall = 1
fall.xvelocity = -3.27;272725105286
fall.yvelocity = -3.25;555985694885
fall.recover = 0
air.fall = 1
air.recover = 0
getpower = 0,0
givepower = 15, 15
p2facing = 1
palfx.time = 20
palfx.add = 50,50,50
palfx.mul = 250,250,250
palfx.sinadd = 150,150,150,10
palfx.invertall = 1

[state 0,] ;pause on every 3 tick
type = pause
trigger1 = movehit
trigger1 = gametime%3=0
time = 1
movetime = 0
ignorehitpause = 1
;persistent = 3

[State 210, Explod]
type = Explod
triggerall = movehit
trigger1 = time = [2,3]
anim  = F3
postype = p2
pos = (target, Const(size.head.pos.x)), ifelse((target, statetype = S), (target, Const(size.head.pos.y)), (target, Const(size.mid.pos.y)))
scale = target,const(size.xscale), target,const(size.yscale)
facing = -1
ownpal = 1
sprpriority = 2
bindtime = 1
ownpal = 1
persistent = 0
ignorehitpause = 1

[State 210, Explod]
type = Explod
triggerall = moveguarded
trigger1 = time = [2,3]
anim  = F40
postype = p2
pos = (target,Const(size.ground.front)) , (target,Const(size.mid.pos.y))
scale = (target,const(size.xscale)) , (target,const(size.yscale))
facing = -1
ownpal = 1
sprpriority = 2
bindtime = 1
ownpal = 1
persistent = 0
ignorehitpause = 1

[State haha]
type = DestroySelf
trigger1 = Time >= 10
trigger2 = movereversed
trigger3 = root,movetype = H
trigger3 = !parent,ishelper(2005)

;---------------------------------------------------------------------------
; Mu ni Kaerou lv1 BG helper
[Statedef 2005]
type = S
movetype = I
physics = N
ctrl = 0
anim = 2006

[State 0, VarSet]
type = VarSet
triggerall = time = 0
trigger1 = root,fvar(6) = 1
var(6) = 1
ignorehitpause = 1
;persistent =

[State 2004, Override]
type = HitOverride
trigger1 = 1
attr = SCA, NA,SA,HA,NT,ST,HT,NP,SP,HP,AA,AT,AP
slot = 0
stateno = 2502
time = -1
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State haha] ;---- Mu ni Kaerou lv1 background Snd (using channel 9,10)
type = PlaySnd
triggerall = root,stateno = 2000
trigger1 = root,AnimElem = 6, 13;5
trigger2 = root,AnimElem = 6, 16;5
value = s0,333
channel = 9 + (root,AnimElem = 6, 16)
abspan = 255 * IfElse((root,AnimElem = 6, 16), -1, 1)

[state haha]
type = playerpush
trigger1 = 1
value = 0
ignorehitpause = 1

[state haha]
type = nothitby
trigger1 = 1
value = SCA
time = -1
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State 800, destroy enemy's any hitdef helpers]
type = ReversalDef
trigger1 = root, stateno = 2001
reversal.attr = SCA, NP,SP,HP
hitflag = HLMAFDP
pausetime = 0,0
priority = 999, hit
numhits = 0
sparkno = -1
sparkxy = 100, -100
fall.xvelocity = -3.27
fall.yvelocity = -3.25
p2stateno = 2006

[State 210, Explod]
type = Explod
trigger1 = Time = 0
id = 2005
anim  = 2005    ;2005 lv1  2008 lv2
postype = back
pos = 0,280
ignorehitpause = 1
ownpal = 0
removetime = 380
sprpriority = -21
bindtime = -1  ;in oder not to see the edge of Explod when using H-res BG
supermovetime = ifelse(var(6) = 1,40,-1)
scale = 1.055, 1.075 ;const(size.yscale)

[State 0, EnvShake]
type = EnvShake
trigger1 = time = 32+ifelse(var(6)=1,3,0)
trigger2 = time = 42+ifelse(var(6)=1,3,0)
trigger3 = time = 117+ifelse(var(6)=1,3,0)
trigger4 = time = 127+ifelse(var(6)=1,3,0)
time = 10
ampl = -6
freq = 120
phase = 120
ignorehitpause = 1

[State , PalFX0] ;---- using var(1) to adjust palfx-----
type = PalFX
trigger1 = 1
time = 1
;color = 256
;invertall = 0
add = var(1),var(1),var(1)
mul = 256,256,256

[State haha] ;Palfx adjust
type = VarSet
trigger1 = Time = [0, 31+ifelse(var(6)=1,3,0)]
trigger2 = Time = 141
var(1) = -255

[State haha] ;Palfx adjust
type = VarAdd
trigger1 = Time = [32+ifelse(var(6)=1,3,0), 52+ifelse(var(6)=1,3,0)]
var(1) = 25

[State haha] ;Palfx adjust
type = VarSet
trigger1 = Time = 53+ifelse(var(6)=1,3,0)
var(1) = 255

[State haha] ;Palfx adjust
type = VarAdd
trigger1 = Time = [117+ifelse(var(6)=1,3,0), 141+ifelse(var(6)=1,3,0)]
var(1) = -30;-36

[State haha]
type = RemoveExplod
trigger1 = time >= 146+ifelse(var(6)=1,3,0)
trigger2 = root, MoveType = H
trigger2 = var(6) != 1
trigger3 = root, stateno = 2010 && root,time >= 30
trigger3 = var(6) != 1
trigger4 = root, stateno = 2020 && root,time >= 30
trigger4 = var(6) != 1
;trigger5 = RoundState > 2
id = 2005

[State haha] ;---- Stop background Snd when on hit( channel 9,10)
type = StopSnd
trigger1 = root, MoveType = H
channel = 9

[State haha] ;---- Stop background Snd when on hit( channel 9,10)
type = StopSnd
trigger1 = root, MoveType = H
channel = 10

[State 0, Mu ni Kaerou lv1 hitdef helper]
type = Helper
TriggerAll = var(6) = 1 ; ---- during time stop
trigger1 = Time = 2+40
trigger2 = Time = 9+40
trigger3 = Time = 17+40
trigger4 = Time = 25+40
trigger5 = Time = 33+40
trigger6 = Time = 41+40
trigger7 = Time = 49+40
trigger8 = Time = 57+40
helpertype = normal
name = "Mu ni Kaerou lv1 hitdef helper"
ID = 2004
pos = 0,0
postype = p1
stateno = 2004
keyctrl = 0
ownpal = 1
scale = 1,1
supermovetime = 0;99999
ignorehitpause = 1

[State , ProjectileNul] ;enemy Projectile nullifier
type = Projectile
TriggerAll = var(6) = 1 ; ---- during time stop
trigger1 = Time = 2+40
trigger2 = Time = 9+40
trigger3 = Time = 17+40
trigger4 = Time = 25+40
trigger5 = Time = 33+40
trigger6 = Time = 41+40
trigger7 = Time = 49+40
trigger8 = Time = 57+40
attr = S,SP
hitflag = P
guardflag = N
animtype = Hard
priority = 7,hit
sparkno = -1
sparkxy = -999, -999
getpower = 0,0
givepower = 0,0
damage = 0, 0
pausetime = 0,0
projscale = Const(size.xscale), Const(size.yscale)
projpriority = 99999
projanim = 2006
projhitanim = 2006
projremanim = 2006
projcancelanim = 2006
;projscale = 1,1
;projremove = 1
projremovetime = 8;4
p2facing = 1
p2stateno = 2003

[State haha]
type = DestroySelf
trigger1 = Time >= 147+ifelse(var(6)=1,3,0) ;152
trigger2 = root, MoveType = H
trigger2 = var(6) != 1

;---------------------------------------------------------------------------
; Reflector Victim, destroy enemy's any hitdef helpers/explod (shared by lv1 and lv2)
[Statedef 2006]
type = U
ctrl = 0
velset = 0,0
movetype = H
physics = U

[State 2006, HitOverride0]
type = null;HitOverride
trigger1 = 1
attr = SCA, NA, SA, HA, NP, SP, HP, NT, ST, HT, AA, AT, AP
slot = 0
stateno = -1
time = 1
forceair = 0

[state 2006, nothitby]  ;reversaled target is ishelper, debug
type = nothitby
trigger1 = ishelper
value = SCA
time = -1
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State 2006, RemoveExplod0]  ;reversaled target is ishelper, debug
type = RemoveExplod
triggerall = ishelper
trigger1 = 1
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[state 2006, destroyself] ;reversaled target is ishelper, debug
type = destroyself
triggerall = ishelper
trigger1 = 1
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State 2006, Changestate]
type = selfstate ;changestate
trigger1 = !ishelper
value = 5030 ;2003
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

;---------------------------------------------------------------------------
; Mu ni Kaerou lv2 (SDM)
[Statedef 2010]
type = S
movetype = I
physics = S
ctrl = 0
velset = 0,0
Anim = 2010
poweradd = -2000
sprpriority = 2

[State haha]
type = playerpush
trigger1 = 1
value = 0
ignorehitpause = 1

[State 0, StopSnd9]
type = StopSnd
trigger1 = time = 0
channel = 9
ignorehitpause = 1

[State 0, StopSnd10]
type = StopSnd
trigger1 = time = 0
channel = 10
ignorehitpause = 1

[State , BGPalFX0]
type = BGPalFX
trigger1 = 1
time = 2
mul = 100,100,100
invertall = 1
ignorehitpause = 1

[State haha] ;lv2 is completely unhittable
type = NotHitBy
trigger1 = 1
value = SCA
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

;[State haha]
;type = VarSet
;trigger1 = Time = 0
;fvar(2) = 1.2
;ignorehitpause = 1

;[State haha] ;---- Mu ni Kaerou movehit counter used for damage adjustment
;type = VarSet
;trigger1 = Time = 0
;var(13) = 0
;ignorehitpause = 1

[State haha] ;---- body palfx disable
type = VarSet
trigger1 = Time = [0,27]
var(27) = 0
ignorehitpause = 1

[State haha] ;---- body palfx enable
type = VarSet
trigger1 = Time = 28
var(27) = 1
ignorehitpause = 1

[state 0, 3]  ;damage adjustment for Mu ni Kaerou lv3 (Extend)
type = varset
trigger1 = time = 0
var(13) = 2

[State 0, Afterimage]
type = NULL;Afterimage
;triggerall = var(18) = 0   ;Catalyst Stand Anim Only
triggerall = roundstate != 0
trigger1 = time = 0
trans = add
Paladd = 15,0,15
PalContrast =  250, 250, 250
PalBright = 0,0,0
time    =  -1
length  = 15
TimeGap = 1
FrameGap = 1

[State , Helper0]
type = Helper
trigger1 = AnimElem = 1
helpertype = normal
name = "Mu ni Kaerou lv2 BG helper"
pos = 0,0
postype = back
;facing = 1
stateno = 2015
ID = 2015
keyctrl = 0
ownpal = 1
scale = 1,1
supermovetime = ifelse(fvar(6) = 1,44,99999)

[State haha] ;---- Mu ni Kaerou start voice snd
type = PlaySnd
trigger1 = Time = 1 ;animelem = 1,1
value = s1,6
channel = 0

;[State haha]
;type = VarSet
;trigger1 = Time = 0 ;animelem = 1
;fvar(5) = 0
;ignorehitpause = 1


[state 190, poweradd] ;Super Cancel poweradd
type = poweradd
Triggerall = time = 0
trigger1 = prevstateno = 1200 ;神指中段
trigger2 = prevstateno = 1210 ;神指上段
trigger3 = prevstateno = 1220 ;神指下段
trigger4 = prevstateno = 1401 ;神指
;trigger5 = prevstateno = 1000 ;天雷闪
;trigger6 = prevstateno = 1001
;trigger7 = prevstateno = 1002
;trigger8 = prevstateno = 1003
;trigger9 = prevstateno = 1004
;trigger10 = prevstateno = 1005
value = -1000
ignorehitpause = 1

[State 1000, Explod] ;Super Cancel Effect
type = Explod
triggerall = time = 0
trigger1 = prevstateno = 1200 ;神指中段
trigger2 = prevstateno = 1210 ;神指上段
trigger3 = prevstateno = 1220 ;神指下段
trigger4 = prevstateno = 1401 ;神指 成功
;trigger5 = prevstateno = 1000 ;天雷闪
;trigger6 = prevstateno = 1001
;trigger7 = prevstateno = 1002
;trigger8 = prevstateno = 1003
;trigger9 = prevstateno = 1004
;trigger10 = prevstateno = 1005
anim = 10300
pos = 0,75
postype = left
removetime = -2
bindtime = -1
pausemove = 1
supermove = 1
sprpriority = 9
ownpal = 1

[State 1000, Explod] ;Super Cancel Effect
type = Explod
triggerall = time = 0
trigger1 = prevstateno = 1200 ;神指中段
trigger2 = prevstateno = 1210 ;神指上段
trigger3 = prevstateno = 1220 ;神指下段
trigger4 = prevstateno = 1401 ;神指
;trigger5 = prevstateno = 1000 ;天雷闪
;trigger6 = prevstateno = 1001
;trigger7 = prevstateno = 1002
;trigger8 = prevstateno = 1003
;trigger9 = prevstateno = 1004
;trigger10 = prevstateno = 1005
anim = 10301
pos = 0,73
postype = left
removetime = -2
bindtime = -1
pausemove = 1
supermove = 1
sprpriority = 8
trans = addalpha
alpha = 256, 135
ownpal = 1

[state 190, poweradd] ;Dream Cancel poweradd
type = poweradd
trigger1 = prevstateno = 2001 || prevstateno = 2002
Trigger1 = time = 0
value = -1000
ignorehitpause = 1

[State 1000, Explod] ;Dream Cancel Effect
type = Explod
triggerall = time = 0
trigger1 = prevstateno = 2001 || prevstateno = 2002
anim = 10302
pos = 0,75
postype = left
removetime = -2
bindtime = -1
pausemove = 1
supermove = 1
sprpriority = 9
ownpal = 1

[State 1000, Explod] ;Dream Cancel Effect
type = Explod
triggerall = time = 0
trigger1 = prevstateno = 2001 || prevstateno = 2002
anim = 10303
pos = 0,73
postype = left
removetime = -2
bindtime = -1
pausemove = 1
supermove = 1
sprpriority = 8
trans = addalpha
alpha = 256, 135
ownpal = 1

[State , SuperPause0]
type = SuperPause
trigger1 = Time = 0;animelem = 1
time = 32 ;30
anim = -1
movetime = 32 ;30
darken = 0
unhittable = 1
p2defmul = 1

[State 9000, Black]
type     = EnvColor
trigger1 = time = [0,27]
value    = 255*(time = [1,4]), 255*(time = [1,4]), 255*(time = [1,4])
time     = 1
under    = 1
supermovetime = -1

[State 2000, Waves] ;XI_supermove_lv2_background
type = Explod
trigger1 = time = 0
anim = 10203
pos = Ceil(2 * Const(size.xscale)),Ceil(-128 * Const(size.yscale))
postype = p1
sprpriority = -1
removetime  = -2
removeongethit = 1
persistent = 0
ownpal = 1
supermovetime = -1

[State 2000, Waves] ;XI_supermove_lv2_foreground
type = Explod
trigger1 = time = 10
anim = 10204
pos = Ceil(2 * Const(size.xscale)),Ceil(-128 * Const(size.yscale))
postype = p1
sprpriority = 3
removetime  = -2
removeongethit = 1
persistent = 0
ownpal = 1
supermovetime = -1

[State haha] ;---- SuperMove Snd
type = PlaySnd
trigger1 = time = 0
value = s4,6

[State haha] ;---- SuperMove Snd
type = PlaySnd
trigger1 = time = 17
value = s4,7

[State , BGPalFX0]
type = Null;BGPalFX
trigger1 = Time = 32
time = 130
;color = 256
;invertall = 0
add = 0,0,0
mul = 256,256,256
sinadd = 256,256,256

[State haha] ;---- Mu ni Kaerou lv2 voice Snd (using channel 0)
type = PlaySnd
trigger1 = Time = 24 ;animelem = 7, 5;14
value = s1,777
channel = 0

[State haha] ;---- Mu ni Kaerou lv2 background Snd (using channel 9,10)
type = PlaySnd
trigger1 = Time = 32
trigger2 = Time = 35
value = s0,33
channel = 9 + (time = 35)
abspan = 255 * IfElse(time = 35, -1, 1)

[State 1000] ;Super Cancel from Shattering Mirror, targetlifeadd
type = targetlifeadd
triggerall = AnimTime = 0
trigger1 = prevstateno = 1200
trigger1 = target,StateNo = 1205
trigger2 = prevstateno = 1210
trigger2 = target,StateNo = 1205
trigger3 = prevstateno = 1220
trigger3 = target,StateNo = 1225
trigger4 = prevstateno = 1220
trigger4 = target,StateNo = 1226
trigger5 = prevstateno = 1401
trigger5 = target,StateNo = 1205
value = floor(-100*fvar(3))
kill = 0
absolute = 1

[State 1000] ;Super Cancel from Shattering Mirror, targetstate
type = targetstate
triggerall = AnimTime = 0
trigger1 = prevstateno = 1200
trigger1 = target,StateNo = 1205
trigger2 = prevstateno = 1210
trigger2 = target,StateNo = 1205
trigger3 = prevstateno = 1220
trigger3 = target,StateNo = 1225
trigger4 = prevstateno = 1220
trigger4 = target,StateNo = 1226
trigger5 = prevstateno = 1401
trigger5 = target,StateNo = 1205
value = 2003

[State haha]
type = ChangeState
trigger1 = AnimTime = 0
value = 2011

;---------------------------------------------------------------------------
; Mu ni Kaerou lv2 progressing
[Statedef 2011]
type = S
movetype = A
physics = S
velset = 0,0
ctrl = 0
anim = 2011
sprpriority = 2

[State haha]
type = playerpush
trigger1 = 1
value = 0
ignorehitpause = 1

[State haha] ;lv2 is completely unhittable
type = NotHitBy
trigger1 = 1
value = SCA
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State , BGPalFX0]
type = BGPalFX
trigger1 = 1
time = 2
mul = 100,100,100
invertall = 1
ignorehitpause = 1

[State 0, Mu ni Kaerou lv2 hitdef helper]
type = Helper
TriggerAll = helper(2015),var(6) != 1 ; ---- not during time stop
trigger1 = Time = 2
trigger2 = Time = 9
trigger3 = Time = 17
trigger4 = Time = 25
trigger5 = Time = 33
trigger6 = Time = 41
trigger7 = Time = 49
trigger8 = Time = 5
trigger9 = Time = 12
trigger10 = Time = 20
trigger11 = Time = 28
trigger12 = Time = 36
trigger13 = Time = 44
trigger14 = Time = 52
helpertype = normal
name = "Mu ni Kaerou lv2 hitdef helper"
ID = 2014
pos = 0,0
postype = p1
stateno = 2014
keyctrl = 0
ownpal = 1
scale = 1,1
supermovetime = 99999
ignorehitpause = 1
facing = 1

[State , Projectile0]
type = NULL;Projectile
trigger1 = Time = 2
trigger2 = Time = 9
trigger3 = Time = 17
trigger4 = Time = 25
trigger5 = Time = 33
trigger6 = Time = 41
trigger7 = Time = 49
trigger8 = Time = 5
trigger9 = Time = 12
trigger10 = Time = 20
trigger11 = Time = 28
trigger12 = Time = 36
trigger13 = Time = 44
trigger14 = Time = 52
id = 200101
attr = A,HP ;P ;T
hitflag = MAFP;D
guardflag = M;A
;affectteam = E
animtype = Hard
air.animtype = Up
;fall.animtype = DiagUp
priority = 7,hit
damage = floor(47*fvar(3)),floor(12*fvar(3))
;Ceil((300 * (1 + ((var(32) = [5,6]) * .34))) * fvar(2)), Ceil((10 * (1 + ((var(32) = [5,6]) * .34))) * fvar(2))
pausetime = 0,0
guard.pausetime = 0,0
sparkno = -1
guard.sparkno = -1
;sparkxy = 0,0
;hitsound = S0,2
;guardsound = S0,21
ground.type = High
;air.type = High
ground.slidetime = 10
guard.slidetime = 20
ground.hittime = 25
;air.hittime = 20
;guard.hittime = 0
;guard.ctrltime = 0
;guard.dist = 0
;yaccel = 0
ground.velocity = 0
guard.velocity = 0
air.velocity = -6,-9
airguard.velocity = 0,0
;ground.cornerpush.veloff = 0,0
;air.cornerpush.veloff = 0,0
;down.cornerpush.veloff = 0,0
;guard.cornerpush.veloff = 0,0
;airguard.cornerpush.veloff = 0,0
;airguard.ctrltime = 0
air.juggle = 1;5
;mindist = 0,0
;maxdist = 0,0
;snap = 0,0
;sprpriority = 1
;p1facing = 0
p2stateno = 2003 ;ifelse(var(25) = 1, 2003, 5000)
;p2facing = 0
p2getp1state = 0 ;var(25)
;forcestand = 0
;fall = 1
fall.xvelocity = -3.27;272725105286
fall.yvelocity = -3.25;555985694885
fall.recover = 0
;fall.recovertime = 4
;fall.damage = 0
air.fall = 1
air.recover = 0
;down.velocity = 0,0
;down.hittime = 0
;down.bounce = 0
;ID = 0
;chainID = 0
;nochainID = -1
;hitonce = 0
;kill = 0
;guard.kill = 1
;fall.kill = 1
;numhits = 1
getpower = 0,0
givepower = 15, 15
;palfx.time = 0
;palfx.mul = 256,256,256
;palfx.add = 0,0,0
;envshake.time = 0
;envshake.freq = 60
;envshake.ampl = -4
;envshake.phase = 90
projID = 200101
projanim = 2006
projhitanim = 2006
projremanim = 2006
projcancelanim = 2006
;projscale = 1,1
;projremove = 1
projremovetime = 4
;velocity = 0,0
;remvelocity = 0,0
;accel = 0,0
;velmul = 1
;projhits = 1
;projmisstime = 0
projpriority = 7
;projsprpriority = 3
;projedgebound = 40
;projstagebound = 40
;projheightbound = -240,1
;offset = 0,0
postype = Back
;projshadow = 0,0,0
;supermovetime = 0
;pausemovetime = 0
p2facing = 1

; Projectile nullifier
[State , ProjectileNul]
type = Projectile
TriggerAll = helper(2015),var(6) != 1 ; ---- not during time stop
trigger1 = Time = 2
trigger2 = Time = 9
trigger3 = Time = 17
trigger4 = Time = 25
trigger5 = Time = 33
trigger6 = Time = 41
trigger7 = Time = 49
trigger8 = Time = 57
trigger9 = Time = 5
trigger10 = Time = 12
trigger11 = Time = 20
trigger12 = Time = 28
trigger13 = Time = 36
trigger14 = Time = 44
trigger15 = Time = 52
attr = S,SP
hitflag = P
guardflag = M
animtype = Hard
priority = 7,hit
sparkno = -1
sparkxy = -999, -999
getpower = 0,0
givepower = 0,0
;damage = 60, 8
pausetime = 0,0
projpriority = 99999
projscale = Const(size.xscale), Const(size.yscale)
projanim = 2006
projhitanim = 2006
projremanim = 2006
projcancelanim = 2006
;projscale = 1,1
;projremove = 1
projremovetime = 5;4
p2facing = 1
p2stateno = 2003

[State haha]
type = ChangeState
trigger1 = AnimTime = 0
;trigger2 = RoundState > 2
value = 2012

;---------------------------------------------------------------------------
; Mu ni Kaerou lv2 end
[Statedef 2012]
type = S
movetype = I
physics = S
velset = 0,0
ctrl = 0
anim = 2012
sprpriority = 2

[State haha]
type = playerpush
trigger1 = animelem = 1, >=0
trigger1 = animelem = 2, <0
value = 0
ignorehitpause = 1

[State haha]
type = NotHitBy
trigger1 = animelem = 1, >=0
trigger1 = animelem = 2, <0
value = SCA
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State , BGPalFX0]
type = BGPalFX
trigger1 = animelem = 1
time = 16
mul = 100,100,100
invertall = 1
ignorehitpause = 1
;pausemovetime = -1

[state 0, 3]  ;damage adjustment for Mu ni Kaerou lv3 (Extend)
type = varset
trigger1 = animtime = 0
var(13) = 0

[State haha]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Mu ni Kaerou lv2 hitdef helper
[Statedef 2014]
type = S
movetype = A
physics = S
ctrl = 0
anim = 2007

[State 2004, Override]
type = HitOverride
trigger1 = 1
attr = SCA, NA,SA,HA,NT,ST,HT,NP,SP,HP,AA,AT,AP
slot = 0
stateno = 2502
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[state haha]
type = playerpush
trigger1 = 1
value = 0
ignorehitpause = 1

[state haha]
type = nothitby
trigger1 = 1
value = SCA
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State 0, hitdef]
type = hitdef
triggerall = animelem = 1
trigger1 = root,Time <= 51
trigger1 = !parent,ishelper
trigger2 = parent,Time <= 51+43
trigger2 = parent,ishelper(2015)
;trigger1 = Time = 2
;trigger2 = Time = 9
;trigger3 = Time = 17
;trigger4 = Time = 25
;trigger5 = Time = 33
;trigger6 = Time = 41
;trigger7 = Time = 49
;trigger8 = Time = 5
;trigger9 = Time = 12
;trigger10 = Time = 20
;trigger11 = Time = 28
;trigger12 = Time = 36
;trigger13 = Time = 44
;trigger14 = Time = 52
attr = A,HP
hitflag = MAF
guardflag = M
animtype = Hard
air.animtype = Up
priority = 7,hit
damage = floor(32*root,fvar(3)),floor(6*root,fvar(3))
;Ceil((300 * (1 + ((var(32) = [5,6]) * .34))) * fvar(2)), Ceil((10 * (1 + ((var(32) = [5,6]) * .34))) * fvar(2))
pausetime = 0,0
guard.pausetime = 0,0
sparkno = -1
guard.sparkno = -1
;sparkxy =
;hitsound = S0,2
;guardsound = S0,21
ground.type = High
ground.slidetime = 10
guard.slidetime = 20
ground.hittime = 25
ground.velocity = -6,-7.5
guard.velocity = 0
air.velocity = -6,-7.5 ;-6,-9
airguard.velocity = 0,0
air.juggle = 0
;p2stateno = 5000 ;2003 ;ifelse(var(25) = 1, 2003, 5000)
;p2getp1state = 0 ;var(25)
fall.xvelocity = -3.27;272725105286
fall.yvelocity = -3.25;555985694885
fall.recover = 0
air.fall = 1
air.recover = 0
getpower = 0,0
givepower = 15, 15
p2facing = 1
palfx.time = 20
palfx.add = 50,50,50
palfx.mul = 250,250,250
palfx.sinadd = 150,150,150,10
palfx.invertall = 1

[State 0, hitdef]
type = hitdef
triggerall = animelem = 1
trigger1 = root,Time > 51
trigger1 = !parent,ishelper
trigger2 = parent,Time > 51+43
trigger2 = parent,ishelper(2015)
attr = A,HP
hitflag = MAF
guardflag = M
animtype = Hard
air.animtype = Up
priority = 7,hit
damage = floor(32*root,fvar(3)),floor(6*root,fvar(3))
;Ceil((300 * (1 + ((var(32) = [5,6]) * .34))) * fvar(2)), Ceil((10 * (1 + ((var(32) = [5,6]) * .34))) * fvar(2))
pausetime = 0,0
guard.pausetime = 0,0
sparkno = -1
guard.sparkno = -1
;sparkxy =
;hitsound = S0,2
;guardsound = S0,21
ground.type = High
ground.slidetime = 10
guard.slidetime = 20
ground.hittime = 25
ground.velocity = -6,-7.5
guard.velocity = 0
air.velocity = -6,-7.5 ;-6,-9
airguard.velocity = 0,0
air.juggle = 0
;p2stateno = 5000 ;2003 ;ifelse(var(25) = 1, 2003, 5000)
;p2getp1state = 0 ;var(25)
fall.xvelocity = -3.27;272725105286
fall.yvelocity = -3.25;555985694885
fall.recover = 0
air.fall = 1
air.recover = 0
getpower = 0,0
givepower = 15, 15
p2facing = 1
fall = 1
palfx.time = 20
palfx.add = 50,50,50
palfx.mul = 250,250,250
palfx.sinadd = 150,150,150,10
palfx.invertall = 1

[State 210, Explod]
type = Explod
triggerall = movehit
trigger1 = time = [2,3]
anim  = F3
postype = p2
pos = (target, Const(size.head.pos.x)), ifelse((target, statetype = S), (target, Const(size.head.pos.y)), (target, Const(size.mid.pos.y)))
scale = target,const(size.xscale), target,const(size.yscale)
facing = -1
ownpal = 1
sprpriority = 2
bindtime = 1
ownpal = 1
persistent = 0
ignorehitpause = 1

[State 210, Explod]
type = Explod
triggerall = moveguarded
trigger1 = time = [2,3]
anim  = F40
postype = p2
pos = (target,Const(size.ground.front)) , (target,Const(size.mid.pos.y))
scale = (target,const(size.xscale)) , (target,const(size.yscale))
facing = -1
ownpal = 1
sprpriority = 2
bindtime = 1
ownpal = 1
persistent = 0
ignorehitpause = 1

[State haha]
type = DestroySelf
trigger1 = Time >= 30
trigger2 = MoveReversed

;---------------------------------------------------------------------------
; Mu ni Kaerou lv2 BG helper
[Statedef 2015]
type = S
movetype = I
physics = N
ctrl = 0
anim = 2006
sprpriority = -5

[State 0, VarSet]
type = VarSet
triggerall = time = 0
trigger1 = root,fvar(6) = 1
var(6) = 1
ignorehitpause = 1
;persistent =

[state haha]
type = playerpush
trigger1 = 1
value = 0
ignorehitpause = 1

[state haha]
type = nothitby
trigger1 = 1
value = SCA
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State 800, destroy enemy's attack helpers]
type = ReversalDef
trigger1 = root, stateno = 2011
reversal.attr = SCA, AA,AT,AP
hitflag =  HLMAFDP
priority = 999, hit
pausetime = 0,0
;hitsound = 0,7
;fall.damage = ceil(210 * 1)
;getpower = 142 * (var(48) != [5,6]), 142 * (var(48) != [5,6])
;givepower = 15, 15
;air.juggle = ifelse(var(32) = 0, 0, 30)
numhits = 0
sparkno = -1
sparkxy = 100, -100
;ground.velocity = -20, -9.5
;air.velocity = -20, -9.5
;guard.cornerpush.veloff = -10
;guard.velocity = -10
;yaccel = .51
fall.xvelocity = -3.27;272725105286
fall.yvelocity = -3.25;555985694885
;p1stateno = 1201
p2stateno = 2006
;p2facing = 1

[State 2004, Override]
type = HitOverride
trigger1 = 1
attr = SCA, NA,SA,HA,NT,ST,HT,NP,SP,HP,AA,AT,AP
slot = 0
stateno = 2502
time = -1
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State 210, Explod]
type = Explod
;triggerall = root,stateno = 2011
;trigger1 = root,Time = 0
trigger1 = Time = 0
ID = 2008
anim  = 2008    ;2005 lv1  2008 lv2
postype = back
pos = 0,280
ignorehitpause = 1
ownpal = 0
removetime = 380
sprpriority = -5
bindtime = -1  ;in oder not to see the edge of Explod when using H-res BG
supermovetime = ifelse(var(6) = 1,40,-1)
scale = 1.055, 1.075 ;const(size.yscale)

[State 0, EnvShake]
type = EnvShake
trigger1 = time = 32+ifelse(var(6)=1,4,0)
trigger2 = time = 42+ifelse(var(6)=1,4,0)
trigger3 = time = 112+ifelse(var(6)=1,4,0)
trigger4 = time = 122+ifelse(var(6)=1,4,0)
time = 10
ampl = -6
freq = 120
phase = 120
ignorehitpause = 1

[State , PalFX0] ;---- using var(1) to adjust palfx
type = PalFX
trigger1 = 1
time = 1
;color = 256
;invertall = 0
add = var(1),var(1),var(1)
mul = 256,256,256

[State haha] ;Palfx adjust
type = VarSet
trigger1 = Time = [0, 31+ifelse(var(6)=1,4,0)]
trigger2 = Time = 146+ifelse(var(6)=1,4,0)
var(1) = -255

[State haha] ;Palfx adjust
type = VarAdd
trigger1 = Time = [32+ifelse(var(6)=1,4,0), 52+ifelse(var(6)=1,4,0)]
var(1) = 25

[State haha] ;Palfx adjust
type = VarSet
trigger1 = Time = 53+ifelse(var(6)=1,4,0)
var(1) = 255

[State haha] ;Palfx adjust
type = VarAdd
trigger1 = Time = [112+ifelse(var(6)=1,4,0), 146+ifelse(var(6)=1,4,0)]
var(1) = -30;-36

[State haha]
type = RemoveExplod
trigger1 = Time >= 150+ifelse(var(6)=1,4,0)
trigger2 = root, MoveType = H
trigger3 = root, stateno = 2020 && root,time >= 30
;trigger5 = RoundState > 2
id = 2008

[State 0, Mu ni Kaerou lv2 hitdef helper]
type = Helper
TriggerAll = var(6) = 1 ; ---- during time stop
trigger1 = Time = 2+40
trigger2 = Time = 9+40
trigger3 = Time = 17+40
trigger4 = Time = 25+40
trigger5 = Time = 33+40
trigger6 = Time = 41+40
trigger7 = Time = 49+40
trigger8 = Time = 5+40
trigger9 = Time = 12+40
trigger10 = Time = 20+40
trigger11 = Time = 28+40
trigger12 = Time = 36+40
trigger13 = Time = 44+40
trigger14 = Time = 52+40
helpertype = normal
name = "Mu ni Kaerou lv2 hitdef helper"
ID = 2014
pos = 0,0
postype = p1
stateno = 2014
keyctrl = 0
ownpal = 1
scale = 1,1
supermovetime = 99999
ignorehitpause = 1
facing = 1

; Projectile nullifier
[State , ProjectileNul]
type = Projectile
TriggerAll = var(6) = 1 ; ---- during time stop
trigger1 = Time = 2+40
trigger2 = Time = 9+40
trigger3 = Time = 17+40
trigger4 = Time = 25+40
trigger5 = Time = 33+40
trigger6 = Time = 41+40
trigger7 = Time = 49+40
trigger8 = Time = 57+40
trigger9 = Time = 5+40
trigger10 = Time = 12+40
trigger11 = Time = 20+40
trigger12 = Time = 28+40
trigger13 = Time = 36+40
trigger14 = Time = 44+40
trigger15 = Time = 52+40
attr = S,SP
hitflag = P
guardflag = M
animtype = Hard
priority = 7,hit
sparkno = -1
sparkxy = -999, -999
getpower = 0,0
givepower = 0,0
;damage = 60, 8
pausetime = 0,0
projpriority = 99999
projscale = Const(size.xscale), Const(size.yscale)
projanim = 2006
projhitanim = 2006
projremanim = 2006
projcancelanim = 2006
;projscale = 1,1
;projremove = 1
projremovetime = 5;4
p2facing = 1
p2stateno = 2003

[State haha]
type = DestroySelf
trigger1 = Time >= 151+ifelse(var(6)=1,4,0) ;152
trigger2 = root, MoveType = H


;---------------------------------------------------------------------------
; Soul Extraction lv1
[Statedef 2100]
type = S
movetype = I
ctrl = 0
anim = 2100
physics = S
velset = 0,0

[State haha]
type = NotHitBy
trigger1 = 1
value = SCA
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State haha] ;---- body palfx disable
type = VarSet
trigger1 = Time = [1,28]
var(27) = 0
ignorehitpause = 1

[State haha] ;---- body palfx enable
type = VarSet
trigger1 = Time = 29
var(27) = 1
ignorehitpause = 1

[State haha]
type = AssertSpecial
trigger1 = Time = [1,28] ;1
flag = nobg
flag2 = nofg

;[State haha]
;type = VarSet
;trigger1 = AnimElem = 1
;fvar(5) = 0
;ignorehitpause = 1

[State 0, Afterimage]
type = NULL;Afterimage
;triggerall = var(18) = 0   ;Catalyst Stand Anim Only
triggerall = roundstate != 0
trigger1 = time = 0
trans = add
Paladd = 15,0,15
PalContrast =  250, 250, 250
PalBright = 0,0,0
time    =  -1
length  = 15
TimeGap = 1
FrameGap = 1

[State , SuperPause0]
type = SuperPause
trigger1 = AnimElem = 1, 1
time = 30
anim = -1
movetime = 30
darken = 0
poweradd = -1000
unhittable = 1
p2defmul = 1

[State 9000, Black]
type     = EnvColor
trigger1 = time = [1,28]
value    = 255 * ((time = [1,4]) * (var(56) != 2)),255 * ((time = [1,4]) * (var(56) != 2)),255 * ((time = [1,4]) * (var(56) != 2))
time     = 1
under    = 1
supermovetime = -1

[State 2000, Waves] ;XI_supermove_lv1_background
type = Explod
trigger1 = time = 0
anim = 10201
pos = Ceil(2 * Const(size.xscale)),Ceil(-128 * Const(size.yscale))
postype = p1
sprpriority = -1
removetime  = -2
removeongethit = 1
persistent = 0
ownpal = 1
supermovetime = -1

[State 2000, Waves] ;XI_supermove_lv1_foreground
type = Explod
trigger1 = time = 10
anim = 10202
pos = Ceil(2 * Const(size.xscale)),Ceil(-128 * Const(size.yscale))
postype = p1
sprpriority = 3
removetime  = -2
removeongethit = 1
persistent = 0
ownpal = 1
supermovetime = -1

[State haha] ;---- SuperMove Snd
type = PlaySnd
trigger1 = time = 0
value = s4,4

[State haha] ;---- SuperMove Snd
type = PlaySnd
trigger1 = time = 18
value = s4,5

[State , Helper0]
type = Helper
triggerall = !NumHelper(2106)
trigger1 = enemynear(floor(fvar(36))),Pos X > Pos X  ;最近之敌在自己右边
helpertype = normal
name = "2P push"
ID = 2106
pos = ( abs(enemynear(floor(fvar(36))),Pos x - Pos X) + enemynear(floor(fvar(36))),Const(size.ground.back)+15 ) , 0
;pos = ( abs(enemynear,Pos x - Pos X) + enemynear,Const(size.ground.back) + 15) , 0
facing = 1
postype = p1
stateno = 2106
keyctrl = 0
ownpal = 1
ground.back = 0  ; Player width (back, ground)
ground.front = 0  ; Player width (front, ground)
stand.friction = 0;.85  ; Friction coefficient when standing
crouch.friction = 0;.82  ; Friction coefficient when crouching
;supermovetime = 9999

[State , Helper0]
type = Helper
triggerall = !NumHelper(2106)
trigger1 = enemynear(floor(fvar(36))),Pos X < Pos X  ;最近之敌在自己左边
helpertype = normal
name = "2P push"
ID = 2106
pos = ( abs(enemynear(floor(fvar(36))),Pos x -Pos X) - enemynear(floor(fvar(36))),Const(size.ground.back)-15 ) , 0
;pos = ( abs(enemynear,Pos x -Pos X) - enemynear,Const(size.ground.back) - 15) , 0
facing = 1
postype = p1
stateno = 2106
keyctrl = 0
ownpal = 1
ground.back = 0  ; Player width (back, ground)
ground.front = 0  ; Player width (front, ground)
stand.friction = 0;.85  ; Friction coefficient when standing
crouch.friction = 0;.82  ; Friction coefficient when crouching
;supermovetime = 9999

[State haha]
type = ChangeState
trigger1 = AnimTime = 0
value = 2101
ctrl = 1

;---------------------------------------------------------------------------
; Soul Extraction (Drain)
[Statedef 2101]
type = S
movetype = A
ctrl = 0
anim = 2101 ;2 ;1
physics = S
velset = 0,0

[State haha] ;---- body palfx disable
type = VarSet
trigger1 = 1
var(27) = 0
ignorehitpause = 1

[State haha]
type = notHitBy
trigger1 = time = [0,12]
value = SCA
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State haha]
type = AttackDist
trigger1 = 1
value = 1
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State 210, Explod] ;Soul Extraction special Anim
type = Explod
trigger1 = time = 0
trigger2 = numexplod(210) = 0
anim  = 210002
id = 210
postype = p1
pos = 0,0
ignorehitpause = 1
ownpal = 1
removetime = -1
sprpriority = 3
bindtime = -1
removeOnGetHit = 1
scale = const(size.xscale), const(size.yscale)

[state haha]
type = RemoveExplod ;RemoveExplod(Soul Extraction special Anim) when P2 get near
trigger1 = P2Dist X < 0
id = 210

[State haha] ;turn when P2 jump to the other side
type = Turn
trigger1 = P2Dist X < 0

[State , Helper0]
type = Helper
triggerall = !NumHelper(2106)
trigger1 = enemynear(floor(fvar(36))),Pos X > Pos X  ;最近之敌在自己右边
helpertype = normal
name = "2P push"
ID = 2106
pos = ( abs(enemynear(floor(fvar(36))),Pos x - Pos X) + enemynear(floor(fvar(36))),Const(size.ground.back)+15 ) , 0
;pos = ( abs(enemynear,Pos x - Pos X) + enemynear,Const(size.ground.back) + 15) , 0
facing = 1
postype = p1
stateno = 2106
keyctrl = 0
ownpal = 1
ground.back = 0  ; Player width (back, ground)
ground.front = 0  ; Player width (front, ground)
stand.friction = 0;.85  ; Friction coefficient when standing
crouch.friction = 0;.82  ; Friction coefficient when crouching
;supermovetime = 9999

[State , Helper0]
type = Helper
triggerall = !NumHelper(2106)
trigger1 = enemynear(floor(fvar(36))),Pos X < Pos X  ;最近之敌在自己左边
helpertype = normal
name = "2P push"
ID = 2106
pos = ( abs(enemynear(floor(fvar(36))),Pos x -Pos X) - enemynear(floor(fvar(36))),Const(size.ground.back)-15 ) , 0
;pos = ( abs(enemynear,Pos x -Pos X) - enemynear,Const(size.ground.back) - 15) , 0
facing = 1
postype = p1
stateno = 2106
keyctrl = 0
ownpal = 1
ground.back = 0  ; Player width (back, ground)
ground.front = 0  ; Player width (front, ground)
stand.friction = 0;.85  ; Friction coefficient when standing
crouch.friction = 0;.82  ; Friction coefficient when crouching
;supermovetime = 9999

;[State , Helper0]
;type = null;Helper
;triggerall = NumEnemy > 1
;triggerall = !NumHelper(2107)
;triggerall = enemy(1),alive
;trigger1 = enemy(1),Pos X > Pos X  ;4P在自己右边
;helpertype = normal
;name = "4P push"
;ID = 2107
;pos = ( abs(enemy(1),Pos x -Pos X) + enemy(1),Const(size.ground.back) + 15) , 0
;facing = 1
;postype = p1
;stateno = 2107
;keyctrl = 0
;ownpal = 1
;ground.back = 0  ; Player width (back, ground)
;ground.front = 0  ; Player width (front, ground)
;stand.friction = 0;.85  ; Friction coefficient when standing
;crouch.friction = 0;.82  ; Friction coefficient when crouching

;[State , Helper0]
;type = Helper
;triggerall = NumEnemy > 1
;triggerall = !NumHelper(2107)
;triggerall = enemy(1),alive
;trigger1 = enemy(1),Pos X < Pos X  ;4P在自己左边
;helpertype = normal
;name = "4P push"
;ID = 2107
;pos = ( abs(enemy(1),Pos x -Pos X) - enemy(1),Const(size.ground.back) - 15) , 0
;facing = 1
;postype = p1
;stateno = 2107
;keyctrl = 0
;ownpal = 1
;ground.back = 0  ; Player width (back, ground)
;ground.front = 0  ; Player width (front, ground)
;stand.friction = 0;.85  ; Friction coefficient when standing
;crouch.friction = 0;.82  ; Friction coefficient when crouching

[State haha]
type = AssertSpecial
trigger1 = Time % 4 = 0
flag = nobg
flag2 = nofg

[State 9000, Black]
type     = EnvColor
trigger1 = Time % 4 = 0
value    = 255, 255, 255
time     = 1
under    = 1

[State 0, Helper]
type = Helper
triggerall = time = [0,12]
trigger1 = numhelper(2103)
helpertype = normal ;player
name = "Soul Extraction reversaldef helper"
ID = 2103
stateno = 2103
pos = 0,0
postype = p1    ;p2,front,back,left,right
facing = 1
keyctrl = 0
ownpal = 0
supermovetime = 1
pausemovetime = 1
ignorehitpause = 1

[State 2010, Reversaldef] ;using reversaldef to reversal enemy's invincible normal physical attacks
type = null;ReversalDef
triggerall = time = [0,12]
;triggerall = p2dist x = [-84,85]
trigger1 = time%2=0
trigger1 = p2movetype = A
reversal.attr = SCA, NA,SA,NT,ST,NP,SP
pausetime = 0,0
guard = 0
numhits = 0
sparkno = -1
getpower = 0,0
givepower = 0,0
priority = 9999, hit
forcestand = 1
p2stateno = 2003
p2facing = 1
guard.dist = 0
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State 2010, hitdef]
type = null;HitDef
triggerall = time = [0,12]
;triggerall = p2dist x = [-84,85]
trigger1 = 1
;trigger1 = time%2=1
;trigger1 = p2movetype = A
;trigger2 = p2movetype != A
attr = S, HT
animtype = DiagUp
guard = 0
hitflag = M
guardflag = N
sparkno = 0
guard.sparkno = 40
pausetime = 0,0
sparkxy = -999,-999
getpower = 0,0
givepower = 0,0
hitsound = S0,10  ;s96,10 s0,10
priority = 999, hit
ground.type = Low
ground.slidetime = 18
ground.hittime  = 18
ground.velocity = -20, -9.5
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = -10
guard.velocity = -10
yaccel = .51
air.velocity = -20, -9.5
p1stateno = 2105  ;LV1 2015   MAX 2305
p2stateno = 2110  ;LV1 2110   MAX 2316
p2facing = 1 ;(facing * -1)
fall = 1
fall.xvelocity = -3.27;272725105286
fall.yvelocity = -3.25;555985694885
fall.recover = 0
guard.dist = 0

[State 200, 1]
type = HitDef
trigger1 = 1
;trigger1 = Time % 2 = 0
;trigger1 = time > 12
;trigger1 = p2dist x = [-84,85]
attr = ,AT
animtype = DiagUp
guard = 0
hitflag = M
guardflag = N
sparkno = 0
guard.sparkno = 40
pausetime = 0,0
sparkxy = -999,-999
getpower = 0,0
givepower = 0,0
hitsound = S0,10  ;s96,10 s0,10
priority = 999, hit
ground.type = Low
ground.slidetime = 18
ground.hittime  = 18
ground.velocity = -20, -9.5
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = -10
guard.velocity = -10
yaccel = .51
air.velocity = -20, -9.5
p1stateno = 2105  ;LV1 2015   MAX 2305
p2stateno = 2110  ;LV1 2110   MAX 2316
p2facing = 1 ;(facing * -1)
fall = 1
fall.xvelocity = -3.27;272725105286
fall.yvelocity = -3.25;555985694885
fall.recover = 0
guard.dist = 0

[State 800, Repel] ;using reversaldef to reversal enemy's invincible attacks
type = null;ReversalDef
trigger1 = Time % 2 != 0
trigger1 = p2dist x = [-84,85]
;trigger1 = p2dist y = 0
reversal.attr = SC, AA, AT, AP
;attr = S, HT
pausetime = 0,0
guard = 0
animtype = DiagUp
numhits = 0
sparkno = -1
getpower = 0,0
givepower = 0,0
hitsound = S0,10
priority = 5, hit
sparkxy = 100, -100
ground.velocity = -20, -9.5
air.velocity = -20, -9.5
guard.cornerpush.veloff = -10
guard.velocity = -10
yaccel = .51
fall.xvelocity = -3.27;272725105286
fall.yvelocity = -3.25;555985694885
p1stateno = 2105
p2stateno = 2110
;2110 + (5 * (var(25) = 1 && var(32) = 0)) + (roundno >= 2 && var(25) = 1 && var(32) = 0)
fall = 1
p2facing = 1 ;(facing * -1)
;p1getp2facing = ifelse(facing = -1, 1, 0)
fall.recover = 0
;snap = ceil(24 * const(size.xscale)),0
guard.dist = 1

[State haha] ;Soul Extraction Loop Sound
type = PlaySnd
trigger1 = AnimElem = 1
value = s0,13
channel = 0 ; Stops on hurt
loop = 1

[State haha]
type = ChangeState
trigger1 = Time >= 181
value = 2102

;---------------------------------------------------------------------------
; Soul Extraction End
[Statedef 2102]
type = S
movetype = I
ctrl = 0
anim = 2103
physics = S
velset = 0,0

[State haha] ;RemoveExplod(Soul Extraction special Anim) when Soul Extraction End
type = RemoveExplod
trigger1 = Time = 0
id = 210
ignorehitpause = 1

[State haha]
type = StopSnd
trigger1 = Time = 0
channel = 0 ;Stops Soul Extraction Loop Sound when Soul Extraction End

[State haha]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Soul Extraction reversaldef helper
[Statedef 2103]
type = S
movetype = A
ctrl = 0
anim = 2103
physics = S
velset = 0,0

[State 0, BindToRoot]
type = BindToRoot
trigger1 =  1
time = -1
pos = 0,0
ignorehitpause = 1

[State 2010, Reversaldef] ;using reversaldef to reversal enemy's invincible normal physical attacks
type = ReversalDef
trigger1 = 1
reversal.attr = SCA, NA,SA,NT,ST,NP,SP
pausetime = 0,0
guard = 0
numhits = 0
sparkno = -1
getpower = 0,0
givepower = 0,0
priority = 9999, hit
forcestand = 1
p2stateno = 2307
p2facing = 1
guard.dist = 1
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State haha]
type = destroyself
trigger1 = root,stateno != 2101
trigger2 = root,stateno = 2101
trigger2 = root,time > 12

;---------------------------------------------------------------------------
; Soul Extraction Success
[Statedef 2105]
type = S
movetype = A
ctrl = 0
anim = 2107 ;2106
physics = S
velset = 0,0
facep2 = 1
sprpriority = 2

[State 0, NotHitBy]
type = NotHitBy
trigger1 =  1
value = SCA
time = 2
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State haha]
type = targetState
triggerall = target,life <=  floor(300*fvar(3))
trigger1 = time = 0
value = 2316

[State haha]
type = ChangeState
triggerall = target,life <=  floor(300*fvar(3))
trigger1 = time = 0
value = 2305
persistent = 0

[State haha] ;RemoveExplod(Soul Extraction special Anim) when Soul Extraction Success
type = Removeexplod
trigger1 = Time = 0
id = 210
ignorehitpause = 1

[State haha]
type = VarRandom
trigger1 = Time = 0
v = 1
range = 0, 2

[State haha] ; VAR(0)  = Soul Extraction Scaler
type = VarSet
trigger1 = (target, Const(size.yscale) * target, Const(size.mid.pos.y)) > (Const(size.yscale) * -70)
var(0) = Ceil((Const(size.yscale) * -70) - ((target, Const(size.yscale)) * (target, Const(size.mid.pos.y))))

[State haha]
type = TargetBind 
trigger1 = Time = 0
;pos = ceil(24 * const(size.xscale)),0
;pos = ceil((target, const(size.xscale)) * ((const(size.yscale) * 50) + (target, const(size.mid.pos.x)))), 0
pos = Ceil(((Const(size.yscale) * 43) + (target, Const(size.xscale) * (target, Const(size.mid.pos.x))))), 0
time = 52 ;145

[State haha]
type = TargetBind 
trigger1 = Time = 53
;pos = ceil(24 * const(size.xscale)),0
pos = Ceil(((Const(size.yscale) * 43) + (target, Const(size.xscale) * (target, Const(size.mid.pos.x))))), var(0)
;ceil(((target, const(size.yscale)) * (target, const(size.mid.pos.y))) - (const(size.yscale) * 70))
time = 92

[State haha] ;Stops Soul Extraction Loop Sound when Soul Extraction End
type = StopSnd
trigger1 = Time = 0
channel = 0

[state haha]
type = playsnd
trigger1 = Animelem = 6
value = s0,8   ;s0,8 s2,6 s0,6
;volume = -100
channel = 2

[State haha]
type = PlaySnd
trigger1 = AnimElem = 9
value = s0,18 + var(1)  ;s0,18+[0,2] s2,20 s0,20
channel = 3 ; Stops on hurt, but for sfx

[State 0, Afterimage]
type = NULL;Afterimage
;triggerall = var(18) = 0   ;Catalyst Stand Anim Only
triggerall = roundstate != 0
trigger1 = time = 0
trans = add
Paladd = 15,0,15
PalContrast =  250, 250, 250
PalBright = 0,0,0
time    =  -1
length  = 15
TimeGap = 1
FrameGap = 1

[State 1000, Flames]
type = Explod
trigger1 = AnimElem = 9
anim = F2
pos = Ceil(46 * Const(size.xscale)), Ceil(-64 * Const(size.yscale))
facing = 1
sprpriority = 5
bindtime = 2
ownpal = 1

[State 1000, Flames]
type = Explod
trigger1 = AnimElem = 9
anim = F12
pos = Ceil(46 * Const(size.xscale)), Ceil(-64 * Const(size.yscale))
facing = 1
sprpriority = 5
bindtime = 2
ownpal = 1

[State 1000, 5]
type = Explod
triggerall = Time >= 103
triggerall = time <= 148
trigger1 = (Gametime%9) = 1
anim = 10305
id = 10305
sprpriority = 8
postype = p1
pos = -17*const(size.xscale), -163*const(size.yscale);-18,-175
bindtime = 1
supermove = 1
under = 0
ownpal = 1
;PauseMoveTime = 14

[State 1000, 5]
type = Explod
triggerall = Time >= 133
triggerall = time <= 180
trigger1 = (Gametime%9) = 1
anim = 10306
id = 10306
sprpriority = 3
postype = p1
pos = -17*const(size.xscale), -163*const(size.yscale);-18,-175
bindtime = 1
supermove = 1
under = 0
ownpal = 1
;PauseMoveTime = 14

[State 1000, 5]
type = Explod
triggerall = !NumExplod(10307)
trigger1 = time = 212
anim = 10307
id = 10307
sprpriority = 3
postype = p1
pos = -19*const(size.xscale), -131*const(size.yscale);-20,-140
bindtime = 1
supermove = 1
under = 0
ownpal = 1

[State 942, 4]
type = EnvShake
trigger1 = AnimElem = 9
trigger2 = AnimElem = 21
time = 15 + (5 * (AnimElemNo(0) = 19))
ampl = -4
freq = 120
phase = 120

[State 9000, Black]
type     = EnvColor
trigger1 = AnimElem = 9,0
trigger2 = AnimElem = 21,0
value    = 255,255,255
time     = 1
under    = 1

[State haha]
type = AssertSpecial
trigger1 = AnimElem = 9,0
trigger2 = AnimElem = 21,0
flag = nobg
flag2 = nofg

[State haha] ;Soul extraction extract punch damage
type = TargetLifeAdd
trigger1 = AnimElem = 9,0
value = floor(-50*fvar(3))
; -250 * (1 + ((var(32) = [5,6]) * .46)) * IfElse(var(25) = 1, 1.2, 1))
absolute = 1
kill = 0

[State 210, Explod] ;Soul extraction soul explod anim
type = Explod
trigger1 = AnimElem = 10,1 ;8, 1
anim  = 210502
postype = p1
pos = 0,0
ownpal = 1
sprpriority = 4
bindtime = -1
scale = Const(size.xscale), Const(size.yscale)
ignorehitpause = 1
removeongethit = 1

[State haha] ;Soul extraction soul gathering snd
type = PlaySnd
trigger1 = Time = 93
value = s8,12 ;s8,9
channel = 4

[State haha] ;soul gathering target power consume
type = targetpoweradd
triggerall = Time = [103,162]
trigger1 = time%3 = 0
value = -25

[State haha] ;Soul extraction voice snd
type = PlaySnd
trigger1 = AnimElem = 19
value = s1,5
channel = 0

[State haha]  ;Soul extraction soul explod snd
type = PlaySnd
trigger1 = AnimElem = 21
value = s0,32
channel = 3 ; Stops on hurt, but for sfx

[State haha]  ;Soul extraction soul explod damage
type = TargetLifeAdd
trigger1 = AnimElem = 21 ;19
value = floor(-250*fvar(3))
kill = 1
absolute = 1
ignorehitpause = 1

[State haha]
type = RemoveExplod
trigger1 = AnimTime = 0
ID = 10305

[State haha]
type = RemoveExplod
trigger1 = AnimTime = 0
ID = 10306

[State haha]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; enemynear Push helper for Soul Extraction
[Statedef 2106]
type = C
movetype = I
ctrl = 0
anim = 2120
physics = N
velset = 0,0
;facep2 = 0;

;此helper的fvar(36)用于为任何需要使用EnemyNear(fvar(36))的提供服务,确保参数判断的是活的敌人,不是死的敌人
[State -3, fvar(36)];タッグ用             ;TAG模式AI (敌方1人,fvar(36) = 0)
Type = varset
Trigger1 = numenemy=1
fvar(36) = 0

[State -3, fvar(36)];タッグ用            ;TAG模式AI (敌方2人)
Type = varset
Trigger1 = numenemy=2
fvar(36) = ifelse(EnemyNear(0),alive,0,1)  ;最近之敌活着,fvar(36) = 0,否则fvar(36) = 1,即最近之活敌为次近之敌

[State 0, destroyself] ;resummon helper when enemy's facing changes (enemy jump to the other side)
type = DestroySelf
trigger1 = enemynear(floor(fvar(36))),Facing != Facing    ;enemynear与helper面向不同
trigger1 = parentdist X > 0             ;parent在helper面前的方向

;[State haha]
;type = VarSet
;trigger1 = 1 ;time = 0
;var(0) = (enemynear, ID)    ;var(0)锁定最近之敌ID

;[State haha]
;type = VarSet
;trigger1 = 1 ;time = 0
;var(1) = (enemy(0), ID)     ;var(1)锁定2P ID

;[State haha]
;type = VarSet
;trigger1 = 1 ;time = 0
;var(2) = (enemy(0),Const(size.ground.back)) ;var(2)检测2P ground.back

;[State haha]
;type = VarSet
;trigger1 = NumEnemy > 1
;var(3) = (enemy(1), ID)     ;var(3)锁定4P ID

;[State haha]
;type = VarSet
;trigger1 = NumEnemy > 1
;var(4) = (enemy(1),Const(size.ground.back)) ;var(4)检测4P ground.back

[State 170, 1]
type = NotHitBy
trigger1 = 1
value = SCA
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State haha] ; push enable
type = PlayerPush
trigger1 = time <= 0
value = 0
ignorehitpause = 1

[State haha] ; push enable
type = PlayerPush
trigger1 = time > 0
value = 1
ignorehitpause = 1

[State haha] ; pushing speed
type = VelSet
trigger1 = 1
x = 2 * Const(size.xscale)

[State haha]
type = Turn
trigger1 = root,Facing != - Facing
ignorehitpause = 1

[State haha] ;Y坐标重定位(可省略)
type = PosSet
trigger1 = enemynear(floor(fvar(36))),StateType = A  ;最近之敌空中
trigger2 = enemynear(floor(fvar(36))),StateType != A
trigger2 = enemynear(floor(fvar(36))),Vel x != 0   ;最近之敌空中且X速度非零
y = enemynear,Pos y

[State haha]  ;X坐标重定位 pusher位置过头情况 之 由右面向左推
type = PosSet
triggerall = Facing = -1    ;helper面向左推
trigger1 = enemynear(floor(fvar(36))),Pos X > Pos X  ;2P在helper右边（推过头了）
x = enemynear(floor(fvar(36))),Pos x + enemynear(floor(fvar(36))),Const(size.ground.back) + 15    ;重定位X到最近之敌右边（继续向左推）

[State haha]  ;X坐标重定位 pusher位置过头情况 之 由左面向右推
type = PosSet
triggerall = Facing = 1    ;helper面向左推
trigger1 = enemynear(floor(fvar(36))),Pos X < Pos X  ;2P在helper右边（推过头了）
x = enemynear(floor(fvar(36))),Pos x - enemynear(floor(fvar(36))),Const(size.ground.back) - 15   ;重定位X到最近之敌右边（继续向左推）

[State heh]  ;width set to 0,0
type = Width
trigger1 = 1
value = 5,0
ignorehitpause = 1

[State 0, destroyself]
type = DestroySelf
trigger1 = root, MoveType = H
trigger2 = root, StateNo != 2101
trigger2 = root, StateNo != 2100
trigger3 = root, StateNo = 2105
trigger4 = Time > 200
ignorehitpause = 1

[State haha]
type = DestroySelf
triggerall = NumEnemy = 2
triggerall = EnemyNear(0),alive
triggerall = EnemyNear(1),alive
trigger1 = time = 20
;trigger1 = (abs(playerID(root,var(22)),Pos X - root,Pos X) - abs(playerID(root,var(20)),Pos X - root,Pos X)) > (15 + playerID(root,var(20)),Const(size.ground.back) + playerID(root,var(22)),Const(size.ground.front))
;trigger2 = abs(enemy(1),Pos x - root,Pos X) < abs(enemynear(floor(fvar(36))),Pos x - root,Pos X)

;---------------------------------------------------------------------------
; Soul Extraction Victim
[Statedef 2110]
type = S
movetype = H
ctrl = 0
physics = N
velset = 0,0
facep2 = 1

[State haha]
type = NULL;ChangeState
triggerall = life <= 300
trigger1 = time = 0
value = 2316
persistent = 0

[State haha] ;helper debug
type = destroyself
trigger1 = time = 0

[State haha]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,0

[State haha]
type = Turn
trigger1 = P2Dist X < 0
persistent = 0

[State haha]
type = ChangeAnim2
trigger1 = 1
value = 2111
persistent = 0

[State haha]
type = AssertSpecial
trigger1 = (SelfAnimExist(5130) && SelfAnimExist(5131)) || (SelfAnimExist(5950) || SelfAnimExist(5330))
flag = nokosnd

;[State haha]
;type = ChangeState
;trigger1 = AnimTime = 0
;;value = ifelse(!alive && selfanimexist(5130) && selfanimexist(5131), 2111, 2120)
;value = IfElse(!Alive && SelfAnimExist(5130) && SelfAnimExist(5131), 2111, IfElse(!Alive && (SelfAnimExist(5950) || SelfAnimExist(5330)), 2112, 2120))

[State haha]
type = ChangeState
triggerall = AnimTime = 0
trigger1 = !Alive
trigger1 = SelfAnimExist(5130) && SelfAnimExist(5131)
value = 2111

[State haha]
type = ChangeState
triggerall = AnimTime = 0
trigger1 = !Alive
trigger1 = SelfAnimExist(5950) || SelfAnimExist(5330)
value = 2112

[State haha]
type = ChangeState
trigger1 = AnimTime = 0
value = 2120

;---------------------------------------------------------------------------
; Into Collapse
; dead end, SelfAnimExist(5130) && SelfAnimExist(5131)
[Statedef 2111]
type = S
Movetype = H
ctrl = 0
physics = S
velset = -8

[State haha]
type = AssertSpecial
trigger1 = 1
flag = nokosnd

[State haha]
type = PosSet
trigger1 = Time = 0
y = 0

[State haha]
type = SelfState
trigger1 = Time = 0
value = 5130

[State haha]
type = ChangeState
trigger1 = Time = 1
value = 5130

[State haha]
type = ChangeState
trigger1 = Time = 10
value = 5030

;---------------------------------------------------------------------------
; Improvised Collapse anims for custom collapse sets
; dead end, SelfAnimExist(5950) || SelfAnimExist(5330)
[Statedef 2112]
type = L
movetype = H
physics = S
anim = IfElse(SelfAnimExist(5950), 5950, 5330)
velset = -8

[State haha]
type = AssertSpecial
trigger1 = 1
flag = nokosnd

[State haha]
type = PosSet
trigger1 = Time = 0
y = 0

[State haha]
type = DefenceMulSet
trigger1 = 1
value = 1
ignorehitpause = 1

[State 2013, Change animation to Lying down on face]
type = ChangeAnim
trigger1 = Anim = 5950 || Anim = 5330
trigger1 = AnimTime = 0 || AnimElemTime(AnimElemNo(0)) > 30
value = IfElse(SelfAnimExist(5112), 5112, IfElse(SelfAnimExist(5111), 5111, 5110)) 

[State 1281, 3]
type = ChangeState
trigger1 = Anim = [5110,5112]
value = 5110 + IfElse(Alive, 0, 40) ;;HIT_BOUNCE

;---------------------------------------------------------------------------
; Soul Extraction Victim (SDM)
[Statedef 2115]
type = S
movetype = H
ctrl = 0
physics = N
velset = 0,0
facep2 = 1

[State haha]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,0

[State haha]
type = Turn
trigger1 = P2Dist X < 0
persistent = 0

[State haha]
type = ChangeAnim2
trigger1 = 1
value = 2110
persistent = 0

[State haha]
type = PowerSet
trigger1 = Time >= 141
value = floor(power/2)

[State haha]
type = LifeSet
trigger1 = Time >= 142
value = 0

[State haha]
type = AssertSpecial
trigger1 = (SelfAnimExist(5130) && SelfAnimExist(5131)) || (SelfAnimExist(5950) || SelfAnimExist(5330))
flag = nokosnd

[State haha]
type = ChangeState
trigger1 = AnimTime = 0
;value = ifelse(!alive && selfanimexist(5130) && selfanimexist(5131), 2111, 2120)
value = IfElse(!Alive && SelfAnimExist(5130) && SelfAnimExist(5131), 2111, IfElse(!Alive && (SelfAnimExist(5950) || SelfAnimExist(5330)), 2112, 2120))

;---------------------------------------------------------------------------
; Soul Extraction Victim (SDM Crossover Mode)
[Statedef 2116]
type = S
movetype = H
ctrl = 0
physics = N
velset = 0,0
facep2 = 1

[State haha]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,0

[State haha]
type = null;AssertSpecial
trigger1 = 1
flag = nokosnd
ignorehitpause = 1

[State haha]
type = Turn
trigger1 = P2Dist X < 0
persistent = 0

[State haha]
type = ChangeAnim2
trigger1 = 1
value = 2110
persistent = 0

[state haha]
type = varset
trigger1 = time = 34
sysvar(0) = 255

[state haha]
type = varadd
trigger1 = time = [35,65]
trigger1 = sysvar(0) > -1
sysvar(0) = -8

[state haha]
type = varset
trigger1 = time >= 60
trigger1 = sysvar(0) < 0
sysvar(0) = 0

[state haha]
type = palfx
trigger1 = time >= 34
time = 1
color = sysvar(0)
ignorehitpause = 1

[State haha]
type = PowerSet
trigger1 = Time >= 141
value = floor(power/2)

[State haha] ;instant kill
type = LifeSet
trigger1 = Time >= 142
value = 0

[State haha]
type = AssertSpecial
trigger1 = (SelfAnimExist(5130) && SelfAnimExist(5131)) || (SelfAnimExist(5950) || SelfAnimExist(5330))
flag = nokosnd

[State haha]
type = ChangeState
trigger1 = AnimTime = 0
value = 2121
;value = ifelse(!alive && selfanimexist(5130) && selfanimexist(5131), 2111, 2120)
;value = IfElse(!Alive && SelfAnimExist(5130) && SelfAnimExist(5131), 2111, IfElse(!Alive && (SelfAnimExist(5950) || SelfAnimExist(5330)), 2112, 2120))

;---------------------------------------------------------------------------
; HITA_UP (initial going up)
[Statedef 2120]
type    = A
movetype= H
physics = N
ctrl = 0

[State haha]
type = LifeSet
trigger1 = !Alive
value = 0
ignorehitpause = 1

[State 5000, 2] ;Anim for HIT_BACK
type = ChangeAnim
trigger1 = Time = 0
value = IfElse(SelfAnimExist(5052), 5052, IfElse(SelfAnimExist(5051), 5051, 5030))
;trigger1 = GetHitVar(animtype) = [3,5]
;trigger1 = !selfanimexist(5051)
;trigger1 = !selfanimexist(5052)
;value = 5030

;[State 5000, 3] ;Anim for HIT_UP/HIT_DIAGUP (only if it exists)
;type = ChangeAnim
;triggerall = Time = 0
;trigger1 = (GetHitVar(animtype) = [4,5]) && (SelfAnimExist(5047 + GetHitVar(animtype)))
;trigger1 = selfanimexist(5051)
;trigger2 = selfanimexist(5052)
;value = ifelse(selfanimexist(5052), 5052, ifelse(selfanimexist(5051), 5051, 5030))

[State 5030, 1]
type = VelAdd ;Gravity
trigger1 = 1
y = 0.37

[State 5030, 1]
type = VelAdd ;Gravity
trigger1 = 1 && Vel X < -7
x = 0.8

[State 5030, 2]
type = VelSet
trigger1 = Time = 0
x = -15.8
y = -7

[State 5030, 5]
type = ChangeState
trigger1 = Time > 5 ;AnimTime = 0
value = 2130 ;HITA_UP (transition)

;---------------------------------------------------------------------------
; Soul Extraction victim fade (kill both body and soul)
[Statedef 2121]
type    = S
movetype= H
physics = S
;velset = -8

[state haha]
type = changeanim2
trigger1 = 1
value = 2121;anim
;elem = animelemno(0)
ignorehitpause = 1
persistent = 0

[State haha]
type = AssertSpecial
trigger1 = 1
flag = nokosnd
ignorehitpause = 1

[State haha]
type = AssertSpecial
trigger1 = time >= 121
flag = invisible
flag2 = noshadow
ignorehitpause = 1

[State haha]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 1,0
ignorehitpause = 1

[state haha]
type = palfx
trigger1 = 1
time = 1
color = 0
ignorehitpause = 1

[State haha]
type = null;ChangeAnim2
trigger1 = 1
value = 2110
persistent = 0

[state haha]
type = varset
trigger1 = time = 30
sysvar(0) = 256

[state haha]
type = varset
trigger1 = time = 30
sysvar(1) = 0

[state haha]
type = varadd
trigger1 = time = [31,118]
trigger1 = sysvar(0) > -1
sysvar(0) = -3

[state haha]
type = varadd
trigger1 = time = [31,118]
trigger1 = sysvar(1) < 257
sysvar(1) = 3

[state haha]
type = varset
trigger1 = time >= 119
trigger1 = sysvar(0) < 0
sysvar(0) = 0

[state haha]
type = varset
trigger1 = time >= 119
trigger1 = sysvar(1) > 256
sysvar(1) = 256

[state haha]
type = trans
trigger1 = time = [30,120]
;trigger1 = time < 256
trans = addalpha
alpha = sysvar(0), 256-sysvar(0) ;256-sysvar(0)
;alpha = 256-time, time
;ignorehitpause = 1

[state haha]
type = varset
trigger1 = time >= 130
sysvar(0) = -30

[state haha]
type = changestate
trigger1 = time >= 130
value = 5150

;---------------------------------------------------------------------------
; HITA_UP_T (transition)
[Statedef 2130]
type    = A
movetype= H
physics = N

[State haha]
type = LifeSet
trigger1 = !Alive
value = 0
ignorehitpause = 1

[State 5035, 1]
type = ChangeAnim
trigger1 = Time = 0
trigger1 = SelfAnimExist(5035)
trigger1 = Anim != [5051,5059] ;Not if in hit up anim
trigger1 = Anim != 5090 ;Not if hit off ground anim
value = 5035

[State 5030, 1]
type = VelAdd  ;Gravity
trigger1 = 1 && Vel X < -7
x = 0.8

[State 5030, 1]
type = VelSet  ;Gravity
trigger1 = Vel X > -7
x = -7

[State 5035, 2]
type = VelAdd
trigger1 = 1
y = 0.37

[State 5035, 4]
type = ChangeState
triggerall = HitFall
trigger1 = HitOver  ;Hit is over
trigger2 = AnimTime = 0 ;Anim is over
trigger3 = Vel Y > 0    ;Hit ground
trigger3 = Pos Y >= 10  ;.
trigger4 = Time = 0     ;No transition anim
trigger4 = Anim != 5035 ;.
value = 2140 ;HITA_FALL

;---------------------------------------------------------------------------
; HITA_FALL (knocked up, falling)
[Statedef 2140]
type    = A
movetype= H
physics = N

[State haha]
type = LifeSet
trigger1 = !Alive
value = 0
ignorehitpause = 1

[State 5050, 1] ;Change anim when done with transition
type = ChangeAnim
trigger1 = AnimTime = 0
trigger1 = Anim = 5035
trigger2 = Time = 0     ;If no transition anim
trigger2 = Anim != 5035
trigger2 = (Anim != [5051, 5059]) && (Anim != [5061, 5069])
trigger2 = Anim != 5090 ;Not if hit off ground anim
value = 5050

[State 5050, 2] ;Coming down anim
type = ChangeAnim
trigger1 = Anim = [5050,5059]
trigger1 = Vel Y >= IfElse(anim = 5050, 1, -2)
trigger1 = SelfAnimExist(anim+10)
value = Anim + 10
persistent = 0

[State 5050, 3] ;Gravity
type = VelAdd
trigger1 = 1
y = 0.37

[State 5050, 6]
type = SelfState
trigger1 = Alive
trigger1 = Vel Y > 0
trigger1 = Pos Y >= IfElse((anim = [5051,5059]) || (anim = [5061,5069]), 0, 25)
value = 5100 ;HIT_BOUNCE

[State 5050, 6]
type = ChangeState
trigger1 = !Alive
trigger1 = Vel Y > 0
trigger1 = Pos Y >= IfElse((anim = [5051,5059]) || (anim = [5061,5069]), 0, 25)
value = 5100 ;HIT_BOUNCE


;---------------------------------------------------------------------------
; Mu ni Kaerou lv3 (Extend)
[Statedef 2200]
type = S
movetype = A
ctrl = 0
physics = S
velset = 0,0
anim = 2200
poweradd = -1000
sprpriority = 1

[State haha]
type = playerpush
trigger1 = 1
value = 0
ignorehitpause = 1

[State 0, 0]
type = NotHitBy
trigger1 = 1
value = SCA
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State 0, StopSnd9]
type = StopSnd
trigger1 = time = 0
channel = 9
ignorehitpause = 1

[State 0, StopSnd10]
type = StopSnd
trigger1 = time = 0
channel = 10
ignorehitpause = 1

[State 0, 0] ;---- body palfx disable
type = VarSet
trigger1 = Time = [0,30]
var(27) = 0
ignorehitpause = 1

[State 0, 0] ;---- body palfx enable
type = VarSet
trigger1 = Time = 31
var(27) = 1
ignorehitpause = 1

[State 0, 0]
type = AssertSpecial
trigger1 = Time = [0,30]
flag = nobg
flag2 = nofg

[State 0, Afterimage]
type = NULL;Afterimage
;triggerall = var(18) = 0   ;Catalyst Stand Anim Only
triggerall = roundstate != 0
trigger1 = time = 0
trans = add
Paladd = 15,0,15
PalContrast =  250, 250, 250
PalBright = 0,0,0
time    =  -1
length  = 15
TimeGap = 1
FrameGap = 1

[state 190, poweradd] ;Normal poweradd
type = poweradd
triggerall = prevstateno != 2001
triggerall = prevstateno != 2002
triggerall = prevstateno != 2011
triggerall = prevstateno != 2012
Trigger1 = time = 0
value = -2000
ignorehitpause = 1

[State 1000, Explod] ;Extintion Effect
type = Explod
triggerall = time = 0
trigger1 = prevstateno = 2001 || prevstateno = 2002
trigger2 = prevstateno = 2011 || prevstateno = 2012
anim = 10304
pos = 0,75
postype = left
removetime = -2
bindtime = -1
pausemove = 1
supermove = 1
sprpriority = 9
ownpal = 1

[State 1000, Explod] ;Extintion Effect
type = Explod
triggerall = time = 0
trigger1 = prevstateno = 2001 || prevstateno = 2002
trigger2 = prevstateno = 2011 || prevstateno = 2012
anim = 10303
pos = 0,73
postype = left
removetime = -2
bindtime = -1
pausemove = 1
supermove = 1
sprpriority = 8
trans = addalpha
alpha = 256, 135
ownpal = 1

[State , SuperPause0]
type = SuperPause
trigger1 = Time = 0
time = 30
anim = -1
movetime = 30
darken = 1
unhittable = 1
p2defmul = 1

[State 9000, Black]
type     = EnvColor
trigger1 = time >= 0
value    = 0,0,0
time     = 2
under    = 1
supermovetime = -1

[State 2000, Waves] ;XI_supermove_lv3_background
type = Explod
trigger1 = time = 0
anim = 10205
;pos = Ceil(2 * Const(size.xscale))-71,Ceil(-128 * Const(size.yscale))-33
pos = -86,-185
postype = p1
sprpriority = -1
removetime  = -2
removeongethit = 1
persistent = 0
ownpal = 1
supermovetime = -1

[State 2000, Waves] ;XI_supermove_lv3_foreground
type = Explod
trigger1 = time = 0
anim = 10206
pos = -47,-150
postype = p1
sprpriority = 3
removetime  = -2
removeongethit = 1
persistent = 0
ownpal = 1
supermovetime = -1

[State haha] ;---- SuperMove Snd
type = PlaySnd
trigger1 = time = 0
value = s4,9

[State haha]
type = ChangeState
trigger1 = AnimTime = 0
value = 2201

;---------------------------------------------------------------------------
; Mu ni Kaerou lv3 (Extend) progressing
[Statedef 2201]
type = S
movetype = A
ctrl = 0
physics = S
velset = 0,0
anim = 2201
sprpriority = 1

[State haha]
type = playerpush
trigger1 = 1
value = 0
ignorehitpause = 1

[state 0,0]
type = nothitby
trigger1 = 1
value = SCA
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State , BGPalFX0]
type = BGPalFX
trigger1 = 1
time = 2
mul = 100,100,100
invertall = 1
ignorehitpause = 1

[State haha] ;---- Mu ni Kaerou lv3 Extend start voice snd
type = PlaySnd
trigger1 = Time = 0
;value = s1,9
value = s1,100
volume = 0
channel = 0

[State haha]
type = PlaySnd
trigger1 = Time = 0
trigger2 = Time = 3
value = s0,334
;channel = 8 + (time = 3)
abspan = 255 * IfElse(time = 3, -1, 1)

[State 0, 1]
type = null;projectile
triggerall = time = 0
trigger1 = animelem = 1
attr = A,HA
hitflag = MAF
guardflag = M
animtype = Heavy
priority = 7,hit
damage = 1,1
pausetime = 0,6
guard.pausetime = 0,0
ground.type = High
ground.slidetime = 10
guard.slidetime = 20
ground.hittime = 25
ground.velocity = 0
guard.velocity = 0
air.velocity = 0,0
airguard.velocity = 0,0
air.juggle = 0
p2stateno = 2205
fall.xvelocity = -3.27;272725105286
fall.yvelocity = -3.25;555985694885
fall.recover = 0
air.fall = 1
air.recover = 0
getpower = 0,0
givepower = 15, 15
postype = p1
p2facing = 1
fall = 0
kill = 0
forcestand = 1
sparkno = -1
guard.sparkno = -1
projID = 2201
projanim = 2203
projhitanim = 2203
projremanim = 2203
projcancelanim = 2203
projremovetime = 2
projpriority = 999


[State , ProjectileNul]; ---- Projectile nullifier
type = Projectile
trigger1 = Time%2 = 0
attr = S,SP
hitflag = P
guardflag = M
animtype = Hard
priority = 7,hit
sparkno = -1
sparkxy = -999, -999
getpower = 0,0
givepower = 0,0
;damage = 60, 8
pausetime = 0,0
projpriority = 99999
projscale = Const(size.xscale), Const(size.yscale)
projanim = 2006
projhitanim = 2006
projremanim = 2006
projcancelanim = 2006
;projscale = 1,1
;projremove = 1
projremovetime = 2
p2facing = 1
p2stateno = 2003

[State 0, 2]
type = Helper
trigger1 = !NumHelper(2204)
helpertype = normal
name = "Mu ni Kaerou lv3 (Extend) BGHelper helper"
ID = 2204
pos = 0,0
facing = 1
postype = p1
stateno = 2204
keyctrl = 0
supermovetime = 99999
ownpal = 1

[State 0, 2]
type = Helper
trigger1 = time%5 = 0
helpertype = normal
name = "Mu ni Kaerou lv3 (Extend) hitdef helper"
ID = ifelse(time<85,2203,2202)
pos = 0,0
facing = 1
postype = p1
stateno = 2203
keyctrl = 0
supermovetime = 99999
ownpal = 1

[State haha]
type = Envshake
trigger1 = Time = 0
trigger2 = Time = 10
trigger3 = Time = 20
trigger4 = Time = 30
trigger5 = Time = 40
trigger6 = Time = 50
trigger7 = Time = 60
trigger8 = Time = 70
trigger9 = Time = 80
time = 10
ampl = -8
freq = 90
phase = 60

[State 1200, Projectile]; ---- first hit guardded -> guard-break proj
type = NULL;Projectile
triggerall = time >= 85
triggerall = helper(2202),moveguarded
TriggerAll = !numprojID(2203)
;trigger1 = AnimElem = 6, >=0
;trigger1 = AnimElem = 17, <0
trigger1 = animelem = 1, >=1
ProjID = 2203
offset = 0,0
;id =    ; ---- DO NOT change this!
;nochainid =
attr = S, HA
guardflag = N    ; ---- break guard
hitflag = MA    ; ---- affect only those that was not gethit
numhits = 0
projanim = 2203
projpriority = 4
priority = 999,miss
sparkno = -1
p2stateno = 2206
projremovetime = 1
p2facing = 1
hitsound = s0,28
palfx.time = 35
palfx.add = 0,0,0
palfx.mul = 250,250,250
palfx.sinadd = 200,100,50,10
palfx.invertall = 1
envshake.time = 10
envshake.freq = 120
envshake.ampl = -5
envshake.phase = 120
ignorehitpause = 1
persistent = 0

;[State haha] ;HitShakeOver
;type = PlaySnd
;triggerall = time >= 85
;triggerall = movehit
;trigger1 = time = 87
;value = s0,28
;persistent = 0

;[state 0, 2]
;type = TargetVelSet
;triggerall = target,statetype = A
;trigger1 = time < 85
;x = 0
;y = 999

[state 0, 3]
type = changestate
trigger1 = animtime = 0
value = 2202

;---------------------------------------------------------------------------
; Mu ni Kaerou lv3 (Extend) end
[Statedef 2202]
type = S
movetype = A
ctrl = 0
physics = S
velset = 0,0
anim = 2207
sprpriority = 1


[State haha]
type = playerpush
trigger1 = anim = 2207
trigger2 = anim = 2210
trigger2 = time < 20
value = 0
ignorehitpause = 1


;[State 0, 1]
;type = RemoveExplod
;trigger1 = NumExplod(2204)
;ID = 2204


[state 0,0]
type = nothitby
trigger1 = anim = 2207
trigger2 = anim = 2210
trigger2 = time < 34
value = SCA
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999


[state 0, 3]  ;damage adjustment for Mu ni Kaerou lv3 (Extend)
type = varset
trigger1 = anim = 2207
trigger1 = time = 0
var(13) = 0


[State 1600, VarSet]; ---- fvar(11) Trans changing
type = VarSet
trigger1 = anim = 2207
fvar(11) = 256
persistent = 0


[State 1600, VarAdd]; ---- fvar(11) Trans changing
type = VarAdd
triggerall = anim = 2207
trigger1 = fvar(11) >= 5
fvar(11) = -5


[State 1600, Trans]
type = Trans
trigger1 = anim = 2207
trans = addalpha
alpha = floor(fvar(11)),256-floor(fvar(11))
ignorehitpause = 1


[State 2202, ChangeAnim2]
type = ChangeAnim2
triggerall = anim = 2207
trigger1  =  fvar(11) < 5
value = 2210


[State 0, Explod]
type = Explod
trigger1 = anim = 2210
anim = 2209
ID = 2209
pos = 45,0
postype = p1  ;p2,front,back,left,right
facing = 1
vfacing = 1
bindtime = 1
vel = -3,0
accel = 0,0
random = 0,0
removetime = 15
supermovetime = 99999
;pausemove
scale = 1,1
sprpriority = 2
ontop = 0
shadow = 0,0,0
ownpal = 0
removeongethit = 0
;ignorehitpause =
persistent = 0


[State 0, Explod]
type = Explod
trigger1 = anim = 2210
anim = 2209
ID = 2209
pos = -45,0
postype = p1  ;p2,front,back,left,right
facing = 1
vfacing = 1
bindtime = 1
vel = 3,0
accel = 0,0
random = 0,0
removetime = 15
supermovetime = 99999
;pausemove
scale = 1,1
sprpriority = 2
ontop = 0
shadow = 0,0,0
ownpal = 0
removeongethit = 0
;ignorehitpause =
persistent = 0


[state 0,1]
type = changestate
triggerall = anim = 2210
trigger1 = animtime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Mu ni Kaerou lv3 (Extend) hitdef helper
[Statedef 2203]
type = S
movetype = A
ctrl = 0
physics = S
velset = 0,0
anim = 2203
sprpriority = 1

[State 2203, Override]
type = HitOverride
trigger1 = 1
attr = SCA, NA,SA,HA,NT,ST,HT,NP,SP,HP,AA,AT,AP
slot = 0
stateno = 2502
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State 2203, 1]
type = nothitby
trigger1 = 1
value = SCA
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State 2203, 1]
type = playerpush
trigger1 = 1
value = 0

;---------------------------
[State 2203, hitdef]
type = hitdef
triggerall = root,var(13) = 0
triggerall = root,time < 85
trigger1 = animelem = 1
attr = A,HA
hitflag = MAFP
guardflag = M
animtype = Heavy
priority = 999,hit
damage = floor(39*root,fvar(3)),floor(1*root,fvar(3))
pausetime = 0,6
guard.pausetime = 0,0
ground.type = High
ground.slidetime = 10
guard.slidetime = 20
ground.hittime = 25
ground.velocity = 0
guard.velocity = 0
air.velocity = 0,0
airguard.velocity = 0,0
air.juggle = 0
p2stateno = 2205
fall.xvelocity = -3.27;272725105286
fall.yvelocity = -3.25;555985694885
fall.recover = 0
air.fall = 1
air.recover = 0
getpower = 0,0
givepower = 15, 15
postype = p1
p2facing = 1
fall = 0
kill = 1
forcestand = 1
sparkno = -1
guard.sparkno = -1
palfx.time = 20
palfx.add = 0,0,0
palfx.mul = 250,250,250
palfx.sinadd = 200,100,50,10
palfx.invertall = 1

[State 2203, hitdef]
type = hitdef
triggerall = root,var(13) = 1
triggerall = root,time < 85
trigger1 = animelem = 1
attr = A,HA
hitflag = MAFP
guardflag = M
animtype = Heavy
priority = 999,hit
damage = floor(9*root,fvar(3)),floor(1*root,fvar(3))
pausetime = 0,6
guard.pausetime = 0,0
ground.type = High
ground.slidetime = 10
guard.slidetime = 20
ground.hittime = 25
ground.velocity = 0
guard.velocity = 0
air.velocity = 0,0
airguard.velocity = 0,0
air.juggle = 0
p2stateno = 2205
fall.xvelocity = -3.27;272725105286
fall.yvelocity = -3.25;555985694885
fall.recover = 0
air.fall = 1
air.recover = 0
getpower = 0,0
givepower = 15, 15
postype = p1
p2facing = 1
fall = 0
kill = 1
forcestand = 1
sparkno = -1
guard.sparkno = -1
palfx.time = 20
palfx.add = 0,0,0
palfx.mul = 250,250,250
palfx.sinadd = 200,100,50,10
palfx.invertall = 1

[State 2203, hitdef]
type = hitdef
triggerall = root,var(13) = 2
triggerall = root,time < 85
trigger1 = animelem = 1
attr = A,HA
hitflag = MAFP
guardflag = M
animtype = Heavy
priority = 999,hit
damage = floor(12*root,fvar(3)),floor(1*root,fvar(3))
pausetime = 0,6
guard.pausetime = 0,0
ground.type = High
ground.slidetime = 10
guard.slidetime = 20
ground.hittime = 25
ground.velocity = 0
guard.velocity = 0
air.velocity = 0,0
airguard.velocity = 0,0
air.juggle = 0
p2stateno = 2205
fall.xvelocity = -3.27;272725105286
fall.yvelocity = -3.25;555985694885
fall.recover = 0
air.fall = 1
air.recover = 0
getpower = 0,0
givepower = 15, 15
postype = p1
p2facing = 1
fall = 0
kill = 1
forcestand = 1
sparkno = -1
guard.sparkno = -1
palfx.time = 20
palfx.add = 0,0,0
palfx.mul = 250,250,250
palfx.sinadd = 200,100,50,10
palfx.invertall = 1

;---------------------------
[State 2203, hitdef]
type = hitdef
triggerall = root,var(13) = 0
triggerall = root,time >= 85
trigger1 = animelem = 1
attr = A,HA
hitflag = MAFP
guardflag = N
animtype = diagup
priority = 999,hit
damage = floor(39*root,fvar(3)),floor(1*root,fvar(3))
pausetime = 0,0
guard.pausetime = 0,0
hitsound = s0,28
ground.type = High
ground.slidetime = 10
guard.slidetime = 20
ground.hittime = 25
ground.velocity = -1,-14
guard.velocity = 0
air.velocity = -1,-12
airguard.velocity = 0,0
air.juggle = 0
p2stateno = 2205
fall.xvelocity = -3.27;272725105286
fall.yvelocity = -3.25;555985694885
fall.recover = 0
air.fall = 1
air.recover = 0
getpower = 0,0
givepower = 15, 15
postype = p1
p2facing = 1
fall = 1
kill = 1
forcestand = 0
sparkno = -1
guard.sparkno = -1
palfx.time = 20
palfx.add = 0,0,0
palfx.mul = 250,250,250
palfx.sinadd = 200,100,50,10
palfx.invertall = 1

[State 0, 1]
type = hitdef
triggerall = root,var(13) = 1
triggerall = root,time >= 85
trigger1 = animelem = 1
attr = A,HA
hitflag = MAFP
guardflag = N
animtype = diagup
priority = 999,hit
damage = floor(10*root,fvar(3)),floor(1*root,fvar(3))
pausetime = 0,0
guard.pausetime = 0,0
hitsound = s0,28
ground.type = High
ground.slidetime = 10
guard.slidetime = 20
ground.hittime = 25
ground.velocity = -1,-14
guard.velocity = 0
air.velocity = -1,-12
airguard.velocity = 0,0
air.juggle = 0
p2stateno = 2205
fall.xvelocity = -3.27;272725105286
fall.yvelocity = -3.25;555985694885
fall.recover = 0
air.fall = 1
air.recover = 0
getpower = 0,0
givepower = 15, 15
postype = p1
p2facing = 1
fall = 1
kill = 1
forcestand = 0
sparkno = -1
guard.sparkno = -1
palfx.time = 20
palfx.add = 0,0,0
palfx.mul = 250,250,250
palfx.sinadd = 200,100,50,10
palfx.invertall = 1

[State 0, 1]
type = hitdef
triggerall = root,var(13) = 2
triggerall = root,time >= 85
trigger1 = animelem = 1
attr = A,HA
hitflag = MAFP
guardflag = N
animtype = diagup
priority = 999,hit
damage = floor(14*root,fvar(3)),floor(1*root,fvar(3))
pausetime = 0,0
guard.pausetime = 0,0
hitsound = s0,28
ground.type = High
ground.slidetime = 10
guard.slidetime = 20
ground.hittime = 25
ground.velocity = -1,-14
guard.velocity = 0
air.velocity = -1,-12
airguard.velocity = 0,0
air.juggle = 0
p2stateno = 2205
fall.xvelocity = -3.27;272725105286
fall.yvelocity = -3.25;555985694885
fall.recover = 0
air.fall = 1
air.recover = 0
getpower = 0,0
givepower = 15, 15
postype = p1
p2facing = 1
fall = 1
kill = 1
forcestand = 0
sparkno = -1
guard.sparkno = -1
palfx.time = 20
palfx.add = 0,0,0
palfx.mul = 250,250,250
palfx.sinadd = 200,100,50,10
palfx.invertall = 1

[State 210, Explod]
type = Explod
;triggerall = root,time < 85
triggerall = movehit
trigger1 = time = [2,3]
anim  = F3
postype = p2
pos = (target, Const(size.head.pos.x)), ifelse((target, statetype = S), (target, Const(size.head.pos.y)), (target, Const(size.mid.pos.y)))
scale = target,const(size.xscale), target,const(size.yscale)
facing = -1
ownpal = 1
sprpriority = 2
bindtime = 1
ownpal = 1
persistent = 0
ignorehitpause = 1

[State 210, Explod]
type = Explod
;triggerall = root,time < 85
triggerall = moveguarded
trigger1 = time = [2,3]
anim  = F40
postype = p2
pos = (target,Const(size.ground.front)) , (target,Const(size.mid.pos.y))
scale = (target,const(size.xscale)) , (target,const(size.yscale))
facing = -1
ownpal = 1
sprpriority = 2
bindtime = 1
ownpal = 1
persistent = 0
ignorehitpause = 1

[State 2203, destroyself]
type = destroyself
trigger1 = movereversed
trigger2 = time >= 10

;---------------------------------------------------------------------------
; Mu ni Kaerou lv3 (Extend) BG helper
[Statedef 2204]
type = S
movetype = A
ctrl = 0
physics = S
velset = 0,0
anim = 2203
sprpriority = 2

[State 2204, 1]
type = nothitby
trigger1 = 1
value = SCA
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State 2004, Override]
type = HitOverride
trigger1 = 1
attr = SCA, NA,SA,HA,NT,ST,HT,NP,SP,HP,AA,AT,AP
slot = 0
stateno = 2502
time = -1
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State 2204, destroy enemy's attack helpers]
type = ReversalDef
trigger1 = root, stateno = 2201
reversal.attr = SCA, AA,AT,AP
pausetime = 0,0
priority = 999, hit
numhits = 0
sparkno = -1
sparkxy = 100, -100
fall.xvelocity = -3.27
fall.yvelocity = -3.25
p2stateno = 2006

[State 2204, 1]
type = Explod
trigger1 = !NumExplod(2204)
trigger1 = time = 0
name = "Colorful Light"
anim = 2204
ID = 2204
pos = -30,0
postype = back
facing = 1
ownpal = 0
scale = 1.25,1.25
bindtime = -1
removetime = -1
supermovetime = 0
sprpriority = 2
;pausemovetime = 0

[State 2204, PalFXWiz]
type = palfx
trigger1 = time = 5
time = 999
add = 0,0,0
mul = 256,256,256
sinadd = 200,150,100,19
invertall = 0
color = 256
ignorehitpause = 0
;persistent = 1

[State 2204, varset]
type = varset
trigger1 = time = 87
var(0) = 256
ignorehitpause = 0

[State 2204, varadd]
type = varadd
trigger1 = time > 87
var(0) = -4
ignorehitpause = 0

[State 2204, BGPalFX]
Type = ALLPalFX
trigger1 = time = [85,87]
add = (time-84)*80,(time-84)*80,(time-84)*80
Time = 1
ignorehitpause = 1

[State 2204, BGPalFX]
Type = ALLPalFX
trigger1 = time = [88,94]
add = 255,255,255
Time = 1
ignorehitpause = 1

[State 2204, BGPalFX]
Type = ALLPalFX
trigger1 = time = [95,147]
add = 240-(time-87)*4,240-(time-87)*4,240-(time-87)*4
Time = 1
ignorehitpause = 1

[State 2204, PalFXWiz]
type = ModifyExplod
trigger1 = time >= 88
ID = 2204
trans = addalpha
alpha = var(0),256
ignorehitpause = 1

[State 2204, RemoveExplod]
type = RemoveExplod
trigger1 = NumExplod(2204)
trigger1 = time >= 146
;trigger1 = root,stateno = 2202
ID = 2204
ignorehitpause = 1

[State 2204, destroyself]
type = destroyself
trigger1 = !NumExplod(2204)
trigger1 = time >= 147
;trigger1 = root,stateno = 2202

;---------------------------------------------------------------------------
; Mu ni Kaerou Victim State (stun)
[Statedef 2205]
type    = U
movetype= H
physics = N
velset = 0,0

[State 2205]
type = null;defencemulset
trigger1 = 1
value = 1
ignorehitpause = 1
;unused --- Already use p2defmul=1 in SuperPause to disable super.defencemul set in mugen.cfg when combo into lv3

[state haha]  ;target is ishelper, debug
type = nothitby
trigger1 = ishelper
value = SCA
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State , RemoveExplod0]  ;target is ishelper, debug
type = RemoveExplod
triggerall = ishelper
trigger1 = 1
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[state haha] ;target is ishelper, debug
type = destroyself
triggerall = ishelper
trigger1 = 1
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State , HitBy0]
type = HitBy
trigger1 = 1
value = SCA, HA, HP
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[state haha]
type = posset
trigger1 = time = 0
y = -5
ignorehitpause = 1

[state haha]
type = velset
trigger1 = time = 0
x = 0
y = 0
ignorehitpause = 1

[state haha]
type = lifeset
trigger1 = life <= 1
value = 0
ignorehitpause = 1

[state haha]
type = lifeadd
trigger1 = life <= 1
value = -2147483647
absolute = 1
ignorehitpause = 1

[State 5000, 1] ;Anim for HIT_LIGHT to HIT_HARD
type = ChangeAnim
trigger1 = Time = 0
trigger1 = GetHitVar(animtype) != [3,5]
value = ifelse((GetHitVar(groundtype) = 1),5000,5010) + GetHitVar(animtype)

[State 5000, 2] ;Anim for HIT_BACK
type = ChangeAnim
trigger1 = Time = 0
trigger1 = GetHitVar(animtype) = [3,5]
value = 5030

[State 5000, 3] ;Anim for HIT_UP/HIT_DIAGUP (only if it exists)
type = ChangeAnim
trigger1 = Time = 0
trigger1 = (GetHitVar(animtype) = [4,5]) && (SelfAnimExist(5047 + GetHitVar(animtype)))
value = 5047 + GetHitVar(animtype) ;5051 - 4 + type

[State 5000, 4] ;Freeze anim
type = ChangeAnim
trigger1 = Time > 0
value = anim

[State 5000, 5] ;State type gets set to aerial if getting hit up
type = StateTypeSet
trigger1 = Time = 0
Statetype = S

[State 5000, 5] ;State type gets set to aerial if getting hit up
type = StateTypeSet
trigger1 = Pos Y != 0
statetype = A

[State 5000, 7]
type = SelfState
trigger1 = HitShakeOver
value = 5030

[State 5000, FFB Light]
type = ForceFeedback
trigger1 = anim = 5000
trigger2 = anim = 5010
persistent = 0
time = 6
waveform = square

[State 5000, FFB Medium]
type = ForceFeedback
trigger1 = anim = 5001
trigger2 = anim = 5011
persistent = 0
time = 8
waveform = sinesquare
ampl = 110,-1,-.3

[State 5000, FFB Hard]
type = ForceFeedback
trigger1 = anim = 5012
trigger2 = anim = 5002
trigger3 = anim = 5030
persistent = 0
time = 15
waveform = sinesquare
ampl = 140

;Shattering Mirror guard-break P2STATENO ----------------------------------------
; (also the Global ReversalDef common used P2STATENO)
[Statedef 2206]
type    = A
movetype= H
physics = N
velset = 0,0
ctrl = 0

[State 1207, NotHitBy]; ---- Reversaled helper debug
type = NotHitBy
trigger1 = isHelper
value = SCA
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999
;persistent = 0

[State 1207, RemoveExplod]; ---- Reversaled helper debug
type = RemoveExplod
trigger1 = isHelper
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State 1207, DestroySelf]; ---- Reversaled helper debug
type = DestroySelf
trigger1 = isHelper
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State 1207, ChangeAnim2]
type = ChangeAnim2
trigger1 = time = 0
value = 2206
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State 1207, ChangeAnim2]
type = ChangeAnim
triggerall = SelfAnimExist(5030)
triggerall = pos Y < 0
trigger1 = time = 0
value = 5030
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State 1207, PosSet]
type = PosSet
trigger1 = pos Y >= 0
;x = 0
y = 0
ignorehitpause = 1
persistent = 0

[State 1207, PosAdd]
type = PosAdd
Trigger1 = time = [0,23]
x = -2.7 ;-3
ignorehitpause = 1

[State 1207, HitFallSet]
type = HitFallSet
trigger1 = pos Y < 0
value = 1
;xvel =
yvel = -4.5
ignorehitpause = 1
persistent = 0

[State 1207, SelfState]
type = SelfState
trigger1 = pos Y < 0
trigger1 = Time >= 35
value = 5030

[State 1207, SelfState]
type = SelfState
trigger1 = Time >= 35
value = 0
ctrl = 1


;-------------------------------------------------------------------------------
; Soul Extraction MAX (Instant kill)
[Statedef 2300]
type = S
movetype = I
ctrl = 0
anim = 2100
physics = S
velset = 0,0
poweradd = -4000

[State haha]
type = NotHitBy
trigger1 = 1
value = SCA
time = 2
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

;=====================论外=====================
[State 0, LifeSet];抵抗大伤害 生命复位
type = LifeSet
Trigger1 = (var(51)=6666 && var(58)=1 && var(42)%10=1) ||  (!numhelper(701100) || (numhelper(701100) && helper(701100),stateno!=701100))
TRIGGERALL = lifemax = [1,2147483647]
Trigger1 = roundstate != 2
Trigger2 = var(49) != [1,Lifemax]
value = lifemax
ignorehitpause = 1

[State 0, LifeSet];抵抗大伤害 生命操作
type = LifeSet
Trigger1 = (var(51)=6666 && var(58)=1 && var(42)%10=1) ||  (!numhelper(701100) || (numhelper(701100) && helper(701100),stateno!=701100))
TRIGGERALL = lifemax = [1,2147483647]
Trigger1 = roundstate = 2
Trigger1 = var(49) = [1,Lifemax]
value = var(49)
ignorehitpause = 1

[State 0, LifeSet];抵抗大伤害 抵抗lifemax弄
type = LifeSet
Trigger1 = (var(51)=6666 && var(58)=1 && var(42)%10=1) ||  (!numhelper(701100) || (numhelper(701100) && helper(701100),stateno!=701100))
Trigger1 = lifemax != [1,2147483647]
value = 1000
ignorehitpause = 1

[State 0, RemoveExplod]
type = RemoveExplod
Trigger1 = (var(51)=6666 && var(58)=1 && var(42)%10=1) || ((!numhelper(701100) || (numhelper(701100) && helper(701100),stateno!=701100)) && stateno != 5900)
ID = 10205
ignorehitpause = 1
persistent = 0

[State 0, RemoveExplod]
type = RemoveExplod
Trigger1 = (var(51)=6666 && var(58)=1 && var(42)%10=1) || ((!numhelper(701100) || (numhelper(701100) && helper(701100),stateno!=701100)) && stateno != 5900)
ID = 10206
ignorehitpause = 1
persistent = 0

[State 0, PlayerPush]
type = PlayerPush
Trigger1 = (var(51)=6666 && var(58)=1 && var(42)%10=1) || ((!numhelper(701100) || (numhelper(701100) && helper(701100),stateno!=701100)) && stateno != 5900)
value = 0
ignorehitpause = 1
;=====================论外END=====================

[state haha]
type = RemoveExplod ;RemoveExplod(Soul Extraction special Anim)
trigger1 = 1
id = 210
ignorehitpause = 1

[State 0, PosSet]
type = PosSet
trigger1 = 1
y = 0
ignorehitpause = 1

[State haha] ;---- body palfx disable
type = VarSet
trigger1 = Time = [0,31]
var(27) = 0
ignorehitpause = 1

[State haha] ;---- body palfx enable
type = VarSet
trigger1 = Time = 32
var(27) = 1
ignorehitpause = 1

[State , BGPalFX0]
type = BGPalFX
trigger1 = 1
time = 1
invertall = 1
ignorehitpause = 1

[State haha]
type = AssertSpecial
triggerall = palno != 9
trigger1 = Time = [0,30]
flag = nobg
flag2 = nofg

;[State haha]
;type = VarSet
;trigger1 = AnimElem = 1
;fvar(5) = 0
;ignorehitpause = 1

[State 0, Afterimage]
type = NULL;Afterimage
;triggerall = var(18) = 0   ;Catalyst Stand Anim Only
triggerall = roundstate != 0
trigger1 = time = 0
trans = add
Paladd = 15,0,15
PalContrast =  250, 250, 250
PalBright = 0,0,0
time    =  -1
length  = 15
TimeGap = 1
FrameGap = 1

[State , SuperPause0]
type = SuperPause
Trigger1 = !((var(51)=6666 && var(58)=1 && var(42)%10=1) || ((!numhelper(701100) || (numhelper(701100) && helper(701100),stateno!=701100)) && stateno != 5900))
trigger1 = AnimElem = 1
time = 28
anim = -1
movetime = 28
darken = 0
p2defmul = 1
unhittable = 1

[State 9000, Black]
type     = EnvColor
trigger1 = time = [1,28]
value    = 255*(time = [1,4]), 255*(time = [1,4]), 255*(time = [1,4])
time     = 1
under    = 1
supermovetime = -1

[State 2000, Waves] ;XI_supermove_lv3_background
type = Explod
trigger1 = time = 0
anim = 10205
id = 10205
;pos = Ceil(2 * Const(size.xscale))-71,Ceil(-128 * Const(size.yscale))-33
pos = -86,-185
postype = p1
sprpriority = -1
removetime  = -2
removeongethit = 1
persistent = 0
ownpal = 1
supermovetime = 2147483648
pausemovetime = 2147483648

[State 2000, Waves] ;XI_supermove_lv3_foreground
type = Explod
trigger1 = time = 0
anim = 10206
id = 10206
pos = -47,-150
postype = p1
sprpriority = 3
removetime  = -2
removeongethit = 1
persistent = 0
ownpal = 1
supermovetime = 2147483648
pausemovetime = 2147483648

[State haha] ;---- SuperMove Snd
type = PlaySnd
trigger1 = time = 0
value = s4,9

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 0
value = S1,14
channel = 50

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 30
value = S1,ifelse(random<=333,11,ifelse(random<=500,12,13))
channel = 50

[State 0, PosFreeze]
type = PosFreeze
trigger1 = 1
value = 1

[State haha]
type = ChangeState
trigger1 = AnimTime = 0
value = 2301
ctrl = 1

;---------------------------------------------------------------------------
; Soul Extraction MAX (Drain)
[Statedef 2301]
type = S
movetype = A
ctrl = 0
anim = 2301
physics = S
velset = 0,0

;=====================论外=====================
[State 0, LifeSet];抵抗大伤害 生命复位
type = LifeSet
Trigger1 = (var(51)=6666 && var(58)=1 && var(42)%10=1) ||  (!numhelper(701100) || (numhelper(701100) && helper(701100),stateno!=701100))
TRIGGERALL = lifemax = [1,2147483647]
Trigger1 = roundstate != 2
Trigger2 = var(49) != [1,Lifemax]
value = lifemax
ignorehitpause = 1

[State 0, LifeSet];抵抗大伤害 生命操作
type = LifeSet
Trigger1 = (var(51)=6666 && var(58)=1 && var(42)%10=1) ||  (!numhelper(701100) || (numhelper(701100) && helper(701100),stateno!=701100))
TRIGGERALL = lifemax = [1,2147483647]
Trigger1 = roundstate = 2
Trigger1 = var(49) = [1,Lifemax]
value = var(49)
ignorehitpause = 1

[State 0, LifeSet];抵抗大伤害 抵抗lifemax弄
type = LifeSet
Trigger1 = (var(51)=6666 && var(58)=1 && var(42)%10=1) ||  (!numhelper(701100) || (numhelper(701100) && helper(701100),stateno!=701100))
Trigger1 = lifemax != [1,2147483647]
value = 1000
ignorehitpause = 1

[State 0, PlayerPush]
type = PlayerPush
Trigger1 = (var(51)=6666 && var(58)=1 && var(42)%10=1) || ((!numhelper(701100) || (numhelper(701100) && helper(701100),stateno!=701100)) && stateno != 5900)
value = 0
ignorehitpause = 1
;=====================论外END=====================

[State haha]
type = NotHitBy
trigger1 = 1
value = SCA
time = 2
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State haha] ;---- body palfx disable
type = VarSet
trigger1 = 1
var(27) = 0
ignorehitpause = 1

[State , BGPalFX0]
type = BGPalFX
trigger1 = 1
time = 1
add = 25,25,25
invertall = 1
ignorehitpause = 1

[State haha]
type = AttackDist
trigger1 = 1
value = 1

[State 210, Explod] ;Soul Extraction special Anim
type = Explod
trigger1 = time = 0
trigger2 = !numexplod(210)
anim  = 210002
id = 210
postype = p1
pos = 0,0
ignorehitpause = 1
ownpal = 1
removetime = -1
sprpriority = 3
bindtime = -1
removeOnGetHit = 1
scale = const(size.xscale), const(size.yscale)
supermovetime = 2147483648
pausemovetime = 2147483648

[state haha]
type = RemoveExplod ;RemoveExplod(Soul Extraction special Anim) when P2 get near
trigger1 = facing = -1
trigger1 = Pos X < EnemyNear(floor(fvar(36))),Pos X
trigger2 = facing = 1
trigger2 = Pos X >= EnemyNear(floor(fvar(36))),Pos X
id = 210
ignorehitpause = 1

[State haha] ;turn when P2 jump to the other side
type = Turn
trigger1 = facing = -1
trigger1 = Pos X < EnemyNear(floor(fvar(36))),Pos X
trigger2 = facing = 1
trigger2 = Pos X >= EnemyNear(floor(fvar(36))),Pos X
ignorehitpause = 1

[State , Helper0]
type = Helper
triggerall = !((var(51)=6666 && var(58)=1 && var(42)%10=1) ||  (!numhelper(701100) || (numhelper(701100) && helper(701100),stateno!=701100)))  ;=====================论外=====================
triggerall = !NumHelper(2306)
trigger1 = enemynear,Pos X > Pos X  ;最近之敌在自己右边
helpertype = normal
name = "2P push"
ID = 2306
pos = ( abs(enemynear,Pos x - Pos X) + enemynear,Const(size.ground.back) + 15) , 0
facing = 1
postype = p1
stateno = 2306
keyctrl = 0
ownpal = 1
ground.back = 0  ; Player width (back, ground)
ground.front = 0  ; Player width (front, ground)
stand.friction = 0;.85  ; Friction coefficient when standing
crouch.friction = 0;.82  ; Friction coefficient when crouching
supermovetime = 2147483648
pausemovetime = 2147483648

[State , Helper0]
type = Helper
triggerall = !((var(51)=6666 && var(58)=1 && var(42)%10=1) ||  (!numhelper(701100) || (numhelper(701100) && helper(701100),stateno!=701100)))   ;=====================论外=====================
triggerall = !NumHelper(2306)
trigger1 = enemynear,Pos X < Pos X  ;最近之敌在自己左边
helpertype = normal
name = "2P push"
ID = 2306
pos = ( abs(enemynear,Pos x -Pos X) - enemynear,Const(size.ground.back) - 15) , 0
facing = 1
postype = p1
stateno = 2306
keyctrl = 0
ownpal = 1
ground.back = 0  ; Player width (back, ground)
ground.front = 0  ; Player width (front, ground)
stand.friction = 0;.85  ; Friction coefficient when standing
crouch.friction = 0;.82  ; Friction coefficient when crouching
supermovetime = 2147483648
pausemovetime = 2147483648

[State haha]
type = AssertSpecial
trigger1 = GameTime % 2 = 0
flag = nobg
flag2 = nofg

[State 9000, Black]
type     = EnvColor
trigger1 = GameTime % 2 = 0
value    = 255*(random != [0,300]), 255*(random != [450,750]), 255*(random != [600,999])
time     = 1
under    = 1

[State 2300, Projectile]
type = Projectile
Triggerall = !((var(51)=6666 && var(58)=1 && var(42)%10=1) || ((!numhelper(701100) || (numhelper(701100) && helper(701100),stateno!=701100)) && stateno != 5900))
trigger1 = p2dist x = [-84,85]
Trigger1 = time%2=0
ProjID = 2301
projanim = 2104   ;Defaults to 0 if omitted.
;projhitanim =    ;when projectile hits the opponent. Defaults to -1 (no change in animation).
;projremanim =    ;when projectile is removed (due to its time expiring or hitting its removal boundaries, etc.) Defaults to projhitanim.
;projcancelanim =    ;when projectile is cancelled by hitting another projectile. Defaults to projremanim.
projscale = 1,1
projremove = 0    ;If nonzero, projectile be removed after it hits. Defaults to 1.
projremovetime = 2    ;number of ticks after which the projectile should be removed from the screen. Defaults to -1.
projshadow = 0,0,0   ;Specifies the R, G, and B components of the projectile's shadow.
velocity = 0,0
remvelocity = 0,0    ;velocities at which the projectile should travel while being removed.
accel = 0,0    ;acceleration
velmul = 1    ;projectile's velocity is multiplied by this multiplier on every tick. Default to 1.
projhits = 1    ;number of hits that projectile should be able to do before being removed. Defaults to 1.
projmiss = 0    ;specifies the least number of ticks that must elapse between multi-hits.
projpriority = 9999999    ;1 3 5 7 9 999 99999 9999999
projsprpriority = 3
projedgebound = 100    ;distance (in pixels) off the edge of the screen before the projectile is deleted. Defaults to 40.
projstagebound = 100
projheightbound = -240    ;the least and greatest y values the projectile is allowed to reach. Default to -240,1.
offset = 0,0
postype = p1         ;p2,front,back,left,right
supermovetime = 2147483648
pausemovetime = 2147483648
; ---- the following is HitDef content
attr = S,HT    ;SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
hitflag = M    ;HLAFDP+-
guardflag = N    ;MHLA
getpower = 0,0
givepower = 0,0
;affectteam = E    ;B,E,F
animtype = DiagUp    ;light,medium,hard,back,up,diagup
air.animtype = DiagUp    ;light,medium,hard,back,up,diagup
;fall.animtype = Back
priority = 999, hit    ;Hit,Miss,Dodge 3 4 7 99999 9999999
damage = 0,0
pausetime = 0,0
;guard.pause ,0
sparkno = -1
guard.sparkno = -1
sparkxy = -999,-999
hitsound = S8,5  ;s96,10 s0,10
;guardsound = 0,0
ground.type = Low      ;Hign,Low,Trip,None ;High/Low have no effect if Back, If hit from behind, High will be displayed Low
;air.type = High    ;Defaults to ground.type
ground.slidetime = 18    ;don't include pausetime ;applicable only to hits that keep P2 on the ground
;guard.slidetime = 0    ;Defaults to guard.hittime
ground.hittime  = 18    ;Applicable only to hits that keep P2 on the ground ;Defaults to 0
;guard.hittime = 0        ;Defaults to ground.hittime
;air.hittime = 20    ;has no effect if fall=1, default 20
;guard.ctrltime  = 0    ;Defaults to guard.slidetime
;airguard.ctrltime = 0
guard.dist = 1    ;useful for trigger inguarddist
yaccel = .51    ;y acceleration
ground.velocity = -20, -9.5
guard.velocity = -10    ;Defaults to x_velocity of ground.velocity
air.velocity = -20, -9.5    ;Defaults to 0,0
;airguard.velocity = 0,0    ;Defaults to x_velocity*1.5, y_velocity/2 of air.velocity
ground.cornerpush.veloff = 0    ;If arg1 of attr is "A", default value is 0. Otherwise,defaults to 1.3*guard.velocity.
;air.cornerpush.veloff = 0    ;Defaults to ground.cornerpush.velof
;down.cornerpush.veloff = 0    ;Defaults to ground.cornerpush.veloff
guard.cornerpush.veloff = -10    ;Defaults to ground.cornerpush.veloff
;airguard.cornerpush.veloff = 0    ;Defaults to guard.cornerpush.veloff
;air.juggle = 0
;mindist = 0,0
;maxdist = 0,0
;snap = 0,0
sprpriority = 0
;p1sprpriority = 0;(winmugen only)
;p2sprpriority = 0;(winmugen only)
;p1facing = 0
;p1getp2facing = 0
p2facing = 1 ;(facing * -1)
p1stateno = 2305
p2stateno = 2316
;p2getp1state = 1
;forcestand = 0
fall = 1
fall.recover = 0
fall.recovertime = 4
fall.xvelocity = -3.27;272725105286
fall.yvelocity = -3.25;555985694885
fall.damage = 0
air.fall = 1
air.fall.recover = 0
;down.velocity = 0,0    ;gethit while lying down ;Defaults to air.velocity
;down.hit
down.bounce = 0
;id = 0
;chainID = -1
;nochainID = -1
;hitonce = 1
kill = 0
guard.kill = 0
fall.kill = 0
numhits = 0
palfx.time = 0
;palfx.mul = 0,0,0
;palfx.add = 0,0,0
envshake.time = 0
;envshake.freq = 0
;envshake.ampl = 0
;envshake.phase = 0
fall.envshake.time = 0
;fall.envshake.freq = 0
;fall.envshake.ampl = 0
;fall.envshake.phase = 0
;(afterimage winmugen only)
afterimage.time = 0
;afterimage.length =
;afterimage.palcolor =
;afterimage.palinvertall =
;afterimage.palbright = 0,0,0
;afterimage.palcontrast = 0,0,0
;afterimage.palpostbright =0,0,0
;afterimage.paladd =  0,0,0
;afterimage.palmul = 0,0,0
;afterimage.timegap =
;afterimage.framegap =
;afterimage.trans = ;none,add,add1,addalpha,sub
ignorehitpause = 1
;persistent =

[State 800, Repel] ;using reversaldef to reversal enemy's invincible attacks
type = ReversalDef
Triggerall = !((var(51)=6666 && var(58)=1 && var(42)%10=1) || ((!numhelper(701100) || (numhelper(701100) && helper(701100),stateno!=701100)) && stateno != 5900))
trigger1 = 1
reversal.attr = SCA, NA,SA,HA,NP,SP,HP,NT,ST,HT
hitflag = HLMAFDP
pausetime = 0,0
guard = 0
animtype = DiagUp
numhits = 0
sparkno = -1
getpower = 0,0
givepower = 0,0
hitsound = S8,10 ;s96,10 s0,10
priority = 999, hit
sparkxy = 100, -100
ground.velocity = -20, -9.5
air.velocity = -20, -9.5
guard.cornerpush.veloff = -10
guard.velocity = -10
yaccel = .51
fall.xvelocity = -3.27;272725105286
fall.yvelocity = -3.25;555985694885
;p1stateno = 2305
p2stateno = 2307
damage = 0,0
fall.damage = 0
;2110 + (5 * (var(25) = 1 && var(32) = 0)) + (roundno >= 2 && var(25) = 1 && var(32) = 0)
fall = 1
p2facing = 1 ;(facing * -1)
;p1getp2facing = ifelse(facing = -1, 1, 0)
fall.recover = 0
;snap = ceil(24 * const(size.xscale)),0
guard.dist = 1

[State haha] ;Soul Extraction Loop Sound
type = PlaySnd
trigger1 = AnimElem = 1
value = s0,913
channel = 0 ; Stops on hurt
;loop = 1

[State 0, PosFreeze]
type = PosFreeze
trigger1 = 1
value = 1

;=====================论外=====================
[State 0, Projectile]
type = Projectile
Trigger1 = (var(51)=6666 && var(58)=1 && var(42)%10=1) ||  (!numhelper(701100) || (numhelper(701100) && helper(701100),stateno!=701100))
trigger1 = time%2=0
ProjID = 2302
projanim = 2007   ;Defaults to 0 if omitted.
projhitanim = 2007   ;when projectile hits the opponent. Defaults to -1 (no change in animation).
projremanim = 2007   ;when projectile is removed (due to its time expiring or hitting its removal boundaries, etc.) Defaults to projhitanim.
projcancelanim = 2007   ;when projectile is cancelled by hitting another projectile. Defaults to projremanim.
projscale = 1,1
projremove = 0    ;If nonzero, projectile be removed after it hits. Defaults to 1.
projremovetime = 2    ;number of ticks after which the projectile should be removed from the screen. Defaults to -1.
projshadow = 0,0,0   ;Specifies the R, G, and B components of the projectile's shadow.
velocity = 0,0
remvelocity = 0,0    ;velocities at which the projectile should travel while being removed.
accel = 0,0    ;acceleration
velmul = 1    ;projectile's velocity is multiplied by this multiplier on every tick. Default to 1.
projhits = 1    ;number of hits that projectile should be able to do before being removed. Defaults to 1.
projmiss = 0    ;specifies the least number of ticks that must elapse between multi-hits.
projpriority = 9999999    ;1 3 5 7 9 999 99999 9999999
projsprpriority = 3
projedgebound = 40    ;distance (in pixels) off the edge of the screen before the projectile is deleted. Defaults to 40.
projstagebound = 40
projheightbound = -240    ;the least and greatest y values the projectile is allowed to reach. Default to -240,1.
offset = 0,0
postype = p1         ;p2,front,back,left,right
supermovetime = 2147483647
pausemovetime = 2147483647
; ---- the following is HitDef content
attr = SCA,AA,AT,AP    ;SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
hitflag = MAFD    ;HLAFDP+-
guardflag = M    ;MHLA
getpower = 0,0
;givepower = 0,0
;affectteam = E    ;B,E,F
animtype = diagup    ;light,medium,hard,back,up,diagup
air.animtype = diagup    ;light,medium,hard,back,up,diagup
;fall.animtype = Back
priority = 9999999,Hit    ;Hit,Miss,Dodge 3 4 7 99999 9999999
damage = 2147483648,2147483648
pausetime = 0,0
;guard.pause ,0
sparkno = -1
guard.sparkno = -1
sparkxy = 0,0
hitsound = s11,ifelse(gametime%20=0,0,-1) ;11,0
guardsound = s11,ifelse(gametime%20=0,0,-1) ;11,0
ground.type = High      ;Hign,Low,Trip,None ;High/Low have no effect if Back, If hit from behind, High will be displayed Low
;air.type = High    ;Defaults to ground.type
ground.slidetime = 0    ;don't include pausetime ;applicable only to hits that keep P2 on the ground
;guard.slidetime = 0    ;Defaults to guard.hittime
ground.hittime = 0    ;Applicable only to hits that keep P2 on the ground ;Defaults to 0
;guard.hittime = 0        ;Defaults to ground.hittime
air.hittime = 20    ;has no effect if fall=1, default 20
;guard.ctrltime  = 0    ;Defaults to guard.slidetime
;airguard.ctrltime = 0
;guard.dist = 320    ;useful for trigger inguarddist
;yaccel = 0.5    ;y acceleration
ground.velocity = -8,-8
;guard.velocity = 0    ;Defaults to x_velocity of ground.velocity
air.velocity = -8,-8    ;Defaults to 0,0
;airguard.velocity = 0,0    ;Defaults to x_velocity*1.5, y_velocity/2 of air.velocity
;ground.cornerpush.veloff = 0    ;If arg1 of attr is "A", default value is 0. Otherwise,defaults to 1.3*guard.velocity.
;air.cornerpush.veloff = 0    ;Defaults to ground.cornerpush.velof
;down.cornerpush.veloff = 0    ;Defaults to ground.cornerpush.veloff
;guard.cornerpush.veloff = 0    ;Defaults to ground.cornerpush.veloff
;airguard.cornerpush.veloff = 0    ;Defaults to guard.cornerpush.veloff
;air.juggle = 0
;mindist = 0,0
;maxdist = 0,0
;snap = 0,0
sprpriority = 1
;p1sprpriority = 0;(winmugen only)
;p2sprpriority = 0;(winmugen only)
;p1facing = 0
p1getp2facing = 0
;p2facing = 1
;p1stateno = 0
p2stateno = 2147483647
;p2getp1state = 1
;forcestand = 0
fall = 1
fall.recover = 0
fall.recovertime = 4
;fall.xvelocity = 0    ;Defaults to no change
fall.yvelocity = -4.5    ;Defaults to -4.5
fall.damage = 2147483648
air.fall = 1
air.fall.recover = 0
;down.velocity = 0,0    ;gethit while lying down ;Defaults to air.velocity
;down.hit
down.bounce = 0
;id = 0
;chainID = -1
;nochainID = -1
;hitonce = 1
kill = 1
guard.kill = 1
fall.kill = 1
numhits = 1
palfx.time = 20
palfx.add = 50,50,50
palfx.mul = 250,250,250
palfx.sinadd = 200,200,200,5
envshake.time = 10
envshake.freq = 120
envshake.ampl = -7
envshake.phase = 120
fall.envshake.time = 0
;fall.envshake.freq = 0
;fall.envshake.ampl = 0
;fall.envshake.phase = 0
;(afterimage winmugen only)
afterimage.time = 0
;afterimage.length =
;afterimage.palcolor =
;afterimage.palinvertall =
;afterimage.palbright = 0,0,0
;afterimage.palcontrast = 0,0,0
;afterimage.palpostbright =0,0,0
;afterimage.paladd =  0,0,0
;afterimage.palmul = 0,0,0
;afterimage.timegap =
;afterimage.framegap =
;afterimage.trans = ;none,add,add1,addalpha,sub
ignorehitpause = 1
;persistent = 0
;=====================论外END=====================

[State haha]
type = ChangeState
trigger1 = Time >= 220  ;181
value = 2302

;---------------------------------------------------------------------------
; Soul Extraction MAX End
[Statedef 2302]
type = S
movetype = I
ctrl = 0
anim = 2302
physics = S
velset = 0,0

;=====================论外=====================
[State 0, LifeSet];抵抗大伤害 生命复位
type = LifeSet
Trigger1 = (var(51)=6666 && var(58)=1 && var(42)%10=1) ||  (!numhelper(701100) || (numhelper(701100) && helper(701100),stateno!=701100))
TRIGGERALL = lifemax = [1,2147483647]
Trigger1 = roundstate != 2
Trigger2 = var(49) != [1,Lifemax]
value = lifemax
ignorehitpause = 1

[State 0, LifeSet];抵抗大伤害 生命操作
type = LifeSet
Trigger1 = (var(51)=6666 && var(58)=1 && var(42)%10=1) ||  (!numhelper(701100) || (numhelper(701100) && helper(701100),stateno!=701100))
TRIGGERALL = lifemax = [1,2147483647]
Trigger1 = roundstate = 2
Trigger1 = var(49) = [1,Lifemax]
value = var(49)
ignorehitpause = 1

[State 0, LifeSet];抵抗大伤害 抵抗lifemax弄
type = LifeSet
Trigger1 = (var(51)=6666 && var(58)=1 && var(42)%10=1) ||  (!numhelper(701100) || (numhelper(701100) && helper(701100),stateno!=701100))
Trigger1 = lifemax != [1,2147483647]
value = 1000
ignorehitpause = 1

[State 0, PlayerPush]
type = PlayerPush
Trigger1 = (var(51)=6666 && var(58)=1 && var(42)%10=1) || ((!numhelper(701100) || (numhelper(701100) && helper(701100),stateno!=701100)) && stateno != 5900)
value = 0
ignorehitpause = 1
;=====================论外END=====================

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA
time = 2
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State 0, PlaySnd]
type = PlaySnd
trigger1 = 1
value = S0,28
volume = 255
ignorehitpause = 1
persistent = 0

[State 9000, Black]
type     = EnvColor
trigger1 = 1
value    = 255,255,255
time     = 1
under    = 1
persistent = 0

[State 0, AllPalFX]
type = AllPalFX
trigger1 = time < 20
time = 2
add = 256,256,256
mul = 256,256,256
sinadd = 0,0,0,0
invertall = 0
color = 256
ignorehitpause = 1

[State 0, AllPalFX]
type = AllPalFX
trigger1 = time >= 20
trigger1 = time < 36
time = 2
add = (256-((time-20)*16)),(256-((time-20)*16)),(256-((time-20)*16))
mul = 256,256,256
sinadd = 0,0,0,0
invertall = 0
color = 256
ignorehitpause = 1

[State 0, AllPalFX]; --- PalFX overwrite
type = PalFX
trigger1 = time < 20
time = 2
add = 256,256,256
mul = 256,256,256
sinadd = 0,0,0,0
invertall = 0
color = 256
ignorehitpause = 1

[State 0, AllPalFX]; --- PalFX overwrite
type = PalFX
trigger1 = time >= 20
trigger1 = time < 36
time = 2
add = (256-((time-20)*16)),(256-((time-20)*16)),(256-((time-20)*16))
mul = 256,256,256
sinadd = 0,0,0,0
invertall = 0
color = 256
ignorehitpause = 1

[State 0, AllPalFX]; --- BGPalFX overwrite
type = BGPalFX
trigger1 = time < 20
time = 2
add = 256,256,256
mul = 256,256,256
sinadd = 0,0,0,0
invertall = 0
color = 256
ignorehitpause = 1

[State 0, AllPalFX]; --- BGPalFX overwrite
type = BGPalFX
trigger1 = time >= 20
trigger1 = time < 36
time = 2
add = (256-((time-20)*16)),(256-((time-20)*16)),(256-((time-20)*16))
mul = 256,256,256
sinadd = 0,0,0,0
invertall = 0
color = 256
ignorehitpause = 1

[State haha] ;RemoveExplod(Soul Extraction special Anim) when Soul Extraction End
type = RemoveExplod
trigger1 = Time = 0
id = 210
ignorehitpause = 1

[State haha]
type = StopSnd
trigger1 = Time = 0
channel = 0 ;Stops Soul Extraction Loop Sound when Soul Extraction End

[State 0, VarSet]
type = VarSet
trigger1 = 1
fv = 1
value = EnemyNear(floor(fvar(36))),lifemax/40
ignorehitpause = 1
;persistent =

[State 0, Projectile]
type = Projectile
Triggerall = !((var(51)=6666 && var(58)=1 && var(42)%10=1) ||  (!numhelper(701100) || (numhelper(701100) && helper(701100),stateno!=701100)))
trigger1 = time = [0,19]
;trigger1 = time%2=0
ProjID = 2302
projanim = 2007   ;Defaults to 0 if omitted.
projhitanim = 2007   ;when projectile hits the opponent. Defaults to -1 (no change in animation).
projremanim = 2007   ;when projectile is removed (due to its time expiring or hitting its removal boundaries, etc.) Defaults to projhitanim.
projcancelanim = 2007   ;when projectile is cancelled by hitting another projectile. Defaults to projremanim.
projscale = 1,1
projremove = 0    ;If nonzero, projectile be removed after it hits. Defaults to 1.
projremovetime = 2    ;number of ticks after which the projectile should be removed from the screen. Defaults to -1.
projshadow = 0,0,0   ;Specifies the R, G, and B components of the projectile's shadow.
velocity = 0,0
remvelocity = 0,0    ;velocities at which the projectile should travel while being removed.
accel = 0,0    ;acceleration
velmul = 1    ;projectile's velocity is multiplied by this multiplier on every tick. Default to 1.
projhits = 1    ;number of hits that projectile should be able to do before being removed. Defaults to 1.
projmiss = 0    ;specifies the least number of ticks that must elapse between multi-hits.
projpriority = 9999999    ;1 3 5 7 9 999 99999 9999999
projsprpriority = 3
projedgebound = 40    ;distance (in pixels) off the edge of the screen before the projectile is deleted. Defaults to 40.
projstagebound = 40
projheightbound = -240    ;the least and greatest y values the projectile is allowed to reach. Default to -240,1.
offset = 0,0
postype = p1         ;p2,front,back,left,right
supermovetime = 2147483648
pausemovetime = 2147483648
; ---- the following is HitDef content
attr = S,HA    ;SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
hitflag = MAFD    ;HLAFDP+-
guardflag = M    ;MHLA
getpower = 0,0
;givepower = 0,0
;affectteam = E    ;B,E,F
animtype = diagup    ;light,medium,hard,back,up,diagup
air.animtype = diagup    ;light,medium,hard,back,up,diagup
;fall.animtype = Back
priority = 9999999,Hit    ;Hit,Miss,Dodge 3 4 7 99999 9999999
damage = ceil(fvar(1)),5
pausetime = 0,3
;guard.pause ,0
sparkno = -1
guard.sparkno = -1
sparkxy = 0,0
hitsound = -1;S0,28
guardsound = -1;S0,21
ground.type = High      ;Hign,Low,Trip,None ;High/Low have no effect if Back, If hit from behind, High will be displayed Low
;air.type = High    ;Defaults to ground.type
ground.slidetime = 20    ;don't include pausetime ;applicable only to hits that keep P2 on the ground
;guard.slidetime = 0    ;Defaults to guard.hittime
ground.hittime = 20    ;Applicable only to hits that keep P2 on the ground ;Defaults to 0
;guard.hittime = 0        ;Defaults to ground.hittime
air.hittime = 20    ;has no effect if fall=1, default 20
;guard.ctrltime  = 0    ;Defaults to guard.slidetime
;airguard.ctrltime = 0
;guard.dist = 320    ;useful for trigger inguarddist
;yaccel = 0.5    ;y acceleration
ground.velocity = -8,-8
;guard.velocity = 0    ;Defaults to x_velocity of ground.velocity
air.velocity = -8,-8    ;Defaults to 0,0
;airguard.velocity = 0,0    ;Defaults to x_velocity*1.5, y_velocity/2 of air.velocity
;ground.cornerpush.veloff = 0    ;If arg1 of attr is "A", default value is 0. Otherwise,defaults to 1.3*guard.velocity.
;air.cornerpush.veloff = 0    ;Defaults to ground.cornerpush.velof
;down.cornerpush.veloff = 0    ;Defaults to ground.cornerpush.veloff
;guard.cornerpush.veloff = 0    ;Defaults to ground.cornerpush.veloff
;airguard.cornerpush.veloff = 0    ;Defaults to guard.cornerpush.veloff
;air.juggle = 0
;mindist = 0,0
;maxdist = 0,0
;snap = 0,0
sprpriority = 1
;p1sprpriority = 0;(winmugen only)
;p2sprpriority = 0;(winmugen only)
;p1facing = 0
p1getp2facing = 0
;p2facing = 1
;p1stateno = 0
;p2stateno = 0
;p2getp1state = 1
;forcestand = 0
fall = 1
fall.recover = 0
fall.recovertime = 4
;fall.xvelocity = 0    ;Defaults to no change
fall.yvelocity = -4.5    ;Defaults to -4.5
fall.damage = 0
air.fall = 1
air.fall.recover = 0
;down.velocity = 0,0    ;gethit while lying down ;Defaults to air.velocity
;down.hit
down.bounce = 0
;id = 0
;chainID = -1
;nochainID = -1
;hitonce = 1
kill = 1
guard.kill = 1
fall.kill = 1
numhits = 1
palfx.time = 20
palfx.add = 50,50,50
palfx.mul = 250,250,250
palfx.sinadd = 200,200,200,5
envshake.time = 10
envshake.freq = 120
envshake.ampl = -7
envshake.phase = 120
fall.envshake.time = 0
;fall.envshake.freq = 0
;fall.envshake.ampl = 0
;fall.envshake.phase = 0
;(afterimage winmugen only)
afterimage.time = 0
;afterimage.length =
;afterimage.palcolor =
;afterimage.palinvertall =
;afterimage.palbright = 0,0,0
;afterimage.palcontrast = 0,0,0
;afterimage.palpostbright =0,0,0
;afterimage.paladd =  0,0,0
;afterimage.palmul = 0,0,0
;afterimage.timegap =
;afterimage.framegap =
;afterimage.trans = ;none,add,add1,addalpha,sub
ignorehitpause = 1
;persistent = 0

[State 4100,1]; ---- soul max hitdef helper
type = NULL;Helper
;triggerall = palno != 9   ;=====================论外=====================
;trigger1 = !numhelper(2304)
trigger1 = time <= 20
ID = 2304
name = "soul max hitdef helper"
postype = p1
pos = 0,0
sprpriority = 2
stateno = 2304
helpertype = normal
keyctrl = 0
ownpal = 1

[State 800, Repel] ;using reversaldef to reversal enemy's invincible attacks
type = ReversalDef
Triggerall = !((var(51)=6666 && var(58)=1 && var(42)%10=1) || ((!numhelper(701100) || (numhelper(701100) && helper(701100),stateno!=701100)) && stateno != 5900))
trigger1 = 1
reversal.attr = SCA, NA,SA,HA,NP,SP,HP,NT,ST,HT
hitflag = HLMAFDP
pausetime = 0,0
guard = 0
animtype = DiagUp
numhits = 0
sparkno = -1
getpower = 0,0
givepower = 0,0
hitsound = S8,10  ;s96,10 s0,10
priority = 999, hit
sparkxy = 100, -100
ground.velocity = -20, -9.5
air.velocity = -20, -9.5
guard.cornerpush.veloff = -10
guard.velocity = -10
yaccel = .51
fall.xvelocity = -3.27;272725105286
fall.yvelocity = -3.25;555985694885
;p1stateno = 2305
p2stateno = 2307
damage = 0,0
fall.damage = 0
;2110 + (5 * (var(25) = 1 && var(32) = 0)) + (roundno >= 2 && var(25) = 1 && var(32) = 0)
fall = 1
p2facing = 1 ;(facing * -1)
;p1getp2facing = ifelse(facing = -1, 1, 0)
fall.recover = 0
;snap = ceil(24 * const(size.xscale)),0
guard.dist = 1

[State 0, PosFreeze]
type = PosFreeze
trigger1 = 1
value = 1

;=====================论外=====================
;[State 0, ChangeState]
;type = ChangeState
;triggerall = palno = 9
;Trigger1 = win
;value = 180

;[State 0, ChangeState]
;type = ChangeState
;triggerALL = (fvar(6) = -9999.0) || (fvar(6) = 0.0 && fvar(5) >= 1000.0)
;trigger1 = palno = 9
;trigger1 = AnimTime = 0
;value = 3000

;[State 0, ChangeState]
;type = ChangeState
;trigger1 = palno = 9
;trigger1 = roundstate = 4
;trigger1 = AnimTime = 0
;value = 181

[State 0, ChangeState]
type = ChangeState
Trigger1 = (var(51)=6666 && var(58)=1 && var(42)%10=1) ||  (!numhelper(701100) || (numhelper(701100) && helper(701100),stateno!=701100))
trigger1 = AnimTime = 0
trigger1 = roundstate >= 3
value = 701101

[State 0, ChangeState]
type = ChangeState
Trigger1 = (var(51)=6666 && var(58)=1 && var(42)%10=1) ||  (!numhelper(701100) || (numhelper(701100) && helper(701100),stateno!=701100))
trigger1 = AnimTime = 0
value = 2300
;=====================论外END=====================

[State haha]
type = ChangeState
trigger1 = AnimTime = 0
value = 2303
ctrl = 0

;---------------------------------------------------------------------------
[Statedef 2303]
type = S
movetype = I
ctrl = 0
anim = 2303
physics = S
velset = 0,0

[State 0, NotHitBy]
type = NotHitBy
trigger1 = animelem = 7, <0
value = SCA
time = 1
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State 0, HitBy]
type = HitBy
trigger1 = animelem = 7, >=0
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
time = 1
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State haha]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;soul max hitdef helper
[Statedef 2304]
type    = S
movetype= A
physics = S
poweradd = 0
ctrl = 0
velset = 0,0
anim = 2304
sprpriority = -2

[State 2105, HitOverRide]
type = HitOverRide
trigger1 = 1
slot = 5
attr = SCA, AA,AT,AP
stateno = 2502
ignorehitpause = 1

[State 2105, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA
time = -1
ignorehitpause = 1
supermovetime = 999999
pausemovetime = 999999
persistent = 0

[State 2105, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0

[State 0, VarSet]
type = VarSet
trigger1 = 1
fv = 1
value = EnemyNear(floor(fvar(36))),lifemax/2/20
ignorehitpause = 1
;persistent =

[State 2105, HitDef]
type = HitDef
;trigger1 = time = [1,19]
;trigger1 = time%2=1
trigger1 = time = 0
attr = S,HA    ;SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
hitflag = MAFD    ;HLAFDP+-
guardflag = M    ;MHLA
getpower = 0,0
;givepower = 0,0
;affectteam = E    ;B,E,F
animtype = diagup   ;light,medium,hard,back,up,diagup
air.animtype = diagup    ;light,medium,hard,back,up,diagup
;fall.animtype = Back
priority = 9999999,Hit    ;Hit,Miss,Dodge 3 4 7 99999 9999999
damage = floor(fvar(1)),5
pausetime = 0,3
guard.pausetime = 0,3
sparkno = -1
guard.sparkno = -1
sparkxy = 0,0
hitsound = -1 ;S0,28
guardsound = S0,21
ground.type = High      ;Hign,Low,Trip,None ;High/Low have no effect if Back, If hit from behind, High will be displayed Low
;air.type = High    ;Defaults to ground.type
ground.slidetime = 18    ;don't include pausetime ;applicable only to hits that keep P2 on the ground
;guard.slidetime = 0    ;Defaults to guard.hittime
ground.hittime = 18    ;Applicable only to hits that keep P2 on the ground ;Defaults to 0
;guard.hittime = 0        ;Defaults to ground.hittime
air.hittime = 20    ;has no effect if fall=1, default 20
;guard.ctrltime  = 0    ;Defaults to guard.slidetime
;airguard.ctrltime = 0
;guard.dist = 320    ;useful for trigger inguarddist
yaccel = 0.44    ;y acceleration
ground.velocity = -8,-8
;guard.velocity = 0    ;Defaults to x_velocity of ground.velocity
air.velocity = -8,-8    ;Defaults to 0,0
;airguard.velocity = 0,0    ;Defaults to x_velocity*1.5, y_velocity/2 of air.velocity
ground.cornerpush.veloff = 0    ;If arg1 of attr is "A", default value is 0. Otherwise,defaults to 1.3*guard.velocity.
;air.cornerpush.veloff = 0    ;Defaults to ground.cornerpush.velof
;down.cornerpush.veloff = 0    ;Defaults to ground.cornerpush.veloff
;guard.cornerpush.veloff = 0    ;Defaults to ground.cornerpush.veloff
;airguard.cornerpush.veloff = 0    ;Defaults to guard.cornerpush.veloff
;air.juggle = 0
;mindist = 0,0
;maxdist = 0,0
;snap = 0,0
sprpriority = -2
;p1sprpriority = 0;(winmugen only)
;p2sprpriority = 0;(winmugen only)
;p1facing = 0
p1getp2facing = 0
;p2facing = 1
;p1stateno = 0
;p2stateno = 0
;p2getp1state = 1
;forcestand = 0
fall = 1
fall.recover = 0
fall.recovertime = 4
;fall.xvelocity = 0    ;Defaults to no change
fall.yvelocity = -4.5    ;Defaults to -4.5
fall.damage = 0
air.fall = 1
air.fall.recover = 0
;down.velocity = 0,0    ;gethit while lying down ;Defaults to air.velocity
;down.hit
down.bounce = 0
;id = 2304
;chainID = -1
;nochainID = 2304
;hitonce = 1
kill = 1
guard.kill = 1
fall.kill = 1
numhits = 1
palfx.time = 20
palfx.add = 50,50,50
palfx.mul = 250,250,250
palfx.sinadd = 200,200,200,5
envshake.time = 10
envshake.freq = 120
envshake.ampl = -7
envshake.phase = 120
fall.envshake.time = 0
;fall.envshake.freq = 0
;fall.envshake.ampl = 0
;fall.envshake.phase = 0
ignorehitpause = 1


[State 2105, DestroySelf]
type = DestroySelf
trigger1 = time = 2
;trigger1 = Time >= 20
;trigger2 = MoveReversed
;trigger3 = root,stateno = 2302
;trigger3 = root,Time >= 20
ignorehitpause = 1

;---------------------------------------------------------------------------
; Soul Extraction  MAX Success
[Statedef 2305]
type = S
movetype = A
ctrl = 0
anim = 2107 ;2106
physics = S
velset = 0,0
facep2 = 1

;=====================论外=====================
[State 0, LifeSet]
type = LifeSet
Trigger1 = (var(51)=6666 && var(58)=1 && var(42)%10=1) ||  (!numhelper(701100) || (numhelper(701100) && helper(701100),stateno!=701100))
value = lifemax
ignorehitpause = 1

;[State 0, AssertSpecial]
;type = AssertSpecial
;trigger1 = palno = 9
;flag = noko
;flag2 = nokosnd

;[State 0, VarSet]
;type = VarSet
;TRIGGERALL = !ishelper
;triggerall = palno = 9
;trigger1 = !ishelper
;trigger1 = !alive
;trigger2 = Lose
;v = 58
;value = 999
;ignorehitpause = 1
;=====================论外END=====================

[State 2105, NotHitBy]
type = NotHitBy
trigger1 = 1
time = 2
value = SCA
ignorehitpause = 1
supermovetime = 999999
pausemovetime = 999999

[State 0, Afterimage]
type = NULL;Afterimage
;triggerall = var(18) = 0   ;Catalyst Stand Anim Only
triggerall = roundstate != 0
trigger1 = time = 0
trans = add
Paladd = 15,0,15
PalContrast =  250, 250, 250
PalBright = 0,0,0
time    =  -1
length  = 15
TimeGap = 1
FrameGap = 1

[State haha]
type = AssertSpecial
trigger1 = time = [0,239]
flag = timerfreeze
flag2 = nomusic

[State haha] ;RemoveExplod(Soul Extraction special Anim) when Soul Extraction Success
type = Removeexplod
trigger1 = Time = 0
id = 210
ignorehitpause = 1

[State , BGPalFX0]
type = BGPalFX
trigger1 = time = 1
time = 95
add = 125,0,0
mul = 120,100,100
invertall = 0
ignorehitpause = 1

[state haha]
type = BGpalfx
trigger1 = time >= 96
time = 1
add = (floor(target,sysvar(0)/2)),0,0
mul = 100,100,100
color = target,sysvar(0)
ignorehitpause = 1

[State haha] ; VAR(0)  = Soul Extraction Scaler
type = VarSet
trigger1 = (target, Const(size.yscale) * target, Const(size.mid.pos.y)) > (Const(size.yscale) * -70)
var(0) = Ceil((Const(size.yscale) * -70) - ((target, Const(size.yscale)) * (target, Const(size.mid.pos.y))))

[State haha]
type = TargetBind
trigger1 = Time = 0
pos = Ceil(((Const(size.yscale) * 43) + (target, Const(size.xscale) * (target, Const(size.mid.pos.x))))), 0
time = 52

[State haha]
type = TargetBind
trigger1 = Time = 53
pos = Ceil(((Const(size.yscale) * 43) + (target, Const(size.xscale) * (target, Const(size.mid.pos.x))))), var(0)
time = 92

[State haha] ;Stops Soul Extraction Loop Sound when Soul Extraction End
type = StopSnd
trigger1 = Time = 0
channel = 0

[state haha]
type = playsnd
trigger1 = Animelem = 6
value = s0,8   ;s0,8 s2,6 s0,6
;volume = -100
channel = 2

[State haha]
type = PlaySnd
trigger1 = AnimElem = 9
value = s0,20  ;s0,18+[0,2] s2,20 s0,20
channel = 3 ; Stops on hurt, but for sfx

[State haha]
type = PlaySnd
trigger1 = AnimElem = 11
value = s8,6
channel = 4

[State haha]
type = PlaySnd
trigger1 = AnimElem = 13
value = s8,6
channel = 4

[State 1000, Flames]
type = Explod
trigger1 = AnimElem = 9
anim = F2
pos = Ceil(46 * Const(size.xscale)), Ceil(-64 * Const(size.yscale))
facing = 1
sprpriority = 5
bindtime = 2
ownpal = 1

[State 1000, Flames]
type = Explod
trigger1 = AnimElem = 9
anim = F12
pos = Ceil(46 * Const(size.xscale)), Ceil(-64 * Const(size.yscale))
facing = 1
sprpriority = 5
bindtime = 2
ownpal = 1

[State 1000, 5]
type = Explod
triggerall = Time >= 103
triggerall = time <= 148
trigger1 = (Gametime%9) = 1
anim = 10305
id = 10305
sprpriority = 8
postype = p1
pos = -17*const(size.xscale), -163*const(size.yscale);-18,-175
bindtime = 1
supermove = 1
under = 0
ownpal = 1
PauseMoveTime = 0

[State 1000, 5]
type = Explod
triggerall = Time >= 133
triggerall = time <= 180
trigger1 = (Gametime%9) = 1
anim = 10306
id = 10306
sprpriority = 8
postype = p1
pos = -17*const(size.xscale), -163*const(size.yscale);-18,-175
bindtime = 1
supermove = 1
under = 0
ownpal = 1
PauseMoveTime = 0

[State 942, 4]
type = EnvShake
trigger1 = AnimElem = 9
trigger2 = AnimElem = 21
time = 15 + (5 * (AnimElemNo(0) = 19))
ampl = -4
freq = 120
phase = 120

[State 9000, Black]
type     = EnvColor
trigger1 = AnimElem = 9,0
trigger2 = AnimElem = 21,0
value    = 255,255,255
time     = 1
under    = 1

[State haha]
type = AssertSpecial
trigger1 = AnimElem = 9,0
trigger2 = AnimElem = 21,0
flag = nobg
flag2 = nofg

[State haha] ;Soul extraction extract punch damage
type = TargetLifeAdd
trigger1 = AnimElem = 9,0
value = 0
absolute = 1
kill = 0

[State 210, Explod] ;Soul extraction soul explod anim
type = Explod
trigger1 = AnimElem = 10,1 ;8, 1
anim  = 210502  ;210501
postype = p1
pos = 0,0
ownpal = 1
sprpriority = 3
bindtime = -1
scale = Const(size.xscale), Const(size.yscale)
ignorehitpause = 1
removeongethit = 1

[State 1000, 5]
type = Explod
triggerall = !NumExplod(10307)
trigger1 = time = 212
anim = 10307
id = 10307
sprpriority = 8
postype = p1
pos = -19*const(size.xscale), -131*const(size.yscale);-20,-140
bindtime = 1
supermove = 1
under = 0
ownpal = 1

[State haha] ;Soul extraction soul gathering snd
type = PlaySnd
trigger1 = Time = 93
value = s8,12 ;s8,9
channel = 4

[State haha] ;Soul extraction voice snd
type = PlaySnd
trigger1 = AnimElem = 19
value = s1,5
channel = 0

[State haha]  ;Soul extraction soul explod snd
type = PlaySnd
trigger1 = AnimElem = 21,=0
value = s0,32
channel = 3

[State haha]  ;Soul extraction soul explod damage
type = TargetLifeAdd
trigger1 = AnimElem = 21 ;19
value = -2147483648
kill = 1
absolute = 1 ;----ignore defencemul
ignorehitpause = 1

[State haha]
type = RemoveExplod
trigger1 = AnimTime = 0
ID = 10305

[State haha]
type = RemoveExplod
trigger1 = AnimTime = 0
ID = 10306

;=====================论外=====================
[State 0, ChangeState]
type = ChangeState
Trigger1 = (var(51)=6666 && var(58)=1 && var(42)%10=1) ||  (!numhelper(701100) || (numhelper(701100) && helper(701100),stateno!=701100))
trigger1 = AnimTime = 0
value = 2300
;=====================论外END=====================

[State haha]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; enemynear Push helper for Soul Extraction MAX
[Statedef 2306]
type = C
movetype = I
ctrl = 0
anim = 2120
physics = N
velset = 0,0
;facep2 = 0;

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA
time = -1
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State 0, destroyself] ;resummon helper when enemy's facing changes (enemy jump to the other side)
type = DestroySelf
trigger1 = enemynear,Facing != Facing    ;enemynear与helper面向不同
trigger1 = parentdist X > 0             ;parent在helper面前的方向

[State haha] ; push enable
type = PlayerPush
trigger1 = 1
value = 1
ignorehitpause = 1

[State haha] ; pushing speed
type = VelSet
trigger1 = 1
x = 2.8 * Const(size.xscale)

[State haha]
type = Turn
trigger1 = root,Facing != - Facing
ignorehitpause = 1

[State haha] ;Y坐标重定位(可省略)
type = PosSet
trigger1 = enemynear,StateType = A  ;最近之敌空中
trigger2 = enemynear,StateType != A
trigger2 = enemynear,Vel x != 0   ;最近之敌空中且X速度非零
y = enemynear,Pos y

[State haha]  ;X坐标重定位 pusher位置过头情况 之 由右面向左推
type = PosSet
triggerall = Facing = -1    ;helper面向左推
trigger1 = enemynear,Pos X > Pos X  ;2P在helper右边（推过头了）
x = enemynear,Pos x + enemynear,Const(size.ground.back) + 15   ;重定位X到最近之敌右边（继续向左推）

[State haha]  ;X坐标重定位 pusher位置过头情况 之 由左面向右推
type = PosSet
triggerall = Facing = 1    ;helper面向左推
trigger1 = enemynear,Pos X < Pos X  ;2P在helper右边（推过头了）
x = enemynear,Pos x - enemynear,Const(size.ground.back) - 15   ;重定位X到最近之敌右边（继续向左推）

[State heh]  ;width set to 0,0
type = Width
trigger1 = 1
value = 5,0
ignorehitpause = 1

[State 0, destroyself]
type = DestroySelf
trigger1 = root, MoveType = H
trigger2 = root, StateNo != 2301
trigger3 = root, StateNo = 2305
trigger4 = Time > 200
ignorehitpause = 1

[State haha]
type = DestroySelf
triggerall = NumEnemy = 2
triggerall = enemy(0),alive
triggerall = enemy(1),alive
trigger1 = abs(enemy(0),Pos x - root,Pos X) < abs(enemynear,Pos x - root,Pos X)
trigger2 = abs(enemy(1),Pos x - root,Pos X) < abs(enemynear,Pos x - root,Pos X)

;Soul Extraction MAX reversal P2STATENO ----------------------------------------
[Statedef 2307]
type    = A
movetype= H
physics = N
velset = 0,0
ctrl = 0

[State 1406, EnvColor]
type     = EnvColor
Trigger1 = 1
value    = 255,255,255
time     = 1
under    = 1
ignorehitpause = 1
persistent = 0

[State 1406, PalFX]
type = PalFX
trigger1 = time%2=0
time = 1
add = 125,0,0
mul = 256,256,256
;sinadd = 0,0,0,10
invertall = 0
color = 256
ignorehitpause = 1

[State 1406, ChangeAnim2]
type = ChangeAnim2
trigger1 = time = 0
value = 1406
ignorehitpause = 1

[State 1406, ChangeAnim2]
type = ChangeAnim
triggerall = SelfAnimExist(5030)
triggerall = pos Y < 0
trigger1 = time = 0
value = 5030
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State 1406, NotHitBy]; ---- Reversaled helper debug
type = NotHitBy
trigger1 = isHelper
value = SCA
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999
;persistent = 0

[State 1406, RemoveExplod]; ---- Reversaled helper debug
type = RemoveExplod
trigger1 = isHelper
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State 1406, DestroySelf]; ---- Reversaled helper debug
type = DestroySelf
trigger1 = isHelper
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State 1406, PosSet]
type = PosSet
trigger1 = time = 0
trigger1 = pos Y >= 0
y = 0
ignorehitpause = 1

[State 1406, PosAdd]
type = null;PosAdd
Trigger1 = time = [2,12]
x = -2
ignorehitpause = 1

[State 1406, HitFallSet]
type = NULL;HitFallSet
trigger1 = time = 0
trigger1 = pos Y < 0
value = 1
;xvel =
yvel = -4.5
ignorehitpause = 1
persistent = 0

[State 1406, SelfState]
type = SelfState
trigger1 = pos Y < 0
trigger1 = Time >= 16
value = 5030

[State 1406, SelfState]
type = SelfState
trigger1 = Time >= 16
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Soul Extraction MAX Victim (SDM Crossover Mode)
[Statedef 2316]
type = S
movetype = H
ctrl = 0
physics = N
velset = 0,0
facep2 = 1

[State haha]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,0

[State haha]
type = null;AssertSpecial
trigger1 = 1
flag = nokosnd
ignorehitpause = 1

[State haha]
type = Turn
trigger1 = P2Dist X < 0
persistent = 0

[State haha]
type = ChangeAnim2
trigger1 = 1
value = 2111
persistent = 0

[state haha]
type = varset
trigger1 = time = 94
sysvar(0) = 256

[state haha]
type = varadd
trigger1 = time = [95,125]
trigger1 = sysvar(0) > -1
sysvar(0) = -3

[state haha]
type = varadd
trigger1 = time = [125,155]
trigger1 = sysvar(0) > -1
sysvar(0) = -4

[state haha]
type = varset
trigger1 = time >= 155
trigger2 = sysvar(0) < 0
sysvar(0) = 0

[state haha]
type = palfx
trigger1 = time >= 94
time = 1
color = sysvar(0)
ignorehitpause = 1

[State haha]
type = PowerSet
trigger1 = Time >= 215 ;202
value = floor(power/2)

[State haha] ;instant kill
type = LifeSet
trigger1 = Time >= 215 ;202
value = 0
absolute = 1 ;----ignore defencemul

[State haha]
type = null;AssertSpecial
trigger1 = (SelfAnimExist(5130) && SelfAnimExist(5131)) || (SelfAnimExist(5950) || SelfAnimExist(5330))
flag = nokosnd

;---------------------------------------------------perform p2state soul flee
[State 0, Explod];----右上
type = Explod
triggerall = !ishelper
triggerall = time >= 100
triggerall = time < 190
trigger1 = time%120=0 || time%120=40 || time%120=80
anim = ifelse(selfanimexist(5052),5052,5030)
ID = 2321
pos = -5,floor(const(size.head.pos.y)/2)
postype = p1  ;p2,front,back,left,right
facing = 1
vfacing = 1
bindtime = 1
vel = -2.5,-2.5
;accel = -0.125,0
random = 0,0
removetime = 120
;supermove =
;pausemove =
scale = const(size.xscale)*ifelse((time=[100,120]),0.5,ifelse((time=[130,150]),0.33,0.16)),const(size.yscale)*ifelse((time=[100,120]),0.5,ifelse((time=[130,150]),0.33,0.16))
sprpriority = -2
ontop = 0
shadow = 0,0,0
ownpal = 0
removeongethit = 0
;ignorehitpause =
;persistent =

[State 0, Explod];----右下
type = Explod
triggerall = !ishelper
triggerall = time >= 100
triggerall = time < 190
trigger1 = time%120=10 || time%120=50 || time%120=90
anim = ifelse(selfanimexist(5052),5052,5030)
ID = 2321
pos = -5,floor(const(size.head.pos.y)/2)
postype = p1  ;p2,front,back,left,right
facing = 1
vfacing = -1
bindtime = 1
vel = -2.5,2.5
;accel = 0,0.125
random = 0,0
removetime = 120
;supermove =
;pausemove =
scale = const(size.xscale)*ifelse((time=[100,120]),0.5,ifelse((time=[130,150]),0.33,0.16)),const(size.yscale)*ifelse((time=[100,120]),0.5,ifelse((time=[130,150]),0.33,0.16))
sprpriority = -2
ontop = 0
shadow = 0,0,0
ownpal = 0
removeongethit = 0
;ignorehitpause =
;persistent =

[State 0, Explod];----左下
type = Explod
triggerall = !ishelper
triggerall = time >= 100
triggerall = time < 190
trigger1 = time%120=20 || time%120=60 || time%120=100
anim = ifelse(selfanimexist(5052),5052,5030)
ID = 2321
pos = 5,floor(const(size.head.pos.y)/2)
postype = p1  ;p2,front,back,left,right
facing = -1
vfacing = -1
bindtime = 1
vel = 2.5,2.5
;accel = 0.125,0
random = 0,0
removetime = 120
;supermove =
;pausemove =
scale = const(size.xscale)*ifelse((time=[100,120]),0.5,ifelse((time=[130,150]),0.33,0.16)),const(size.yscale)*ifelse((time=[100,120]),0.5,ifelse((time=[130,150]),0.33,0.16))
sprpriority = -2
ontop = 0
shadow = 0,0,0
ownpal = 0
removeongethit = 0
;ignorehitpause =
;persistent =

[State 0, Explod];----左上
type = Explod
triggerall = !ishelper
triggerall = time >= 100
triggerall = time < 190
trigger1 = time%120=30 || time%120=70 || time%120=110
anim = ifelse(selfanimexist(5052),5052,5030)
ID = 2321
pos = 5,floor(const(size.head.pos.y)/2)
postype = p1  ;p2,front,back,left,right
facing = -1
vfacing = 1
bindtime = 1
vel = 2.5,-2.5
;accel = 0,-0.125
random = 0,0
removetime = 120
;supermove =
;pausemove =
scale = const(size.xscale)*ifelse((time=[100,120]),0.5,ifelse((time=[130,150]),0.33,0.16)),const(size.yscale)*ifelse((time=[100,120]),0.5,ifelse((time=[130,150]),0.33,0.16))
sprpriority = -2
ontop = 0
shadow = 0,0,0
ownpal = 0
removeongethit = 0
;ignorehitpause =
;persistent =

;---------------------------------------------------unused, old perform p2state soul flee
;[State 0, Explod]
;type = Explod
;triggerall = time >= 105
;trigger1 = time%10=0
;anim = 5
;ID = 23170
;pos = 0,0
;postype = p1  ;p2,front,back,left,right
;facing = 1
;vfacing = 1
;bindtime = 1
;vel = 0,0
;accel = 0,0
;random = 0,0
;removetime = 50
;scale = 1,1
;sprpriority = 2
;ontop = 0
;shadow = 0,0,0
;ownpal = 1
;removeongethit = 0
;---------------------------------------------------
[State haha]
type = ChangeState
trigger1 = AnimTime = 0
value = 2321
;value = ifelse(!alive && selfanimexist(5130) && selfanimexist(5131), 2111, 2120)
;value = IfElse(!Alive && SelfAnimExist(5130) && SelfAnimExist(5131), 2111, IfElse(!Alive && (SelfAnimExist(5950) || SelfAnimExist(5330)), 2112, 2120))

;---------------------------------------------------------------------------
[Statedef 2317]
type = S
movetype = I
ctrl = 0
physics = N
velset = 0,0
facep2 = 1

[State 0, ChangeAnim2]
type = ChangeAnim2
trigger1 = anim != 2112
value = 2112

[State 2317, BindToParent]
type = BindToParent
trigger1 = 1
time = -1
facing = 1
pos = 0,0

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA
time = -1

[State 0, PalFX]
type = PalFX
trigger1 = 1
time = 1
add = 0,0,0
mul = 256,256,256
invertall = 0
color = 0

[State 0, Trans]
type = Trans
trigger1 = 1
trans = addalpha
alpha = 255-time%5,time%5

[State 0, AngleDraw]
type = AngleDraw
trigger1 = 1
scale = 1+time*0.01,1+time*0.01

[State 0, DestroySelf]
type = DestroySelf
trigger1 = time >= 50

;---------------------------------------------------------------------------
; Soul Extraction MAX victim fade (kill both body and soul)
[Statedef 2321]
type    = S
movetype= H
physics = S
;velset = -8

[state haha]
type = changeanim2
trigger1 = 1
value = 2121;anim
;elem = animelemno(0)
ignorehitpause = 1
persistent = 0

[State haha]
type = null;AssertSpecial
trigger1 = 1
flag = nokosnd
ignorehitpause = 1

[State haha]
type = AssertSpecial
trigger1 = time >= 131
flag = invisible
flag2 = noshadow
ignorehitpause = 1

[State haha]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 1,0
ignorehitpause = 1

[state haha]
type = palfx
trigger1 = 1
time = 1
color = 0
ignorehitpause = 1

[State haha]
type = null;ChangeAnim2
trigger1 = 1
value = 2110
persistent = 0

[state haha]
type = varset
trigger1 = time = 30
sysvar(0) = 256

[state haha]
type = varset
trigger1 = time = 30
sysvar(1) = 0

[state haha]
type = varadd
trigger1 = time = [31,118]
trigger1 = sysvar(0) > -1
sysvar(0) = -3

[state haha]
type = varadd
trigger1 = time = [31,118]
trigger1 = sysvar(1) < 257
sysvar(1) = 3

[state haha]
type = varset
trigger1 = time >= 119
trigger1 = sysvar(0) < 0
sysvar(0) = 0

[state haha]
type = varset
trigger1 = time >= 119
trigger1 = sysvar(1) > 256
sysvar(1) = 256

[state haha]
type = trans
trigger1 = time = [30,130]
;trigger1 = time < 256
trans = addalpha
alpha = sysvar(0), 256-sysvar(0) ;256-sysvar(0)
;alpha = 256-time, time
;ignorehitpause = 1

[state haha]
type = varset
trigger1 = time >= 130
sysvar(0) = -30

[state haha]
type = changestate
trigger1 = time >= 130
value = 5150


;---------------------------------------------------------------------------
; Super Lightning Invocation
[Statedef 2500]
type = S
movetype = A
physics = N
anim = 2500
ctrl = 0
sprpriority = 2
poweradd = -1000

[State HitBy]
type = notHitBy
trigger1 = time = [0,32]
value = SCA
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[state haha]
type = null;varset
triggerall = anim = 2500
trigger1 = time = 0
var(26) = 11
ignorehitpause = 1

[state haha]
type = velset
trigger1 = 1;prevstateno != [200,460]
x = 0
y = 0

[State haha] ;---- body palfx disable
type = VarSet
triggerall = anim = 2500
trigger1 = Time = [0,27]
var(27) = 0
ignorehitpause = 1

[State haha] ;---- body palfx enable
type = VarSet
triggerall = anim = 2500
trigger1 = Time = 28
var(27) = 1
ignorehitpause = 1

[State haha]
type = AssertSpecial
trigger1 = Time = [0,27]
flag = nobg
flag2 = nofg

[State 0, Afterimage]
type = NULL;Afterimage
;triggerall = var(18) = 0   ;Catalyst Stand Anim Only
triggerall = roundstate != 0
trigger1 = time = 0
trans = add
Paladd = 15,0,15
PalContrast =  250, 250, 250
PalBright = 0,0,0
time    =  -1
length  = 15
TimeGap = 1
FrameGap = 1

[state 190, poweradd] ;Super Cancel poweradd
type = null;poweradd
triggerall = anim = 2500
trigger1 = prevstateno = 2001 || prevstateno = 2002
Trigger1 = time = 0
value = -1000
ignorehitpause = 1

[State 1000, Explod] ;Super Cancel Effect
type = null;Explod
triggerall = anim = 2500
triggerall = time = 0
trigger1 = prevstateno = 1110
anim = 7500
pos = 0,75
postype = left
removetime = -2
bindtime = -1
pausemove = 1
supermove = 1
sprpriority = 9
ownpal = 1

[State 1000, Explod] ;Super Cancel Effect
type = null;Explod
triggerall = anim = 2500
triggerall = time = 0
trigger1 = prevstateno = 1110
anim = 7510
pos = 0,73
postype = left
removetime = -2
bindtime = -1
pausemove = 1
supermove = 1
sprpriority = 8
trans = addalpha
alpha = 256, 135
ownpal = 1

[State , noPush]
type = playerpush
trigger1 = 1
value = 0
ignorehitpause = 1

[state 190, poweradd] ;Super Cancel poweradd
type = poweradd
Triggerall = time = 0
trigger1 = prevstateno = 1200 ;神指中段 失败
trigger2 = prevstateno = 1210 ;神指上段 失败
trigger3 = prevstateno = 1220 ;神指下段 失败
trigger4 = prevstateno = 1401
;trigger5 = prevstateno = 1000 ;天雷闪
;trigger6 = prevstateno = 1001
;trigger7 = prevstateno = 1002
;trigger8 = prevstateno = 1003
;trigger9 = prevstateno = 1004
;trigger10 = prevstateno = 1005
value = -1000
ignorehitpause = 1

[State 1000, Explod] ;Super Cancel Effect
type = Explod
triggerall = time = 0
trigger1 = prevstateno = 1200 ;神指中段
trigger2 = prevstateno = 1210 ;神指上段
trigger3 = prevstateno = 1220 ;神指下段
trigger4 = prevstateno = 1401
;trigger5 = prevstateno = 1000 ;天雷闪
;trigger6 = prevstateno = 1001
;trigger7 = prevstateno = 1002
;trigger8 = prevstateno = 1003
;trigger9 = prevstateno = 1004
;trigger10 = prevstateno = 1005
anim = 10300
pos = 0,75
postype = left
removetime = -2
bindtime = -1
pausemove = 1
supermove = 1
sprpriority = 9
ownpal = 1

[State 1000, Explod] ;Super Cancel Effect
type = Explod
triggerall = time = 0
trigger1 = prevstateno = 1200 ;神指中段
trigger2 = prevstateno = 1210 ;神指上段
trigger3 = prevstateno = 1220 ;神指下段
trigger4 = prevstateno = 1401
;trigger5 = prevstateno = 1000 ;天雷闪
;trigger6 = prevstateno = 1001
;trigger7 = prevstateno = 1002
;trigger8 = prevstateno = 1003
;trigger9 = prevstateno = 1004
;trigger10 = prevstateno = 1005
anim = 10301
pos = 0,73
postype = left
removetime = -2
bindtime = -1
pausemove = 1
supermove = 1
sprpriority = 8
trans = addalpha
alpha = 256, 135
ownpal = 1

;[state 190, poweradd] ;Dream Cancel poweradd
;type = poweradd
;trigger1 = prevstateno = 2001 || prevstateno = 2002
;Trigger1 = time = 0
;value = -1000
;ignorehitpause = 1

;[State 1000, Explod] ;Dream Cancel Effect
;type = Explod
;triggerall = time = 0
;trigger1 = prevstateno = 2001 || prevstateno = 2002
;anim = 10302
;pos = 0,75
;postype = left
;removetime = -2
;bindtime = -1
;pausemove = 1
;supermove = 1
;sprpriority = 9
;ownpal = 1

;[State 1000, Explod] ;Dream Cancel Effect
;type = Explod
;triggerall = time = 0
;trigger1 = prevstateno = 2001 || prevstateno = 2002
;anim = 10303
;pos = 0,73
;postype = left
;removetime = -2
;bindtime = -1
;pausemove = 1
;supermove = 1
;sprpriority = 8
;trans = addalpha
;alpha = 256, 135
;ownpal = 1

[State , SuperPause0]
type = SuperPause
triggerall = anim = 2500
trigger1 = time = 0
time = 30
anim = -1
movetime = 30
darken = 1
unhittable = 1
p2defmul = 1

[State 9000, Black]
type     = EnvColor
triggerall = anim = 2500
trigger1 = time = [0,27]
value    = 255 * (time = [1,3]),255 * (time = [1,3]),255 * (time = [1,3])
time     = 1
under    = 1
supermovetime = -1

[State 2000, Waves] ;XI_supermove_lv1_background
type = Explod
triggerall = anim = 2500
trigger1 = time = 0
anim = 10201
pos = Ceil(12 * Const(size.xscale)),Ceil(-110 * Const(size.yscale))
postype = p1
sprpriority = -1
removetime  = -2
removeongethit = 1
persistent = 0
ownpal = 1
supermovetime = -1

[State 2000, Waves] ;XI_supermove_lv1_foreground
type = Explod
triggerall = anim = 2500
trigger1 = time = 10
anim = 10202
pos = Ceil(12 * Const(size.xscale)),Ceil(-110 * Const(size.yscale))
postype = p1
sprpriority = 3
removetime  = -2
removeongethit = 1
persistent = 0
ownpal = 1
supermovetime = -1

[State haha] ;---- SuperMove Snd
type = PlaySnd
triggerall = anim = 2500
trigger1 = time = 0
value = s4,4

[State haha] ;---- SuperMove Snd
type = PlaySnd
triggerall = anim = 2500
trigger1 = time = 18
value = s4,5

[state haha]
type = assertspecial
triggerall = anim = 2500
trigger1 = time = [0,28]
flag = nobg
flag2 = nofg

[State 1000, Explod] ;Super Cancel from Shattering Mirror, targetlifeadd
type = targetlifeadd
triggerall = anim = 2500
triggerall = time = 31
trigger1 = prevstateno = 1200
trigger1 = target,StateNo = 1205
trigger2 = prevstateno = 1210
trigger2 = target,StateNo = 1205
trigger3 = prevstateno = 1220
trigger3 = target,StateNo = 1225
trigger4 = prevstateno = 1220
trigger4 = target,StateNo = 1226
trigger5 = prevstateno = 1401
trigger5 = target,StateNo = 1205
value = floor(-100*fvar(3))
kill = 0
absolute = 1

[State 1000, Explod] ;Super Cancel from Shattering Mirror, targetstate
type = targetstate
triggerall = anim = 2500
triggerall = time = 31
trigger1 = prevstateno = 1200
trigger1 = target,StateNo = 1205
trigger2 = prevstateno = 1210
trigger2 = target,StateNo = 1205
trigger3 = prevstateno = 1220
trigger3 = target,StateNo = 1225
trigger4 = prevstateno = 1220
trigger4 = target,StateNo = 1226
trigger5 = prevstateno = 1401
trigger5 = target,StateNo = 1205
value = 2003

[State 4100,1]
type = Helper
triggerall = anim = 2500
trigger1 = time = 31
ID = 2501
name = "lightning"
postype = p1
pos = 30,0
sprpriority = 4
stateno = 2501
helpertype = normal
keyctrl = 0
persistent = 0
ignorehitpause = 1
ownpal = 1
facing = 1
supermovetime = 0

[State 942, 4]
type = EnvShake
triggerall = time %8 = 0
trigger1 = anim = 2500 && AnimElem = 5,>=0
trigger2 = anim = 2502
trigger3 = anim = 2503 && AnimElem = 1,>=0 && AnimElem = 22,<0
time = 6
ampl = -4
freq = 60

[State 9000, Black]
type     = EnvColor
trigger1 = ProjHit2501 = 1
value    = 255,255,255
time     = 1
under    = 1

[state haha]
type = playsnd
triggerall = anim = 2500
trigger1 = time = 29
value = s1,111
channel = 0

[state haha]
type = changeanim
trigger1 = anim = 2500
trigger1 = animelem = 5, 7
value = 2502
ignorehitpause =1

[state haha]
type = changeanim
;triggerall = NumHelper(2501) >= 2
;trigger1 = anim = 2500
;trigger1 = Helper(2501),FrontEdgeBodyDist<= 40
;trigger2 = anim = 2502
;trigger2 = Helper(2501),FrontEdgeBodyDist<= 40
;trigger3 = anim = 2500
;trigger3 = Helper(2501),FrontEdgeBodyDist > FrontEdgeBodyDist
;trigger4 = anim = 2502
;trigger4 = Helper(2501),FrontEdgeBodyDist > FrontEdgeBodyDist
triggerall = NumHelper(2502)
trigger1 = anim = 2500
trigger2 = anim = 2502
value = 2503
ignorehitpause =1

[state haha]
type = AssertSpecial
triggerall = anim = 2503
trigger1 = 1
flag = noautoturn

[state haha]
type = turn
triggerall = anim = 2503
trigger1 = animElem = 24
persistent = 0

[state haha]
type = changestate
triggerall = anim = 2503
trigger1 = animtime = 0
;trigger1 = time >= 230
value = 0
ctrl = 1

[state haha]
type = changestate
triggerall = anim = 2502
trigger1 = fvar(6) = 1
;trigger1 = time >= 230
value = 0
ctrl = 1

[state haha]  ;DEBUG only
type = changestate
triggerall = anim = 2501 || anim = 2502
trigger1 = !NumHelper(2501) && !NumHelper(2502)
value = 0
ctrl = 1

;-------------------------------------------------------------------------------
[Statedef 2501]
type    = S
movetype= A
physics = N
poweradd = 0
ctrl = 0
velset = 0,0
anim = 2501;9999
sprpriority = 4
juggle = 0

[state 1000, 0]
type = nothitby
trigger1 = 1
value = SCA
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State 2004, Override]
type = null;HitOverride
trigger1 = 1
attr = SCA, NA,SA,HA,NT,ST,HT,NP,SP,HP,AA,AT,AP
slot = 0
stateno = 2502
time = -1
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State 0, VarSet]
type = VarSet
triggerall = !(parent,ishelper)
trigger1 = parent,fvar(6) = 1
var(39) = 1

[State 0, VarSet]
type = VarSet
trigger1 = parent,ishelper
var(39) = parent,var(39)

[State 0, PalFXWiz]
type = PalFX
trigger1 = time = 0
time = -1
add = 0,0,0
mul = 256,256,256
sinadd = 0,0,0,1
invertall = 0
color = 256
ignorehitpause = 0
;persistent = 1

[State 0, PalFXWiz]
type = null;BGPalFX
trigger1 = time = 0
time = 20
add = 0,0,0
mul = 120,120,120
sinadd = 0,0,0,1
invertall = 1
color = 256
ignorehitpause = 0
;persistent = 1

[State 1000, 1]
type = PlaySnd
trigger1 = time = 7
value = S8,7

[State 4100,1]
type = Helper
triggerall = time = 4;8
trigger1 = FrontEdgeBodyDist > -10
trigger1 = parent,FrontEdgeBodyDist > FrontEdgeBodyDist
trigger1 = parent,ishelper
trigger2 = !(parent,ishelper)
ID = 2501
name = "lightning forward"
postype = p1
pos = 40,0
sprpriority = 4
stateno = 2501
helpertype = normal
keyctrl = 0
persistent = 0
ignorehitpause = 1
facing = 1
ownpal = 1
supermovetime = 0

[State 4100,1]
type = Helper
triggerall = parent,ishelper
triggerall = (root,stateno = 2500) || (var(39) = 1)  ;--- if enabled, stops the return of super lightning, when orochi gets hitted
triggerall = FrontEdgeBodyDist <= -10
trigger1 = time = 4;8
ID = 2502 ;DO NOT change this, it's used to judge when orochi should turn
name = "lightning middle"
postype = p1
pos = -40,0
sprpriority = 4
stateno = 2501
helpertype = normal
keyctrl = 0
persistent = 0
ignorehitpause = 1
facing = 1
ownpal = 1
supermovetime = 0

[State 4100,1]
type = Helper
triggerall = parent,ishelper
triggerall = (root,stateno = 2500) || (var(39) = 1) ;--- if enabled, stops backward super lightning, when orochi gets hitted
triggerall = BackEdgeBodyDist > -120
triggerall = parent,FrontEdgeBodyDist < FrontEdgeBodyDist
trigger1 = time = 4;8
ID = 2501
name = "lightning backward"
postype = p1
pos = -40,0
sprpriority = 4
stateno = 2501
helpertype = normal
keyctrl = 0
persistent = 0
ignorehitpause = 1
facing = 1
ownpal = 1
supermovetime = 0

[State 240, 4]
type = varset
trigger1 = time = 0
var(11) = 0

[State 240, 4]
type = varset
trigger1 = P2statetype = C
trigger1 = 1
var(11) = 130

[State 240, 4]
type = varset
trigger1 = 1
trigger1 = P2statetype != C
var(11) = -150 - (-150 - floor(p2bodydist y))

[State 0, Super Lightning Ivocation physical attack Reversal helper]
type = Helper
trigger1 = time = 0
helpertype = normal
name = "Super Lightning Ivocation physical attack Reversal helper"
ID = 2503
pos = 0,0
postype = p1
stateno = 2503
keyctrl = 0
ownpal = 1
scale = 1,1
bindtime = -1
;supermovetime = 9999
ignorehitpause = 1

[State 1034, 2]
type = Projectile
triggerall = time = 0;8
trigger1 = FrontEdgeBodyDist > -10
trigger1 = parent,FrontEdgeBodyDist > FrontEdgeBodyDist
trigger1 = parent,ishelper
trigger2 = !(parent,ishelper)
projID = 2501
projremove = 0
Projremovetime = 30
projhits = 1
;projmisstime = 4
projremanim = -1
;projhitanim = -1
projpriority = 999
;projremove = 1344
projanim = 2504
offset = 0,0
velocity = 0,0
attr = A, HP
damage = floor(20*root,fvar(3)),floor(4*root,fvar(3))
getpower = 0,0
givepower = 2,2
animtype = DiagUp
guardflag = M
hitflag = MAFLDP
pausetime = 0,3 ;5
sparkno = 3
guard.sparkno = 40
sparkxy = -10, -76 + var(11)
hitsound = -1 ;S0,17
guardsound = -1 ;S0,10
ground.type = High
ground.slidetime = 5
ground.hittime  = 5
guard.hittime = 5
ground.velocity = -9,-5
guard.velocity = -10
air.velocity = -9,-4
fall = 1
fall.recover = 0
sprpriority = 4
ignorehitpause = 1
ownpal = 1

[State 1034, 2]
type = Projectile
triggerall = parent,ishelper
triggerall = FrontEdgeBodyDist < -10
trigger1 = time = 0
projID = 2501
projremove = 0
Projremovetime = 30
projhits = 1
;projmisstime = 4
projremanim = -1
;projhitanim = -1
projpriority = 999
;projremove = 1344
projanim = 2504
offset = 0,0
velocity = 0,0
attr = A, HP
damage = floor(20*root,fvar(3)),floor(4*root,fvar(3))
getpower = 0,0
givepower = 2,2
animtype = DiagUp
guardflag = M
hitflag = MAFLDP
pausetime = 0,2 ;8
sparkno = 3
guard.sparkno = 40
sparkxy = -10, -76 + var(11)
hitsound = -1 ;S0,17
guardsound = -1 ;S0,10
ground.type = High
ground.slidetime = 5
ground.hittime  = 5
guard.hittime = 5
ground.velocity = 2,-7
guard.velocity = 3
air.velocity = 2,-5
fall = 1
fall.recover = 0
sprpriority = 4
ignorehitpause = 1
ownpal = 1

[State 1034, 2]
type = Projectile
triggerall = parent,ishelper
triggerall = BackEdgeBodyDist > -120
triggerall = parent,FrontEdgeBodyDist < FrontEdgeBodyDist
trigger1 = time = 0
projID = 2501
projremove = 0
Projremovetime = 30
projhits = 1
;projmisstime = 4
projremanim = -1
;projhitanim = -1
projpriority = 999
;projremove = 1344
projanim = 2504
offset = 0,0
velocity = 0,0
attr = A, HP
damage = floor(20*root,fvar(3)),floor(4*root,fvar(3))
getpower = 0,0
givepower = 2,2
animtype = DiagUp
guardflag = M
hitflag = MAFLDP
pausetime = 0,1 ;4
sparkno = 3
guard.sparkno = 40
sparkxy = -10, -76 + var(11)
hitsound = -1 ;S0,17
guardsound = -1 ;S0,10
ground.type = High
ground.slidetime = 5
ground.hittime  = 5
guard.hittime = 5
ground.velocity = 12,-6
guard.velocity = 13
air.velocity = 12,-5
fall = 1
fall.recover = 0
sprpriority = 4
ignorehitpause = 1
ownpal = 1

[State 210, Explod]
type = null;Explod
trigger1 = time = 0
anim  = 2501
postype = p1
pos = 0,0
ignorehitpause = 1
ownpal = 1
removetime = -2
sprpriority = 2
bindtime = 1
scale = 1, 1
persistent = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = root,projhit2501 = 1
value = S0,17
volume = 0
channel = 25
ignorehitpause = 1
persistent = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = root,projguarded2501 = 1
value = S0,10
volume = 0
channel = 25
ignorehitpause = 1
persistent = 0

[State 0, Afterimage]
type = Afterimage
trigger1 = time = 0
trans = add
Paladd = 15,0,15
PalContrast =  250, 250, 250
PalBright = 0,0,0
time    =  25
length  = 12
TimeGap = 1
FrameGap = 2
ignorehitpause = 1
supermovetime = 999
pausemovetime = 999

[State 240, 4]
type = destroyself
trigger1 = Time = 25
;trigger2 = FrontEdgeBodyDist < -50
trigger2 = BackEdgeBodyDist < -85

;-------------------------------------------------------------------------------
[Statedef 2502]
type    = U
movetype= I
physics = U
poweradd = 0
ctrl = 0
velset = 0,0
anim = 9999
sprpriority = 4
juggle = 0

[state 1000, 0]
type = nothitby
trigger1 = 1
value = SCA
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State 240, 4]
type = destroyself
trigger1 = 1

;---------------------------------------------------------------------------
; Super Lightning Ivocation physical attack Reversal helper
[Statedef 2503]
type = S
movetype = A
physics = S
ctrl = 0
anim = 2504

[State 800, reversaldef]
type = ReversalDef
trigger1 = 1
reversal.attr = SCA, NP,SP,HP
hitflag = HLMAFDP
pausetime = 0,0
priority = 999, hit
numhits = 0
sparkno = -1
sparkxy = 100, -100
fall.xvelocity = -3.27;272725105286
fall.yvelocity = -3.25;555985694885
p2stateno = 2006
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[state haha]
type = nothitby
trigger1 = 1
value = SCA
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State 2004, Override]
type = HitOverride
trigger1 = 1
attr = SCA, NA,SA,HA,NT,ST,HT,NP,SP,HP,AA,AT,AP
slot = 0
stateno = 2502
time = -1
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[state haha]
type = playerpush
trigger1 = 1
value = 0
ignorehitpause = 1

[State haha]
type = DestroySelf
trigger1 = animtime = 0


;-------------------------------------------------------------------------------
; Hyper Move: Combination Throw of Geonitz
[Statedef 2600]
type    = S
movetype= A
physics = S
poweradd = 0
ctrl = 0
velset = 0,0
anim = 2600
sprpriority = 2

[state 2600, NotHitBy]; ---- Combination Throw of Geonitz completely invincible
type = NotHitBy
trigger1 = 1
;trigger1 = animelem = 1, >=0
;trigger1 = animelem = 2, <0
value = SCA
time = 2
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State 2600, PalFX]
type = PalFX
trigger1 = Time < 16 && Time % 2
trigger1 = prevstateno = [1000,1062]
time = 1
add = 255,255,255
ignorehitpause = 1

[State 2600, PalFX]
type = PalFX
trigger1 = animelem = 2, >=0
trigger1 = animelem = 16, <0
add = 0,0,100
mul = 256,256,256
;sinadd = 0,0,0,10
invertall = 0
color = 256
ignorehitpause = 1
supermove = 1
;persistent =

[State 2600, EnvColor]
type = EnvColor
trigger1 = time = 0
value = 255,255,255
time = 2
under = 1
ignorehitpause = 1

[State 2600, AssertSpecial]
type = AssertSpecial
trigger1 = Time = [0,30]
flag = NoFG
flag2 = NoBG
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State 2600, SuperPause]
type = SuperPause
trigger1 = time = 0
time = 1
anim = -1
;sound =
;pos =
movetime = 1
;darken = 1
p2defmul = 1 ;ifelse(palno=12,1,ifelse(((prevstateno=[1000,1062])||(prevstateno=[1070,1080])),1,0))
poweradd = -2000
unhittable = 1
;endcmdbuftime = (winmugen only)
;pausebg =  (winmugen only)
ignorehitpause = 1
;persistent =

[State 2600, PlaySnd]; ---- voice
type = PlaySnd
trigger1 = AnimElem = 1
value = S0,73
channel = 0

;---------------------- old kof2001 DM spark
;[State 240, 4]
;type = Explod
;trigger1 = time = 1
;anim = 512
;postype = p1
;pos = 0,-90
;sprpriority = -1
;supermove = 1
;ownpal = 1

;[State 240, 4]
;type = Explod
;trigger1 = time = 10;
;anim = 513
;postype = p1
;pos = 0,-90
;sprpriority = 5
;supermove = 1
;ownpal = 1
;----------------------

[State haha] ;---- SuperMove Snd
type = PlaySnd
trigger1 = time = 0
value = s4,6

[State haha] ;---- SuperMove Snd
type = PlaySnd
trigger1 = time = 18
value = s4,7

[State 2600, Waves] ;XI_supermove_lv2_background
type = Explod
trigger1 = time = 0
anim = 10203
pos = Ceil(2 * Const(size.xscale)),Ceil(-115 * Const(size.yscale))
postype = p1
sprpriority = -1
removetime  = -2
bindtime = -1
removeongethit = 1
persistent = 0
ownpal = 1
supermovetime = -1

[State 2600, Waves] ;XI_supermove_lv2_foreground
type = Explod
trigger1 = time = 10
anim = 10204
pos = Ceil(2 * Const(size.xscale)),Ceil(-115 * Const(size.yscale))
postype = p1
sprpriority = 3
removetime  = -2
bindtime = -1
removeongethit = 1
persistent = 0
ownpal = 1
supermovetime = -1

[State 2400, ReversalDef]; ---- Combination Throw of Goenitz reversaldef
type = ReversalDef
Trigger1 = time = [0,5]
reversal.attr = SC,NA,SA,HA,NT,ST,HT   ;SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
priority = 99999, miss    ;;Hit,Miss,Dodge 3 4 7 99999 9999999
hitflag = HL  ;HLMAFDP
numhits = 0
sparkno = -1
;hitsound =
;p1stateno =
p2stateno = 2003
guard.dist = 0
ignorehitpause = 1
supermovetime = 99999
;persistent =

[State 2600, Projectile]
type = Projectile
Trigger1 = time = [0,6]
ProjID = 2600
projanim = 2609   ;Defaults to 0 if omitted.
;projhitanim =    ;when projectile hits the opponent. Defaults to -1 (no change in animation).
;projremanim =    ;when projectile is removed (due to its time expiring or hitting its removal boundaries, etc.) Defaults to projhitanim.
;projcancelanim =    ;when projectile is cancelled by hitting another projectile. Defaults to projremanim.
projscale = 1,1
projremove = 0    ;If nonzero, projectile be removed after it hits. Defaults to 1.
projremovetime = 2    ;number of ticks after which the projectile should be removed from the screen. Defaults to -1.
projshadow = 0,0,0   ;Specifies the R, G, and B components of the projectile's shadow.
velocity = 0,0
remvelocity = 0,0    ;velocities at which the projectile should travel while being removed.
accel = 0,0    ;acceleration
velmul = 1    ;projectile's velocity is multiplied by this multiplier on every tick. Default to 1.
projhits = 1    ;number of hits that projectile should be able to do before being removed. Defaults to 1.
projmiss = 0    ;specifies the least number of ticks that must elapse between multi-hits.
projpriority = 999    ;1 3 5 7 9 999 99999 9999999
projsprpriority = 3
projedgebound = 100    ;distance (in pixels) off the edge of the screen before the projectile is deleted. Defaults to 40.
projstagebound = 100
projheightbound = -240    ;the least and greatest y values the projectile is allowed to reach. Default to -240,1.
offset = 0,0
postype = p1         ;p2,front,back,left,right
supermovetime = 99999    ;important while using SuperPause. 99999
pausemovetime = 0    ;important while using Pause. 99999
; ---- the following is HitDef content
attr = S,HT    ;SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
hitflag = HL    ;HLAFDP+-
guardflag = N    ;MHLA
getpower = 0,0
;givepower = 0,0
;affectteam = E    ;B,E,F
animtype = up    ;light,medium,hard,back,up,diagup
air.animtype = up    ;light,medium,hard,back,up,diagup
;fall.animtype = Back
priority = 7,miss    ;Hit,Miss,Dodge 3 4 7 99999 9999999
damage = 0,0
pausetime = 0,0
;guard.pause ,0
sparkno = -1
guard.sparkno = -1
sparkxy = 0,0
;hitsound = 0,0
;guardsound = 0,0
;ground.type = High      ;Hign,Low,Trip,None ;High/Low have no effect if Back, If hit from behind, High will be displayed Low
;air.type = High    ;Defaults to ground.type
;ground.slidetime = 0    ;don't include pausetime ;applicable only to hits that keep P2 on the ground
;guard.slidetime = 0    ;Defaults to guard.hittime
;ground.hittime = 0    ;Applicable only to hits that keep P2 on the ground ;Defaults to 0
;guard.hittime = 0        ;Defaults to ground.hittime
;air.hittime = 20    ;has no effect if fall=1, default 20
;guard.ctrltime  = 0    ;Defaults to guard.slidetime
;airguard.ctrltime = 0
;guard.dist = 320    ;useful for trigger inguarddist
;yaccel = 0.5    ;y acceleration
;ground.velocity = 0,0
;guard.velocity = 0    ;Defaults to x_velocity of ground.velocity
;air.velocity = 0,0    ;Defaults to 0,0
;airguard.velocity = 0,0    ;Defaults to x_velocity*1.5, y_velocity/2 of air.velocity
;ground.cornerpush.veloff = 0    ;If arg1 of attr is "A", default value is 0. Otherwise,defaults to 1.3*guard.velocity.
;air.cornerpush.veloff = 0    ;Defaults to ground.cornerpush.velof
;down.cornerpush.veloff = 0    ;Defaults to ground.cornerpush.veloff
;guard.cornerpush.veloff = 0    ;Defaults to ground.cornerpush.veloff
;airguard.cornerpush.veloff = 0    ;Defaults to guard.cornerpush.veloff
;air.juggle = 0
;mindist = 0,0
;maxdist = 0,0
;snap = 0,0
sprpriority = 0
;p1sprpriority = 0;(winmugen only)
;p2sprpriority = 0;(winmugen only)
;p1facing = 0
;p1getp2facing = 0
p2facing = 1
p1stateno = 2601
p2stateno = 2620
;p2getp1state = 1
;forcestand = 0
fall = 0
fall.recover = 0
fall.recovertime = 4
;fall.xvelocity = 0    ;Defaults to no change
fall.yvelocity = -4.5    ;Defaults to -4.5
fall.damage = 0
air.fall = 0
air.fall.recover = 0
;down.velocity = 0,0    ;gethit while lying down ;Defaults to air.velocity
;down.hit
down.bounce = 0
;id = 0
;chainID = -1
;nochainID = -1
;hitonce = 1
kill = 0
guard.kill = 0
fall.kill = 0
numhits = 0
palfx.time = 0
;palfx.mul = 0,0,0
;palfx.add = 0,0,0
envshake.time = 0
;envshake.freq = 0
;envshake.ampl = 0
;envshake.phase = 0
fall.envshake.time = 0
;fall.envshake.freq = 0
;fall.envshake.ampl = 0
;fall.envshake.phase = 0
;(afterimage winmugen only)
afterimage.time = 0
;afterimage.length =
;afterimage.palcolor =
;afterimage.palinvertall =
;afterimage.palbright = 0,0,0
;afterimage.palcontrast = 0,0,0
;afterimage.palpostbright =0,0,0
;afterimage.paladd =  0,0,0
;afterimage.palmul = 0,0,0
;afterimage.timegap =
;afterimage.framegap =
;afterimage.trans = ;none,add,add1,addalpha,sub
ignorehitpause = 1
;persistent =

[State 2600, BGPalFX]
type = BGPalFX
trigger1 = animelem = 1, >=0
trigger1 = animelem = 13, <0
time = 5
invertall = 1
ignorehitpause = 1
supermovetime = 999

[State 2600, ChangeState]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1


; Combination Throw of Goenitz success P1STATENO -------------------------------
[Statedef 2601]
type    = S
movetype= A
physics = S
poweradd = 0
ctrl = 0
velset = 0,0
anim = 2601
sprpriority = 2

[State 2401, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = NoFG
flag2 = NoBG
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State 2404, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State 2401, VelSet]; ---- moving to screen center
type = VelSet
trigger1 = frontedgedist <= 160
trigger1 = AnimElem = 1, >= 0
x = -4

[State 2401, VelSet]; ---- moving to screen center
type = VelSet
trigger1 = backedgedist <= 70
trigger1 = AnimElem = 1, >= 0
x = 4

[State 2401, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0

[State 2401, TargetBind]
type = TargetBind
trigger1 = animelem = 4, <=0
pos = 40, 0

[State 2401, TargetBind]
type = TargetBind
trigger1 = animelem = 4, =1
pos = 40, -5
[State 2401, TargetBind]
type = TargetBind
trigger1 = animelem = 4, =2
pos = 40, -10
[State 2401, TargetBind]
type = TargetBind
trigger1 = animelem = 4, =3
pos = 40, -15
[State 2401, TargetBind]
type = TargetBind
trigger1 = animelem = 4, =4
pos = 40, -20

[State 2401, TargetBind]
type = TargetBind
trigger1 = animelem = 4, >=5
pos = 40, -20

[State 2401, PlaySnd]; ---- throw grap sound
type = PlaySnd
trigger1 = animelem = 4
value = S2,10

[State 2401, Envcolor]; ---- black background
type = Envcolor
trigger1 = 1
time = 2
value = 0,0,0
under = 1
ignorehitpause = 1

[State 2401, SuperPause]
type = SuperPause
trigger1 = time = 1
time = 30
anim = -1
sound = S0,39
;pos =
movetime = 30
;darken = 1
p2defmul = 1 ;ifelse(palno=12,1,ifelse(((prevstateno=[1000,1062])||(prevstateno=[1070,1080])),1,0))
unhittable = 1
;endcmdbuftime = (winmugen only)
;pausebg =  (winmugen only)
ignorehitpause = 1
;persistent =

;---------------------- old kof2001 DM spark
;[State 240, 4]
;type = Explod
;trigger1 = time = 1
;anim = 512
;postype = p1
;pos = 0,-90
;sprpriority = -1
;supermove = 1
;ownpal = 1

;[State 240, 4]
;type = Explod
;trigger1 = time = 10
;anim = 513
;postype = p1
;pos = 0,-90
;sprpriority = 5
;supermove = 1
;ownpal = 1
;----------------------

[State 2600, Waves] ;XI_supermove_lv2_background
type = Explod
trigger1 = time = 0
anim = 10203
pos = Ceil(2 * Const(size.xscale)),Ceil(-115 * Const(size.yscale))
postype = p1
sprpriority = -1
removetime  = -2
bindtime = -1
removeongethit = 1
persistent = 0
ownpal = 1
supermovetime = -1

[State 2600, Waves] ;XI_supermove_lv2_foreground
type = Explod
trigger1 = time = 10
anim = 10204
pos = Ceil(2 * Const(size.xscale)),Ceil(-115 * Const(size.yscale))
postype = p1
sprpriority = 3
removetime  = -2
bindtime = -1
removeongethit = 1
persistent = 0
ownpal = 1
supermovetime = -1

[State 2601, ChangeState]
type = ChangeState
trigger1 = AnimTime = 0
value = 2602

; Combination Throw of Geonitz P1STATENO summon Geonitz ------------------------
[Statedef 2602]
type = S
movetype = I
physics = S
anim = 2602
velset = 0,0
ctrl = 0
sprpriority = 1
poweradd = 0

[State 2402, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = NoFG
flag2 = NoBG
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State 2402, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State 2401, TargetBind]
type = TargetBind
trigger1 = 1
time = 0
pos = 40, -30

[State 2402, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0

[State 2402, PosAdd]
type = PosAdd
trigger1 = time = [0,5]
x = -5
;y = 0
ignorehitpause = 1
;persistent =


[State 2403, PlaySnd]
type = PlaySnd
trigger1 = time = 0
value = S1,8

[State 2602, Helper]; ---- summon 96' Geonitz
type = Helper
trigger1 = time = 0
name = "Combination Move: Geonitz"
postype = p1
pos = 125,0
sprpriority = 2
facing = -1
id = 2610
stateno = 2610
helpertype = normal
keyctrl = 0
persistent = 0
ignorehitpause = 1
ownpal = 1

;[State 2402, VelSet]
;type = VelSet
;trigger1 = animelem = 3
;trigger2 = animelem = 4
;trigger3 = animelem = 5
;trigger4 = animelem = 6
;x = -4

;[State 2402, VelSet]
;type = VelSet
;trigger1 = animtime = 0
;x = 0

[State 2602, ChangeState]
type = ChangeState
trigger1 = AnimTime = 0
value = 2603

; Combination Throw of Geonitz P1STATENO fast-hits -----------------------------
[Statedef 2603]
type    = S
movetype= A
physics = S
poweradd = 0
ctrl = 0
velset = 0,0
anim = 2603
sprpriority = 2

[State 2403, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = NoFG
flag2 = NoBG
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State 2403, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0

[State 2403, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State 0]
type = AfterImage
trigger1 = !time
time = 130
palbright = 12,12,12
palcontrast = 100,100,100
paladd = 0,0,0
palmul = .6,.6,.6
length = 9
frameGap = 3
timegap = 2

[State 2403, TargetState]
type = TargetState
trigger1 = AnimElem = 3
value = 2621

[State 2403, TargetState]
type = TargetState
trigger1 = AnimElem = 45
value = 2622

[State 2403, TargetState]
type = TargetState
trigger1 = AnimElem = 47
value = 2623

[State 2403, PlaySnd]
type = PlaySnd
trigger1 = AnimElem = 5
trigger2 = AnimElem = 9
trigger3 = AnimElem = 15
trigger4 = AnimElem = 20
trigger5 = AnimElem = 26
trigger6 = AnimElem = 30
trigger7 = AnimElem = 36
trigger8 = AnimElem = 41
value = S0,39
channel = 2

[State 0, PlaySnd]
type = PlaySnd
trigger1 = AnimElem = 45
value = S0,12
;ignorehitpause =
;persistent =

[State 2403, HitAdd]
type = HitAdd
trigger1 = AnimElem = 5
trigger2 = AnimElem = 9
trigger3 = AnimElem = 15
trigger4 = AnimElem = 20
trigger5 = AnimElem = 26
trigger6 = AnimElem = 30
trigger7 = AnimElem = 36
trigger8 = AnimElem = 41
trigger9 = AnimElem = 45
value = 1

[State 2403, EnvColor]
type = EnvColor
trigger1 = AnimElem = 5
trigger2 = AnimElem = 9
trigger3 = AnimElem = 15
trigger4 = AnimElem = 20
trigger5 = AnimElem = 26
trigger6 = AnimElem = 30
trigger7 = AnimElem = 36
trigger8 = AnimElem = 41
;trigger9 = AnimElem = 45
time = 1
value = 250,250,250
under = 1
ignorehitpause = 1

[State 2403, EnvColor]
type = EnvColor
trigger1 = AnimElem = 45, >=0
trigger1 = AnimElem = 46, <0
trigger1 = time%2=1
time = 1
value = 250,250,250
under = 1
ignorehitpause = 1

[State 2403, TargetLifeAdd]
type = TargetLifeAdd
trigger1 = AnimElem = 5
trigger2 = AnimElem = 9
trigger3 = AnimElem = 15
trigger4 = AnimElem = 20
trigger5 = AnimElem = 26
trigger6 = AnimElem = 30
trigger7 = AnimElem = 36
trigger8 = AnimElem = 41
value = floor(-15*fvar(3))
kill = 0
absolute = 1

[State 2403, TargetLifeAdd]
type = TargetLifeAdd
trigger1 = AnimElem = 45
value =  floor(-75*fvar(3))
kill = 0
absolute = 1

[State 2403, HitAdd]
type = HitAdd
trigger1 = helper(2610),AnimElem = 4
trigger2 = helper(2610),AnimElem = 17
trigger3 = helper(2610),AnimElem = 30
trigger4 = helper(2610),AnimElem = 11
trigger5 = helper(2610),AnimElem = 24
trigger6 = helper(2610),AnimElem = 37
trigger7 = helper(2610),AnimElem = 46
value = 1

[State 2403, TargetLifeAdd]
type = TargetLifeAdd
trigger1 = helper(2610),AnimElem = 4
trigger2 = helper(2610),AnimElem = 17
trigger3 = helper(2610),AnimElem = 30
trigger4 = helper(2610),AnimElem = 11
trigger5 = helper(2610),AnimElem = 24
trigger6 = helper(2610),AnimElem = 37
value =  floor(-15*fvar(3))
kill = 0
absolute = 1

[State 2403, TargetLifeAdd]
type = TargetLifeAdd
trigger1 = helper(2610),AnimElem = 46
value =  floor(-75*fvar(3))
kill = 0
absolute = 1

;----------------------------
[State 0, Explod]
type = Explod
trigger1 = AnimElem = 6
trigger2 = AnimElem = 27
anim = 2632
ID = 2632
pos = 40,0
postype = p1  ;p2,front,back,left,right
facing = 1
vfacing = 1
bindtime = 1
vel = 0,0
accel = 0,0
random = 0,0
removetime = -2
;supermove
;pausemove
scale = const(size.xscale), const(size.yscale)
sprpriority = 3
ontop = 0
shadow = 0,0,0
ownpal = 1
removeongethit = 1
;ignorehitpause =
;persistent =

[State 0, Explod]
type = Explod
trigger1 = AnimElem = 10
trigger2 = AnimElem = 31
anim = 2634
ID = 2634
pos = 50,0
postype = p1  ;p2,front,back,left,right
facing = 1
vfacing = 1
bindtime = 1
vel = 0,0
accel = 0,0
random = 0,0
removetime = -2
;supermove
;pausemove
scale = const(size.xscale), const(size.yscale)
sprpriority = 3
ontop = 0
shadow = 0,0,0
ownpal = 1
removeongethit = 1
;ignorehitpause =
;persistent =

[State 0, Explod]
type = Explod
trigger1 = AnimElem = 15
trigger2 = AnimElem = 36
anim = 2631
ID = 2631
pos = 0,-10
postype = p1  ;p2,front,back,left,right
facing = 1
vfacing = 1
bindtime = 1
vel = 0,0
accel = 0,0
random = 0,0
removetime = -2
;supermove
;pausemove
scale = const(size.xscale), const(size.yscale)
sprpriority = 3
ontop = 0
shadow = 0,0,0
ownpal = 1
removeongethit = 1
;ignorehitpause =
;persistent =

[State 0, Explod]
type = Explod
trigger1 = AnimElem = 20
trigger2 = AnimElem = 41
anim = 2633
ID = 2633
pos = -20,0
postype = p1  ;p2,front,back,left,right
facing = 1
vfacing = 1
bindtime = 1
vel = 0,0
accel = 0,0
random = 0,0
removetime = -2
;supermove
;pausemove
scale = const(size.xscale), const(size.yscale)
sprpriority = 3
ontop = 0
shadow = 0,0,0
ownpal = 1
removeongethit = 1
;ignorehitpause =
;persistent =

[State 250, Explod]
type = Explod
trigger1 = animelem = 45
anim  = 2638
postype = p1
pos = 12,-5
ownpal = 1
sprpriority = 3
bindtime = -1
scale = const(size.xscale), const(size.yscale)
ignorehitpause = 1
removeongethit = 1
;----------------------------
[State 0, Explod]
type = Explod
trigger1 = AnimElem = 6
trigger2 = AnimElem = 27
anim = F2
pos = 10,-70
postype = p2  ;p2,front,back,left,right
facing = 1
vfacing = 1
bindtime = 1
vel = 0,0
accel = 0,0
random = 0,0
removetime = -2
;supermove
;pausemove
scale = const(size.xscale), const(size.yscale)
sprpriority = 3
ontop = 0
shadow = 0,0,0
ownpal = 1
removeongethit = 1
;ignorehitpause =
;persistent =

[State 0, Explod]
type = Explod
trigger1 = AnimElem = 10
trigger2 = AnimElem = 31
anim = F2
pos = 10,-20
postype = p2  ;p2,front,back,left,right
facing = 1
vfacing = 1
bindtime = 1
vel = 0,0
accel = 0,0
random = 0,0
removetime = -2
;supermove
;pausemove
scale = const(size.xscale), const(size.yscale)
sprpriority = 3
ontop = 0
shadow = 0,0,0
ownpal = 1
removeongethit = 1
;ignorehitpause =
;persistent =

[State 0, Explod]
type = Explod
trigger1 = AnimElem = 15
trigger2 = AnimElem = 36
anim = F2
pos = 10,-50
postype = p2  ;p2,front,back,left,right
facing = 1
vfacing = 1
bindtime = 1
vel = 0,0
accel = 0,0
random = 0,0
removetime = -2
;supermove
;pausemove
scale = const(size.xscale), const(size.yscale)
sprpriority = 3
ontop = 0
shadow = 0,0,0
ownpal = 1
removeongethit = 1
;ignorehitpause =
;persistent =

[State 0, Explod]
type = Explod
trigger1 = AnimElem = 20
trigger2 = AnimElem = 41
anim = F2
pos = 10,-30
postype = p2  ;p2,front,back,left,right
facing = 1
vfacing = 1
bindtime = 1
vel = 0,0
accel = 0,0
random = 0,0
removetime = -2
;supermove
;pausemove
scale = const(size.xscale), const(size.yscale)
sprpriority = 3
ontop = 0
shadow = 0,0,0
ownpal = 1
removeongethit = 1
;ignorehitpause =
;persistent =

[State 250, Explod]
type = Explod
trigger1 = animelem = 45
anim  = F2
postype = p2
pos = 0,-40
ownpal = 1
sprpriority = 3
bindtime = -1
scale = const(size.xscale), const(size.yscale)
ignorehitpause = 1
removeongethit = 1

[State 2603, ChangeState]
type = ChangeState
trigger1 = animTime = 0
value = 2604

; Combination Throw of Geonitz P1STATENO backwd --------------------------------
[Statedef 2604]
type    = S
movetype= A
physics = S
poweradd = 0
ctrl = 0
velset = -3,0
anim = 2604
sprpriority = 2

[State 2404, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = NoFG
flag2 = NoBG
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State 2404, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0

[State 2404, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,0
;ignorehitpause =
;persistent =

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 0
value = S0,24
;ignorehitpause =
;persistent =

[State 0, Trans]
type = Trans
trigger1 = 1
trans = addalpha
alpha = 256-time*16,time*16
;ignorehitpause =
;persistent =

[State 0, VelAdd]
type = VelAdd
trigger1 = 1
x = -2
y = 0
;ignorehitpause =
;persistent =

[State 2604, ChangeState]
type = ChangeState
trigger1 = Time = 15
value = 2605

; Combination Throw of Geonitz P1STATENO heavy kick ----------------------------
[Statedef 2605]
type    = A
movetype= A
physics = N
poweradd = 0
ctrl = 0
velset = 0,0
anim = 2605
sprpriority = 2

[State 2406, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = NoFG
flag2 = NoBG
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State 2406, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0

[State 2406, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,0
;ignorehitpause =
;persistent =

[State 2406, EnvColor]
type = EnvColor
trigger1 = time = [6,20]
time = 1
value = 250,250,250
under = 1
ignorehitpause = 1

[State 2406, PosSet]
type = Posadd
Trigger1 = time = 0
y = -220
;y = (pos X)*facing

[State 0, VelSet]
type = VelSet
trigger1 = 1
x = 20
y = 15
;ignorehitpause =
;persistent =

[State 0, VelAdd]
type = VelAdd
trigger1 = 1
x = 4
y = 3
;ignorehitpause =
;persistent =

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 6
value = S0,28
;ignorehitpause =
;persistent =

[State 2406, TargetState]
type = TargetState
trigger1 = time = 6
value = 2624

[State 2403, HitAdd]
type = HitAdd
trigger1 = time = 6
value = 2

[State 2403, TargetLifeAdd]
type = TargetLifeAdd
trigger1 = time = 6
value =  floor(-140*fvar(3))
kill = 1
absolute = 1

[State 250, Explod]
type = Explod
trigger1 = time = 6
anim  = 10307
postype = p1
pos = 70,-10
ownpal = 1
sprpriority = 3
bindtime = 1
scale = 1,1
ignorehitpause = 1
;persistent =

[State 0, PosFreeze]
type = PosFreeze
trigger1 = time = [6,20]
value = 1
;ignorehitpause =
;persistent =

[state 1225, EnvShake]
type = EnvShake
trigger1 = time = 6
time = 14
ampl = -4
freq = 120
phase = 120

[State 2406, TargetState]
type = TargetState
trigger1 = time = 20
value = 2625

[State 0]
type = AfterImage
trigger1 = time = 19
time = 6
palbright = 5,5,12
palcontrast = 100,100,100
paladd = 0,0,0
palmul = .7,.7,.7
length = 9
frameGap = 2
timegap = 2

[State 2605, ChangeState]
type = ChangeState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
value = 2606

; Combination Throw of Geonitz P1STATENO turn end ------------------------------
[Statedef 2606]
type    = S
movetype= A
physics = S
poweradd = 0
ctrl = 0
velset = 0,0
anim = 2606
sprpriority = 2

[State 2406, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = NoFG
flag2 = NoBG
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State 2406, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0

[State 2406, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State 0, PosSet]
type = PosSet
trigger1 = 1
y = 0
;ignorehitpause =
persistent = 0

[State 2606, Turn]
type = Turn
trigger1 = animelem = 5
ignorehitpause = 1
;persistent =

[State 2606, ChangeState]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

; Combination Throw of Geonitz helper summon Geonitz ------------------------
[Statedef 2610]
type = S
movetype = I
physics = S
anim = 9999;2610
velset = 0,0
ctrl = 0
sprpriority = 1
poweradd = 0

[State 2402, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = NoFG
flag2 = NoBG
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State 2402, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State 2402, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0

;[State 2402, VelSet]
;type = VelSet
;trigger1 = animelem = 3
;trigger2 = animelem = 4
;trigger3 = animelem = 5
;trigger4 = animelem = 6
;x = -4

;[State 2402, VelSet]
;type = VelSet
;trigger1 = animtime = 0
;x = 0

[State 0, Explod]
type = Explod
trigger1 = 1
anim = 2630
ID = 2630
pos = 0,0
postype = p1  ;p2,front,back,left,right
facing = 1
vfacing = 1
bindtime = 1
vel = 0,0
accel = 0,0
random = 0,0
removetime = -2
;supermove
;pausemove
scale = 1,1
sprpriority = 3
ontop = 0
shadow = 0,0,0
ownpal = 0
removeongethit = 0
;ignorehitpause =
persistent = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = anim = 9999
trigger1 = time = 0
value = S0,40
;ignorehitpause =
;persistent =

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = anim = 9999
trigger1 = Time = 2
value = 2610
;elem = 1
ignorehitpause = 1
;persistent =

[State 0, PlaySnd]
type = PlaySnd
trigger1 = anim = 2610
trigger1 = animelem = 18
value = S0,43
;ignorehitpause =
;persistent =

[State 2602, ChangeState]
type = ChangeState
trigger1 = anim = 2610
trigger1 = AnimTime = 0
value = 2611

; Combination Throw of Geonitz helper fast-hits -----------------------------
[Statedef 2611]
type    = S
movetype= A
physics = S
poweradd = 0
ctrl = 0
velset = 0,0
anim = 2611
sprpriority = 2

[State 2403, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = NoFG
flag2 = NoBG
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State 2403, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0

[State 2403, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State 0]
type = AfterImage
trigger1 = !time
time = 142
palbright = 5,5,12
palcontrast = 100,100,100
paladd = 0,0,0
palmul = .6,.6,.7
length = 9
frameGap = 3
timegap = 2

[State 2403, PlaySnd]
type = PlaySnd
trigger1 = AnimElem = 4
trigger2 = AnimElem = 17
trigger3 = AnimElem = 30
value = S0,41
channel = 2

[State 2403, PlaySnd]
type = PlaySnd
trigger1 = AnimElem = 11
trigger2 = AnimElem = 24
trigger3 = AnimElem = 37
value = S0,42
channel = 3

[State 0, PlaySnd]
type = PlaySnd
trigger1 = AnimElem = 46
value = S0,20

[State 0, PlaySnd]
type = PlaySnd
trigger1 = AnimElem = 46
value = S0,44

[State 2403, EnvColor]
type = EnvColor
trigger1 = AnimElem = 4
trigger2 = AnimElem = 17
trigger3 = AnimElem = 30
trigger4 = AnimElem = 11
trigger5 = AnimElem = 24
trigger6 = AnimElem = 37
trigger7 = AnimElem = 46
time = 1
value = 250,250,250
under = 1
ignorehitpause = 1

;---------------------------------
[State 0, Explod]
type = Explod
trigger1 = AnimElem = 4
trigger2 = AnimElem = 17
trigger3 = AnimElem = 30
anim = 2635
ID = 2635
pos = 15,0
postype = p1  ;p2,front,back,left,right
facing = 1
vfacing = 1
bindtime = 1
vel = 0,0
accel = 0,0
random = 0,0
removetime = -2
;supermove
;pausemove
scale = const(size.xscale), const(size.yscale)
sprpriority = 3
ontop = 0
shadow = 0,0,0
ownpal = 1
removeongethit = 1
;ignorehitpause =
;persistent =

[State 0, Explod]
type = Explod
trigger1 = AnimElem = 11
trigger2 = AnimElem = 24
trigger3 = AnimElem = 37
anim = 2636
ID = 2636
pos = 20,-5
postype = p1  ;p2,front,back,left,right
facing = 1
vfacing = 1
bindtime = 1
vel = 0,0
accel = 0,0
random = 0,0
removetime = -2
;supermove
;pausemove
scale = const(size.xscale), const(size.yscale)
sprpriority = 3
ontop = 0
shadow = 0,0,0
ownpal = 1
removeongethit = 1
;ignorehitpause =
;persistent =

[State 0, Explod]
type = Explod
trigger1 = AnimElem = 47
anim = 2637
ID = 2637
pos = 20,10
postype = p1  ;p2,front,back,left,right
facing = 1
vfacing = 1
bindtime = 1
vel = 0,0
accel = 0,0
random = 0,0
removetime = -2
;supermove
;pausemove
scale = const(size.xscale), const(size.yscale)
sprpriority = 3
ontop = 0
shadow = 0,0,0
ownpal = 1
removeongethit = 1
;ignorehitpause =
;persistent =
;---------------------------------
[State 0, Explod]
type = Explod
trigger1 = AnimElem = 4
trigger2 = AnimElem = 17
trigger3 = AnimElem = 30
anim = F2
pos = -10,-20
postype = p2  ;p2,front,back,left,right
facing = 1
vfacing = 1
bindtime = 1
vel = 0,0
accel = 0,0
random = 0,0
removetime = -2
;supermove
;pausemove
scale = const(size.xscale), const(size.yscale)
sprpriority = 3
ontop = 0
shadow = 0,0,0
ownpal = 1
removeongethit = 1
;ignorehitpause =
;persistent =

[State 0, Explod]
type = Explod
trigger1 = AnimElem = 11
trigger2 = AnimElem = 24
trigger3 = AnimElem = 37
anim = F2
pos = -10,-60
postype = p2  ;p2,front,back,left,right
facing = 1
vfacing = 1
bindtime = 1
vel = 0,0
accel = 0,0
random = 0,0
removetime = -2
;supermove
;pausemove
scale = const(size.xscale), const(size.yscale)
sprpriority = 3
ontop = 0
shadow = 0,0,0
ownpal = 1
removeongethit = 1
;ignorehitpause =
;persistent =

[State 0, Explod]
type = Explod
trigger1 = AnimElem = 47
anim = F2
pos = -10,-40
postype = p2  ;p2,front,back,left,right
facing = 1
vfacing = 1
bindtime = 1
vel = 0,0
accel = 0,0
random = 0,0
removetime = -2
;supermove
;pausemove
scale = const(size.xscale), const(size.yscale)
sprpriority = 3
ontop = 0
shadow = 0,0,0
ownpal = 1
removeongethit = 1
;ignorehitpause =
;persistent =

[State 2611, ChangeState]
type = ChangeState
trigger1 = animTime = 0
value = 2612

; Combination Throw of Geonitz helper backwd --------------------------------
[Statedef 2612]
type    = S
movetype= A
physics = S
poweradd = 0
ctrl = 0
velset = -3,0
anim = 2612
sprpriority = 2

[State 2404, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = NoFG
flag2 = NoBG
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State 2404, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0

[State 2404, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,0
;ignorehitpause =
;persistent =

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 0
value = S0,24
;ignorehitpause =
;persistent =

[State 0, Trans]
type = Trans
trigger1 = 1
trans = addalpha
alpha = 256-time*16,time*16
;ignorehitpause =
;persistent =

[State 0, VelAdd]
type = VelAdd
trigger1 = 1
x = -2
y = 0
;ignorehitpause =
;persistent =

[State 2612, ChangeState]
type = ChangeState
trigger1 = Time = 15
value = 2613

; Combination Throw of Geonitz helper heavy kick ----------------------------
[Statedef 2613]
type    = A
movetype= A
physics = N
poweradd = 0
ctrl = 0
velset = 0,0
anim = 2613
sprpriority = 2

[State 2406, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = NoFG
flag2 = NoBG
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State 2406, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0

[State 2406, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,0
;ignorehitpause =
;persistent =

[State 2406, EnvColor]
type = EnvColor
trigger1 = time = [6,20]
time = 1
value = 250,250,250
under = 1
ignorehitpause = 1

[State 2406, PosSet]
type = Posadd
Trigger1 = time = 0
x = 10
y = -220
;y = (pos X)*facing

[State 0, VelSet]
type = VelSet
trigger1 = 1
x = 20
y = 15
;ignorehitpause =
;persistent =

[State 0, VelAdd]
type = VelAdd
trigger1 = 1
x = 4
y = 3
;ignorehitpause =
;persistent =

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 6
value = S0,28
;ignorehitpause =
;persistent =

[State 0, PosFreeze]
type = PosFreeze
trigger1 = time = [6,20]
value = 1
;ignorehitpause =
;persistent =

[State 0]
type = AfterImage
trigger1 = time = 19
time = 6
palbright = 5,5,12
palcontrast = 100,100,100
paladd = 0,0,0
palmul = .7,.7,.7
length = 9
frameGap = 2
timegap = 2

[State 2613, ChangeState]
type = ChangeState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
value = 2614

; Combination Throw of Geonitz helper turn end ------------------------------
[Statedef 2614]
type    = S
movetype= A
physics = S
poweradd = 0
ctrl = 0
velset = 0,0
anim = 2614
sprpriority = 2

[State 2406, AssertSpecial]
type = null;AssertSpecial
trigger1 = 1
flag = NoFG
flag2 = NoBG
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State 2406, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0

[State 2406, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State 0, PosSet]
type = PosSet
trigger1 = 1
y = 0
;ignorehitpause =
persistent = 0

[State 2606, Turn]
type = Turn
trigger1 = animelem = 3
ignorehitpause = 1
;persistent =

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 4
value = S0,45
;ignorehitpause =
;persistent =

[State 0, Explod]
type = Explod
trigger1 = animelem = 10, =15
anim = 2630
ID = 2630
pos = 0,0
postype = p1  ;p2,front,back,left,right
facing = 1
vfacing = 1
bindtime = 1
vel = 0,0
accel = 0,0
random = 0,0
removetime = -2
;supermove
;pausemove
scale = 1,1
sprpriority = 3
ontop = 0
shadow = 0,0,0
ownpal = 0
removeongethit = 0
;ignorehitpause =
persistent = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 10, =15
value = S0,40
;ignorehitpause =
;persistent =

[State 2606, ChangeState]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

; Combination Move P2STATENO start ---------------------------------------------
[Statedef 2620]
type    = A
movetype= H
physics = N
velset = 0,0
;anim = 811
sprpriority = -1

[State 2202, ScreenBound]
type = ScreenBound
trigger1 = 1
movecamera = 1,0

[State 2202, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0
ignorehitpause = 1

[state haha]; ---- target is ishelper, debug
type = nothitby
trigger1 = ishelper
value = SCA
time = -1
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[state 1205, Destroyself]; ---- if ishelper debug
type = Destroyself
triggerall = isHelper
trigger1 = 1
ignorehitpause = 1

[State 2620, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State 2620, ChangeAnim2]
type = ChangeAnim2
trigger1 = time = 0
value = 2620

[State 2620, PalFX]
type = null;PalFX
trigger1 = 1
time = 80
add = 0,0,0
mul = 175,175,175
sinadd = 120,120,120,5
invertall = 0
color = 256
ignorehitpause = 1
supermovetime = 99999
persistent = 0

[State 2620, SelfState]; ---- DEBUG
type = SelfState
trigger1 = time >= 600
value = 5000
;ctrl =
ignorehitpause = 1
persistent = 0

; Combination Throw of Geonitz P2STATENO fast-hit ------------------------------
[Statedef 2621]
type    = S
movetype= H
physics = S
poweradd = 0
ctrl = 0
velset = 0,0

[state haha]; ---- target is ishelper, debug
type = nothitby
trigger1 = ishelper
value = SCA
time = -1
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[state 1205, Destroyself]; ---- if ishelper debug
type = Destroyself
triggerall = isHelper
trigger1 = 1
ignorehitpause = 1

[State 2621, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State 2621, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0
ignorehitpause = 1

[State 2620, PalFX]
type = PalFX
trigger1 = 1
time = 150
add = 0,0,0
mul = 175,175,175
sinadd = 120,120,120,5
invertall = 0
color = 256
ignorehitpause = 1
persistent = 0

[State 2621, ChangeAnim2]
type = ChangeAnim2
Trigger1 = Time = 0
value = 2621


; Combination Throw of Geonitz P2STATENO hit up shake --------------------------
[Statedef 2622]
type    = S
movetype= H
physics = S
poweradd = 0
ctrl = 0
velset = 0,0

[state haha]; ---- target is ishelper, debug
type = nothitby
trigger1 = ishelper
value = SCA
time = -1
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[state 1205, Destroyself]; ---- if ishelper debug
type = Destroyself
triggerall = isHelper
trigger1 = 1
ignorehitpause = 1

[State 2622, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State 2622, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0
ignorehitpause = 1

[State 2011, Offset]
type = Offset
triggerall = 1
trigger1 = time%4=0
x = 0
ignorehitpause = 1
;persistent =

[State 2011, Offset]
type = Offset
triggerall = 1
trigger1 = time%4=1
x = 1
ignorehitpause = 1
;persistent =

[State 2011, Offset]
type = Offset
triggerall = 1
trigger1 = time%4=2
x = 0
ignorehitpause = 1
;persistent =

[State 2011, Offset]
type = Offset
triggerall = 1
trigger1 = time%4=3
x = -1
ignorehitpause = 1
;persistent =

[State 2622, PalFX]
type = PalFX
trigger1 = 1
time = 14
add = 0,0,0
mul = 175,175,175
sinadd = 120,120,120,5
invertall = 0
color = 256
ignorehitpause = 1
persistent = 0

[State 2622, ChangeAnim2]
type = ChangeAnim2
Trigger1 = Time = 0
value = 2622

; Combination Throw of Geonitz P2STATENO hit-up -------------------------------
[Statedef 2623]
type    = A
movetype= H
physics = N
velset = 0,0

[State 2422, ScreenBound]
type = ScreenBound
trigger1 = 1
movecamera = 1,0

[state haha]; ---- target is ishelper, debug
type = nothitby
trigger1 = ishelper
value = SCA
time = -1
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[state 1205, Destroyself]; ---- if ishelper debug
type = Destroyself
triggerall = isHelper
trigger1 = 1
ignorehitpause = 1

[State 2422, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State 2422, ChangeAnim2]
type = ChangeAnim2
trigger1 = Time  = 0
value = 2623

[State 2422, VelSet]
type = VelSet
trigger1 = Time = 0
y = -10

[State 2422, VelAdd]
type = VelAdd
trigger1 = Time > 3
y = .62

[State 2422, EnvColor]
type = EnvColor
trigger1 = Pos Y >= 0 && Vel Y > 0
time = 1
value = 250,250,250
under = 1
ignorehitpause = 1

[State 2422, SelfState]
type = SelfState
trigger1 = Pos Y >= 0 && Vel Y > 0
value = 5100

; Combination Throw of Geonitz P2STATENO kick shake ----------------------------
[Statedef 2624]
type    = S
movetype= H
physics = S
poweradd = 0
ctrl = 0
velset = 0,0

[state haha]; ---- target is ishelper, debug
type = nothitby
trigger1 = ishelper
value = SCA
time = -1
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[state 1205, Destroyself]; ---- if ishelper debug
type = Destroyself
triggerall = isHelper
trigger1 = 1
ignorehitpause = 1

[State 2420, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State 2420, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0
ignorehitpause = 1

[State 2011, Offset]
type = Offset
triggerall = 1
trigger1 = time%4=0
x = 0
ignorehitpause = 1
;persistent =

[State 2011, Offset]
type = Offset
triggerall = 1
trigger1 = time%4=1
x = 1
ignorehitpause = 1
;persistent =

[State 2011, Offset]
type = Offset
triggerall = 1
trigger1 = time%4=2
x = 0
ignorehitpause = 1
;persistent =

[State 2011, Offset]
type = Offset
triggerall = 1
trigger1 = time%4=3
x = -1
ignorehitpause = 1
;persistent =

[State 2420, ChangeAnim2]
type = ChangeAnim2
Trigger1 = Time = 0
value = 2624

;-------------------------------------------------------------------------------
; Shattering Mirror Victim For Lower Version
[Statedef 2625]
type = A
ctrl = 0
velset = 0,0
movetype = H
physics = N

[state haha]; ---- target is ishelper, debug
type = nothitby
trigger1 = ishelper
value = SCA
time = -1
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[state 1205, Destroyself]; ---- if ishelper debug
type = Destroyself
triggerall = isHelper
trigger1 = 1
ignorehitpause = 1

[state 1225, nothitby]
type = nothitby
trigger1 = 1
value = SCA
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[state 1225]
type = changeanim2
trigger1 = 1
value = 2625
persistent = 0
ignorehitpause = 1

[State 0, VelSet]
type = VelSet
trigger1 = animelem = 2,=0
x = 0
y = 10
;ignorehitpause =
;persistent =

[State 5030, 1]
type = VelAdd;Gravity
trigger1 = animelem = 2,>=0
y = GetHitVar(yaccel)

;[State 5030, 1]
;type = VelAdd;Gravity
;trigger1 = animelemno(0) >= 2 && animelemno(8) <= 3
;trigger1 = vel X < -3
;x = 1.4 ;52

;[state 1225]
;type = velset
;trigger1 = animelem = 3, 9
;x = -3

[state 1225, EnvShake]
type = EnvShake
trigger1 = anim = 2625
;rigger1 = animelem >= 3
trigger1 = Vel Y > 0
trigger1 = Pos Y > 0
time = 15
ampl = -4
freq = 120
phase = 120

[State 0, HitFallSet]
type = HitFallSet
trigger1 = 1
value = -1
;xvel =
yvel = 20
;ignorehitpause =
persistent = 0

[state 1225, changestate]
type = changestate
trigger1 = anim = 2625
;rigger1 = animelem >= 3
trigger1 = Vel Y > 0
trigger1 = Pos Y > 0
value = 1206


;-------------------------------------------------------------------------------
; Hyper Move: I am The Omnipresence  (Extintion)
[Statedef 2800]
type    = S
movetype= A
physics = S
poweradd = -3000
ctrl = 0
velset = 0,0
anim = 2800
sprpriority = 2

[State 2800, NotHitBy]
type = NotHitBy
trigger1 = 1
;trigger1 = animelem = 1, >=0
;trigger1 = animelem = 9, <0
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
;value2 = S,NA
time = 2
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999
;persistent = 0

[State 2800, PlaySnd]
type = PlaySnd
trigger1 = time = 0
value = S1,2
ignorehitpause = 1

[State 2800, PlaySnd]; ---- grasp circle
type = PlaySnd
trigger1 = Animelem = 1,=0
value = S8,14

;[State 2800, envcolor]
;type = envcolor
;trigger1 = Time = 0
;time = 40
;value = 0,0,0
;under = -1

[State 2800, BGPalFX]
type = BGPalFX
trigger1 = 1
time = 2
add = 0,0,0
mul = 0,0,0
;sinadd = 0,0,0,10
;invertall = 0
;color = 256
ignorehitpause = 1
;persistent =

[State 2800, superpause]
type = superpause
trigger1 = time = 0
time = 30
movetime = 0
anim = -1
darken = 0
p2defmul = 1
unhittable = 1
sound = S4,9

[State 2800, Explod]; ---- blood
type = Explod
trigger1 = animelem = 2
anim  = 2801
id = 2801
postype = p1
pos = 0,0
ignorehitpause = 1
ownpal = 1
removetime = -2
sprpriority = 3
bindtime = -1
scale = const(size.xscale), const(size.yscale) + ifelse(const(size.yscale) != 1, .008, 0)

[State 2800, Explod]; ---- XI_supermove_lv3
type = Explod
trigger1 = Time = 0
anim = 11001
pos = -86,-165
scale = 1
postype = p1
facing = 1
vfacing = 1
bindtime = 1
removetime = -2
supermove = 1
sprpriority = -1
ownpal = 1
removeongethit = 1

[State 2800, Explod]; ---- XI_supermove_lv3_foreground
type = Explod
trigger1 = Time = 0
anim = 11000
pos = -47,-130
scale = 1
postype = p1
facing = 1
vfacing = 1
bindtime = 1
removetime = -2
supermove = 1
sprpriority = 9
ownpal = 1
removeongethit = 1

[State 2800, Helper]; ---- HSDM hitdef helper
type = Helper
trigger1 = time = 0
ID = 2803
name = "HSDM hitdef helper"
postype = p2
facing = -1
pos = 0,0 ;-8,-108
sprpriority = 2
stateno = 2803
helpertype = normal
keyctrl = 0
ownpal = 1
bindtime = -1
size.xscale = const(size.yscale)
size.yscale = const(size.xscale)

[State 2800, Explod]; ---- XI_supermove_lv3_background
type = Explod
trigger1 = time = 0
anim = 10205
;pos = Ceil(2 * Const(size.xscale))-71,Ceil(-128 * Const(size.yscale))-33
pos = -86,-185
postype = p1
sprpriority = -1
removetime  = -2
removeongethit = 1
persistent = 0
ownpal = 1
supermovetime = -1

[State 2800, Explod]; ---- XI_supermove_lv3_foreground
type = Explod
trigger1 = time = 0
anim = 10206
pos = -47,-150
postype = p1
sprpriority = 3
removetime  = -2
removeongethit = 1
persistent = 0
ownpal = 1
supermovetime = -1

;------------------------------------------
[State 2800, Helper]
type = Helper
triggerall = !numhelper(20001)
trigger1 = time = 0
helpertype = normal
name = "02um HSDM BG"
ID = 20001
stateno = 20001
pos = 160,120
postype = left
facing = 1
keyctrl = 0
ownpal = 0
supermovetime = 999999999999
pausemovetime = 999999999999
ignorehitpause = 1

[State 2800, Helper]
type = Helper
triggerall = !numhelper(20003)
trigger1 = time = 0
helpertype = normal
name = "02um HSDM Portrait"
ID = 20003
stateno = 20003
pos = 160,120
postype = left
facing = 1
keyctrl = 0
ownpal = 0
supermovetime = 999999999999
pausemovetime = 999999999999
ignorehitpause = 1
;------------------------------------------

[State 2800, VarSet]
type = VarSet
trigger1 = projhit2803=1 ;helper(2803),movehit
fv = 13
value = helper(2803),pos X
ignorehitpause = 1
;persistent =

[State 2800, ChangeState]
type = ChangeState
trigger1 = projhit2803=1 ;helper(2803),movehit
value = 2801
ctrl = 0
;anim =
ignorehitpause = 1
;persistent =

[State 2800, ChangeState]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;-------------------------------------------------------------------------------
[Statedef 2801]
type = S
movetype = A
physics = S
juggle = 0
anim = 2802
poweradd = 0
ctrl = 0
Velset = 0,0
sprpriority = 2

[State 2801, Helper]
type = Helper
trigger1 = time = 0
trigger1 = !numhelper(2802)
helpertype = normal
name = "HSDM enemy helper"
ID = 2802
stateno = 2802
pos = 0,0
postype = p1
facing = 1
keyctrl = 0
ownpal = 1
supermove = 1
pausemove = 1
ignorehitpause = 1
supermovetime = 2147483647
pausemovetime = 2147483647

;------------------------------------------
[State 2801, Helper]
type = Helper
triggerall = !numhelper(20001)
trigger1 = time = 0
helpertype = normal
name = "02um HSDM BG"
ID = 20001
stateno = 20001
pos = 160,120
postype = left
facing = 1
keyctrl = 0
ownpal = 1
supermovetime = 999999999999
pausemovetime = 999999999999
ignorehitpause = 1

[State 2801, Helper]
type = Helper
triggerall = !numhelper(20003)
trigger1 = time = 0
helpertype = normal
name = "02um HSDM Portrait"
ID = 20003
stateno = 20003
pos = 160,120
postype = left
facing = 1
keyctrl = 0
ownpal = 1
supermovetime = 999999999999
pausemovetime = 999999999999
ignorehitpause = 1

;------------------------------------------
[State 2801, RemoveExplod]
type = RemoveExplod
trigger1 = time = 0
id = 2801
;ignorehitpause =
;persistent =

[State 2801, Explod]; ---- blood
type = Explod
trigger1 = animelem = 2
anim  = 2801
id = 2801
postype = p1
pos = 0,0
ignorehitpause = 1
ownpal = 1
removetime = -2
sprpriority = 3
bindtime = -1
scale = const(size.xscale), const(size.yscale) + ifelse(const(size.yscale) != 1, .008, 0)

[State 2801, Explod]; ---- ground sky
type = Explod
trigger1 = animelem = 1
anim  = 18101
id = 18101
postype = p1
pos = 0,0
ignorehitpause = 1
ownpal = 1
removetime = -1
sprpriority = -3
bindtime = -1
scale = const(size.xscale), const(size.yscale)

[State 2801, RemoveExplod]
type = RemoveExplod
trigger1 = animelem = 85
id = 18101
;ignorehitpause =
;persistent =

[State 2801, Explod]; ----  Back Light
type = Explod
trigger1 = animelem = 33
anim  = 18102
postype = p1
pos = 0,0
ignorehitpause = 1
ownpal = 1
;removetime = -1
sprpriority = -1
bindtime = -1
scale = const(size.xscale), const(size.yscale)
;------------------------------------------

[State 2801, TargetState]
type = TargetState
trigger1 = animelem = 26, <0
trigger1 = time%8 = 0
value = 2810
ignorehitpause = 1

[State 2801, Explod]; ---- soul up
type = Explod
trigger1 = animelem = 11
id = 2807
anim  = 2807
postype = p2
pos = 0,-80
ignorehitpause = 1
ownpal = 1
removetime = -2
sprpriority = 3
bindtime = -1

[State 2801, Explod]; ---- soul down
type = Explod
trigger1 = animelem = 25
id = 2808
anim  = 2808
postype = p1
pos = 41*const(size.xscale), -114*const(size.yscale);43,-122
ignorehitpause = 1
ownpal = 1
removetime = -2
sprpriority = 3
bindtime = -1

[State 2801, RemoveExplod]
type = RemoveExplod
trigger1 = animelem = 26
id = 2808
ignorehitpause = 1
;persistent =

[State 2801, Explod]; ---- soul destroy
type = Explod
trigger1 = animelem = 26
id = 2810
anim  = 2810
postype = p1
pos = 41*const(size.xscale), -114*const(size.yscale);43,-122
ignorehitpause = 1
ownpal = 1
removetime = -2
sprpriority = 3
bindtime = -1

[State 2801, TargetState]
type = TargetState
trigger1 = Animelem = 26
value = 2811
ignorehitpause = 1

[State 2801, TargetState]
type = TargetState
trigger1 = Animelem = 36
value = 2812
ignorehitpause = 1

[State 2801, TargetState]
type = TargetState
trigger1 = Animelem = 85
value = 2813
ignorehitpause = 1

[State 2801, TargetFacing]
type = null;TargetFacing
trigger1 = Animelem = 85
value = 1

[State 2801, PlaySnd]; ---- blood
type = PlaySnd
trigger1 = Animelem = 1,=0
value = S0,19

[State 2801, PlaySnd]; ---- grasp
type = PlaySnd
trigger1 = Animelem = 1,=0
value = S0,10

[State 2801, PlaySnd]; ---- soul up
type = PlaySnd
trigger1 = Animelem = 11,=0
value = S8,3

[state 195, playsnd]; ---- fist bone sound
type = playsnd
trigger1 = animelem = 12
trigger2 = animelem = 19
value = s0,38

[State 2801, PlaySnd]; ---- soul up
type = PlaySnd
trigger1 = Animelem = 25,=0
value = S8,0

[State 2801, PlaySnd]; ---- soul destroy voice
type = PlaySnd
trigger1 = Animelem = 25,=0
value = S1,5

[State 2801, PlaySnd]; ---- soul destroy
type = PlaySnd
trigger1 = Animelem = 26,=0
value = S0,32

[State 2801, PlaySnd]; ---- hands voice
type = PlaySnd
trigger1 = Animelem = 35,=0
value = S1,3

[State 2801, PlaySnd]; ---- power pillar
type = PlaySnd
trigger1 = Animelem = 35,=0
value = S0,334
pan = -50
volume = 255

[State 2801, PlaySnd]; ---- power pillar
type = PlaySnd
trigger1 = Animelem = 35,=5
value = S0,334
pan = 50
volume = 255

[State 2801, PlaySnd]; ---- sxplod end
type = PlaySnd
trigger1 = Animelem = 84,=40
value = S0,28

[State 2801, EnvShake]
type = EnvShake
trigger1 = time = 290
time = 150
ignorehitpause = 1

[State 2801, HitAdd]
type = HitAdd
trigger1 = Animelem = 26,=0
trigger2 = time = [290,440]
trigger2 = time%2=0
value = 1

[State 2801, HitAdd]
type = HitAdd
trigger1 = Time = 441
value = 3

[State 2801, TargetLifeAdd]
type = TargetLifeAdd
trigger1 = Animelem = 26,=0
value =  floor(-100*fvar(3))
kill = 0
absolute = 1

[State 2801, TargetLifeAdd]
type = TargetLifeAdd
trigger1 = time = [290,440]
value =  floor(-3*fvar(3))
kill = 0
absolute = 1

[State 2801, TargetLifeAdd]
type = TargetLifeAdd
trigger1 = Time = 441
value =  floor(-97*fvar(3))
kill = 1
absolute = 1

[State 2801, TargetDrop]
type = TargetDrop
trigger1 = Time = 500
excludeID = -1
keepone = 0
ignorehitpause =1

;---------------------------
[State 2801, VarSet]; ---- fvar(12) PalFX
type = VarSet
trigger1 = time = 0
fvar(12) = 30
persistent = 0

[State 2801, VarSet]; ---- fvar(12) PalFX
type = VarAdd
triggerall = time >= 390
triggerall = time < 430
trigger1 = fvar(12) > 0
fvar(12) = 5.6

[State 2801, VarSet]; ---- fvar(12) PalFX
type = VarSet
trigger1 = time >= 430
trigger1 = time <= 450
fvar(12) = 255

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = time >= 430
trigger1 = time <= 450
flag = globalnoshadow

[State 2801, VarSet]; ---- fvar(12) PalFX
type = VarAdd
triggerall = time >= 450
triggerall = time <= 460
trigger1 = fvar(12)-25 > 0
fvar(12) = -25

[State 2801, PalFX]; ---- PalFX overwrite
type = PalFX
trigger1 = time >= 390
trigger1 = time <= 460
time = 2
add = floor(fvar(12)),floor(fvar(12)),floor(fvar(12))
mul = 256,256,256
;sinadd = 0,0,0,10
;invertall = 0
;color = 256
ignorehitpause = 1
;persistent =

[State 2801, BGPalFX]
type = AllPalFX
trigger1 = time >= 390
trigger1 = time <= 460
time = 2
add = floor(fvar(12)),floor(fvar(12)),floor(fvar(12))
mul = 256,256,256
;sinadd = 0,0,0,10
;invertall = 0
;color = 256
ignorehitpause = 1
;persistent =
;---------------------------

[State 2801, PosAdd]
type = PosAdd
trigger1 = Animelem = 2,>= 0 && Animelem  = 8, < 0
x = -2

[State 2801, ChangeState]
type = ChangeState
trigger1 = Animtime = 0
value = 0
ctrl = 1

;-------------------------------------------------------------------------------
[StateDef 2802]
anim = 9999
ctrl = 0
type = A
sprpriority = 1

[State 2802, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA
time = -1
ignorehitpause = 1

[State 2802, PosSet]
type = PosSet
triggerall = ishelper
trigger1 = root,Animelem = 85, <0
x = floor(root,fvar(13))
y = -10
ignorehitpause = 1
persistent = 0

;---------------------------------
[State 2802, ChangeAnim]
type = ChangeAnim
trigger1 = ishelper
trigger1 = parent,Animelem = 31,=0
value = 2809
ignorehitpause = 1

[State 2802, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1
;persistent =

;---------------------------
[State 2802, Black]
type     = EnvColor
trigger1 = parent,Animelem = 31,>0
trigger1 = parent,Animelem = 85,<0
trigger1 = Time % 4 = 0
value    = 255, 255, 255
time     = 1
under    = 1

;--------------------------------
[State 2802, VarSet]; ---- fvar(11) AngleDraw
type = VarSet
trigger1 = ishelper
trigger1 = parent,Animelem = 31,=0
fvar(11) = 0.01
persistent = 0

[State 2802, VarSet]; ---- fvar(11) AngleDraw
type = VarAdd
trigger1 = ishelper
trigger1 = parent,Animelem = 31,>0
trigger1 = parent,Animelem = 85,<0
trigger1 = fvar(11) < 1.2
fvar(11) = 0.03

[State 2802, VarSet]; ---- fvar(11) AngleDraw
type = VarSet
trigger1 = ishelper
trigger1 = parent,Animelem = 31,>0
trigger1 = parent,Animelem = 85,<0
trigger1 = fvar(11) >= 1.2
fvar(11) = 1.2

[State 2802, VarSet]; ---- fvar(11) AngleDraw
type = Varadd
trigger1 = ishelper
trigger1 = parent,Animelem = 85,>=0
trigger1 = fvar(11) >= 0.1
fvar(11) = -0.04

[State 2802, VarSet]; ---- fvar(11) AngleDraw
type = Varadd
trigger1 = ishelper
trigger1 = parent,Animelem = 85,>=0
trigger1 = fvar(11) < 0.15
trigger1 = fvar(11) > 0.01
fvar(11) = -0.005

[State 2802, VarSet]; ---- fvar(11) AngleDraw
type = Varset
trigger1 = ishelper
trigger1 = parent,Animelem = 85,>=0
trigger1 = fvar(11) <= 0.01
fvar(11) = 0.01

[State 2802, AngleDraw]
type = AngleDraw
trigger1 = ishelper
trigger1 = parent,Animelem = 31,>=0
;value =  (winmugen only)
scale = fvar(11),2
ignorehitpause = 1
;persistent =

;------------------------------
[State 2802, Trans]
type = Trans
trigger1 = parent,Animelem = 85,<0
trigger2 = parent,Animelem = 85,>=0
trigger2 = fvar(11) > 0.005
trans = add1
;alpha =
ignorehitpause = 1
;persistent =

[State 2802, VarSet]; ---- fvar(12) Trans
type = VarSet
trigger1 = ishelper
fvar(12) = 255
persistent = 0

[State 2802, VarSet]; ---- fvar(12) Trans
type = VarAdd
trigger1 = ishelper
trigger1 = parent,Animelem = 85,>=0
trigger1 = fvar(11) <= 0.01
trigger1 = fvar(12) > 0
fvar(12) = -5

[State 2802, VarSet]; ---- fvar(12) Trans
type = VarSet
trigger1 = ishelper
trigger1 = parent,Animelem = 85,>=0
trigger1 = fvar(11) <= 0.01
trigger1 = fvar(12) <= 0
fvar(12) = 0

[State 2802, Trans]
type = Trans
trigger1 = parent,Animelem = 85,>=0
trigger1 = fvar(11) <= 0.01
trans = addalpha
alpha = floor(fvar(12)),255
ignorehitpause = 1
;persistent =

;------------------------------

;[State 2802, Explod]
;type = Explod
;trigger1 = ishelper
;trigger1 = parent,Animelem = 31,=0
;anim = 2809
;ID = 2809
;pos = 0,0
;postype = p1
;removetime = -2
;bindtime = -1
;supermovetime = 99999
;pausemovetime = 99999
;facing = 1
;shadow = 0
;ownpal = 1
;sprpriority = 5

;[State 2802, RemoveExplod]
;type = RemoveExplod
;trigger1 = ishelper
;trigger1 = root,time >= 290
;id = 2809
;ignorehitpause = 1

[State 2802, DestroySelf]
type = DestroySelf
trigger1 = parent,StateNo != 2801
trigger2 = parent,StateNo  = 2801
trigger2 = parent,time >= 540
ignorehitpause = 1

; HSDM hitdef helper -----------------------------------------------------------
[Statedef 2803]
type    = S
movetype= A
physics = S
poweradd = 0
ctrl = 0
velset = 0,0
anim = 2820
sprpriority = -4

[State 2803, HitOverRide]; ---- self hitoverride
type = Hitoverride
trigger1 = 1
slot = 3
attr = SCA, AA,AT,AP
stateno = 2705
ignorehitpause = 1

[State 2803, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA
time = -1
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999
persistent = 0

[State 0, PosSet]
type = PosSet
trigger1 = 1
y = 0
ignorehitpause = 1
;persistent =

[State 2803, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0
ignorehitpause = 1

[State 2803, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 2803, projectile]
type = Projectile
Trigger1 = time >= 0
Trigger1 = time < 30
ProjID = 2803
projanim = 2823   ;Defaults to 0 if omitted.
projhitanim = -1   ;when projectile hits the opponent. Defaults to -1 (no change in animation).
projremanim = -1   ;when projectile is removed (due to its time expiring or hitting its removal boundaries, etc.) Defaults to projhitanim.
projcancelanim = -1   ;when projectile is cancelled by hitting another projectile. Defaults to projremanim.
projscale = 1,1
projremove = 0    ;If nonzero, projectile be removed after it hits. Defaults to 1.
projremovetime = 1    ;number of ticks after which the projectile should be removed from the screen. Defaults to -1.
projshadow = 0,0,0   ;Specifies the R, G, and B components of the projectile's shadow.
velocity = 0,0
remvelocity = 0,0    ;velocities at which the projectile should travel while being removed.
accel = 0,0    ;acceleration
velmul = 1    ;projectile's velocity is multiplied by this multiplier on every tick. Default to 1.
projhits = 1    ;number of hits that projectile should be able to do before being removed. Defaults to 1.
projmiss = 0    ;specifies the least number of ticks that must elapse between multi-hits.
projpriority = 9999999    ;1 3 5 7 9 999 99999 9999999
projsprpriority = 3
projedgebound = 40    ;distance (in pixels) off the edge of the screen before the projectile is deleted. Defaults to 40.
projstagebound = 40
projheightbound = -240    ;the least and greatest y values the projectile is allowed to reach. Default to -240,1.
offset = 0,0
postype = p1         ;p2,front,back,left,right
supermovetime = 0    ;important while using SuperPause. 99999
pausemovetime = 0    ;important while using Pause. 99999
; ---- the following is HitDef content
attr = C,HT    ;SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
hitflag = HLFD    ;HLAFDP+-
guardflag = N    ;MHLA
getpower = 0,0
;givepower = 0,0
;affectteam = E    ;B,E,F
animtype = light    ;light,medium,hard,back,up,diagup
air.animtype = light    ;light,medium,hard,back,up,diagup
;fall.animtype = Back
priority = 4,Hit    ;Hit,Miss,Dodge 3 4 7 99999 9999999
damage = 0,0
pausetime = 0,0
;guard.pause ,0
sparkno = -1
guard.sparkno = -1
sparkxy = 0,0
hitsound = 0,0
guardsound = 0,0
ground.type = High      ;Hign,Low,Trip,None ;High/Low have no effect if Back, If hit from behind, High will be displayed Low
;air.type = High    ;Defaults to ground.type
ground.slidetime = 0    ;don't include pausetime ;applicable only to hits that keep P2 on the ground
;guard.slidetime = 0    ;Defaults to guard.hittime
ground.hittime = 0    ;Applicable only to hits that keep P2 on the ground ;Defaults to 0
;guard.hittime = 0        ;Defaults to ground.hittime
air.hittime = 20    ;has no effect if fall=1, default 20
;guard.ctrltime  = 0    ;Defaults to guard.slidetime
;airguard.ctrltime = 0
;guard.dist = 320    ;useful for trigger inguarddist
;yaccel = 0.5    ;y acceleration
ground.velocity = 0,0
;guard.velocity = 0    ;Defaults to x_velocity of ground.velocity
air.velocity = 0,0    ;Defaults to 0,0
;airguard.velocity = 0,0    ;Defaults to x_velocity*1.5, y_velocity/2 of air.velocity
;ground.cornerpush.veloff = 0    ;If arg1 of attr is "A", default value is 0. Otherwise,defaults to 1.3*guard.velocity.
;air.cornerpush.veloff = 0    ;Defaults to ground.cornerpush.velof
;down.cornerpush.veloff = 0    ;Defaults to ground.cornerpush.veloff
;guard.cornerpush.veloff = 0    ;Defaults to ground.cornerpush.veloff
;airguard.cornerpush.veloff = 0    ;Defaults to guard.cornerpush.veloff
;air.juggle = 0
;mindist = 0,0
;maxdist = 0,0
;snap = 0,0
sprpriority = 1
;p1sprpriority = 0;(winmugen only)
;p2sprpriority = 0;(winmugen only)
;p1facing = 0
p1getp2facing = 0
p2facing = 1
;p1stateno = 2801
p2stateno = 2810
;p2getp1state = 1
;forcestand = 0
fall = 1
fall.recover = 0
fall.recovertime = 4
;fall.xvelocity = 0    ;Defaults to no change
fall.yvelocity = -4.5    ;Defaults to -4.5
fall.damage = 0
air.fall = 0
air.fall.recover = 0
;down.velocity = 0,0    ;gethit while lying down ;Defaults to air.velocity
;down.hit
down.bounce = 0
id = 2800
;chainID = -1
;nochainID = -1
;hitonce = 1
kill = 1
guard.kill = 1
fall.kill = 1
numhits = 0
palfx.time = 0
;palfx.mul = 0,0,0
;palfx.add = 0,0,0
envshake.time = 0
;envshake.freq = 0
;envshake.ampl = 0
;envshake.phase = 0
fall.envshake.time = 0
;fall.envshake.freq = 0
;fall.envshake.ampl = 0
;fall.envshake.phase = 0
;(afterimage winmugen only)
afterimage.time = 0
;afterimage.length =
;afterimage.palcolor =
;afterimage.palinvertall =
;afterimage.palbright = 0,0,0
;afterimage.palcontrast = 0,0,0
;afterimage.palpostbright =0,0,0
;afterimage.paladd =  0,0,0
;afterimage.palmul = 0,0,0
;afterimage.timegap =
;afterimage.framegap =
;afterimage.trans = ;none,add,add1,addalpha,sub
;ignorehitpause =
;persistent =

[State 2803, ChangeAnim]
type = ChangeAnim
triggerall = anim = 2820
trigger1 = root,stateno = 2801
value = 2822
elem = AnimElemNo(0)
ignorehitpause = 1
;persistent =

[State 2803, PosSet]
type = PosSet
triggerall = ishelper
trigger1 = anim = 2822
x = floor(root,fvar(13))
y = 0
ignorehitpause = 1
persistent = 0

[State 2803, DestroySelf]
type = DestroySelf
trigger1 = anim = 2820
trigger1 = animtime = 0
trigger2 = anim = 2822
trigger2 = root,stateno = 2801
trigger2 = root,time >= 450
trigger3 = anim = 2822
trigger3 = root,stateno != [2800,2801]
trigger4 = MoveReversed
ignorehitpause = 1

;-------------------------------------------------------------------------------
[Statedef 2810]
type = S
movetype = H
physics = N
juggle = 0
ctrl = 0
sprpriority = 1

[State 2810, NotHitBy]
type = NotHitBy
trigger1 = ishelper
value = SCA
;value2 = S,NA
time = 1
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999
;persistent = 0

[State 2810, DestroySelf]
type = DestroySelf
trigger1 = ishelper
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999
;persistent = 0

[State 2810, Turn]
type = Turn
trigger1 = Time = 0
trigger1 = Enemynear(0),Name = "Orochi Eagrose Version"
trigger1 = facing*(Enemynear(0),facing)=1
trigger1 = Time = 0
trigger1 = Enemynear(1),Name = "Orochi Eagrose Version"
trigger1 = facing*(Enemynear(1),facing)=1
ignorehitpause = 1

[State 2810, VelSet]
type = VelSet
trigger1 = 1
x = 0
ignorehitpause =1

[State 2810, PosSet]
type = PosSet
trigger1 = 1
y = 0
ignorehitpause =1

[State 2810, ChangeAnim2]
type = ChangeAnim2
trigger1 = 1
value = 2803

[State 2810, Offset]
type = Offset
triggerall = 1
trigger1 = time%4=0
x = 0
ignorehitpause = 1
;persistent =

[State 2810, Offset]
type = Offset
triggerall = 1
trigger1 = time%4=1
x = 1
ignorehitpause = 1
;persistent =

[State 2810, Offset]
type = Offset
triggerall = 1
trigger1 = time%4=2
x = 0
ignorehitpause = 1
;persistent =

[State 2810, Offset]
type = Offset
triggerall = 1
trigger1 = time%4=3
x = -1
ignorehitpause = 1

[State 2810, PalFX]
type = PalFX
trigger1 = 1
time = 200
add = 0,0,100
mul = 250,250,250
sinadd = 200,200,100,5
invertall = 0
persistent = 0

[State 2810, SelfState]
type = SelfState
trigger1 = Time >= 300
value = 5050

;-------------------------------------------------------------------------------
[Statedef 2811]
type = S
movetype = H
physics = N
juggle = 0
ctrl = 0
Velset = 0,0
sprpriority = 1

[State 2811, PosSet]
type = PosSet
trigger1 = 1
y = 0
ignorehitpause =1

[State 2811, ChangeAnim2]
type = ChangeAnim2
trigger1 = !Time
value = 2804

[State 2811, Offset]
type = Offset
triggerall = 1
trigger1 = time%4=0
x = 0
ignorehitpause = 1
;persistent =

[State 2811, Offset]
type = Offset
triggerall = 1
trigger1 = time%4=1
x = 1
ignorehitpause = 1
;persistent =

[State 2811, Offset]
type = Offset
triggerall = 1
trigger1 = time%4=2
x = 0
ignorehitpause = 1
;persistent =

[State 2811, Offset]
type = Offset
triggerall = 1
trigger1 = time%4=3
x = -1
ignorehitpause = 1

[State 2811, PalFX]
type = PalFX
trigger1 = 1
time = 200
add = 0,0,100
mul = 250,250,250
sinadd = 200,200,100,5
invertall = 0
persistent = 0

;-------------------------------------------------------------------------------
[Statedef 2812]
type = A
movetype = H
physics = N
juggle = 0
ctrl = 0
Velset = 0,-.5
sprpriority = -1

[State 2812, PosSet]
type = Veladd
trigger1 = Vel Y >= -3
y = -.05
ignorehitpause =1

[State 2812, ChangeAnim2]
type = ChangeAnim2
trigger1 = !Time
value = 2806

[State 2812, Offset]
type = Offset
triggerall = 1
trigger1 = time%4=0
x = 0
ignorehitpause = 1
;persistent =

[State 2812, Offset]
type = Offset
triggerall = 1
trigger1 = time%4=1
x = 1
ignorehitpause = 1
;persistent =

[State 2812, Offset]
type = Offset
triggerall = 1
trigger1 = time%4=2
x = 0
ignorehitpause = 1
;persistent =

[State 2812, Offset]
type = Offset
triggerall = 1
trigger1 = time%4=3
x = -1
ignorehitpause = 1

[State 2812, PalFX]
type = PalFX
trigger1 = 1
time = 300
add = 50,50,50
mul = 250,250,250
sinadd = 150,150,150,10
invertall = 1
persistent = 0

;-------------------------------------------------------------------------------
[Statedef 2813]
type = A
movetype = H
physics = N
velset = -2.2,-20
sprpriority = -1

[State 2813, DestroySelf]
Type = DestroySelf
trigger1 = ishelper

[State 2813, AssertSpecial]
type = AssertSpecial
trigger1 = Vel Y < 0
flag = invisible
ignorehitpause = 1
;persistent =

[State 2813, ChangeAnim2]
type = ChangeAnim2
Trigger1 = Time = 0
value = 2805

[State 2813, PalFX]
type = PalFX
trigger1 = 1
time = 1
add = 50,50,50
mul = 250,250,250
sinadd = 150,150,150,10
invertall = 1
persistent = 0

[State 2813, VelAdd]
type = VelAdd
trigger1 = Time > 0
y = .6

[State 2813, EnvShake]
type = EnvShake
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
time = 16
ampl = 10
freq = 90
phase = 90
ignorehitpause = 1

[State 2813, LifeAdd]
type = null;LifeAdd
trigger1 = Pos Y >= 0
trigger1 = life <= 95
value = -1
absolute = 1
kill = 1

[State 2813, SelfState]
type = SelfState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
value = 5100


;===============================================================================
;UNKNOWN ULTIMATE MOVE : Time Stop
;made by Eagrose
;===============================================================================
[Statedef 3000]
type    = S
physics = S
movetype = I
anim = 3000
velset = 0,0
ctrl = 0
sprpriority = 2

[State 3000, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999
;persistent = 0

[State 3000, PosAdd]
type = NULL;PosAdd
trigger1 = frontEdgeDist < 60
x = -(70-frontEdgeDist)
;y = 0
ignorehitpause = 1
persistent = 0

[State 3000, VarSet]; ---- var(1) BGPALFX changing
type = VarSet
trigger1 = 1
var(1) = 0
persistent = 0
ignorehitpause = 1

[State 3000, VarAdd]; ---- var(1) BGPALFX changing
type = VarAdd
triggerall = var(1) < 255
trigger1 = AnimElem = 1, >= 0
trigger1 = AnimElem = 15, < 1
var(1) = 6

[State 3000, VarSet]; ---- var(1) BGPALFX changing
type = VarSet
trigger1 = var(1) > 255
var(1) = 255
ignorehitpause = 1

[State 3000, BGPalFX]
type = BGPalFX
trigger1 = AnimElem = 1, >= 0
trigger1 = AnimElem = 15, < 1
time = 1
add = var(1),var(1),var(1)
mul = 255,255,255
;sinadd = 0,0,0,10
invertall = 0
color = 256
ignorehitpause = 1

[State 3000, BGPalFX]
type = BGPalFX
trigger1 = AnimElem = 15, >= 1
time = 1
add = 0,0,0
mul = 255,255,255
;sinadd = 0,0,0,10
invertall = 1
color = 256
ignorehitpause = 1

[State 3000, AssertSpecial]
type = AssertSpecial
Trigger1 = 1
flag = nobardisplay
flag2 = timerfreeze
ignorehitpause = 1

[State 3000, AssertSpecial]
type = null;AssertSpecial
Trigger1 = AnimElem = 15, >=0
;Trigger1 = AnimElem = 15, <60
flag = noBG
flag2 = noFG
ignorehitpause = 1

[State 3000, SuperPause]
type = SuperPause
trigger1 = 1
time = 143
anim = -1
;sound =
;pos =
movetime = 143
darken = 0
p2defmul = 1
poweradd = 0;ifelse((((palno = 12) || ((palno=[7,11]) && var(58)=1 && floor(var(42)/10)%10=1)) && var(59)),0,-5000)
unhittable = 1
;endcmdbuftime = (winmugen only)
pausebg = 1 ;(winmugen only)
ignorehitpause = 1
persistent = 0

[State 3000, SuperPause]
type = SuperPause
trigger1 = animtime = 0
time = 540
anim = -1
;sound =
;pos =
movetime = 540
darken = 0
p2defmul = 1
poweradd = 0;ifelse((((palno = 12) || ((palno=[7,11]) && var(58)=1 && floor(var(42)/10)%10=1)) && var(59)),0,ifelse(fvar(6)!=-9999,0,-5000))
unhittable = 1
;endcmdbuftime = (winmugen only)
pausebg = 1 ;(winmugen only)
ignorehitpause = 1
persistent = 0

[State -2, Time Stop Time Counter Bar Reset]
type = VarSet
trigger1 = fvar(6) = -9999
trigger1 = stateno = 3000
trigger1 = animelem = 15
fv = 5
value = 1000.0
ignorehitpause = 1

[State -2, VarSet]
type = VarSet
trigger1 = stateno = 3000
trigger1 = animelem = 15
fv = 6
value = 1
;ignorehitpause =
persistent = 0

[State -2, VarSet]
type = VarSet
trigger1 = stateno = 3000
;trigger1 = animelem = 15
fv = 7
value = 1.0
;ignorehitpause =
persistent = 0

[State -2, VarSet];AI combo reset
type = VarSet
trigger1 = stateno = 3000
;trigger1 = animelem = 15
fv = 37
value = 0.0
;ignorehitpause =
persistent = 0

[State -2, VarSet];AI combo reset
type = VarSet
trigger1 = stateno = 3000
;trigger1 = animelem = 15
fv = 39
value = 0.0
;ignorehitpause =
persistent = 0

[State 3000, Helper]; ---- UNKNOWN ULTIMATE MOVE FLASH from mai_mvc2
type = Helper
Trigger1 = AnimElem = 15, >=0
helpertype = normal
stateno = 31030
ID = 31010
name = "UNKNOWN ULTIMATE MOVE FLASH from mai_mvc2"
pos = -2,-104
PosType = P1
ownpal = 1
supermovetime = 9999
pausemovetime = 9999
persistent = 0

[State 3000, PlaySnd]
type = PlaySnd
Trigger1 = AnimElem = 15, >=0
value = S9,1
ignorehitpause = 1
persistent = 0

[State 3000, Ultimate Move Screen helper]
Type = Helper
Trigger1 = AnimElem = 15, >=0
StateNo = 6300
ID = 6301
Name = "Ultimate Move Screen helper"
Pos = 0,0
PosType = P1
facing = 1
Ownpal = 1
SuperMoveTime = 999
PauseMoveTime = 999
persistent = 0

;-----------------------striker reset
[State -2, Striker Time Cooldown start]
type = VarSet
trigger1 = fvar(20) < var(40)/2
fv = 20
value = 0
ignorehitpause = 1
persistent = 0

[State -2, Striker Time Cooldown start]
type = VarSet
trigger1 = fvar(21) < var(40)/2
fv = 21
value = 0.0
ignorehitpause = 1
persistent = 0

[State -2, Striker Time Cooldown start]
type = VarSet
trigger1 = fvar(22) < var(40)/2
fv = 22
value = 0.0
ignorehitpause = 1
persistent = 0

[State -2, Striker Time Cooldown start]
type = VarSet
trigger1 = fvar(23) < var(40)/2
fv = 23
value = 0.0
ignorehitpause = 1
persistent = 0
;-----------------------

[State 3000, PlaySnd]
type = PlaySnd
trigger1 = animelem = 3, >=0
value = S1,4
persistent = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animTime = 0
value = S9,2
volume = 255
pan = 50

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animTime = 0
value = S9,2
volume = 255
pan = -50

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animTime = 0
value = S9,5
volume = 255
pan = 50
channel = 24

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animTime = 0
value = S9,5
volume = 255
pan = -50
channel = 25

[State 0, EnvColor]
type = EnvColor
trigger1 = animTime = 0
value = 0,0,0
time = 2
under = 1
;ignorehitpause =
;persistent =

[State 3000, ChangeState]
type = ChangeState
trigger1 = animTime = 0
value = 0
ctrl = 1


;===============================================================================
;Ultimate Team-Only Move : Orochi's Unholy Life
;made by Eagrose
;===============================================================================
[Statedef 4200]
type    = S
physics = S
movetype = I
anim = 0
velset = 0,0
ctrl = 0
sprpriority = 2

[State 4200, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999
;persistent = 0

[State 4200, Helper]
type = null;Helper
trigger1 = !Numhelper(4210)
helpertype = normal ;player
name = "Orochi's Unholy Life Reversaldef Helper"
ID = 4210
stateno = 4210
pos = 0,0
postype = p1    ;p2,front,back,left,right
facing = 1
keyctrl = 0
ownpal = 0
supermovetime = 99999
pausemovetime = 99999
ignorehitpause = 1

[State 4200, Helper]
type = Helper
trigger1 = !Numhelper(4211)
helpertype = normal ;player
name = "Orochi's Unholy Life Hitdef Helper"
ID = 4211
stateno = 4211
pos = 0,0
postype = p1    ;p2,front,back,left,right
facing = 1
keyctrl = 0
ownpal = 0
supermovetime = 99999
pausemovetime = 99999
ignorehitpause = 1

[State 4200, ChangeState]
type = ChangeState
trigger1 = Numhelper(4211)
value = 0
ctrl = 1


;-------------------------------------------------------------------------------
;Orochi's Unholy Life Reversaldef Helper
[Statedef 4210]
type    = S
physics = S
movetype = A
anim = 4210
velset = 0,0
ctrl = 0
sprpriority = 2

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
time = -1
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State 0, ReversalDef]
type = ReversalDef
trigger1 = 1
affectteam = F
reversal.attr = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT,AA,AP,AT
priority = 9999999, hit    ;;Hit,Miss,Dodge 3 4 7 99999 9999999
hitflag = HLMAFD
numhits = 0
sparkno = -1
hitsound = -1
p1stateno = 4215
p2stateno = 4216
guard.dist = 0
ID = 4200
ignorehitpause = 1

[State 0, DestroySelf]
type = DestroySelf
trigger1 = time >= 600
trigger2 = movereversed
trigger3 = !partner,alive
ignorehitpause = 1

;-------------------------------------------------------------------------------
;Orochi's Unholy Life Hitdef Helper
[Statedef 4211]
type    = S
physics = S
movetype = A
anim = 4210
velset = 0,0
ctrl = 0
sprpriority = 2

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
time = -1
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State 0, Hitdef]
type = Hitdef
trigger1 = time%3=0
affectteam = F
attr = SCA,HA
priority = 9999999, hit    ;;Hit,Miss,Dodge 3 4 7 99999 9999999
hitflag = HLMAFD
guardflag = N
numhits = 0
sparkno = -1
hitsound = -1
p1stateno = 4215
p2stateno = 4216
guard.dist = 0
hitonce = 1
ignorehitpause = 1

[State 0, Hitdef]
type = Hitdef
trigger1 = time%3=1
affectteam = F
attr = SCA,HT
priority = 9999999, hit    ;;Hit,Miss,Dodge 3 4 7 99999 9999999
hitflag = HLMAFD
guardflag = N
numhits = 0
sparkno = -1
hitsound = -1
p1stateno = 4215
p2stateno = 4216
guard.dist = 0
hitonce = 1
ignorehitpause = 1

[State 0, Hitdef]
type = Hitdef
trigger1 = time%3=2
affectteam = F
attr = SCA,HP
priority = 9999999, hit    ;;Hit,Miss,Dodge 3 4 7 99999 9999999
hitflag = HLMAFD
guardflag = N
numhits = 0
sparkno = -1
hitsound = -1
p1stateno = 4215
p2stateno = 4216
guard.dist = 0
hitonce = 1
ignorehitpause = 1

[State 0, DestroySelf]
type = DestroySelf
trigger1 = time >= 600
trigger2 = movereversed
trigger3 = !partner,alive
ignorehitpause = 1

;-------------------------------------------------------------------------------
;Infinit-target Helper 永续目标
;change with rather much CAUTION !!
;-------------------------------------------------------------------------------
[Statedef 4215]
type    = S
physics = S
movetype = I
anim = 9999
velset = 0,0
ctrl = 0
sprpriority = 2

[State 0, BindToRoot]
type = BindToRoot
trigger1 = 1
time = -1
facing = 1
pos = 0,0
ignorehitpause =  1

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
time = -1
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State 0, TargetDrop];Drop other helper target (for example shadow clone)
type = TargetDrop
trigger1 = Numtarget > 1
trigger2 = target,ishelper
keepone = 1
ignorehitpause = 1

[State 0, TargetDrop]
type = TargetDrop
trigger1 = IsHelper(4210)
trigger1 = !(target,ID = partner,ID)
keepone = 0
ignorehitpause = 1

[State 0, ChangeState]
type = ChangeState
triggerall = !win || !lose || !drawgame
trigger1 = IsHelper(4210)
trigger1 = !(target,ID = partner,ID)
value = 4210
ignorehitpause = 1

[State 0, TargetDrop]
type = TargetDrop
trigger1 = IsHelper(4211)
trigger1 = !(target,ID = partner,ID)
keepone = 0
ignorehitpause = 1

[State 0, ChangeState]
type = ChangeState
triggerall = !win || !lose || !drawgame
trigger1 = IsHelper(4211)
trigger1 = !(target,ID = partner,ID)
value = 4211
ignorehitpause = 1

[State 0, ReversalDef]
type = ReversalDef
trigger1 = 1
reversal.attr = SCA
priority = 9999999, hit    ;;Hit,Miss,Dodge 3 4 7 99999 9999999
hitflag = P
numhits = 0
sparkno = -1
hitsound = -1
guard.dist = 0
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

;------------------------------
;Soul binding
;------------------------------
[State 0, VarSet];tell explod
type = VarSet
trigger1 = 1
v = 31
value = 888
ignorehitpause = 1

[State 0, parentVarSet];varset determine self, only nightmare can resurrect self
type = parentVarSet
trigger1 = (parent,palno = 12) || ((parent,palno=[7,11]) && parent,var(58)=1 && floor(parent,var(42)/10)%10=1)
trigger1 = parent,var(30) = 0
var(30) = 1
ignorehitpause = 1

[State 0, SuperPause]
type = SuperPause
trigger1 = 1
time = 70
anim = -1
movetime = 70
darken = 0
p2defmul = 1
poweradd = 0
unhittable = 1
ignorehitpause = 1
persistent = 0

[State 3000, Helper]; ---- UNKNOWN ULTIMATE MOVE FLASH from mai_mvc2
type = Helper
Trigger1 = 1
helpertype = normal
stateno = 31030
ID = 31010
name = "UNKNOWN ULTIMATE MOVE FLASH from mai_mvc2"
;pos = IfElse(TeamSide=2,303,17),-146
pos = (160+floor(Partner,Pos X)),(Partner,Pos Y)-(parent,Pos Y)+(partner,const(size.mid.pos.y))
PosType = left
ownpal = 1
supermovetime = 9999
pausemovetime = 9999
persistent = 0

[State 3000, PlaySnd];suprepause snd
type = PlaySnd
Trigger1 = 1
value = S9,1
ignorehitpause = 1
persistent = 0

;------------------------------
;soul bind black pillar effect
;------------------------------
[State 3000, PlaySnd];soul stone sound
type = PlaySnd
trigger1 = time = 50
value = S9,6
volume = 100
pan = -50
ignorehitpause = 1
persistent = 0

[State 3000, PlaySnd];soul stone sound
type = PlaySnd
trigger1 = time = 50
value = S9,6
volume = 100
pan = 50
ignorehitpause = 1
persistent = 0

[State 0, Explod];self explod
type = Explod
trigger1 = (root,palno = 12) || ((root,palno=[7,11]) && root,var(58)=1 && floor(root,var(42)/10)%10=1)
anim = 4222
ID = 4223
pos = 0,0 ;165+floor(Parent,Pos X),220
postype = P1 ;left  ;p2,front,back,left,right
facing = 1
vfacing = 1
bindtime = -1
vel = 0,0
accel = 0,0
random = 0,0
removetime = 60
scale = 1,2
sprpriority = 3
ontop = 0
shadow = 0,0,0
ownpal = 1
removeongethit = 0
ignorehitpause = 1
supermove = 1
persistent = 0

[State 0, ModifyExplod];self explod change pos
type = ModifyExplod
triggerall = (root,palno = 12) || ((root,palno=[7,11]) && root,var(58)=1 && floor(root,var(42)/10)%10=1)
triggerall = time <= 60
trigger1 = NumExplod(4223)
ID = 4223
;pos = 165+floor(Parent,Pos X),220
;postype = left  ;p2,front,back,left,right
;facing = 1
;vfacing = 1
;bindtime = -1
;vel = 0,0
;accel = 0,0
;random = 0,0
;removetime = ifelse(-0.0167*time+1<0.5,0,-1)
scale = ifelse(-0.0167*time+1>=0,-0.0167*time+1,0.01),2
;sprpriority = 3
;ontop = 0
;shadow = 0,0,0
;ownpal = 1
;removeongethit = 0
ignorehitpause = 1
supermove = 1

[State 0, Explod];partner explod
type = Explod
trigger1 = 1
anim = 4222
ID = 4222
pos = 160+floor(Partner,Pos X),220
postype = left  ;p2,front,back,left,right
facing = 1
vfacing = 1
bindtime = -1
vel = 0,0
accel = 0,0
random = 0,0
removetime = 60
scale = 1,2
sprpriority = 3
ontop = 0
shadow = 0,0,0
ownpal = 1
removeongethit = 0
ignorehitpause = 1
supermove = 1
persistent = 0

[State 0, ModifyExplod];partner explod change pos
type = ModifyExplod
triggerall = time <= 60
trigger1 = NumExplod(4222)
ID = 4222
;pos = 160+floor(Partner,Pos X),220
;postype = left  ;p2,front,back,left,right
;facing = 1
;vfacing = 1
;bindtime = -1
;vel = 0,0
;accel = 0,0
;random = 0,0
;removetime = ifelse(-0.0167*time+1<0.5,0,-1)
scale = ifelse(-0.0167*time+1>=0,-0.0167*time+1,0.01),2
;sprpriority = 3
;ontop = 0
;shadow = 0,0,0
;ownpal = 1
;removeongethit = 0
ignorehitpause = 1
supermove = 1

[State 0, VarSet]
type = VarSet
trigger1 = 1
v = 10
value = 0
ignorehitpause = 1
persistent = 0

;------------------------------
;Resurrection
;------------------------------
[State 0, SuperPause];Resurrect pause
type = SuperPause
triggerall = var(10) = 0
trigger1 = partner,life = 0
trigger2 = partner,life = [0,1]
trigger2 = Partner,AuthorName = "GONZO-,Eagrose"
trigger2 = Partner,Name = "Igniz Eagrose Version"
trigger2 = Partner,alive
trigger2 = Partner,var(39) = 1
trigger2 = partner,NumHelper(4211)
time = 60
anim = -1
movetime = 60
darken = 0
p2defmul = 1
poweradd = 0
unhittable = 1
ignorehitpause = 1

[State 0, VarSet];varset determine partner
type = VarSet
triggerall = var(10) = 0
trigger1 = partner,life = 0
trigger2 = partner,life = [0,1]
trigger2 = Partner,AuthorName = "GONZO-,Eagrose"
trigger2 = Partner,Name = "Igniz Eagrose Version"
trigger2 = Partner,alive
trigger2 = Partner,var(39) = 1
trigger2 = partner,NumHelper(4211)
var(10) = 1
ignorehitpause = 1

[State 3000, PlaySnd]
type = PlaySnd
triggerall = var(10) = 1
trigger1 = partner,life = 0
trigger2 = partner,life = [0,1]
trigger2 = Partner,AuthorName = "GONZO-,Eagrose"
trigger2 = Partner,Name = "Igniz Eagrose Version"
;trigger2 = Partner,alive
;trigger2 = Partner,var(39) = 1
;trigger2 = partner,NumHelper(4211)
value = S9,7
volume = 100
pan = -50
ignorehitpause = 1
persistent = 0

[State 3000, PlaySnd]
type = PlaySnd
triggerall = var(10) = 1
trigger1 = partner,life = 0
trigger2 = partner,life = [0,1]
trigger2 = Partner,AuthorName = "GONZO-,Eagrose"
trigger2 = Partner,Name = "Igniz Eagrose Version"
;trigger2 = Partner,alive
;trigger2 = Partner,var(39) = 1
;trigger2 = partner,NumHelper(4211)
value = S9,7
volume = 100
pan = 50
ignorehitpause = 1
persistent = 0

[State 0, Explod];resurrect explod
type = Explod
triggerall = var(10) = 1
trigger1 = partner,life = 0
trigger2 = partner,life = [0,1]
trigger2 = Partner,AuthorName = "GONZO-,Eagrose"
trigger2 = Partner,Name = "Igniz Eagrose Version"
;trigger2 = Partner,alive
;trigger2 = Partner,var(39) = 1
;trigger2 = partner,NumHelper(4211)
anim = 4221
ID = 4220
;pos = 160+floor(Partner,Pos X),floor(Partner,Pos Y)+240
pos = floor(Partner,ScreenPos X),floor(Partner,ScreenPos Y)
postype = left  ;p2,front,back,left,right
facing = 1
vfacing = 1
bindtime = 1
vel = 0,0
accel = 0,0
random = 0,0
removetime = -2
scale = 2.5,1.5
sprpriority = 2
ontop = 0
shadow = 0,0,0
ownpal = 1
removeongethit = 0
ignorehitpause = 1
supermove = 1
persistent = 0

[State 0, BGPalFX]
type = BGPalFX
triggerall = var(10) = 1
trigger1 = partner,life = 0
trigger2 = partner,life = [0,1]
trigger2 = Partner,AuthorName = "GONZO-,Eagrose"
trigger2 = Partner,Name = "Igniz Eagrose Version"
;trigger2 = Partner,alive
;trigger2 = Partner,var(39) = 1
;trigger2 = partner,NumHelper(4211)
time = 60
add = 0,0,0
mul = 50,50,50
sinadd = 0,0,0,0
invertall = 0
color = 256
ignorehitpause = 1
persistent = 0

[State 0, TargetState];Resurrection
type = TargetState
triggerall = var(10) = 1
trigger1 = partner,life = 0
trigger2 = partner,life = [0,1]
trigger2 = Partner,AuthorName = "GONZO-,Eagrose"
trigger2 = Partner,Name = "Igniz Eagrose Version"
;trigger2 = Partner,alive
;trigger2 = Partner,var(39) = 1
;trigger2 = partner,NumHelper(4211)
value = 4230
ignorehitpause =  1

[State 0, AssertSpecial];debug
type = AssertSpecial
triggerall = var(10) = 1
trigger1 = partner,life < floor(partner,lifemax/2)
flag = noko
ignorehitpause = 1

[State 0, TargetLifeAdd];debug
type = TargetLifeAdd
triggerall = var(10) = 1
trigger1 = partner,life < floor(partner,lifemax/2)
value = floor(partner,lifemax/2)-1
kill = 0
absolute = 1
ignorehitpause = 1

[State 0, TargetState];resist mugen dead when in 0/5050
type = null;TargetState
trigger1 = roundstate = 2
trigger1 = !partner,alive
trigger1 = partner,life > 0
trigger1 = partner,stateno = 5050
value = 4240
ignorehitpause =  1

[State 0, TargetState];resist mugen dead when in 5150
type = null;TargetState
trigger1 = roundstate = 2
trigger1 = !partner,alive
trigger1 = partner,life > 0
trigger1 = partner,stateno = 5150
value = 5120
ignorehitpause =  1

[State 0, TargetState];Resurrect winko
type = null;TargetState
trigger1 = winko
trigger1 = partner,life > 0
trigger1 = partner,ctrl
trigger1 = partner,pos Y = 0
value = 4241
ignorehitpause =  1

[State 0, VarSet];varset complete
type = VarSet
trigger1 = var(10) = 1
var(10) = 2
ignorehitpause = 1

;------------------------------
;useful DEBUG
;------------------------------
[State 0, AssertSpecial]; ---- DO NOT CHANGE THIS!!!
type = AssertSpecial
triggerall = !((win || lose || drawgame) && roundstate = 2)
trigger1 = parent,var(29) = 1
flag = noko
ignorehitpause =  1

;------------------------------
;DEBUG
;this var is transfering helper's var(10) to parent's var(32)
;then continue transfer to partner, if partner is Igniz-EV
;because MUGEN does not allow twice time of redirection. (such as partner,helper(xxx),XXX)
;------------------------------
[State 0, VarSet];Parent-varset
type = ParentVarSet
trigger1 = var(10) = 0
var(32) = 0
ignorehitpause = 1

[State 0, VarSet];Parent-varset
type = ParentVarSet
trigger1 = var(10) = 1
var(32) = 1
ignorehitpause = 1

[State 0, VarSet];Parent-varset
type = ParentVarSet
trigger1 = var(10) = 2
var(32) = 2
ignorehitpause = 1

[State 0, HitAdd];Infinite-Target hitadd not reset DEBUG
type = HitAdd
trigger1 = 1
value = -999
ignorehitpause = 1

[State 0, TargetDrop];End Infinite-Target when already win/lose
type = TargetDrop
trigger1 = win || lose || drawgame
excludeID = -1
keepone = 0
ignorehitpause = 1

[State 0, DestroySelf]
type = DestroySelf
trigger1 = win || lose || drawgame
ignorehitpause = 1

;-------------------------------------------------------------------------------
;Infinit-target Helper P2stateno
[Statedef 4216]
type    = U
physics = U
movetype = H
anim = -1
velset = 0,0
ctrl = 0
sprpriority = -1

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
time = 1
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State 0, RemoveExplod]; ---- Reversaled helper debug
type = RemoveExplod
trigger1 = isHelper
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State 0, DestroySelf]; ---- Reversaled helper debug
type = DestroySelf
trigger1 = isHelper
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State 0, SelfState]
type = SelfState
triggerall = statetype = A
trigger1 = time >= 1
value = 5210
ctrl = 1
ignorehitpause = 0

[State 0, SelfState]
type = SelfState
triggerall = statetype != A
trigger1 = time >= 1
value = 5201
ctrl = 1
ignorehitpause = 0

;-------------------------------------------------------------------------------
;Resurrection P2stateno
[Statedef 4230]
type    = U
physics = U
movetype = I
anim = -1
velset = 0,0
ctrl = 0
sprpriority = -1

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
time = 2
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State 0, PalFX]
type = PalFX
trigger1 = 1
time = 10
add = 125,125,0
mul = 256,256,256
;sinadd = 100,100,0,9
invertall = 0
color = 256
ignorehitpause = 1
persistent = 0

[State 0, SuperPause]
type = SuperPause
trigger1 = 1
time = 2
anim = -1
movetime = 2
darken = 1
p2defmul = 1
poweradd = 0
unhittable = 1
ignorehitpause = 1
persistent = 0

[State 0, LifeSet]
type = LifeSet
trigger1 = life < floor(lifemax/2)
value = floor(lifemax/2)
ignorehitpause = 1

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = !alive
trigger2 = life < floor(lifemax/2)
flag = noko
flag2 = timerfreeze
ignorehitpause =  1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = 1
value = S11,0
channel = 0
persistent = 0

[State 0, ChangeState]
type = ChangeState
triggerall = life >= floor(lifemax/2)
triggerall = statetype = A
trigger1 = time >= 1
value = 4251
ignorehitpause = 0

[State 0, ChangeState]
type = ChangeState
triggerall = life >= floor(lifemax/2)
triggerall = statetype != A
trigger1 = time >= 1
value = 4250
ignorehitpause = 0

;-------------------------------------------------------------------------------
;Resurrection self
[Statedef 4231]
type    = U
physics = U
movetype = I
anim = -1
velset = 0,0
ctrl = 0
sprpriority = -1

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
time = 2
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State 0, PalFX]
type = PalFX
trigger1 = 1
time = 1
add = 125,125,0
mul = 256,256,256
;sinadd = 100,100,0,9
invertall = 0
color = 256
ignorehitpause = 1

[State 0, BGPalFX]
type = BGPalFX
trigger1 = 1
time = 2
add = 0,0,0
mul = 50,50,50
sinadd = 0,0,0,0
invertall = 0
color = 256
ignorehitpause = 1

[State 0, SuperPause]
type = SuperPause
trigger1 = 1
time = 2
anim = -1
movetime = 2
darken = 1
p2defmul = 1
poweradd = 0
unhittable = 1
ignorehitpause = 1
persistent = 0

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = 1
value = -1
elem = -1
ignorehitpause = 1

[State 0, VarSet];varset determine
type = VarSet
trigger1 = var(30) = 1
var(30) = 2
ignorehitpause = 1

[State 0, SuperPause];Resurrect pause
type = SuperPause
trigger1 = 1
time = 60
anim = -1
movetime = 60
darken = 0
p2defmul = 1
poweradd = 0
unhittable = 1
ignorehitpause = 1
persistent = 0

[State 3000, PlaySnd]
type = PlaySnd
trigger1 = 1
value = S9,7
volume = 100
pan = -50
ignorehitpause = 1
persistent = 0

[State 3000, PlaySnd]
type = PlaySnd
trigger1 = 1
value = S9,7
volume = 100
pan = 50
ignorehitpause = 1
persistent = 0

[State 0, Explod];resurrect explod
type = Explod
trigger1 = 1
anim = 4221
ID = 4231
;pos = 160+floor(Pos X),floor(Pos Y)+240
;postype = left  ;p2,front,back,left,right
pos = 0,0
postype = p1  ;p2,front,back,left,right
facing = 1
vfacing = 1
bindtime = 1
vel = 0,0
accel = 0,0
random = 0,0
removetime = -2
scale = 2.5,1.5
sprpriority = 2
ontop = 0
shadow = 0,0,0
ownpal = 1
removeongethit = 0
ignorehitpause = 1
supermove = 1
persistent = 0

[State 0, LifeSet]
type = LifeSet
trigger1 = life < floor(lifemax/2)
value = floor(lifemax/2)
ignorehitpause = 1

[State 0, LifeSet]
type = null;LifeAdd
trigger1 = life < floor(lifemax/2)
value = floor(lifemax/2)
absolute = 1
ignorehitpause = 1

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = !alive
trigger2 = life < floor(lifemax/2)
flag = noko
flag2 = timerfreeze
ignorehitpause =  1

[State 0, SelfState]
type = SelfState
triggerall = life >= floor(lifemax/2)
triggerall = statetype = A
trigger1 = time >= 60
value = 5210
ctrl = 1
ignorehitpause = 0

[State 0, SelfState]
type = SelfState
triggerall = life >= floor(lifemax/2)
triggerall = statetype != A
trigger1 = time >= 60
value = 5201
ctrl = 1
ignorehitpause = 0


;-------------------------------------------------------------------------------
;resist mugen dead when in 0/5050
[Statedef 4240]
type    = U
physics = U
movetype = I
anim = 0
velset = 0,0
ctrl = 0
sprpriority = -1

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = 1
value = 0
ignorehitpause = 1
persistent = 0

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
time = 1
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State 0, PosSet]
type = PosSet
trigger1 = 1
y = 0
ignorehitpause = 1

[State 0, SelfState]
type = SelfState
trigger1 = roundstate = 2
trigger1 = life > 0
value = 20
ctrl = 1
ignorehitpause = 1

[State 0, SelfState]
type = SelfState
trigger1 = roundstate > 2
value = 5050
ignorehitpause = 1

;-------------------------------------------------------------------------------
;Resurrect winko
[Statedef 4241]
type    = U
physics = U
movetype = I
anim = 0
velset = 0,0
ctrl = 0
sprpriority = 0

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = 1
value = 0
ignorehitpause = 1
persistent = 0

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
time = 1
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State 0, SelfState]
type = SelfState
trigger1 = 1
value = 180
ctrl = 0
ignorehitpause = 1


;---------------------------------------------------------------------
; HIT_FALLRECOVER (on the ground)
[Statedef 4250]
type = S
physics = N
movetype = I
anim = -1
ctrl = 0

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = SelfAnimExist(5200)
trigger1 = anim != 5200
value = 5200
ignorehitpause = 1

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = !SelfAnimExist(5200)
trigger1 = anim != 5030
value = 5030
ignorehitpause = 1

[State 5201, NotHitBy]
type = NotHitBy
trigger1 = 1
time = 2
value = SCA
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State 5201, PalFX] ;Blink white
type = PalFX
trigger1 = Time = 0
time = 3
add = 125,125,0

[State 5201, Turn] ;Turn if not facing opponent
type = Turn
trigger1 = Time = 0
trigger1 = p2dist X < -5

[State 5201, VelSet]
type = VelSet
trigger1 = Time = 0
x = -3
y = 0

[State 5201, VelSet]
type = VelSet
trigger1 = Time > 13
trigger1 = Vel X >= 0
x = 0
y = 0

[State 5201, PosSet]
type = PosSet
trigger1 = Time = 0
y = 0

[State 5201, SelfState]
type = SelfState
trigger1 = AnimTime = 0
value = 120
ctrl = 1

;---------------------------------------------------------------------------
; HIT_AIRFALLRECOVER
[Statedef 4251]
type    = A
movetype= I
physics = N
anim = -1
ctrl = 0

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = SelfAnimExist(5210)
trigger1 = anim != 5210
value = 5210
ignorehitpause = 1

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = !SelfAnimExist(5210)
trigger1 = anim != 5030
value = 5030
ignorehitpause = 1

[State 5210, PalFX] ;Blink white
type = PalFX
trigger1 = Time = 0
time = 3
add = 128,128,128 ;256,256,256

[State 5210, PosFreeze]
type = PosFreeze
trigger1 = Time = 0
value = 4

[State 5210, 2] ;Turn if not facing opponent
type = Turn
trigger1 = Time = 0
trigger1 = p2dist X < -20

[State 5210, 1]
type = VelMul
trigger1 = Time = 4
x = .8
y = .8

[State 5210, 1]
type = VelAdd
trigger1 = Time = 4
y = -4.5

[State 5210, 1]
type = VelMul
trigger1 = Time = 4
trigger1 = Vel Y > 0
y = .5

[State 5210, 1]
type = VelAdd
trigger1 = Time = 4
trigger1 = Vel Y > -3
y = -2

[State 5210, 1]
type = VelAdd
trigger1 = Time = 4
trigger1 = Vel Y > -2
y = -1

[State 5210, NotHitBy]
type = NotHitBy
trigger1 = 1
time = 2
value = SCA
ignorehitpause = 1
supermovetime = 99999
pausemovetime = 99999

[State 5210, VelAdd]
type = VelAdd;Gravity
trigger1 = Time >= 4
y = .35

[State 5210, SelfState] ;Land on ground
type = SelfState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
value = 120 ;JUMP_LAND
ctrl = 1

