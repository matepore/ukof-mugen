;===========================================================================================================================
;Orochi Eagrose Version, AI by Eagrose
;CNS file part: States that are executed when in self's state file (use statedef -3)
;===========================================================================================================================
[Statedef -3]

;===========================================================================================================================
;Player AI Option
;===========================================================================================================================
[State -3, infinite combo until p2 is nearly dead then ended with hypermoves];永久无限连
type = null;varset     ;<=== if you want orochi AI to perform infinite Light Kick combo, change null to varset.
TriggerAll = var(59)
TriggerAll = fvar(39) >= 3
Trigger1 = EnemyNear(floor(fvar(36))),life >= 100
fvar(39)= 2
ignorehitpause = 1



[State -3, AI Supernatual Reacting Level 1-12];AI超反应等级 1-13
Type = VarSet
triggerAll = !IsHelper
TriggerAll = !var(59)
TriggerAll = RoundState = [1,2]             ;1 - intro, 2 - Fight
Trigger1  = Command = "AI0"  || Command = "AI1"  || Command = "AI2"
Trigger2  = Command = "AI3"  || Command = "AI4"  || Command = "AI5"
Trigger3  = Command = "AI6"  || Command = "AI7"  || Command = "AI8"
Trigger4  = Command = "AI9"  || Command = "AI10" || Command = "AI11"
Trigger5  = Command = "AI12" || Command = "AI13" || Command = "AI14"
Trigger6  = Command = "AI15" || Command = "AI16" || Command = "AI17"
Trigger7  = Command = "AI18" || Command = "AI19" || Command = "AI20"
Trigger8  = Command = "AI21" || Command = "AI22" || Command = "AI23"
Trigger9  = Command = "AI24" || Command = "AI25" || Command = "AI26"
Trigger10 = Command = "AI27" || Command = "AI28" || Command = "AI29"
Trigger11 = Command = "AI30" || Command = "AI31" || Command = "AI32"
Trigger12 = Command = "AI33" || Command = "AI34" || Command = "AI35"   ;前36条件用于command型 AI开关，当按下人类无法按出的指令的时候触发
Trigger13 = numhelper(96600)   ;helper共享所有根人物的-1 -2 -3 state，helper能收到键盘指令但收不到CPU指令
Trigger13 = helper(96600),var(59)
trigger14 = ishometeam      ;in arcade, CPU always ishometeam
trigger14 = (teamside>1) || (matchno>1)
;trigger15 = 1     ;常rAI起
var(59) = 12       ;var(59) AI超反应等级 1-13
ignorehitpause = 1
;AI Level
;Range 1 - 12, 13
;Note: level 13 is not suggested, it will cause AI to be very defensive.


;===========================================================================================================================
;论外
;===========================================================================================================================
;=====================论外=====================
[State 0, Helper];混线检测、全局当身+永续target、NOKO保持、抵抗变数弄
type = Helper
TriggerAll = !IsHelper ; ---- Not Shadow Clone Igniz
triggerall = !numhelper(701100)
trigger1 = 1
;trigger3 = stateno = 0 && ctrl = 0
helpertype = player
name = "God Orochi Core Helper"
ID = 701100
stateno = 701100
pos = 0,0
postype = p1    ;p2,front,back,left,right
facing = 1
keyctrl = 0
ownpal = 0
supermovetime = 2147483646
pausemovetime = 2147483646
ignorehitpause = 1

;--------------------------------------
[State -2, VarSet];抵抗palno弄
type = VarSet
triggerall = Name = "Orochi Eagrose Version"
triggerall = AuthorName = "Orochi Herman,Eagrose"
triggerall = !ishelper
triggerall = roundstate = 0
trigger1 = roundno = 1
trigger1 = palno = 12
var(51) = 6666
ignorehitpause = 1

[State -2, VarSet];抵抗palno弄 本体遭到变数弄检测
type = VarSet
triggerall = Name = "Orochi Eagrose Version"
triggerall = AuthorName = "Orochi Herman,Eagrose"
triggerall = !ishelper
triggerall = roundstate > 0
trigger1 = var(51) != 0
trigger1 = var(51) != 6666
var(51) = 6666
ignorehitpause = 1

[State -2, VarSet];抵抗palno弄 Helper开幕占有变数弄抵抗
type = VarSet
triggerall = Name = "Orochi Eagrose Version"
triggerall = AuthorName = "Orochi Herman,Eagrose"
triggerall = !ishelper
triggerall = roundstate > 0
trigger1 = !numhelper(701100)
trigger2 = numhelper(701100)
trigger2 = helper(701100),stateno!=701100
trigger3 = numhelper(701100)
trigger3 = helper(701100),stateno=701100
trigger3 = helper(701100),var(51)=6666
var(51) = 6666
ignorehitpause = 1

;--------------------------------------
[State 0, Helper];OTHK受体
type = Helper
Triggerall = (var(51)=6666 && var(58)=1 && var(42)%10=1) || ((!numhelper(701100) || (numhelper(701100) && helper(701100),stateno!=701100)) && stateno != 5900)
TriggerAll= !IsHelper ; ---- Not Shadow Clone Igniz
triggerall = !numhelper(701110)
trigger1 = 1
helpertype = player
name = "OTHK hitoverride"
ID = 701110
stateno = 701110
pos = 0,0
postype = p1    ;p2,front,back,left,right
facing = 1
keyctrl = 0
ownpal = 0
supermovetime = 2147483646
pausemovetime = 2147483646
ignorehitpause = 1
persistent = 0

[State 0, Helper];混线矛A
type = Helper
Triggerall = (var(51)=6666 && var(58)=1 && var(42)%10=1) || ((!numhelper(701100) || (numhelper(701100) && helper(701100),stateno!=701100)) && stateno != 5900)
TriggerAll= !IsHelper ; ---- Not Shadow Clone Igniz
triggerall = !numhelper(702210)
trigger1 = 1
helpertype = player
name = "Wild Pointer Attacker A"
ID = 702210
stateno = 702210
pos = 0,0
postype = p1    ;p2,front,back,left,right
facing = 1
keyctrl = 0
ownpal = 0
supermovetime = 2147483646
pausemovetime = 2147483646
ignorehitpause = 1

[State 0, Helper];混线矛B
type = Helper
Triggerall = (var(51)=6666 && var(58)=1 && var(42)%10=1) || ((!numhelper(701100) || (numhelper(701100) && helper(701100),stateno!=701100)) && stateno != 5900)
TriggerAll= !IsHelper ; ---- Not Shadow Clone Igniz
triggerall = !numhelper(702220)
trigger1 = 1
helpertype = player
name = "Wild Pointer Attacker B"
ID = 702220
stateno = 702220
pos = 0,0
postype = p1    ;p2,front,back,left,right
facing = 1
keyctrl = 0
ownpal = 0
supermovetime = 2147483646
pausemovetime = 2147483646
ignorehitpause = 1

[State 0, Helper];混线矛C
type = Helper
Triggerall = (var(51)=6666 && var(58)=1 && var(42)%10=1) || ((!numhelper(701100) || (numhelper(701100) && helper(701100),stateno!=701100)) && stateno != 5900)
TriggerAll= !IsHelper ; ---- Not Shadow Clone Igniz
triggerall = !numhelper(702230)
trigger1 = 1
helpertype = player
name = "Wild Pointer Attacker C"
ID = 702230
stateno = 702230
pos = 0,0
postype = p1    ;p2,front,back,left,right
facing = 1
keyctrl = 0
ownpal = 0
supermovetime = 2147483646
pausemovetime = 2147483646
ignorehitpause = 1

[State 0, Helper];混线矛D
type = Helper
Triggerall = (var(51)=6666 && var(58)=1 && var(42)%10=1) || ((!numhelper(701100) || (numhelper(701100) && helper(701100),stateno!=701100)) && stateno != 5900)
TriggerAll= !IsHelper ; ---- Not Shadow Clone Igniz
triggerall = !numhelper(702240)
trigger1 = 1
helpertype = player
name = "Wild Pointer Attacker D"
ID = 702240
stateno = 702240
pos = 0,0
postype = p1    ;p2,front,back,left,right
facing = 1
keyctrl = 0
ownpal = 0
supermovetime = 2147483646
pausemovetime = 2147483646
ignorehitpause = 1

[State 0, Helper];混线矛E
type = Helper
Triggerall = (var(51)=6666 && var(58)=1 && var(42)%10=1) || ((!numhelper(701100) || (numhelper(701100) && helper(701100),stateno!=701100)) && stateno != 5900)
TriggerAll= !IsHelper ; ---- Not Shadow Clone Igniz
triggerall = !numhelper(702250)
trigger1 = 1
helpertype = player
name = "Wild Pointer Attacker E"
ID = 702250
stateno = 702250
pos = 0,0
postype = p1    ;p2,front,back,left,right
facing = 1
keyctrl = 0
ownpal = 0
supermovetime = 2147483646
pausemovetime = 2147483646
ignorehitpause = 1

[State 0, Helper];混线矛F
type = null;Helper
Triggerall = (var(51)=6666 && var(58)=1 && var(42)%10=1) || ((!numhelper(701100) || (numhelper(701100) && helper(701100),stateno!=701100)) && stateno != 5900)
TriggerAll= !IsHelper ; ---- Not Shadow Clone Igniz
triggerall = !numhelper(702260)
trigger1 = 1
helpertype = player
name = "Wild Pointer Attacker F"
ID = 702260
stateno = 702260
pos = 0,0
postype = p1    ;p2,front,back,left,right
facing = 1
keyctrl = 0
ownpal = 0
supermovetime = 2147483646
pausemovetime = 2147483646
ignorehitpause = 1

;-----------------------------------------
[State -2, VarSet];本体变数弄检测
type = VarSet
triggerall = Name = "Orochi Eagrose Version"
triggerall = AuthorName = "Orochi Herman,Eagrose"
triggerall = roundno > 1
triggerall = !ishelper
triggerall = var(58) != [0,2]
trigger1 = roundstate <= 2
trigger2 = !lose
var(58) = 1
ignorehitpause = 1

[State -2, VarSet];本体变数弄检测
type = VarSet
triggerall = Name = "Orochi Eagrose Version"
triggerall = AuthorName = "Orochi Herman,Eagrose"
triggerall = !ishelper
triggerall = var(58) != [0,2]
trigger1 = roundstate > 2
trigger1 = lose
var(58) = 2
ignorehitpause = 1

[State -2, VarSet];Helper开幕占有变数弄抵抗
type = VarSet
triggerall = Name = "Orochi Eagrose Version"
triggerall = AuthorName = "Orochi Herman,Eagrose"
triggerall = roundno > 1
triggerall = !ishelper
trigger1 = !numhelper(701100)
trigger2 = numhelper(701100)
trigger2 = helper(701100),stateno!=701100
trigger3 = numhelper(701100)
trigger3 = helper(701100),stateno=701100
trigger3 = helper(701100),var(58)=9999
var(58) = 1
ignorehitpause = 1
;-----------------------------------------

[State 0, ChangeState]
type = ChangeState
triggerall = roundstate <4
triggerall = roundstate >1
Trigger1 = (var(51)=6666 && var(58)=1 && var(42)%10=1) || ( (!numhelper(701100) || (numhelper(701100) && helper(701100),stateno!=701100)) && stateno != 5900)
trigger1 = stateno!=2300
trigger1 = stateno!=2301
trigger1 = stateno!=2302
trigger1 = stateno!=2305
;trigger1 = stateno!=3000
value = 2300
ignorehitpause = 1
;=====================论外END=====================

;===========================================================================================================================
;Helper型 AI开关
;===========================================================================================================================
[State -3, SuperPause]; ---- helper型 AI开关 重置CMD缓存以免误开
type = SuperPause
Triggerall = !((var(51)=6666 && var(58)=1 && var(42)%10=1) || ((!numhelper(701100) || (numhelper(701100) && helper(701100),stateno!=701100)) && stateno != 5900))
TriggerAll=!IsHelper
Triggerall=!NumHelper(96600)
Triggerall=!var(59)
trigger1 = prevstateno = [190,194]
trigger2 = prevstateno = 5900
time = 1
anim = -1
movetime = 0
darken = 1
p2defmul = 1
poweradd = 0
unhittable = 1
endcmdbuftime = 1  ; ---- 重置CMD缓存以免误开
ignorehitpause = 1
persistent = 0

[State -3, AI起佑氓廿毳雪`]; ---- helper型 AI开关
type=helper
Triggerall = !((var(51)=6666 && var(58)=1 && var(42)%10=1) || ((!numhelper(701100) || (numhelper(701100) && helper(701100),stateno!=701100)) && stateno != 5900))
TriggerAll=!IsHelper
Triggerall=!NumHelper(96600)
Triggerall=!var(59)
trigger1 = prevstateno = [190,194]
trigger2 = prevstateno = 5900
helpertype=normal
name="AI switch"
stateno=96600
ID=96600
pos=9999,9999
keyctrl=1    ;利用helper的指令bug来判断AI
facing=0
pausemovetime=2147483647
supermovetime=2147483647
persistent = 0

;===========================================================================================================================
;反晁俣仍O定
;var(55) React Speed Setting for AI Level Setting
;===========================================================================================================================
;カウンタ`用反晁俣仍O定
[State -3, React Speed Setting]
type = VarSet
triggerall = var(59)
trigger1 = 1
var(55) = 60-var(59)*5                ;var(59)越大，var(55)越小。 var(59)最大12时，var(55) = 0


;================================================================================================
;最近之活敌设定
;fvar(36) EnemyNear Parameter
;fvar(36)用于为任何需要使用EnemyNear(fvar(36))的提供服务,确保参数判断的是活的敌人,不是死的敌人
;================================================================================================
[State -3, EnemyNear Parameter];TAG模式AI (敌方1人,fvar(36) = 0)
Type = varset
Trigger1 = numenemy=1
fvar(36) = 0

[State -3, EnemyNear Parameter];TAG模式AI (敌方2人)
Type = varset
Trigger1 = numenemy=2
fvar(36) = ifelse(EnemyNear(0),alive,0,1)
;最近之敌活着,fvar(36) = 0,否则fvar(36) = 1,即最近之活敌为次近之敌


;================================================================================================
;X速度计算
;fvar(28) Vel X Calculate for precise Air Combo
;此state用于将最近之敌的X速度参数时刻读取给fvar(28)
;================================================================================================
[state -3, Vel X Calculate];非受击 读取Vel X
type = varset
Triggerall = EnemyNear(floor(fvar(36))),stateno != [5000,5299]
Trigger1 = fvar(28) != EnemyNear(floor(fvar(36))),Vel X
FV = 28
value = EnemyNear(floor(fvar(36))),Vel X
ignorehitpause = 1

[state -3, Vel X Calculate];受击 非暂停 读取Vel X
type = varset
Triggerall = EnemyNear(floor(fvar(36))),stateno = [5000,5299]
Triggerall = EnemyNear(floor(fvar(36))),GetHitVar(HitShakeTime) = 0
Trigger1 = fvar(28) != EnemyNear(floor(fvar(36))),Vel X
FV = 28
value = EnemyNear(floor(fvar(36))),Vel X
ignorehitpause = 1

[state -3, Vel X Calculate];受击 暂停 读取受击参数GetHitVar(xvel)
type = varset
Triggerall = EnemyNear(floor(fvar(36))),stateno = [5000,5299]
Triggerall = EnemyNear(floor(fvar(36))),GetHitVar(HitShakeTime) != 0
Trigger1 = fvar(28) != EnemyNear(floor(fvar(36))),GetHitVar(xvel)
FV = 28
value = EnemyNear(floor(fvar(36))),GetHitVar(xvel)
ignorehitpause = 1

;================================================================================================
;Y速度计算
;fvar(29) Vel Y Calculate for precise Air Combo
;此state用于将最近之敌的Y速度参数时刻读取给fvar(29)
;================================================================================================
[state -3, Vel Y Calculate];非受击 读取Vel X
type = varset
Triggerall = EnemyNear(floor(fvar(36))),stateno != [5000,5299]
Trigger1 = fvar(29) != EnemyNear(floor(fvar(36))),Vel Y
FV = 29
value = EnemyNear(floor(fvar(36))),Vel Y
ignorehitpause = 1

[state -3, Vel Y Calculate];受击 非暂停 读取Vel X
type = varset
Triggerall = EnemyNear(floor(fvar(36))),stateno = [5000,5299]
Triggerall = EnemyNear(floor(fvar(36))),GetHitVar(HitShakeTime) = 0
Trigger1 = fvar(29) != EnemyNear(floor(fvar(36))),Vel Y
FV = 29
value = EnemyNear(floor(fvar(36))),Vel Y
ignorehitpause = 1

[state -3, Vel Y Calculate];受击 暂停 读取受击参数GetHitVar(xvel)
type = varset
Triggerall = EnemyNear(floor(fvar(36))),stateno = [5000,5299]
Triggerall = EnemyNear(floor(fvar(36))),GetHitVar(HitShakeTime) != 0
Trigger1 = fvar(29) != EnemyNear(floor(fvar(36))),GetHitVar(yvel)
FV = 29
value = EnemyNear(floor(fvar(36))),GetHitVar(yvel)
ignorehitpause = 1

;================================================================================================
;重力加速度算
;fvar(30) Yaccel/Gravity Calculate for precise Air Combo
;此state用于将最近之敌的重力加速度参数时刻读取给fvar(30)
;================================================================================================
[state -3, Yaccel/Gravity Calculate];非受击 读取DATA参数const(movement.yaccel)
type = varset
Triggerall = EnemyNear(floor(fvar(36))),stateno != [5000,5299]
Trigger1 = fvar(30) != EnemyNear(floor(fvar(36))),const(movement.yaccel)
FV = 30
value = EnemyNear(floor(fvar(36))),const(movement.yaccel)
ignorehitpause = 1

[state -3, Yaccel/Gravity Calculate];受击 读取受击参数GetHitVar(yaccel)
type = varset
Triggerall = EnemyNear(floor(fvar(36))),stateno = [5000,5299]
Trigger1 = fvar(30) != EnemyNear(floor(fvar(36))),GetHitVar(yaccel)
FV = 30
value = EnemyNear(floor(fvar(36))),GetHitVar(yaccel)
ignorehitpause = 1

[state -3, Yaccel/Gravity reset];此state用于将最近之敌 y速度为零时的 重力加速度参数以零值赋给fvar(30)
type = varset
Trigger1 = fvar(30) != 0
;Trigger1 = EnemyNear(floor(fvar(36))),Vel Y = 0
Trigger1 = EnemyNear(floor(fvar(36))),statetype = S || EnemyNear(floor(fvar(36))),statetype = C
FV = 30
value = 0
ignorehitpause = 1

;================================================================================================
;受击僵直剩余时间获取
;fvar(31) HitShake Remaining Time Calculate for precise Air Combo
;此state用于将最近之敌受击时的受击僵直剩余时间参数时刻读取给fvar(31)
;written by Eagrose
;================================================================================================
[state -3, HitShake Remaining Time Calculate];受击 读取受击参数GetHitVar(hitshaketime)
type = varset
Triggerall = EnemyNear(floor(fvar(36))),movetype = H
Trigger1 = fvar(31) != EnemyNear(floor(fvar(36))),GetHitVar(hitshaketime)
FV = 31
value = EnemyNear(floor(fvar(36))),GetHitVar(hitshaketime) ;(打牡堡皮rのhitshaketime)
ignorehitpause = 1

[state -3, HitShake Remaining Time Calculate];非受击重置
type = varset
Triggerall = EnemyNear(floor(fvar(36))),movetype != H
Trigger1 = fvar(31) != 0
FV = 31
value = 0
ignorehitpause = 1

;================================================================================================
;标准受击动画 原点Y坐标 偏移修正
;减少因坐标原点与人物受击框偏离造成的空中连段失误
;fvar(32) Enemy Standard GetHitAnim Coordinate-Origin Calculate for precise Air Combo
;此state用于根据最近之敌受击时的系统默认动画号，对动画原点Y坐标进行偏移修正，并存储于fvar(32)
;written by Eagrose
;================================================================================================
[state -3, Standing GetHitAnim Origin];站立受击  原点:脚  对策:略上偏移(半身高的1/8)
type = varset
Triggerall = EnemyNear(floor(fvar(36))),movetype = H
Triggerall = EnemyNear(floor(fvar(36))),statetype = A
Trigger1 = EnemyNear(floor(fvar(36))),stateno = [5000,5019]
Trigger1 = fvar(32) != EnemyNear(floor(fvar(36))),const(Size.mid.pos.Y)/8.0 ;Size.mid.pos.Y本身负值
FV = 32
value = EnemyNear(floor(fvar(36))),const(Size.mid.pos.Y)/8.0
ignorehitpause = 1

[state -3, Crouching GetHitAnim Origin];下蹲受击  原点:脚  对策:略上偏移(半身高的1/8)
type = varset
Triggerall = EnemyNear(floor(fvar(36))),movetype = H
Triggerall = EnemyNear(floor(fvar(36))),statetype = A
Trigger1 = EnemyNear(floor(fvar(36))),stateno = [5020,5029]
Trigger1 = fvar(32) != EnemyNear(floor(fvar(36))),const(Size.mid.pos.Y)/8.0 ;Size.mid.pos.Y本身负值
FV = 32
value = EnemyNear(floor(fvar(36))),const(Size.mid.pos.Y)/8.0
ignorehitpause = 1

[state -3, Air Start GetHitAnim Origin];空中受击初始  原点:脚  对策:上偏移(半身高的1/6)
type = varset
Triggerall = EnemyNear(floor(fvar(36))),movetype = H
Triggerall = EnemyNear(floor(fvar(36))),statetype = A
Trigger1 = EnemyNear(floor(fvar(36))),stateno = 5030
Trigger1 = fvar(32) != EnemyNear(floor(fvar(36))),const(Size.mid.pos.Y)/6.0 ;Size.mid.pos.Y本身负值
FV = 32
value = EnemyNear(floor(fvar(36))),const(Size.mid.pos.Y)/6.0
ignorehitpause = 1

[state -3, Air HitBack GetHitAnim Origin];空中受击后仰  原点:站立时的脚  但中途身体浮空偏移极大  对策:上偏移(半身高的1/4)
type = varset
Triggerall = EnemyNear(floor(fvar(36))),movetype = H
Triggerall = EnemyNear(floor(fvar(36))),statetype = A
Trigger1 = EnemyNear(floor(fvar(36))),stateno = 5035
Trigger1 = fvar(32) != EnemyNear(floor(fvar(36))),const(Size.mid.pos.Y)/4.0 ;Size.mid.pos.Y本身负值
FV = 32
value = EnemyNear(floor(fvar(36))),const(Size.mid.pos.Y)/4.0
ignorehitpause = 1

[state -3, Air Fall/Trip GetHitAnim Origin];空中受击下落、绊脚  原点:站立时的脚（此时受击框因图而异,差异巨大）  对策:上偏移(半身高的1/4)
type = varset
Triggerall = EnemyNear(floor(fvar(36))),movetype = H
Triggerall = EnemyNear(floor(fvar(36))),statetype = A
Trigger1 = EnemyNear(floor(fvar(36))),stateno = [5050,5079]
Trigger1 = fvar(32) != EnemyNear(floor(fvar(36))),const(Size.mid.pos.Y)/4.0  ;Size.mid.pos.Y本身负值
FV = 32
value = EnemyNear(floor(fvar(36))),const(Size.mid.pos.Y)/4.0
ignorehitpause = 1

[state -3, GetHitAnim Origin reset]
type = varset
Triggerall = fvar(31) != 0
Trigger1 = EnemyNear(floor(fvar(36))),movetype != H
Trigger2 = EnemyNear(floor(fvar(36))),statetype != A
FV = 32
value = 0
ignorehitpause = 1

;━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
; Orochi-Ev AI
;━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
[State -3, test debug only!]
type = null;ChangeState
value = 1100
Triggerall = ctrl
Triggerall = statetype = S
Trigger1 = p2movetype = a
;Trigger2 = EnemyNear(floor(fvar(36))),stateno = 0

;===============================================================================
;最高优先级
;===============================================================================
;组队模式专属技能
[State -3, teammode only]
type = ChangeState
value = 4200
triggerall = !(win || lose || drawgame)
TriggerAll = !((var(51)=6666 && var(58)=1 && var(42)%10=1) || ( (!numhelper(701100) || (numhelper(701100) && helper(701100),stateno!=701100)) && stateno != 5900)) ;梦魇一败加强后不开启
TriggerAll = var(39) = 1
TriggerAll = NumPartner
TriggerAll = Partner,alive
TriggerAll = !IsHelper
TriggerAll = !NumHelper(4211)
;**************环境变量
TriggerAll = var(59)
TriggerAll = RoundState = 2
;**************自我条件
TriggerAll = StateType != A
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100  || stateno = [120,159]
;**************额外特殊条件
;**************分支条件
Trigger1 = 1

;时间停止（梦魇模式专用）
[State -3, Time Stop]
type = ChangeState
value = 3000
triggerALL = (fvar(6) = -9999.0) || (fvar(6) = 0.0 && fvar(5) >= 1000.0)
TriggerAll = (palno = 12) || ((palno=[7,11]) && var(58)=1 && floor(var(42)/10)%10=1) ;Catalysm Mode
;**************环境变量
TriggerAll = var(59)
TriggerAll = RoundState = 2
TriggerAll = p2statetype != L
;**************自我条件
TriggerAll = StateType != A
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = [120,159]
;**************额外特殊条件
;**************分支条件
Trigger1 = inguarddist
Trigger2 = EnemyNear(floor(fvar(36))),movetype=A || ifelse((NumEnemy=2 && EnemyNear(0),alive && EnemyNear(1),alive),EnemyNear(floor(fvar(36))+1),movetype=A,0)
Trigger3 = EnemyNear(floor(fvar(36))),Numproj || ifelse((NumEnemy=2 && EnemyNear(0),alive && EnemyNear(1),alive),(EnemyNear(floor(fvar(36))+1),Numproj),0)
Trigger4 = EnemyNear(floor(fvar(36))),stateno < 160
;Trigger5 = EnemyNear(floor(fvar(36))),ctrl


;Soul Extraction MAX                    ;<"无">一击必杀 无敌 近程
[State -3,Soul Extraction MAX]
type = ChangeState
value = 2300
TriggerAll = fvar(6) != 1
TriggerAll = palno = [1,12] ;not Catalysm Mode
TriggerAll = var(59)
TriggerAll = RoundState = 2
TriggerAll = power >= 4000
triggerall = life < ceil(lifemax/3)              ;low life
TriggerAll = statetype != A                ;前提:  自己非空中
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100  || stateno = [120,159]
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
;trigger1 = P2dist X = [-200+floor(19*(EnemyNear(floor(fvar(36))),vel X)),200+floor(19*(EnemyNear(floor(fvar(36))),vel X))]
Trigger1 = inguarddist
Trigger2 = EnemyNear(floor(fvar(36))),movetype=A || ifelse((NumEnemy=2 && EnemyNear(0),alive && EnemyNear(1),alive),EnemyNear(floor(fvar(36))+1),movetype=A,0)
Trigger3 = EnemyNear(floor(fvar(36))),Numproj || ifelse((NumEnemy=2 && EnemyNear(0),alive && EnemyNear(1),alive),(EnemyNear(floor(fvar(36))+1),Numproj),0)

;Soul Extraction MAX                    ;<"无">一击必杀 无敌 近程
[State -3,Soul Extraction MAX]
type = ChangeState
value = 2300
TriggerAll = fvar(6) != 1
TriggerAll = palno = 12 && var(58)=1 && var(42)%10=1 ;Catalysm Mode
TriggerAll = var(59)
TriggerAll = RoundState = 2
;triggerall = life < ceil(lifemax/3)              ;low life
TriggerAll = statetype != A                ;前提:  自己非空中
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100  || stateno = [120,159]
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
Trigger1 = inguarddist
Trigger2 = EnemyNear(floor(fvar(36))),movetype=A || ifelse((NumEnemy=2 && EnemyNear(0),alive && EnemyNear(1),alive),EnemyNear(floor(fvar(36))+1),movetype=A,0)
Trigger3 = EnemyNear(floor(fvar(36))),Numproj || ifelse((NumEnemy=2 && EnemyNear(0),alive && EnemyNear(1),alive),(EnemyNear(floor(fvar(36))+1),Numproj),0)

; Mu ni Kaerou lv3                    ;<灭绝阳光>完全无敌
[State -3,Mu ni Kaerou lv2]
type = ChangeState
value = 2200
TriggerAll = fvar(6) != 1
TriggerAll = var(59)
TriggerAll = RoundState = 2
TriggerAll = power >= 3000
TriggerAll = power < 4000
TriggerAll = life < ceil(lifemax/3)
TriggerAll = statetype != A                ;前提:  自己非空中
TriggerAll = P2StateType != L              ;前提:  P2非倒地
TriggerAll = P2moveType != H               ;前提:  P2非受击
TriggerAll = EnemyNear(floor(fvar(36))),ctrl = 0
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102 || stateno = 120 || stateno = 140
TriggerAll = EnemyNear(floor(fvar(36))),AnimTime <= -8               ;前提:  最近之敌将来不及防御
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
Trigger1 = P2MoveType = A
Trigger2 = inguarddist


; Mu ni Kaerou lv2                    ;<圣光普照>完全无敌
[State -3,Mu ni Kaerou lv2]
type = ChangeState
value = 2010
TriggerAll = fvar(6) != 1
TriggerAll = var(59)
TriggerAll = RoundState = 2
TriggerAll = power >= 2000
;TriggerAll = life < ceil(lifemax/2)
TriggerAll = statetype != A                ;前提:  自己非空中
TriggerAll = P2StateType != L              ;前提:  P2非倒地
TriggerAll = P2moveType != H               ;前提:  P2非受击
TriggerAll = EnemyNear(floor(fvar(36))),ctrl = 0
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102 || stateno = 120 || stateno = 140
TriggerAll = EnemyNear(floor(fvar(36))),AnimTime <= -13               ;前提:  最近之敌将来不及防御
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
Trigger1 = P2MoveType = A
Trigger2 = inguarddist


;Soul Extraction DM                    ;<掏心> 无敌10tick 近程
[State -3, Soul Extraction DM]
type = ChangeState
value = 2100
TriggerAll = fvar(6) != 1
TriggerAll = var(59)
TriggerAll = RoundState = 2
TriggerAll = power >= 1000
;TriggerAll = life < ceil(lifemax/2)
TriggerAll = statetype != A                ;前提:  自己非空中
TriggerAll = P2StateType != L              ;前提:  P2非倒地
TriggerAll = P2moveType != H               ;前提:  P2非受击
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102  ;前提:  自己可控,刚从倒地起身
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
triggerAll = EnemyNear(floor(fvar(36))),Vel X >= 0
triggerAll = EnemyNear(floor(fvar(36))),ctrl = 0
TriggerALL = P2MoveType = A
trigger1 = p2statetype = A
trigger1 = P2dist X >= -75+floor(ifelse(19>fvar(31),19-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
trigger1 = P2dist X <= 75+floor(ifelse(19>fvar(31),19-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
trigger1 = P2bodydist Y >= -80-floor(ifelse(19>fvar(31),19-fvar(31),0)*fvar(29)+(ifelse(19>fvar(31),19-fvar(31),0)*19/2)*fvar(30))
trigger2 = p2statetype != A
trigger2 = P2dist X >= -75+floor(ifelse(19>fvar(31),19-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
trigger2 = P2dist X <= 75+floor(ifelse(19>fvar(31),19-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))


; Mu ni Kaerou lv1                    ;<阳光普照>起手不无敌
[State -3,Mu ni Kaerou lv2]
type = ChangeState
value = 2000
TriggerAll = fvar(6) != 1
TriggerAll = var(59)
TriggerAll = RoundState = 2
TriggerAll = power >= 1000
;TriggerAll = life < ceil(lifemax/2)
TriggerAll = P2stateno < 2000
TriggerAll = statetype != A                ;前提:  自己非空中
TriggerAll = P2StateType != L              ;前提:  P2非倒地
TriggerAll = P2moveType != H               ;前提:  P2非受击
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102 || stateno = 120 || stateno = 140
TriggerAll = EnemyNear(floor(fvar(36))),ctrl = 0
TriggerAll = EnemyNear(floor(fvar(36))),AnimTime <= -12               ;前提:  最近之敌将来不及防御
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
Trigger1 = P2MoveType = A
Trigger2 = inguarddist


[State -3, I am The Omnipresence]; ---- 终结技
type = ChangeState
value = 2800
TriggerAll = fvar(6) != 1
;**************环境变量
TriggerAll = var(59)
TriggerAll = RoundState = 2
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
;**************自我条件
TriggerAll = power >= 4000
TriggerAll = life >= ceil(lifemax/2)
TriggerAll = statetype != A
;TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100
;**************对手条件
;TriggerAll = P2StateType = L
TriggerAll = EnemyNear(floor(fvar(36))),ctrl = 0
TriggerAll = EnemyNear(floor(fvar(36))),AnimTime <= -1
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************额外特殊条件
;triggerAll = EnemyNear(floor(fvar(36))),life <= 400
triggerAll = P2statetype = S || P2statetype = C
TriggerAll = P2moveType = H
;**************分支条件
trigger1 = ctrl = 1
trigger2 = stateno = 200
trigger2 = movecontact
trigger3 = stateno = 220
trigger3 = movecontact
trigger4 = stateno = 235
trigger4 = movecontact
trigger5 = stateno = 250
trigger5 = movecontact
trigger6 = stateno = 300
trigger6 = movecontact
trigger7 = stateno = 320
trigger7 = movecontact
trigger8 = stateno = 330
trigger8 = movecontact


;===============================================================================
;Inner Mode N.E.S.T.S Striker
;===============================================================================
[State -3, VarSet];inner mode striker cannot be disabled by set -1
type = VarSet
triggerall = var(40) = -1
trigger1 = (palno=[7,11]) && !(var(58)=1 && floor(var(42)/10)%10=1) ;里模式未一败或关闭一败加强，保持里模式，维持援护
Trigger2 = (palno=[1,6]) && var(58)=1 && floor(var(42)/100)%10=1 ;表模式一败加强，进入里模式，维持援护
var(40) = 180
ignorehitpause = 1

;---------------------------------------------------------------------------
;Striker Shermie
[State -3, Shermie]
type = ChangeState
value = 1601
Triggerall = var(40) != -1 ;总开关
TriggerAll = fvar(6) != 1
TriggerAll = (palno = [7,12]) || ((palno=[1,6]) && var(58)=1 && floor(var(42)/100)%10=1)
;**************环境变量
TriggerAll = var(59)
TriggerAll = RoundState = 2
TriggerAll = fvar(37)=0||inguarddist||EnemyNear(floor(fvar(36))),movetype=A||ifelse((NumEnemy=2 && EnemyNear(0),alive && EnemyNear(1),alive),EnemyNear(floor(fvar(36))+1),movetype=A,0)
TriggerAll = fvar(39)=0||inguarddist||EnemyNear(floor(fvar(36))),movetype=A||ifelse((NumEnemy=2 && EnemyNear(0),alive && EnemyNear(1),alive),EnemyNear(floor(fvar(36))+1),movetype=A,0)
;**************自我条件
TriggerAll = statetype != A
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100
;**************对手条件
TriggerAll = P2StateType != L
TriggerAll = P2moveType != H  || inguarddist
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************额外特殊条件
TriggerAll = !fvar(22)
;**************分支条件
trigger1 = EnemyNear(floor(fvar(36))),Vel X > 0
trigger2 = P2bodydist X = [-5,80]
trigger3 = life < (lifemax/2) || var(59) >= 13
;trigger4 = fvar(6) = 1

;---------------------------------------------------------------------------
;Striker Yashiro
[State -3, Yashiro]
type = ChangeState
value = 1602
Triggerall = var(40) != -1 ;总开关
TriggerAll = fvar(6) != 1
TriggerAll = (palno = [7,12]) || ((palno=[1,6]) && var(58)=1 && floor(var(42)/100)%10=1)
;**************环境变量
TriggerAll = var(59)
TriggerAll = RoundState = 2
TriggerAll = fvar(37)=0||inguarddist||EnemyNear(floor(fvar(36))),movetype=A||ifelse((NumEnemy=2 && EnemyNear(0),alive && EnemyNear(1),alive),EnemyNear(floor(fvar(36))+1),movetype=A,0)
TriggerAll = fvar(39)=0||inguarddist||EnemyNear(floor(fvar(36))),movetype=A||ifelse((NumEnemy=2 && EnemyNear(0),alive && EnemyNear(1),alive),EnemyNear(floor(fvar(36))+1),movetype=A,0)
;**************自我条件
TriggerAll = statetype != A
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100
;**************对手条件
TriggerAll = P2StateType != L
TriggerAll = P2moveType != H  || inguarddist
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************额外特殊条件
TriggerAll = !fvar(21)
;**************分支条件
trigger1 = P2bodydist X = [81,160]
trigger2 = p2stateno = [120,159]
trigger3 = life < (lifemax/2) || var(59) >= 13
;trigger4 = fvar(6) = 1

;---------------------------------------------------------------------------
;Striker Chris
[State -3, Chris]
type = ChangeState
value = 1600
Triggerall = var(40) != -1 ;总开关
TriggerAll = fvar(6) != 1
triggerall = (palno = [7,12]) || ((palno=[1,6]) && var(58)=1 && floor(var(42)/100)%10=1)
;**************环境变量
TriggerAll = var(59)
TriggerAll = RoundState = 2
TriggerAll = fvar(37)=0||inguarddist||EnemyNear(floor(fvar(36))),movetype=A||ifelse((NumEnemy=2 && EnemyNear(0),alive && EnemyNear(1),alive),EnemyNear(floor(fvar(36))+1),movetype=A,0)
TriggerAll = fvar(39)=0||inguarddist||EnemyNear(floor(fvar(36))),movetype=A||ifelse((NumEnemy=2 && EnemyNear(0),alive && EnemyNear(1),alive),EnemyNear(floor(fvar(36))+1),movetype=A,0)
;**************自我条件
TriggerAll = statetype != A
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100
;**************对手条件
TriggerAll = P2StateType != L
TriggerAll = P2moveType != H  || inguarddist
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************额外特殊条件
TriggerAll = !fvar(20)
;**************分支条件
trigger1 = p2statetype = L
trigger2 = P2bodydist X >= 161
trigger3 = life < (lifemax/2) || var(59) >= 13
;trigger4 = fvar(6) = 1

;---------------------------------------------------------------------------
;Striker Geonitz
[State -3, Geonitz]
type = ChangeState
value = 1603
Triggerall = var(40) != -1 ;总开关
TriggerAll = fvar(6) != 1
triggerall = (palno = [7,12]) || ((palno=[1,6]) && var(58)=1 && floor(var(42)/100)%10=1)
;**************环境变量
TriggerAll = var(59)
TriggerAll = RoundState = 2
TriggerAll = fvar(37)=0||inguarddist||EnemyNear(floor(fvar(36))),movetype=A||ifelse((NumEnemy=2 && EnemyNear(0),alive && EnemyNear(1),alive),EnemyNear(floor(fvar(36))+1),movetype=A,0)
TriggerAll = fvar(39)=0||inguarddist||EnemyNear(floor(fvar(36))),movetype=A||ifelse((NumEnemy=2 && EnemyNear(0),alive && EnemyNear(1),alive),EnemyNear(floor(fvar(36))+1),movetype=A,0)
;**************自我条件
TriggerAll = statetype != A
triggerall = p2statetype != A
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100
;**************对手条件
TriggerAll = P2StateType != L
TriggerAll = P2moveType != H  || inguarddist
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************额外特殊条件
TriggerAll = !fvar(23)
;**************分支条件
trigger1 = abs(EnemyNear(floor(fvar(36))), Vel X) <= 5
trigger2 = life < (lifemax/2) || var(59) >= 13
;trigger3 = fvar(6) = 1

;===============================================================================
;supercancel to unhittable hypermoves when inguarddist
;连段过程即将挨打时超级取消至起手无敌的超杀
;===============================================================================
;super cancel to "Mu ni Kaerou lv3" when inguarddist
[State -3, azure]
type = ChangeState
value = 2200
TriggerAll = fvar(6) != 1
;**************环境变量
TriggerAll = var(59)
TriggerAll = RoundState = 2
;**************自我条件
TriggerAll = statetype != A
triggerAll = movetype = A
triggerall = power >= 3000
;**************对手条件
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************额外特殊条件
triggerall = inguarddist || (p2movetype = A && p2bodydist X <= 70)
;**************分支条件
trigger1 = stateno = 200
trigger1 = movecontact
trigger2 = stateno = 210
trigger2 = movecontact
trigger3 = stateno = 220
trigger3 = movecontact
trigger4 = stateno = 235
trigger4 = movecontact
trigger5 = stateno = 250
trigger5 = movecontact
trigger6 = stateno = 300
trigger6 = movecontact
trigger7 = stateno = 310
trigger7 = movecontact
trigger8 = stateno = 330
trigger8 = movecontact
trigger9 = stateno = 340
trigger9 = movecontact


;super cancel to "Mu ni Kaerou lv2" when inguarddist
[State -3, azure]
type = ChangeState
value = 2010
TriggerAll = fvar(6) != 1
;**************环境变量
TriggerAll = var(59)
TriggerAll = RoundState = 2
;**************自我条件
TriggerAll = statetype != A
triggerAll = movetype = A
triggerall = power >= 2000
;**************对手条件
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************额外特殊条件
triggerall = inguarddist || (p2movetype = A && p2bodydist X <= 70)
;**************分支条件
trigger1 = stateno = 200
trigger1 = movecontact
trigger2 = stateno = 210
trigger2 = movecontact
trigger3 = stateno = 220
trigger3 = movecontact
trigger4 = stateno = 235
trigger4 = movecontact
trigger5 = stateno = 250
trigger5 = movecontact
trigger6 = stateno = 300
trigger6 = movecontact
trigger7 = stateno = 310
trigger7 = movecontact
trigger8 = stateno = 330
trigger8 = movecontact
trigger9 = stateno = 340
trigger9 = movecontact

;super cancel to "Mu ni Kaerou lv1" when inguarddist
[State -3, azure]
type = ChangeState
value = 2000
TriggerAll = fvar(6) != 1
;**************环境变量
TriggerAll = var(59)
TriggerAll = RoundState = 2
;**************自我条件
TriggerAll = statetype != A
triggerAll = movetype = A
triggerall = power >= 1000
;**************对手条件
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************额外特殊条件
triggerall = inguarddist || (p2movetype = A && p2bodydist X <= 70)
;**************分支条件
trigger1 = stateno = 200
trigger1 = movecontact
trigger2 = stateno = 210
trigger2 = movecontact
trigger3 = stateno = 220
trigger3 = movecontact
trigger4 = stateno = 235
trigger4 = movecontact
trigger5 = stateno = 250
trigger5 = movecontact
trigger6 = stateno = 300
trigger6 = movecontact
trigger7 = stateno = 310
trigger7 = movecontact
trigger8 = stateno = 330
trigger8 = movecontact
trigger9 = stateno = 340
trigger9 = movecontact


;super cancel to "shattering mirror betrayer" when inguarddist
[State -3, shattering mirror betrayer]
type = ChangeState
value = 1400
TriggerAll = fvar(6) != 1
;**************环境变量
TriggerAll = var(59)
TriggerAll = RoundState = 2
;**************自我条件
TriggerAll = statetype != A
triggerAll = movetype = A
triggerall = power < 1000
;**************对手条件
;triggerall = EnemyNear(floor(fvar(36))), HitDefAttr = SCA, NA,SA,HA
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************额外特殊条件
triggerall = inguarddist || (p2movetype = A && p2bodydist X <= 70)
;**************分支条件
;**************NEGATIVE GENESIS
trigger1 = stateno = 200
trigger1 = movecontact
trigger2 = stateno = 210
trigger2 = movecontact
trigger3 = stateno = 220
trigger3 = movecontact
trigger4 = stateno = 235
trigger4 = movecontact
trigger5 = stateno = 250
trigger5 = movecontact
trigger6 = stateno = 300
trigger6 = movecontact
trigger7 = stateno = 310
trigger7 = movecontact
trigger8 = stateno = 330
trigger8 = movecontact
trigger9 = stateno = 340
trigger9 = movecontact

;━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
;闪避   应对近身攻击
;━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
;神指-叛镜  反近身攻击
[State -3, mirror reversal]
type = ChangeState
value = 1400
TriggerAll = fvar(6) != 1
;**************环境变量
TriggerAll = var(59)
TriggerAll = RoundState = 2
;TriggerAll = fvar(37) = 0
;**************自我条件
TriggerAll = statetype != A
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100
;**************对手条件
TriggerAll = P2StateType != L
;TriggerAll = P2StateType != A
TriggerAll = P2moveType = A
TriggerAll = EnemyNear(floor(fvar(36))),ctrl = 0
TriggerAll = EnemyNear(floor(fvar(36))),AnimTime < -1
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************额外特殊条件
TriggerAll = EnemyNear(floor(fvar(36))),stateno < 2000
TriggerAll = ifelse((NumEnemy=2 && EnemyNear(0),alive && EnemyNear(1),alive),(EnemyNear(floor(fvar(36))+1),stateno < 2000),1)
TriggerAll = EnemyNear(floor(fvar(36))), Vel X >= 0
;TriggerAll = !EnemyNear(floor(fvar(36))),Numproj
;TriggerAll = ifelse((NumEnemy=2 && EnemyNear(0),alive && EnemyNear(1),alive),!(EnemyNear(floor(fvar(36))+1),Numproj),1)
;**************分支条件
triggerall = P2bodydist X >= -5
triggerall = P2bodydist X <= 80+floor(ifelse(1>fvar(31),1-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
;triggerall = P2bodydist X <= 45+floor(ifelse(5>fvar(31),5-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
triggerall = P2bodydist Y >= -40
Trigger1 = EnemyNear(floor(fvar(36))),stateno <= 500
Trigger1 = random <= 666
Trigger2 = inguarddist
;Trigger2 = EnemyNear(floor(fvar(36))),power < 2000
Trigger2 = EnemyNear(floor(fvar(36))), HitDefAttr = SCA, NA,SA


;前o急回避
[State -3, roll fwd]
type = ChangeState
value = 271
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = StateType != A
TriggerAll = RoundState = 2
;TriggerAll = P2StateType != L
TriggerAll = EnemyNear(floor(fvar(36))),movetype=A || ifelse((NumEnemy=2 && EnemyNear(0),alive && EnemyNear(1),alive),EnemyNear(floor(fvar(36))+1),movetype=A,0)
TriggerAll = inguarddist
TriggerAll = !(EnemyNear(floor(fvar(36))),HitDefAttr = ,NT,ST,HT,AT)
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
TriggerAll = ((P2bodydist X <= 94)&&(EnemyNear(floor(fvar(36))),ctrl = 0)&&(EnemyNear(floor(fvar(36))),animtime < -31)) || ((P2bodydist X > 94)&&(backEdgeBodydist <= 15))
Trigger1 = P2bodydist X >= 60
;Trigger1 = (P2bodydist X = [60,160])
Trigger2 = EnemyNear(floor(fvar(36))),stateno >= 2000
Trigger3 = ifelse((NumEnemy=2 && EnemyNear(0),alive && EnemyNear(1),alive),(EnemyNear(floor(fvar(36))+1),stateno >= 2000),0)
;Trigger4 = EnemyNear(floor(fvar(36))),ctrl = 1
;Trigger5 = ifelse((NumEnemy=2 && EnemyNear(0),alive && EnemyNear(1),alive),(EnemyNear(floor(fvar(36))+1),ctrl = 1),0)


;后o急回避
[State -3, roll back]
type = ChangeState
value = ifelse(var(59)<13,120,ifelse((!EnemyNear(floor(fvar(36))),ctrl && P2bodydist X > 15),275,120))
ctrl = 1
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = StateType != A
TriggerAll = RoundState = 2
;TriggerAll = P2StateType != L
TriggerAll = EnemyNear(floor(fvar(36))),movetype=A || ifelse((NumEnemy=2 && EnemyNear(0),alive && EnemyNear(1),alive),EnemyNear(floor(fvar(36))+1),movetype=A,0)
TriggerAll = inguarddist
TriggerAll = !(EnemyNear(floor(fvar(36))),HitDefAttr = ,NT,ST,HT,AT)
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
TriggerAll = P2bodydist X <= 188 ;94*2
TriggerAll = backEdgeBodydist >= 15
Trigger1 = P2bodydist X >= 60
;Trigger1 = (P2bodydist X = [60,160])
Trigger2 = EnemyNear(floor(fvar(36))),stateno >= 2000
Trigger3 = ifelse((NumEnemy=2 && EnemyNear(0),alive && EnemyNear(1),alive),(EnemyNear(floor(fvar(36))+1),stateno >= 2000),0)
;Trigger4 = EnemyNear(floor(fvar(36))),ctrl = 1
;Trigger5 = ifelse((NumEnemy=2 && EnemyNear(0),alive && EnemyNear(1),alive),(EnemyNear(floor(fvar(36))+1),ctrl = 1),0)


;原地回避
[State -3, dodge]
type = ChangeState
value = 270
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = StateType != A
TriggerAll = RoundState = 2
;TriggerAll = P2StateType != L
TriggerAll = EnemyNear(floor(fvar(36))),movetype=A || ifelse((NumEnemy=2 && EnemyNear(0),alive && EnemyNear(1),alive),EnemyNear(floor(fvar(36))+1),movetype=A,0)
TriggerAll = inguarddist || ((P2bodydist X>=100) && (p2movetype=A) && (P2stateno>=2000) && (life < ceil(lifemax/3)) )
TriggerAll = !(EnemyNear(floor(fvar(36))),HitDefAttr = ,NT,ST,HT,AT)
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
Trigger1 = P2bodydist X >= 60
;(P2bodydist X = [60,160])
Trigger2 = EnemyNear(floor(fvar(36))),stateno >= 2000
Trigger3 = ifelse((NumEnemy=2 && EnemyNear(0),alive && EnemyNear(1),alive),(EnemyNear(floor(fvar(36))+1),stateno >= 2000),0)
;Trigger4 = EnemyNear(floor(fvar(36))),ctrl = 1
;Trigger5 = ifelse((NumEnemy=2 && EnemyNear(0),alive && EnemyNear(1),alive),(EnemyNear(floor(fvar(36))+1),ctrl = 1),0)


;原地防御
[State -3, guard]
type = ChangeState
value = ifelse(var(59)<13,120,ifelse((!EnemyNear(floor(fvar(36))),ctrl && P2bodydist X > 15),275,120))
ctrl = 1
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = StateType != A
TriggerAll = RoundState = 2
;TriggerAll = P2StateType != L
TriggerAll = inguarddist || (EnemyNear(floor(fvar(36))),movetype=A || ifelse((NumEnemy=2 && EnemyNear(0),alive && EnemyNear(1),alive),EnemyNear(floor(fvar(36))+1),movetype=A,0))
TriggerAll = inguarddist || ((P2bodydist X>=100) && (p2movetype=A) && (P2stateno>=2000) && (life < ceil(lifemax/2)) )
TriggerAll = !(EnemyNear(floor(fvar(36))),HitDefAttr = ,NT,ST,HT,AT)
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
Trigger1 = 1;P2bodydist X >= 60 ;(P2bodydist X = [60,160])
Trigger2 = EnemyNear(floor(fvar(36))),stateno >= 2000
Trigger3 = ifelse((NumEnemy=2 && EnemyNear(0),alive && EnemyNear(1),alive),(EnemyNear(floor(fvar(36))+1),stateno >= 2000),0)
;Trigger4 = EnemyNear(floor(fvar(36))),ctrl = 1
;Trigger5 = ifelse((NumEnemy=2 && EnemyNear(0),alive && EnemyNear(1),alive),(EnemyNear(floor(fvar(36))+1),ctrl = 1),0)

;━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
;闪避      应对飞行道具
;━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
; Reflector                             ;光澈之盾 飞行道具反射 单人模式
[State -3, Reflector]
type = ChangeState
value = 1300
TriggerAll = fvar(6) != 1
TriggerAll = Alive
triggerall = !NumHelper(1310)
TriggerAll = var(59)
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
triggerall = !NumHelper(1310)
TriggerAll = Statetype != A
TriggerAll = P2StateType != L
TriggerAll = EnemyNear(floor(fvar(36))),Numproj || EnemyNear(floor(fvar(36))),NumHelper
TriggerAll = EnemyNear(floor(fvar(36))),movetype = A
TriggerAll = inguarddist
TriggerAll = EnemyNear(floor(fvar(36))),stateno < 2000
TriggerAll = ifelse((NumEnemy=2 && EnemyNear(0),alive && EnemyNear(1),alive),(EnemyNear(floor(fvar(36))+1),stateno < 2000),1)
TriggerAll = !(EnemyNear(floor(fvar(36))),HitDefAttr = , HA,HP,AT)
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102 || stateno = 120 || stateno = 140
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
Trigger1 = P2bodydist x >= 80

; Reflector                             ;光澈之盾 飞行道具反射 双打模式
[State -3, Reflector]
type = ChangeState
value = 1300
TriggerAll = fvar(6) != 1
TriggerAll = Alive
triggerall = !NumHelper(1310)
TriggerAll = var(59)
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
triggerall = !NumHelper(1310)
TriggerAll = Statetype != A
TriggerAll = P2StateType != L
TriggerAll = NumEnemy=2 && EnemyNear(0),alive && EnemyNear(1),alive
TriggerAll = EnemyNear(floor(fvar(36))+1),Numproj || EnemyNear(floor(fvar(36))+1),NumHelper
TriggerAll = EnemyNear(floor(fvar(36))+1),movetype = A
TriggerAll = inguarddist
TriggerAll = EnemyNear(floor(fvar(36))),stateno < 2000
TriggerAll = ifelse((NumEnemy=2 && EnemyNear(0),alive && EnemyNear(1),alive),(EnemyNear(floor(fvar(36))+1),stateno < 2000),1)
TriggerAll = !(EnemyNear(floor(fvar(36))),HitDefAttr = ,HA,HP,AT)
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102 || stateno = 120 || stateno = 140
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
Trigger1 = P2bodydist x >= 80

;前o急回避
[State -3, roll fwd]
type = ChangeState
value = 271
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = StateType != A
TriggerAll = RoundState = 2
;TriggerAll = P2StateType != L
TriggerAll = EnemyNear(floor(fvar(36))),Numproj || ifelse((NumEnemy=2 && EnemyNear(0),alive && EnemyNear(1),alive),EnemyNear(floor(fvar(36))+1),Numproj,0)
TriggerAll = inguarddist || ((P2bodydist X>=100) && (p2movetype=A) && (P2stateno>=2000))
TriggerAll = EnemyNear(floor(fvar(36))),HitDefAttr != ,AT
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
Trigger1 = P2bodydist X <= 94 ;80+14
Trigger1 = EnemyNear(floor(fvar(36))),ctrl = 0
Trigger1 = EnemyNear(floor(fvar(36))),animtime < -31
Trigger2 = P2bodydist X > 94
Trigger2 = backEdgeBodydist <= 15

;后o急回避
[State -3, roll back]
type = ChangeState
value = 275
;ctrl = 1
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = StateType != A
TriggerAll = RoundState = 2
;TriggerAll = P2StateType != L
TriggerAll = EnemyNear(floor(fvar(36))),Numproj || ifelse((NumEnemy=2 && EnemyNear(0),alive && EnemyNear(1),alive),(EnemyNear(floor(fvar(36))+1),Numproj),0)
TriggerAll = inguarddist || ((P2bodydist X>=100) && (p2movetype=A) && (P2stateno>=2000))
TriggerAll = EnemyNear(floor(fvar(36))),HitDefAttr != ,AT
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
Trigger1 = P2bodydist X <= 188 ;94*2

;原地回避
[State -3, dodge]
type = ChangeState
value = 270
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = StateType != A
TriggerAll = RoundState = 2
;TriggerAll = P2StateType != L
TriggerAll = EnemyNear(floor(fvar(36))),Numproj || ifelse((NumEnemy=2 && EnemyNear(0),alive && EnemyNear(1),alive),(EnemyNear(floor(fvar(36))+1),Numproj),0)
TriggerAll = inguarddist || ((P2bodydist X>=120) && (p2movetype=A))
TriggerAll = EnemyNear(floor(fvar(36))),HitDefAttr != ,AT
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
Trigger1 = 1


[State -3, reflector];反射盾 快速攒气 敌方倒地时
type = ChangeState
value = 1300
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = StateType != A
TriggerAll = RoundState = 2
TriggerAll = P2moveType != A
TriggerAll = P2StateType = L && ifelse((NumEnemy=2 && EnemyNear(0),alive && EnemyNear(1),alive),(EnemyNear(floor(fvar(36))+1),statetype = L),1)
TriggerAll = !inguarddist
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
TriggerAll = power < 5000
TriggerAll = p2bodydist X >= 30
Trigger1 = p2stateno != 5120 && ifelse((NumEnemy=2 && EnemyNear(0),alive && EnemyNear(1),alive),(EnemyNear(floor(fvar(36))+1),stateno != 5120),1)
Trigger2 = p2stateno = 5120 && EnemyNear(floor(fvar(36))),animtime < -9 && ifelse((NumEnemy=2 && EnemyNear(0),alive && EnemyNear(1),alive),(EnemyNear(floor(fvar(36))+1),stateno != 5120),1)
Trigger3 = p2stateno != 5120 && ifelse((NumEnemy=2 && EnemyNear(0),alive && EnemyNear(1),alive),(EnemyNear(floor(fvar(36))+1),stateno = 5120 && EnemyNear(floor(fvar(36))+1),animtime < -9),1)
Trigger4 = p2stateno = 5120 && EnemyNear(floor(fvar(36))),animtime < -9
Trigger4 = ifelse((NumEnemy=2 && EnemyNear(0),alive && EnemyNear(1),alive),(EnemyNear(floor(fvar(36))+1),stateno = 5120 && EnemyNear(floor(fvar(36))+1),animtime < -9),1)

[State -3, reflector];反射盾 快速攒气 神指不能连段时
type = ChangeState
value = 1300
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = StateType != A
TriggerAll = RoundState = 2
TriggerAll = P2moveType != A
TriggerAll = P2moveType = H
TriggerAll = !inguarddist
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
TriggerAll = power < 5000
TriggerAll = p2bodydist X >= 30
TriggerAll = P2StateType = A && (p2stateno=1205 || p2stateno=1225 || p2stateno=1226)
Trigger1 = ifelse((NumEnemy=2 && EnemyNear(0),alive && EnemyNear(1),alive),(EnemyNear(floor(fvar(36))+1),StateType = A && ((EnemyNear(floor(fvar(36))+1),stateno=1205) || (EnemyNear(floor(fvar(36))+1),stateno=[1225,1226]))),1)
Trigger2 = ifelse((NumEnemy=2 && EnemyNear(0),alive && EnemyNear(1),alive),(EnemyNear(floor(fvar(36))+1),statetype = L),1)

;================================================================================================
;combo 连续技AI ("连续技启动指令"fvar(39))
;================================================================================================
[State -3, fvar(39)];combo 连续技AI ("连续技启动指令"fvar(39))
type = VarSet
TriggerAll = var(59)
TriggerAll = fvar(39) = 0                  ;此条连续技前提:  fvar(39)已归零
Trigger1 = stateno = 235 && Movecontact       ;;轻腿a命中
Trigger2 = stateno = 220 && Movecontact       ;;重拳x命中
Trigger3 = ProjHit1101 = 1, <= 5
Trigger3 = P2movetype = H
Trigger3 = P2statetype = S || P2statetype = C
Trigger3 = P2bodydist X <= 200
fvar(39) = 1


[State -3, super]
type = NULL;ChangeState
value = 2000
TriggerAll = var(59)
TriggerAll = RoundState = 2
TriggerAll = fvar(39) >= 7
TriggerAll = power >= 2000
TriggerAll = statetype != A                ;前提:  自己非空中
TriggerAll = P2StateType != L              ;前提:  P2非倒地
TriggerAll = P2StateType != A               ;前提:  P2非空中
TriggerAll = P2movetype = H && P2StateNo != [120,159]               ;前提:  P2受击
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
Trigger1 = 1

[State -3, super hit end --> mu ni kaero lv2]
type = ChangeState
value = 2010
TriggerAll = var(59)
TriggerAll = RoundState = 2
TriggerAll = fvar(39) >= 7 || EnemyNear(floor(fvar(36))),life < 70
TriggerAll = power >= 2000
TriggerAll = statetype != A                ;前提:  自己非空中
TriggerAll = P2StateType != L              ;前提:  P2非倒地
TriggerAll = P2StateType != A               ;前提:  P2非空中
TriggerAll = P2movetype = H && P2StateNo != [120,159]               ;前提:  P2受击
;TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
trigger1 = stateno = 235 && movecontact


[State -3, super hit end --> soul]
type = ChangeState
value = 2100
TriggerAll = var(59)
TriggerAll = RoundState = 2
TriggerAll = fvar(39) >= 7 || EnemyNear(floor(fvar(36))),life < 70
TriggerAll = power >= 1000 && power < 2000 && inguarddist
TriggerAll = statetype != A                ;前提:  自己非空中
TriggerAll = P2StateType != L              ;前提:  P2非倒地
TriggerAll = P2StateType != A               ;前提:  P2非空中
TriggerAll = P2movetype = H && P2StateNo != [120,159]               ;前提:  P2受击
;TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
trigger1 = stateno = 235 && movecontact


[State -3, super hit end --> mu ni kaero lv1]
type = ChangeState
value = 2000
TriggerAll = var(59)
TriggerAll = RoundState = 2
TriggerAll = fvar(39) >= 7 || EnemyNear(floor(fvar(36))),life < 70
TriggerAll = power >= 1000
TriggerAll = statetype != A                ;前提:  自己非空中
TriggerAll = P2StateType != L              ;前提:  P2非倒地
TriggerAll = P2StateType != A               ;前提:  P2非空中
TriggerAll = P2movetype = H && P2StateNo != [120,159]               ;前提:  P2受击
;TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
trigger1 = stateno = 235 && movecontact


[State -3, super guard end with power --> soul]
type = ChangeState
value = 2100
TriggerAll = var(59)
TriggerAll = RoundState = 2
TriggerAll = fvar(39) >= 2 ;7
TriggerAll = power >= 1000
TriggerAll = statetype != A                ;前提:  自己非空中
TriggerAll = P2StateType != L              ;前提:  P2非倒地
TriggerAll = P2StateType != A               ;前提:  P2非空中
TriggerAll = P2StateNo = [120,159]               ;前提:  P2受击
;TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
trigger1 = stateno = 235 && movecontact


[State -3, super guard end with no power --> dodge]
type = ChangeState
value = 275
TriggerAll = var(59)
TriggerAll = RoundState = 2
TriggerAll = fvar(39) >= 7
TriggerAll = power < 1000
TriggerAll = statetype != A                ;前提:  自己非空中
TriggerAll = P2StateType != L              ;前提:  P2非倒地
TriggerAll = P2StateType != A               ;前提:  P2非空中
TriggerAll = P2StateNo = [120,159]               ;前提:  P2受击
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
Trigger1 = 1


[State -3, stand heavy Kick combo start]
type = ChangeState
value = 1300
TriggerAll = fvar(6) != 1
TriggerAll = var(59)
TriggerAll = fvar(39) >= 1
TriggerAll = RoundState = 2
TriggerAll = StateType != A
TriggerAll = P2StateType != L
;TriggerAll = P2MoveType = H
triggerAll = movecontact
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
trigger1 = stateno = 235 && (animelemno(0) = [4,15])
trigger2 = stateno = 220 && (animelemno(0) = [8,15])


[State -3, fvar(39)];combo 连续技AI
type = Varadd
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = fvar(39) >= 1
TriggerAll = fvar(39) < 7
TriggerAll = RoundState = 2
TriggerAll = StateType != A
TriggerAll = P2StateType != L
TriggerAll = StateType != A
TriggerAll = P2MoveType = H
TriggerAll = Ctrl || stateno = 20 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102   ;statedef 20 正常步行,statedef 52 && Time >= 3跳跃落地并可控,statedef 100 前冲
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
;Trigger1 = P2BodyDist X = [24-Const(size.ground.front),79-Const(size.ground.front)]              ;前提: 技能范围内
Trigger1 = P2bodydist X >= -5
Trigger1 = P2bodydist X <= 76-10-EnemyNear(fvar(36)),const(size.air.front)+floor(ifelse(4>fvar(31),4-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
fvar(39) = 1


[State -3, stand heavy Kick combo progressing]
type = ChangeState
value = 235
TriggerAll = var(59)
TriggerAll = fvar(39) >= 1
TriggerAll = fvar(39) <= 7
TriggerAll = RoundState = 2
TriggerAll = StateType != A
TriggerAll = P2StateType != L
TriggerAll = StateType != A
TriggerAll = P2MoveType = H
TriggerAll = Ctrl || stateno = 20 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102   ;statedef 20 正常步行,statedef 52 && Time >= 3跳跃落地并可控,statedef 100 前冲
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
;Trigger1 = P2BodyDist X = [24-Const(size.ground.front),79-Const(size.ground.front)]              ;前提: 技能范围内
trigger1 = P2bodydist X >= -5
trigger1 = P2bodydist X <= 76-10-EnemyNear(fvar(36)),const(size.air.front)+floor(ifelse(4>fvar(31),4-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))


[State -3, fvar(39)];combo 连续技AI (连续技结束后关闭"连续技启动指令")
type = VarSet
TriggerAll = var(59)
TriggerAll = fvar(39)                        ;关闭指令前提:  fvar(39)为正 (即连续技已启动)
Trigger1 = p2movetype != H && p2stateno != [120,159]                   ;关闭指令前提:  P2不再处于受击状态(包括防御中受击),即无限连结束
Trigger2 = p2statetype = A
Trigger3 = stateno = 1200
Trigger4 = inguarddist
Trigger5 = fvar(6) = 1
trigger6 = p2movetype = H
trigger6 = p2stateno != [5000,5999]
trigger6 = p2stateno != [120,159]
fvar(39) = 0                               ;fvar(39)归零

;==========================================================================================================
;无限连AI ("无限连启动指令"fvar(37))  暂时弃用
;==========================================================================================================
[State -3];无限连AI ("无限连启动指令"fvar(37))
type = NULL;VarSet
TriggerAll = var(59)
TriggerAll = fvar(37) = 0            ;此条连续技前提:  fvar(37)已归零
Trigger1 = stateno = 1031 && Movehit           ;重拳<链刃 体轴垂直 切开>命中
Trigger2 = stateno = 1060 && Movehit           ;重拳<链刃 颅顶骨棱 切开>命中
Trigger3 = stateno = 1040                    ;<空间集体屠杀>动作中
Trigger3 = P2stateno = 1042                  ;P2处于<空间集体屠杀>命中后的击飞state
Trigger4 = stateno = 1080                    ;<圣光之刃>动作中
Trigger4 = ProjHitTime(1000) = 1             ;<圣光之刃>命中后1 tick时刻
Trigger5 = stateno = 1010                    ;<神圣之箭 地面>动作中
Trigger5 = ProjHitTime(1000) = 1             ;<神圣之箭 地面>命中后1 tick时刻
fvar(37) = 1

[State -3];无限连AI (无限连结束后关闭"无限连启动指令")
type = VarSet
TriggerAll = var(59)
TriggerAll = fvar(37) >= 1                 ;关闭指令前提:  上一条成立
Trigger1 = p2movetype != H                ;关闭指令前提1:  P2不再处于受击状态(包括防御中受击),即无限连结束
fvar(37) = 0                          ;fvar(37)归零

;━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
;リバ`サル                 ;AI倒地起身反击
;━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
;Soul Extraction DM                    ;<掏心>反击 无敌12tick 近程
[State -3,Soul Extraction DM]
type = ChangeState
value = 2100
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = RoundState = 2
TriggerAll = power >= 1000
TriggerAll = statetype != A                ;前提:  自己非空中
TriggerAll = P2StateType != L              ;前提:  P2非倒地
TriggerAll = P2StateType = S || P2StateType = C
;TriggerAll = P2moveType != H               ;前提:  P2非受击
TriggerAll = Ctrl && prevstateno = 5120 && time <= 1                  ;前提:  自己可控,刚从倒地起身
;TriggerAll = EnemyNear(floor(fvar(36))),AnimTime <= -14              ;无视防御 此行不写
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
triggerAll = EnemyNear(floor(fvar(36))),Vel X >= 0
triggerAll = EnemyNear(floor(fvar(36))),ctrl = 0
trigger1 = P2bodydist X >= -75+EnemyNear(fvar(36)),const(size.air.front)+floor(ifelse(19>fvar(31),19-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
trigger1 = P2bodydist X <= 75-EnemyNear(fvar(36)),const(size.air.front)+floor(ifelse(19>fvar(31),19-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))


;Mu ni Kaerou lv1 combo                   ;<阳光普照>反击 不无敌 远程 （连续技开始）
[State -3,Mu ni Kaerou lv1 combo]
type = ChangeState
value = 2000
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = RoundState = 2
TriggerAll = power >= 4000
TriggerAll = statetype != A                ;前提:  自己非空中
TriggerAll = P2StateType != L              ;前提:  P2非倒地
TriggerAll = P2moveType = A
TriggerAll = Ctrl && prevstateno = 5120 && time <= 1                  ;前提:  自己可控,刚从倒地起身
triggerAll = EnemyNear(floor(fvar(36))),ctrl = 0
TriggerAll = EnemyNear(floor(fvar(36))),AnimTime <= -12               ;前提:  最近之敌将来不及防御
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
Trigger1 = P2MoveType = A ;|| P2MoveType = I


; Mu ni Kaerou lv2                    ;<圣光普照>反击 完全无敌
[State -3,Mu ni Kaerou lv2]
type = ChangeState
value = 2010
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = RoundState = 2
TriggerAll = power >= 2000
TriggerAll = statetype != A                ;前提:  自己非空中
TriggerAll = P2StateType != L              ;前提:  P2非倒地
TriggerAll = P2moveType = A
TriggerAll = Ctrl && prevstateno = 5120 && time <= 1                  ;前提:  自己可控,刚从倒地起身
triggerAll = EnemyNear(floor(fvar(36))),ctrl = 0
TriggerAll = EnemyNear(floor(fvar(36))),AnimTime <= -13               ;前提:  最近之敌将来不及防御
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
Trigger1 = P2MoveType = A ;|| P2MoveType = I


;Mu ni Kaerou lv1                    ;<阳光普照>反击 不无敌 远程 仅1格气
[State -3,Mu ni Kaerou lv1]
type = ChangeState
value = 2000
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = RoundState = 2
TriggerAll = power >= 1000
TriggerAll = statetype != A                ;前提:  自己非空中
TriggerAll = P2StateType != L              ;前提:  P2非倒地
TriggerAll = P2moveType = A
TriggerAll = Ctrl && prevstateno = 5120 && time <= 1                  ;前提:  自己可控,刚从倒地起身
triggerAll = EnemyNear(floor(fvar(36))),ctrl = 0
TriggerAll = EnemyNear(floor(fvar(36))),AnimTime <= -12               ;前提:  最近之敌将来不及防御
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
Trigger1 = P2MoveType = A ;|| P2MoveType = I


;中段 <神指> 反击
[State -3, mirror1]
type = ChangeState
value = 1200
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59) && var(59) < 13
TriggerAll = RoundState = 2
TriggerAll = statetype != A                 ;前提:  自己非空中
TriggerAll = P2StateType != L               ;前提:  P2非倒地
TriggerAll = P2moveType = A
TriggerAll = Ctrl && prevstateno = 5120 && time <= 1                    ;前提:  自己可控,刚从倒地起身
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
Trigger1 = EnemyNear(floor(fvar(36))),AnimTime <= -8        ;来不及防御
Trigger1 = EnemyNear(floor(fvar(36))),ctrl = 0
trigger1 = P2bodydist X <= 67-Const(size.ground.front)+floor(8*(EnemyNear(floor(fvar(36))),vel X))
trigger1 = P2bodydist Y = [-136-floor(8*(EnemyNear(floor(fvar(36))),vel Y)+(8*8/2)*fvar(30)),0]
Trigger2 = EnemyNear(floor(fvar(36))),StateNo = [120,159]   ;防御中
Trigger2 = EnemyNear(floor(fvar(36))),StateType = C         ;对应破防
trigger2 = P2bodydist X <= 67-Const(size.ground.front)+floor(8*(EnemyNear(floor(fvar(36))),vel X))
trigger2 = P2bodydist Y = [-136-floor(8*(EnemyNear(floor(fvar(36))),vel Y)+(8*8/2)*fvar(30)),0]
;trigger2 = P2bodydist Y = [-136-floor(8*(EnemyNear(floor(fvar(36))),vel Y)),-33-floor(8*(EnemyNear(floor(fvar(36))),vel Y))]
Trigger3 = P2moveType = A
Trigger3 = EnemyNear(floor(fvar(36))),hitdefattr = S, NA,SA
trigger3 = P2bodydist X <= 67-Const(size.ground.front)+floor(8*(EnemyNear(floor(fvar(36))),vel X))
trigger3 = P2bodydist Y = [-136-floor(8*(EnemyNear(floor(fvar(36))),vel Y)+(8*8/2)*fvar(30)),0]

;下段 <神指> 反击
[State -3, mirror3]
type = ChangeState
value = 1220
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59) && var(59) < 13
TriggerAll = RoundState = 2
TriggerAll = statetype != A                 ;前提:  自己非空中
TriggerAll = P2StateType != L               ;前提:  P2非倒地
TriggerAll = P2moveType = A
TriggerAll = Ctrl && prevstateno = 5120 && time <= 1                    ;前提:  自己可控,刚从倒地起身
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
Trigger1 = EnemyNear(floor(fvar(36))),AnimTime <= -8        ;来不及防御
Trigger1 = EnemyNear(floor(fvar(36))),ctrl = 0
trigger1 = P2bodydist X <= 67-Const(size.ground.front)+floor(8*(EnemyNear(floor(fvar(36))),vel X))
trigger1 = P2bodydist Y = [-104-floor(8*(EnemyNear(floor(fvar(36))),vel Y)+(8*8/2)*fvar(30)),0]
Trigger2 = EnemyNear(floor(fvar(36))),StateNo = [120,159]   ;防御中
Trigger2 = EnemyNear(floor(fvar(36))),StateType = S || EnemyNear(floor(fvar(36))),StateType = A       ;对应破防
trigger2 = P2bodydist X <= 67-Const(size.ground.front)+floor(8*(EnemyNear(floor(fvar(36))),vel X))
trigger2 = P2bodydist Y = [-104-floor(8*(EnemyNear(floor(fvar(36))),vel Y)+(8*8/2)*fvar(30)),0]
;trigger2 = P2bodydist Y = [-104-floor(8*(EnemyNear(floor(fvar(36))),vel Y)),-1-floor(8*(EnemyNear(floor(fvar(36))),vel Y))]
Trigger3 = P2moveType = A
Trigger3 = EnemyNear(floor(fvar(36))),hitdefattr = C, NA,SA
trigger3 = P2bodydist X <= 67-Const(size.ground.front)+floor(8*(EnemyNear(floor(fvar(36))),vel X))
trigger3 = P2bodydist Y = [-104-floor(8*(EnemyNear(floor(fvar(36))),vel Y)+(8*8/2)*fvar(30)),0]

;上段 <神指> 反击
[State -3, mirror2]
type = ChangeState
value = 1210
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59) && var(59) < 13
TriggerAll = RoundState = 2
TriggerAll = statetype != A                 ;前提:  自己非空中
TriggerAll = P2StateType != L               ;前提:  P2非倒地
TriggerAll = P2moveType = A
TriggerAll = Ctrl && prevstateno = 5120 && time <= 1                    ;前提:  自己可控,刚从倒地起身
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
Trigger1 = EnemyNear(floor(fvar(36))),AnimTime <= -9        ;来不及防御
Trigger1 = EnemyNear(floor(fvar(36))),ctrl = 0
trigger1 = P2bodydist X <= 61-Const(size.ground.front)+floor(9*(EnemyNear(floor(fvar(36))),vel X))
trigger1 = P2bodydist Y = [-151-floor(9*(EnemyNear(floor(fvar(36))),vel Y)+(9*9/2)*fvar(30)),-104-floor(9*(EnemyNear(floor(fvar(36))),vel Y)+(9*9/2)*fvar(30))]
Trigger2 = EnemyNear(floor(fvar(36))),StateNo = [120,159]   ;防御中
Trigger2 = EnemyNear(floor(fvar(36))),StateType = A         ;对应破防
trigger2 = P2bodydist X <= 61-Const(size.ground.front)+floor(9*(EnemyNear(floor(fvar(36))),vel X))
trigger2 = P2bodydist Y = [-151-floor(9*(EnemyNear(floor(fvar(36))),vel Y)+(9*9/2)*fvar(30)),-104-floor(9*(EnemyNear(floor(fvar(36))),vel Y)+(9*9/2)*fvar(30))]
Trigger3 = P2moveType = A
Trigger3 = EnemyNear(floor(fvar(36))),hitdefattr = A, NA,SA
trigger3 = P2bodydist X <= 61-Const(size.ground.front)+floor(9*(EnemyNear(floor(fvar(36))),vel X))
trigger3 = P2bodydist Y = [-151-floor(9*(EnemyNear(floor(fvar(36))),vel Y)+(9*9/2)*fvar(30)),-104-floor(9*(EnemyNear(floor(fvar(36))),vel Y)+(9*9/2)*fvar(30))]

;轻腿a 反击
[State -3, stand Light Kick]
type = ChangeState
value = 235
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59) && var(59) < 13
TriggerAll = RoundState = 2
TriggerAll = StateType != A
TriggerAll = RoundState = 2
TriggerAll = P2StateType != L                   ;前提: P2非倒地
TriggerAll = P2MoveType = A
TriggerAll = Ctrl && prevstateno = 5120 && time <= 1                    ;前提:  自己可控,刚从倒地起身
TriggerAll = EnemyNear(floor(fvar(36))),AnimTime <= -4
TriggerAll = (PrevStateNo=[5000,5270]) || (PrevStateNo=[120,159]) || prevstateno = 900            ;前提: 自己刚处于挨打动作 或 防御动作 或 前回避动作
TriggerAll = EnemyNear(floor(fvar(36))),ctrl = 0                     ;前提:  最近之敌当前动作不可控(即最近之敌将来不及防御)
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
TriggerAll = !inguarddist
TriggerAll = !EnemyNear(floor(fvar(36))),Numproj
TriggerAll = ifelse((NumEnemy=2 && EnemyNear(0),alive && EnemyNear(1),alive),!(EnemyNear(floor(fvar(36))+1),Numproj),1)
Triggerall = EnemyNear(floor(fvar(36))),Time >= var(55)
;TriggerAll = P2BodyDist X = [24-Const(size.ground.front)+floor(4*(EnemyNear(floor(fvar(36))),vel X)),50-Const(size.ground.front)+floor(4*(EnemyNear(floor(fvar(36))),vel X))]              ;前提: 技能范围内
;TriggerAll = P2BodyDist X = [24-Const(size.ground.front)+floor(4*(EnemyNear(floor(fvar(36))),vel X)),50-Const(size.ground.front)+floor(4*(EnemyNear(floor(fvar(36))),vel X))]              ;前提: 技能范围内
trigger1 = P2bodydist X >= -5
trigger1 = P2bodydist X <= 76-Const(size.ground.front)+floor(ifelse(4>fvar(31),4-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))


;━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
;硬直相手へ反                 ;AI防御反击
;━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
[State -3, COMBINATION THROW OF GOENITZ]
type = ChangeState
value = 2600
TriggerAll = fvar(6) != 1
;**************环境变量
TriggerAll = var(59)
TriggerAll = RoundState = 2
TriggerAll = fvar(37) = 0
;**************自我条件
TriggerAll = power >= 3000
triggerall = fvar(23) < ifelse(((palno = 12) || ((palno=[7,11]) && var(58)=1 && floor(var(42)/10)%10=1)),var(40)/2,var(40)) ;striker geonitz not using
TriggerAll = statetype != A
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100
;**************对手条件
TriggerAll = P2StateType != L
TriggerAll = P2StateType != A
TriggerAll = P2moveType = A
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************额外特殊条件
;**************分支条件
Trigger1 = P2BodyDist X = [-5,20]

;Soul Extraction DM                    ;<掏心>反超杀 无敌12tick 近程
[State -3,Soul Extraction DM]
type = ChangeState
value = 2100
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = RoundState = 2
TriggerAll = power >= 1000
TriggerAll = statetype != A                ;前提:  自己非空中
TriggerAll = P2StateType != L              ;前提:  P2非倒地
TriggerAll = P2StateType = S || P2StateType = C
TriggerAll = P2moveType = A
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102 || stateno = 120 || stateno = 140
TriggerAll = (PrevStateNo=[5000,5270]) || (PrevStateNo=[120,159]) || prevstateno = 900   ;前提: 自己刚处于挨打动作 或 防御动作 或 前回避动作
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
triggerall = EnemyNear(floor(fvar(36))),Vel X >= 0
triggerall = EnemyNear(floor(fvar(36))),ctrl = 0
;trigger1 = P2dist X = [-84+10*Const(size.xscale)+floor(19*(EnemyNear(floor(fvar(36))),vel X)),85+10*Const(size.xscale)+floor(19*(EnemyNear(floor(fvar(36))),vel X))]
;trigger1 = P2dist X = [-60+10*Const(size.xscale)+floor(19*(EnemyNear(floor(fvar(36))),vel X)),60+10*Const(size.xscale)+floor(19*(EnemyNear(floor(fvar(36))),vel X))]
;trigger1 = P2bodydist Y = [-127-floor(19*(EnemyNear(floor(fvar(36))),vel Y)+(19*(19)/2)*fvar(30)),0]
trigger1 = p2statetype = A
trigger1 = P2dist X >= -75+floor(ifelse(19>fvar(31),19-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
trigger1 = P2dist X <= 75+floor(ifelse(19>fvar(31),19-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
trigger1 = P2bodydist Y >= -80-floor(ifelse(19>fvar(31),19-fvar(31),0)*fvar(29)+(ifelse(19>fvar(31),19-fvar(31),0)*19/2)*fvar(30))
trigger2 = p2statetype != A
trigger2 = P2dist X >= -75+floor(ifelse(19>fvar(31),19-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
trigger2 = P2dist X <= 75+floor(ifelse(19>fvar(31),19-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))


; Mu ni Kaerou lv2                    ;<圣光普照>反击 完全无敌
[State -3,Mu ni Kaerou lv2]
type = ChangeState
value = 2010
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = RoundState = 2
TriggerAll = power >= 2000
TriggerAll = statetype != A                ;前提:  自己非空中
TriggerAll = P2StateType != L              ;前提:  P2非倒地
TriggerAll = P2moveType = A               ;前提:  P2非受击
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102 || stateno = 120 || stateno = 140
TriggerAll = (PrevStateNo=[5000,5270]) || (PrevStateNo=[120,159]) || prevstateno = 900   ;前提: 自己刚处于挨打动作 或 防御动作 或 前回避动作
triggerAll = EnemyNear(floor(fvar(36))),ctrl = 0
TriggerAll = EnemyNear(floor(fvar(36))),AnimTime <= -13               ;前提:  最近之敌将来不及防御
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
Trigger1 = P2MoveType = A || P2MoveType = I

;前投げ                    ;C投技
[State -3, C throw]
type = ChangeState
value = 280
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = StateType != A                ;前提:  自己非空中
TriggerAll = RoundState = 2
TriggerAll = P2StateType != L              ;前提:  P2非倒地
TriggerAll = P2StateType != A              ;前提:  P2非空中
TriggerAll = P2BodyDist X = [-5,15]         ;前提: 技能范围内
TriggerAll = BackEdgeBodyDist <= 60                    ;前提: 身体距离版边<=60
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3)   ;statedef 19 AI后退,statedef 20 正常步行,statedef 21 AI前进,statedef 52 && Time >= 3跳跃落地并可控
TriggerAll = stateno != 100                  ;前提: 非前冲
TriggerAll = EnemyNear(floor(fvar(36))),AnimTime <= -1
TriggerAll = (PrevStateNo=[5000,5270]) || (PrevStateNo=[120,159])  ;前提: 自己刚处于挨打动作 或 防御动作 或 前回避动作
TriggerAll = EnemyNear(floor(fvar(36))),ctrl = 0
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
Trigger1 = 1

;後ろ投げ                  ;D投技
[State -3, D throw]
type = ChangeState
value = 295
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = StateType != A
TriggerAll = RoundState = 2
TriggerAll = P2StateType != L                   ;前提:  P2非倒地
TriggerAll = P2StateType != A                   ;前提:  P2非空中
TriggerAll = P2BodyDist X = [-5,15]              ;前提: 技能范围内
TriggerAll = BackEdgeBodyDist > 60                    ;前提: 身体距离版边<=60
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3)  ;statedef 19 AI后退,statedef 20 正常步行,statedef 21 AI前进,statedef 52 && Time >= 3跳跃落地并可控
TriggerAll = stateno != 100                     ;前提: 非前冲
TriggerAll = EnemyNear(floor(fvar(36))),AnimTime <= -1
TriggerAll = (PrevStateNo=[5000,5270]) || (PrevStateNo=[120,159])   ;前提: 自己刚处于挨打动作 或 防御动作 或 前回避动作
TriggerAll = EnemyNear(floor(fvar(36))),ctrl = 0
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
Trigger1 = 1

;神指 判镜 反击
[State -3, void]
type = ChangeState
value = 1400
TriggerAll = fvar(6) != 1
;**************环境变量
TriggerAll = var(59)
TriggerAll = RoundState = 2
;TriggerAll = fvar(37) = 0
;**************自我条件
TriggerAll = statetype != A
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100
;**************对手条件
TriggerAll = P2StateType != L
TriggerAll = P2StateType != A
TriggerAll = P2moveType = A
TriggerAll = EnemyNear(floor(fvar(36))),ctrl = 0
TriggerAll = EnemyNear(floor(fvar(36))),AnimTime < -5
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************额外特殊条件
TriggerAll = EnemyNear(floor(fvar(36))),stateno < 2000
TriggerAll = ifelse((NumEnemy=2 && EnemyNear(0),alive && EnemyNear(1),alive),(EnemyNear(floor(fvar(36))+1),stateno < 2000),1)
TriggerAll = EnemyNear(floor(fvar(36))), Vel X >= 0
;TriggerAll = !EnemyNear(floor(fvar(36))),Numproj
;TriggerAll = ifelse((NumEnemy=2 && EnemyNear(0),alive && EnemyNear(1),alive),!(EnemyNear(floor(fvar(36))+1),Numproj),1)
;**************分支条件
TriggerAll = P2BodyDist X = [-5,45+floor(ifelse(5>fvar(31),5-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))]
TriggerAll = P2BodyDist Y >= -40
Trigger1 = EnemyNear(floor(fvar(36))),stateno <= 300
Trigger1 = random <= 666
Trigger2 = inguarddist
Trigger2 = EnemyNear(floor(fvar(36))),power < 2000
Trigger2 = EnemyNear(floor(fvar(36))), HitDefAttr = SCA, NA,SA

;中段 <神指> 反击
[State -3, mirror1]
type = ChangeState
value = 1200
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59) && var(59) < 13
TriggerAll = statetype != A                 ;前提:  自己非空中
TriggerAll = RoundState = 2
TriggerAll = P2StateType != L                   ;前提: P2非倒地
;TriggerAll = P2StateType = A || P2StateType = S
TriggerAll = P2BodyDist X > 5
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
TriggerAll = (PrevStateNo=[5000,5270]) || (PrevStateNo=[120,159]) || prevstateno = 900            ;前提: 自己刚处于挨打动作 或 防御动作 或 前回避动作
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
TriggerAll = EnemyNear(floor(fvar(36))),ctrl = 0
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)                ;var(55)AI反应速度,AI难度越大,var(55)越小,AI反应越迅速
Trigger1 = EnemyNear(floor(fvar(36))),AnimTime <= -8        ;来不及防御
trigger1 = P2bodydist X <= 67-Const(size.ground.front)+floor(8*(EnemyNear(floor(fvar(36))),vel X))
trigger1 = P2bodydist Y = [-136-floor(8*(EnemyNear(floor(fvar(36))),vel Y)+(8*8/2)*fvar(30)),0]
Trigger2 = EnemyNear(floor(fvar(36))),StateNo = [120,159]   ;防御中
Trigger2 = EnemyNear(floor(fvar(36))),StateType = C         ;对应破防
trigger2 = P2bodydist X <= 67-Const(size.ground.front)+floor(8*(EnemyNear(floor(fvar(36))),vel X))
trigger2 = P2bodydist Y = [-136-floor(8*(EnemyNear(floor(fvar(36))),vel Y)+(8*8/2)*fvar(30)),0]
;trigger2 = P2bodydist Y = [-136-floor(8*(EnemyNear(floor(fvar(36))),vel Y)),-33-floor(8*(EnemyNear(floor(fvar(36))),vel Y))]
Trigger3 = P2moveType = A
Trigger3 = EnemyNear(floor(fvar(36))),hitdefattr = S, NA,SA
trigger3 = P2bodydist X <= 67-Const(size.ground.front)+floor(8*(EnemyNear(floor(fvar(36))),vel X))
trigger3 = P2bodydist Y = [-136-floor(8*(EnemyNear(floor(fvar(36))),vel Y)+(8*8/2)*fvar(30)),0]

;下段 <神指> 反击  站立远距
[State -3, mirror3]
type = ChangeState
value = 1220
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59) && var(59) < 13
TriggerAll = statetype != A                 ;前提:  自己非空中
TriggerAll = RoundState = 2
TriggerAll = P2StateType != L                   ;前提: P2非倒地
TriggerAll = P2StateType = S || P2StateType = C
TriggerAll = EnemyNear(floor(fvar(36))),Vel X >= 0
TriggerAll = EnemyNear(floor(fvar(36))),Vel Y >= 0
TriggerAll = P2BodyDist X > 5
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
TriggerAll = (PrevStateNo=[5000,5270]) || (PrevStateNo=[120,159]) || prevstateno = 900            ;前提: 自己刚处于挨打动作 或 防御动作 或 前回避动作
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
TriggerAll = EnemyNear(floor(fvar(36))),ctrl = 0
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)                ;var(55)AI反应速度,AI难度越大,var(55)越小,AI反应越迅速
Trigger1 = EnemyNear(floor(fvar(36))),AnimTime <= -8        ;来不及防御
trigger1 = P2bodydist X = [67-Const(size.ground.front)+floor(8*(EnemyNear(floor(fvar(36))),vel X)),103-Const(size.ground.front)+floor(8*(EnemyNear(floor(fvar(36))),vel X))]
trigger1 = P2bodydist Y = [-104-floor(8*(EnemyNear(floor(fvar(36))),vel Y)+(8*8/2)*fvar(30)),0]
Trigger2 = EnemyNear(floor(fvar(36))),StateNo = [120,159]   ;防御中
Trigger2 = EnemyNear(floor(fvar(36))),StateType = S         ;对应破防
trigger2 = P2bodydist X = [67-Const(size.ground.front)+floor(8*(EnemyNear(floor(fvar(36))),vel X)),103-Const(size.ground.front)+floor(8*(EnemyNear(floor(fvar(36))),vel X))]
trigger2 = P2bodydist Y = [-104-floor(8*(EnemyNear(floor(fvar(36))),vel Y)+(8*8/2)*fvar(30)),0]
;trigger2 = P2bodydist Y = [-104-floor(8*(EnemyNear(floor(fvar(36))),vel Y)),-1-floor(8*(EnemyNear(floor(fvar(36))),vel Y))]
Trigger3 = P2moveType = A
Trigger3 = EnemyNear(floor(fvar(36))),hitdefattr = C, NA
trigger3 = P2bodydist X = [67-Const(size.ground.front)+floor(8*(EnemyNear(floor(fvar(36))),vel X)),103-Const(size.ground.front)+floor(8*(EnemyNear(floor(fvar(36))),vel X))]
trigger3 = P2bodydist Y = [-104-floor(8*(EnemyNear(floor(fvar(36))),vel Y)+(8*8/2)*fvar(30)),0]

;下段 <神指> 反击
[State -3, mirror3]
type = ChangeState
value = 1220
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59) && var(59) < 13
TriggerAll = statetype != A                 ;前提:  自己非空中
TriggerAll = RoundState = 2
TriggerAll = P2StateType != L                   ;前提: P2非倒地
;TriggerAll = P2StateType != A   ;前提:  P2空中或不将倒地
TriggerAll = P2BodyDist X > 5
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
TriggerAll = (PrevStateNo=[5000,5270]) || (PrevStateNo=[120,159]) || prevstateno = 900            ;前提: 自己刚处于挨打动作 或 防御动作 或 前回避动作
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
TriggerAll = EnemyNear(floor(fvar(36))),ctrl = 0
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)                ;var(55)AI反应速度,AI难度越大,var(55)越小,AI反应越迅速
Trigger1 = EnemyNear(floor(fvar(36))),AnimTime <= -8        ;来不及防御
trigger1 = P2bodydist X <= 67-Const(size.ground.front)+floor(8*(EnemyNear(floor(fvar(36))),vel X))
trigger1 = P2bodydist Y = [-104-floor(8*(EnemyNear(floor(fvar(36))),vel Y)+(8*8/2)*fvar(30)),0]
Trigger2 = EnemyNear(floor(fvar(36))),StateNo = [120,159]   ;防御中
Trigger2 = EnemyNear(floor(fvar(36))),StateType = S         ;对应破防
trigger2 = P2bodydist X <= 67-Const(size.ground.front)+floor(8*(EnemyNear(floor(fvar(36))),vel X))
trigger2 = P2bodydist Y = [-104-floor(8*(EnemyNear(floor(fvar(36))),vel Y)+(8*8/2)*fvar(30)),0]
;trigger2 = P2bodydist Y = [-104-floor(8*(EnemyNear(floor(fvar(36))),vel Y)),-1-floor(8*(EnemyNear(floor(fvar(36))),vel Y))]
Trigger3 = P2moveType = A
Trigger3 = EnemyNear(floor(fvar(36))),hitdefattr = C, NA,SA,NT,ST,NP,SP
trigger3 = P2bodydist X <= 67-Const(size.ground.front)+floor(8*(EnemyNear(floor(fvar(36))),vel X))
trigger3 = P2bodydist Y = [-104-floor(8*(EnemyNear(floor(fvar(36))),vel Y)+(8*8/2)*fvar(30)),0]

;上段 <神指> 反击
[State -3, mirror2]
type = ChangeState
value = 1210
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59) && var(59) < 13
TriggerAll = statetype != A                 ;前提:  自己非空中
TriggerAll = RoundState = 2
TriggerAll = P2StateType != L                   ;前提: P2非倒地
TriggerAll = P2StateType = A  ;前提:  P2空中
TriggerAll = P2BodyDist X > 5
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
TriggerAll = (PrevStateNo=[5000,5270]) || (PrevStateNo=[120,159]) || prevstateno = 900            ;前提: 自己刚处于挨打动作 或 防御动作 或 前回避动作
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
;TriggerAll = EnemyNear(floor(fvar(36))),ctrl = 0
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)                ;var(55)AI反应速度,AI难度越大,var(55)越小,AI反应越迅速
Trigger1 = EnemyNear(floor(fvar(36))),AnimTime <= -9       ;来不及防御
trigger1 = P2bodydist X <= 61-Const(size.ground.front)+floor(9*(EnemyNear(floor(fvar(36))),vel X))
trigger1 = P2bodydist Y = [-151-floor(9*(EnemyNear(floor(fvar(36))),vel Y)+(9*9/2)*fvar(30)),-104-floor(9*(EnemyNear(floor(fvar(36))),vel Y)+(9*9/2)*fvar(30))]
Trigger2 = EnemyNear(floor(fvar(36))),StateNo = [120,159]   ;防御中
Trigger2 = EnemyNear(floor(fvar(36))),StateType = A         ;对应破防
trigger2 = P2bodydist X <= 61-Const(size.ground.front)+floor(9*(EnemyNear(floor(fvar(36))),vel X))
trigger2 = P2bodydist Y = [-151-floor(9*(EnemyNear(floor(fvar(36))),vel Y)+(9*9/2)*fvar(30)),-104-floor(9*(EnemyNear(floor(fvar(36))),vel Y)+(9*9/2)*fvar(30))]
Trigger3 = P2moveType = A
Trigger3 = EnemyNear(floor(fvar(36))),hitdefattr = A, NA,SA
trigger3 = P2bodydist X <= 61-Const(size.ground.front)+floor(9*(EnemyNear(floor(fvar(36))),vel X))
trigger3 = P2bodydist Y = [-151-floor(9*(EnemyNear(floor(fvar(36))),vel Y)+(9*9/2)*fvar(30)),-104-floor(19*(EnemyNear(floor(fvar(36))),vel Y)+(9*9/2)*fvar(30))]

;轻腿a 反击
[State -3, stand Light Kick]
type = ChangeState
value = 235
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59) && var(59) < 13
TriggerAll = RoundState = 2
TriggerAll = StateType != A
TriggerAll = RoundState = 2
TriggerAll = P2StateType != L                   ;前提: P2非倒地
;TriggerAll = P2MoveType = A                    ;前提:  P2攻击
TriggerAll = P2BodyDist X > 5
;TriggerAll = P2BodyDist X = [24-Const(size.ground.front)+floor(4*(EnemyNear(floor(fvar(36))),vel X)),50-Const(size.ground.front)+floor(4*(EnemyNear(floor(fvar(36))),vel X))]              ;前提: 技能范围内
TriggerAll = P2BodyDist X = [24-Const(size.ground.front)+floor(4*(EnemyNear(floor(fvar(36))),vel X)),50-Const(size.ground.front)+floor(4*(EnemyNear(floor(fvar(36))),vel X))]              ;前提: 技能范围内
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
TriggerAll = EnemyNear(floor(fvar(36))),AnimTime <= -4
TriggerAll = (PrevStateNo=[5000,5270]) || (PrevStateNo=[120,159]) || prevstateno = 900            ;前提: 自己刚处于挨打动作 或 防御动作 或 前回避动作
TriggerAll = EnemyNear(floor(fvar(36))),ctrl = 0                     ;前提:  最近之敌当前动作不可控(即最近之敌将来不及防御)
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
TriggerAll = !EnemyNear(floor(fvar(36))),Numproj
TriggerAll = !inguarddist
TriggerAll = ifelse((NumEnemy=2 && EnemyNear(0),alive && EnemyNear(1),alive),!(EnemyNear(floor(fvar(36))+1),Numproj),1)
Trigger1 = EnemyNear(floor(fvar(36))),Time >= var(55)                ;var(55)AI反应速度,AI难度越大,var(55)越小,AI反应越迅速
Trigger2 = var(59) >= 11                 ;常时启动: AI难度11级以上

;重拳y 反击
[State -3, stand heavy punch]
type = null;ChangeState
value = 220
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59) && var(59) < 13
TriggerAll = RoundState = 2
TriggerAll = StateType != A
TriggerAll = RoundState = 2
TriggerAll = P2StateType != L                   ;前提: P2非倒地
TriggerAll = P2MoveType = A                    ;前提:  P2攻击
TriggerAll = P2BodyDist X = [28-Const(size.ground.front)+floor(18*(EnemyNear(floor(fvar(36))),vel X)),75-Const(size.ground.front)+floor(18*(EnemyNear(floor(fvar(36))),vel X))]             ;前提: 技能范围内
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
TriggerAll = EnemyNear(floor(fvar(36))),AnimTime <= -18
TriggerAll = (PrevStateNo=[5000,5270]) || (PrevStateNo=[120,159]) || prevstateno = 900            ;前提: 自己刚处于挨打动作 或 防御动作 或 前回避动作
TriggerAll = EnemyNear(floor(fvar(36))),ctrl = 0                     ;前提:  最近之敌当前动作不可控(即最近之敌将来不及防御)
TriggerAll = EnemyNear(floor(fvar(36))),hitdefattr != SCA, HA,HT,HP
TriggerAll = !inguarddist
TriggerAll = !EnemyNear(floor(fvar(36))),Numproj
TriggerAll = ifelse((NumEnemy=2 && EnemyNear(0),alive && EnemyNear(1),alive),!(EnemyNear(floor(fvar(36))+1),Numproj),1)
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
Trigger1 = 1

;===============================================================================
;Cancel Moves                ;AI超杀取消
;===============================================================================
; Mu ni Kaerou lv3 Extended from Mu ni Kaerou SDM/DM
[State -1, Mu ni Kaerou lv3 Extended from Mu ni Kaerou SDM/DM]
type = Changestate
value = 2200
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59)
;TriggerAll = fvar(37) = 0
;TriggerAll = fvar(39) = 0
triggerall = roundstate = 2
triggerall = power >= 1000
triggerall = statetype != A
TriggerAll = P2StateType != L
TriggerAll = P2MoveType = H
;triggerAll = P2bodydist Y <= 0-floor(15*(EnemyNear(floor(fvar(36))),vel Y)+(15*15/2)*fvar(30))
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
trigger1 = stateno = 2011 && helper(2014),movehit
trigger1 = time >= 65
trigger2 = stateno = 2001 && helper(2004),movehit
trigger2 = time >= 65
trigger2 = power < 4000 ;4格气以上则转用DC阳光再延展

; Mu ni Kaerou SDM DreamCancelled from Mu ni Kaerou DM
[State -1, Mu ni Kaerou SDM DreamCancelled from Mu ni Kaerou DM]
type = Changestate
value = 2010
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = RoundState = 2
;TriggerAll = fvar(37) = 0
;TriggerAll = fvar(39) = 0
triggerall = power >= 3000
triggerall = statetype != A
TriggerAll = P2StateType != L
TriggerAll = P2MoveType = H
;triggerAll = P2bodydist Y <= 0-floor(15*(EnemyNear(floor(fvar(36))),vel Y)+(15*15/2)*fvar(30))
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
trigger1 = stateno = 2001 && helper(2004),movehit
trigger1 = time >= 65

; Mu ni Kaerou SDM SuperCancel
[State -1, Mu ni Kaerou SDM]
type = Changestate
value = 2010
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = RoundState = 2
;TriggerAll = fvar(37) = 0
;TriggerAll = fvar(39) = 0
triggerall = power >= 3000
triggerall = power < 4000
triggerall = statetype != A
TriggerAll = P2StateType != L
TriggerAll = P2MoveType = H
;triggerAll = P2bodydist Y <= 0-floor(15*(EnemyNear(floor(fvar(36))),vel Y)+(15*15/2)*fvar(30))
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
trigger1 = stateno = 1200 && movehit = 10
trigger2 = stateno = 1200 && movecontact && (inguarddist || p2movetype = A)
trigger3 = stateno = 1210 && movehit = 10
trigger4 = stateno = 1210 && movecontact && (inguarddist || p2movetype = A)
trigger5 = stateno = 1220 && movehit = 10
trigger6 = stateno = 1220 && movecontact && (inguarddist || p2movetype = A)
trigger7 = stateno = 1401 && (projhit1401 = 1,>= 25)
trigger8 = stateno = 1401 && (projcontact1401 = 1,>= 1) && (inguarddist || p2movetype = A)

; Mu ni Kaerou DM SuperCancel
[State -1, Mu ni Kaerou]
type = Changestate
value = 2000
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59)
;TriggerAll = fvar(37) = 0
;TriggerAll = fvar(39) = 0
triggerall = roundstate = 2
triggerall = power >= 2000
triggerall = statetype != A
TriggerAll = P2StateType != L
TriggerAll = P2MoveType = H
;triggerAll = P2bodydist Y <= 0-floor(15*(EnemyNear(floor(fvar(36))),vel Y)+(15*15/2)*fvar(30))
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
trigger1 = stateno = 1200 && movehit = 10
trigger2 = stateno = 1200 && movecontact && (inguarddist || p2movetype = A)
trigger3 = stateno = 1210 && movehit = 10
trigger4 = stateno = 1210 && movecontact && (inguarddist || p2movetype = A)
trigger5 = stateno = 1220 && movehit = 10
trigger6 = stateno = 1220 && movecontact && (inguarddist || p2movetype = A)
trigger7 = stateno = 1401 && (projhit1401 = 1,>= 25)
trigger8 = stateno = 1401 && (projcontact1401 = 1,>= 1) && (inguarddist || p2movetype = A)

[State -3, reflector cancel]
type = ChangeState
value = 1300
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = RoundState = 2
TriggerAll = StateType != A
TriggerAll = P2StateType != L
TriggerAll = P2MoveType = H
TriggerAll = p2stateno != [120,159]
triggerAll = movecontact
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
trigger1 = stateno = 260
trigger2 = stateno = 265

;===============================================================================
;Throw 投技
;===============================================================================
;前投げ                    ;C投技
[State -3, C throw]
type = ChangeState
value = 280
TriggerAll = fvar(6) != 1
TriggerAll = fvar(6) != 1
TriggerAll = var(59)
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = StateType != A                ;前提:  自己非空中
TriggerAll = RoundState = 2
TriggerAll = P2StateType != L              ;前提:  P2非倒地
TriggerAll = P2StateType != A              ;前提:  P2非空中
TriggerAll = P2BodyDist X = [-5,15]         ;前提: 技能范围内
TriggerAll = BackEdgeBodyDist <= 60                    ;前提: 身体距离版边<=60
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3)   ;statedef 19 AI后退,statedef 20 正常步行,statedef 21 AI前进,statedef 52 && Time >= 3跳跃落地并可控
TriggerAll = EnemyNear(floor(fvar(36))),AnimTime <= -1
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
Trigger1 = 1


;後ろ投げ                  ;D投技
[State -3, D throw]
type = ChangeState
value = 295
TriggerAll = fvar(6) != 1
TriggerAll = fvar(6) != 1
TriggerAll = var(59)
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = StateType != A
TriggerAll = RoundState = 2
TriggerAll = P2StateType != L                   ;前提:  P2非倒地
TriggerAll = P2StateType != A                   ;前提:  P2非空中
TriggerAll = P2BodyDist X = [-5,15]              ;前提: 技能范围内
TriggerAll = BackEdgeBodyDist > 60                    ;前提: 身体距离版边<=60
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3)  ;statedef 19 AI后退,statedef 20 正常步行,statedef 21 AI前进,statedef 52 && Time >= 3跳跃落地并可控
TriggerAll = EnemyNear(floor(fvar(36))),AnimTime <= -1
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
Trigger1 = 1

;===============================================================================
;AI移动分支   combo 连续技AI ("连续技启动指令"fvar(39))
;===============================================================================
;stand
[State -3, stand]
type = ChangeState
value = 0
Ctrl = 1
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = fvar(39)
TriggerAll = RoundState = 2
TriggerAll = StateType != A
TriggerAll = P2StateType != L
TriggerAll = P2MoveType = H
;**************反应速度及频率意识
TriggerAll = Random<=var(59)*85
;**************
TriggerAll = P2bodydist X <= 25
;TriggerAll = EnemyNear(floor(fvar(36))),BackEdgeBodyDist >= 11 || FrontEdgeBodyDist >= 45
;Trigger1 = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
Trigger1 = stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102

;Run Fwd
[State -3, Run Fwd]
type = ChangeState
value = 100
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = fvar(39)
TriggerAll = RoundState = 2
TriggerAll = StateType != A
TriggerAll = P2StateType != L
TriggerAll = P2MoveType = H
TriggerAll = stateno != 100
;**************反应速度及频率意识
TriggerAll = Random<=var(59)*85
;**************
TriggerAll = P2bodydist X >= 30
;TriggerAll = EnemyNear(floor(fvar(36))),BackEdgeBodyDist >= 11 || FrontEdgeBodyDist >= 45
Trigger1 = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3)


;===============================================================================
;AI Guard Universal  全局防御
;===============================================================================
[State -3]
Type = ChangeState
Value = ifelse(var(59)<13,120,ifelse((EnemyNear(floor(fvar(36))),ctrl),120,275))
ctrl = 1
TriggerAll = fvar(6) != 1
TriggerAll = RoundState = 2
TriggerAll = Var(59) > 0
TriggerAll = StateType = A
TriggerAll = Ctrl
TriggerAll = IfElse(Facing*(EnemyNear(floor(fvar(36))),Facing)*P2Dist X >0,(Abs(P2Dist X) <= 60),1)
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************分支条件
Trigger1 = InGuardDist || (Facing*(EnemyNear(floor(fvar(36))),Facing)*P2Dist X >0 && P2MoveType = A)
Trigger1 = EnemyNear(floor(fvar(36))),HitDefAttr = SC,NA,SA,HA,NP,SP,HP || EnemyNear(floor(fvar(36))),HitDefAttr = A,NA,SA,HA,NP,SP,HP
Trigger2 = InGuardDist || Facing*(EnemyNear(floor(fvar(36))),Facing)*P2Dist X >0
Trigger2 = Enemy,NumProj > 0
Trigger3 = EnemyNear(floor(fvar(36))),HitDefAttr = SC,NA,SA,HA,NP,SP,HP || EnemyNear(floor(fvar(36))),HitDefAttr = A,NA,SA,HA,NP,SP,HP
Trigger3 = P2BodyDist X < 0
Trigger4 = fvar(28) > 0
Trigger4 = EnemyNear(floor(fvar(36))),HitDefAttr = SC,NA,SA,HA,NP,SP,HP || EnemyNear(floor(fvar(36))),HitDefAttr = A,NA,SA,HA,NP,SP,HP
Trigger5 = Enemy,NumHelper
Trigger5 = InGuardDist


[State -3]
Type = ChangeState
Value = ifelse(var(59)<13,120,ifelse((EnemyNear(floor(fvar(36))),ctrl),120,275))
ctrl = 1
TriggerAll = fvar(6) != 1
TriggerAll = RoundState = 2
TriggerAll = Var(59) > 0
TriggerAll = StateType != A
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100
TriggerAll = IfElse(Facing*(EnemyNear(floor(fvar(36))),Facing)*P2Dist X >0,(Abs(P2Dist X) <= 60),1)
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************分支条件
Trigger1 = InGuardDist || (Facing*(EnemyNear(floor(fvar(36))),Facing)*P2Dist X >0 && P2MoveType = A)
Trigger1 = EnemyNear(floor(fvar(36))),HitDefAttr = SC,NA,SA,HA,NP,SP,HP || EnemyNear(floor(fvar(36))),HitDefAttr = A,NA,SA,HA,NP,SP,HP
Trigger2 = InGuardDist || Facing*(EnemyNear(floor(fvar(36))),Facing)*P2Dist X >0
Trigger2 = Enemy,NumProj > 0
Trigger3 = EnemyNear(floor(fvar(36))),HitDefAttr = SC,NA,SA,HA,NP,SP,HP || EnemyNear(floor(fvar(36))),HitDefAttr = A,NA,SA,HA,NP,SP,HP
Trigger3 = P2BodyDist X < 0
Trigger4 = fvar(28) > 0
Trigger4 = EnemyNear(floor(fvar(36))),HitDefAttr = SC,NA,SA,HA,NP,SP,HP || EnemyNear(floor(fvar(36))),HitDefAttr = A,NA,SA,HA,NP,SP,HP
Trigger5 = Enemy,NumHelper
Trigger5 = InGuardDist


;===============================================================================
;AI Recovery  受身
;===============================================================================
[State -3] ;空中受身
type = ChangeState
value = 5210
TriggerAll = Alive
TriggerAll = RoundState = 2
TriggerAll = Var(59)
TriggerAll = Alive
TriggerAll = CanRecover
TriggerAll = Vel Y > -1
TriggerAll = Pos Y < -20
TriggerAll = stateno = 5050
;**************反应速度及频率意识
TriggerAll = Random<=var(59)*85
Trigger1 = Random <= var(59)*100


[State -3] ;地面受身
type = ChangeState
value = 5201
TriggerAll = Alive
TriggerAll = RoundState = 2
TriggerAll = Var(59)
TriggerAll = Alive
TriggerAll = CanRecover
TriggerAll = Vel Y > -1
TriggerAll = Pos Y >= -20
TriggerAll = stateno = 5050
;**************反应速度及频率意识
TriggerAll = Random<=var(59)*85
Trigger1 = Random <= var(59)*100

;━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
;起手攻击
;━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
[State -3, stop jump]
type = ChangeState
value = 0
ctrl = 1
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = RoundState = 2
TriggerAll = StateType != A
TriggerAll = StateNo = 40         ;jump start state
;**************反应速度及频率意识
TriggerAll = Random<=var(59)*85
;**************
TriggerAll = p2Statetype != A
trigger1 = time = 0

[State -1, COMBINATION THROW OF GOENITZ]
type = ChangeState
value = 2600
TriggerAll = fvar(6) != 1
TriggerAll = RoundState = 2
TriggerAll = var(59)
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = power >= 4000  ; ---- easily miss so don't use it very often
triggerall = fvar(23) < ifelse(((palno = 12) || ((palno=[7,11]) && var(58)=1 && floor(var(42)/10)%10=1)),var(40)/2,var(40)) ;striker geonitz not using
TriggerAll = StateType != A
TriggerAll = P2StateType != L
TriggerAll = P2bodydist X = [-5,20]
TriggerAll = P2StateType != A
TriggerAll = P2MoveType != H
TriggerAll = !(EnemyNear(floor(fvar(36))),prevstateno = 5120 && EnemyNear(floor(fvar(36))),time <= 10)
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100
Trigger1 = Random <= var(59)*85
Trigger2 = (P2StateNo=[120,159])

;Super Lightning Invocation                 ;<混> 近程
[State -3, Super Lightning Invocation]
type = null;ChangeState
value = 2500
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = power >= 1000
TriggerAll = !InGuardDist
TriggerAll = !EnemyNear(floor(fvar(36))),NumProj
TriggerAll = RoundState = 2
TriggerAll = statetype != A                ;前提:  自己非空中
TriggerAll = P2StateType != L              ;前提:  P2非倒地
TriggerAll = P2moveType = A               ;前提:  P2攻击
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102 ;前提:  自己可控,刚从倒地起身
TriggerAll = EnemyNear(floor(fvar(36))),ctrl = 0
TriggerAll = EnemyNear(floor(fvar(36))),AnimTime <= -8
TriggerAll = EnemyNear(floor(fvar(36))),StateNo != [120,159]
TriggerAll = EnemyNear(floor(fvar(36))),Vel Y <= 0  || P2bodydist Y <= -5-floor(11*(EnemyNear(floor(fvar(36))),vel Y)+(11*11/2)*fvar(30))
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
trigger1 = P2bodydist X = [-5+floor(8*(EnemyNear(floor(fvar(36))),vel X)),50-Const(size.ground.front)+floor(8*(EnemyNear(floor(fvar(36))),vel X))]
trigger1 = P2bodydist Y = [-220-floor(8*(EnemyNear(floor(fvar(36))),vel Y)+(8*8/2)*fvar(30)),0-floor(8*(EnemyNear(floor(fvar(36))),vel Y)+(40*40/2)*fvar(30))]
trigger2 = P2bodydist X = [50-Const(size.ground.front)+floor(16*(EnemyNear(floor(fvar(36))),vel X)),90-Const(size.ground.front)+floor(16*(EnemyNear(floor(fvar(36))),vel X))]
trigger2 = P2bodydist Y = [-220-floor(16*(EnemyNear(floor(fvar(36))),vel Y)+(16*16/2)*fvar(30)),0-floor(16*(EnemyNear(floor(fvar(36))),vel Y)+(40*40/2)*fvar(30))]
Trigger2 = EnemyNear(floor(fvar(36))),AnimTime <= -16
trigger3 = P2bodydist X = [90-Const(size.ground.front)+floor(24*(EnemyNear(floor(fvar(36))),vel X)),130-Const(size.ground.front)+floor(24*(EnemyNear(floor(fvar(36))),vel X))]
trigger3 = P2bodydist Y = [-220-floor(24*(EnemyNear(floor(fvar(36))),vel Y)+(24*24/2)*fvar(30)),0-floor(24*(EnemyNear(floor(fvar(36))),vel Y)+(40*40/2)*fvar(30))]
Trigger3 = EnemyNear(floor(fvar(36))),AnimTime <= -24
trigger4 = P2bodydist X = [130-Const(size.ground.front)+floor(32*(EnemyNear(floor(fvar(36))),vel X)),170-Const(size.ground.front)+floor(32*(EnemyNear(floor(fvar(36))),vel X))]
trigger4 = P2bodydist Y = [-220-floor(32*(EnemyNear(floor(fvar(36))),vel Y)+(32*32/2)*fvar(30)),0-floor(32*(EnemyNear(floor(fvar(36))),vel Y)+(40*40/2)*fvar(30))]
Trigger4 = EnemyNear(floor(fvar(36))),AnimTime <= -32
;trigger5 = P2bodydist X = [170-Const(size.ground.front)+floor(40*(EnemyNear(floor(fvar(36))),vel X)),210-Const(size.ground.front)+floor(40*(EnemyNear(floor(fvar(36))),vel X))]
;trigger5 = P2bodydist Y = [-220-floor(40*(EnemyNear(floor(fvar(36))),vel Y)+(40*40/2)*fvar(30)),0-floor(40*(EnemyNear(floor(fvar(36))),vel Y)+(40*40/2)*fvar(30))]

;Soul Extraction DM                    ;<掏心> 无敌12tick 近程
[State -3,Soul Extraction DM]
type = ChangeState
value = 2100
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = power >= 1000
TriggerAll = RoundState = 2
TriggerAll = statetype != A                ;前提:  自己非空中
TriggerAll = P2StateType != L              ;前提:  P2非倒地
TriggerAll = P2moveType != H               ;前提:  P2非受击
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102 || stateno = 120 || stateno = 140
TriggerAll = P2moveType = A               ;前提:  P2攻击
TriggerAll = EnemyNear(floor(fvar(36))),ctrl = 0
TriggerAll = EnemyNear(floor(fvar(36))),StateNo >= 2000
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
triggerall = EnemyNear(floor(fvar(36))),Vel X >= 0
triggerall = EnemyNear(floor(fvar(36))),ctrl = 0
trigger1 = p2statetype = A
trigger1 = P2dist X >= -75+floor(ifelse(19>fvar(31),19-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
trigger1 = P2dist X <= 75+floor(ifelse(19>fvar(31),19-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
trigger1 = P2bodydist Y >= -80-floor(ifelse(19>fvar(31),19-fvar(31),0)*fvar(29)+(ifelse(19>fvar(31),19-fvar(31),0)*19/2)*fvar(30))
trigger2 = p2statetype != A
trigger2 = P2dist X >= -75+floor(ifelse(19>fvar(31),19-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
trigger2 = P2dist X <= 75+floor(ifelse(19>fvar(31),19-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))

; Mu ni Kaerou lv1                    ;<阳光普照>起手不无敌
[State -3,Mu ni Kaerou lv1]
type = ChangeState
value = 2000
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = (power >= 1000 && power < 2000) || power >= 4000
TriggerAll = statetype != A                ;前提:  自己非空中
TriggerAll = P2StateType != L              ;前提:  P2非倒地
TriggerAll = P2moveType != H               ;前提:  P2非受击
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102 || stateno = 120 || stateno = 140
TriggerAll = EnemyNear(floor(fvar(36))),ctrl = 0
TriggerAll = EnemyNear(floor(fvar(36))),AnimTime <= -12               ;前提:  最近之敌将来不及防御
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
TriggerAll = !EnemyNear(floor(fvar(36))),NumProj
Trigger1 = P2MoveType = A
Trigger1 = P2StateNo != [120,159]

; Mu ni Kaerou lv2                    ;<圣光普照>起手 完全无敌
[State -3,Mu ni Kaerou lv2]
type = ChangeState
value = 2010
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = power >= 2000
TriggerAll = power < 4000
TriggerAll = statetype != A                ;前提:  自己非空中
TriggerAll = P2StateType != L              ;前提:  P2非倒地
TriggerAll = P2moveType != H               ;前提:  P2非受击
TriggerAll = EnemyNear(floor(fvar(36))),ctrl = 0
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102 || stateno = 120 || stateno = 140
TriggerAll = EnemyNear(floor(fvar(36))),AnimTime <= -13               ;前提:  最近之敌将来不及防御
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
Trigger1 = P2MoveType = A
Trigger1 = P2StateNo != [120,159]

;中段 <神指>
[State -3, mirror1]
type = ChangeState
value = 1200
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59) &&  var(59) < 13
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = statetype != A                 ;前提:  自己非空中
TriggerAll = RoundState = 2
TriggerAll = P2StateType != L                   ;前提: P2非倒地
TriggerAll = P2StateType = S || P2StateType = A || P2StateType = C
TriggerAll = P2movetype = A
TriggerAll = EnemyNear(floor(fvar(36))),StateNo != [120,159]
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
TriggerAll = EnemyNear(floor(fvar(36))),ctrl = 0
TriggerAll = EnemyNear(floor(fvar(36))),AnimTime <= -8        ;来不及防御
triggerAll = P2bodydist X <= 67-Const(size.ground.front)+floor(8*(EnemyNear(floor(fvar(36))),vel X))
triggerAll = P2bodydist Y = [-136-floor(8*(EnemyNear(floor(fvar(36))),vel Y)+(8*8/2)*fvar(30)),0]
TriggerAll = EnemyNear(floor(fvar(36))),hitdefattr != SCA, HP
Trigger1 = EnemyNear(floor(fvar(36))),Time >= var(55)                ;var(55)AI反应速度,AI难度越大,var(55)越小,AI反应越迅速
Trigger2 = var(59) >= 11                 ;常时启动: AI难度11级以上

;下段 <神指>  站立远距
[State -3, mirror3]
type = ChangeState
value = 1220
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59) &&  var(59) < 13
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = statetype != A                 ;前提:  自己非空中
TriggerAll = RoundState = 2
TriggerAll = P2StateType != L                   ;前提: P2非倒地
TriggerAll = P2StateType = C || P2StateType = S
TriggerAll = P2movetype = A
TriggerAll = EnemyNear(floor(fvar(36))),Vel X >= 0
TriggerAll = EnemyNear(floor(fvar(36))),Vel Y >= 0
TriggerAll = EnemyNear(floor(fvar(36))),StateNo != [120,159]
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
TriggerAll = EnemyNear(floor(fvar(36))),ctrl = 0
TriggerAll = EnemyNear(floor(fvar(36))),AnimTime <= -8        ;来不及防御
triggerAll = P2bodydist X = [67-Const(size.ground.front)+floor(8*(EnemyNear(floor(fvar(36))),vel X)),103-Const(size.ground.front)+floor(8*(EnemyNear(floor(fvar(36))),vel X))]
triggerAll = P2bodydist Y = [-136-floor(8*(EnemyNear(floor(fvar(36))),vel Y)+(8*8/2)*fvar(30)),0]
Trigger1 = EnemyNear(floor(fvar(36))),Time >= var(55)                ;var(55)AI反应速度,AI难度越大,var(55)越小,AI反应越迅速
Trigger2 = var(59) >= 11                 ;常时启动: AI难度11级以上

;下段 <神指>
[State -3, mirror3]
type = ChangeState
value = 1220
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59) &&  var(59) < 13
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = statetype != A                 ;前提:  自己非空中
TriggerAll = RoundState = 2
TriggerAll = P2StateType != L                   ;前提: P2非倒地
;TriggerAll = P2StateType = C||P2StateType = S
TriggerAll = P2movetype = A
TriggerAll = EnemyNear(floor(fvar(36))),StateNo != [120,159]
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
TriggerAll = EnemyNear(floor(fvar(36))),ctrl = 0
TriggerAll = EnemyNear(floor(fvar(36))),AnimTime <= -8        ;来不及防御
triggerAll = P2bodydist X <= 67-Const(size.ground.front)+floor(8*(EnemyNear(floor(fvar(36))),vel X))
triggerAll = P2bodydist Y = [-136-floor(8*(EnemyNear(floor(fvar(36))),vel Y)+(8*8/2)*fvar(30)),0]
Trigger1 = EnemyNear(floor(fvar(36))),Time >= var(55)                ;var(55)AI反应速度,AI难度越大,var(55)越小,AI反应越迅速
Trigger2 = var(59) >= 11                 ;常时启动: AI难度11级以上

;上段 <神指>
[State -3, mirror2]
type = ChangeState
value = 1210
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59) &&  var(59) < 13
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = statetype != A                 ;前提:  自己非空中
TriggerAll = RoundState = 2
TriggerAll = P2StateType != L                   ;前提: P2非倒地
TriggerAll = P2StateType = A                 ;前提:  P2空中
TriggerAll = P2movetype = A
TriggerAll = EnemyNear(floor(fvar(36))),StateNo != [120,159]
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
;TriggerAll = EnemyNear(floor(fvar(36))),ctrl = 0
TriggerAll = EnemyNear(floor(fvar(36))),AnimTime <= -9        ;来不及防御
triggerAll = P2bodydist X <= 61-Const(size.ground.front)+floor(9*(EnemyNear(floor(fvar(36))),vel X))
triggerAll = P2bodydist Y = [-151-floor(9*(EnemyNear(floor(fvar(36))),vel Y)+(9*9/2)*fvar(30)),-104-floor(9*(EnemyNear(floor(fvar(36))),vel Y)+(9*9/2)*fvar(30))]
Trigger1 = EnemyNear(floor(fvar(36))),Time >= var(55)                ;var(55)AI反应速度,AI难度越大,var(55)越小,AI反应越迅速
Trigger2 = var(59) >= 11                 ;常时启动: AI难度11级以上

;━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
;浮かし追           ;浮空追击
;━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
; Lightning Strike A
[State -3, Lightning Strike]     ;天雷闪A 浮空追击 非版边
type = ChangeState
value = 1000
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = Statetype != A
TriggerAll = P2StateType = A
TriggerAll = P2StateType != L
TriggerAll = P2movetype = H && P2StateNo != [120,159]
TriggerAll = ifelse((NumEnemy=2&&(EnemyNear(0),alive)&&(EnemyNear(1),alive)),((EnemyNear(1),movetype=H)&&(EnemyNear(1),StateNo!=[120,159])),1)
TriggerAll = !inguarddist
TriggerAll = P2bodydist X > 5
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
TriggerAll = (P2StateNo != 1205) && (P2StateNo != 1225) && (P2StateNo != 1226)
;TriggerAll = frontedgebodydist < ceil(48*const(size.xscale))-39
;TriggerAll = EnemyNear(floor(fvar(36))),backedgebodydist > 40
;***************
TriggerAll = ifelse((facing*EnemyNear(floor(fvar(36))),facing)=-1,EnemyNear(floor(fvar(36))),BackEdgeBodyDist>=30 || fvar(28)>0,1)
TriggerAll = ifelse((facing*EnemyNear(floor(fvar(36))),facing)=1,EnemyNear(floor(fvar(36))),FrontEdgeBodyDist>=30 || fvar(28)<0,1)
;***************
TriggerALL = P2dist X >= ceil(48*const(size.xscale))-25+floor(ifelse(19>fvar(31),19-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
TriggerALL = P2dist X <= ceil(48*const(size.xscale))+23+floor(ifelse(19>fvar(31),19-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
;TriggerAll = P2BodyDist Y = [-200-floor(15*(EnemyNear(floor(fvar(36))),vel Y)+(15*15/2)*fvar(30)),0-floor(15*(EnemyNear(floor(fvar(36))),vel Y)+(15*15/2)*fvar(30))]
TriggerAll = P2bodydist y >= -200-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30)+fvar(32))
TriggerAll = P2bodydist y <= -1-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30)+fvar(32))
TriggerAll = P2bodydist y <= -1-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30));浮空确保 AirEnsure
Trigger1 = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102


; Lightning Strike A
[State -3, Lightning Strike]     ;天雷闪A 浮空追击 版边
type = ChangeState
value = 1000
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = Statetype != A
TriggerAll = P2StateType = A
TriggerAll = P2StateType != L
TriggerAll = P2movetype = H && P2StateNo != [120,159]
TriggerAll = ifelse((NumEnemy=2&&(EnemyNear(0),alive)&&(EnemyNear(1),alive)),((EnemyNear(1),movetype=H)&&(EnemyNear(1),StateNo!=[120,159])),1)
TriggerAll = !inguarddist
TriggerAll = P2bodydist X > 5
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
TriggerAll = (P2StateNo != 1205) && (P2StateNo != 1225) && (P2StateNo != 1226)
;TriggerAll = frontedgebodydist < ceil(48*const(size.xscale))-39
;TriggerAll = EnemyNear(floor(fvar(36))),backedgebodydist <= 40
;***************
TriggerAll = -facing*EnemyNear(floor(fvar(36))),facing*fvar(28)<=0
TriggerAll = ifelse((facing*EnemyNear(floor(fvar(36))),facing)=-1,EnemyNear(floor(fvar(36))),BackEdgeBodyDist <= 30,1)
TriggerAll = ifelse((facing*EnemyNear(floor(fvar(36))),facing)=1,EnemyNear(floor(fvar(36))),FrontEdgeBodyDist <= 30,1)
;***************
TriggerALL = P2dist X >= ceil(48*const(size.xscale))-25;+floor(ifelse(15>fvar(31),15-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
TriggerALL = P2dist X <= ceil(48*const(size.xscale))+23;+floor(ifelse(15>fvar(31),15-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
;TriggerAll = P2BodyDist Y = [-200-floor(15*(EnemyNear(floor(fvar(36))),vel Y)+(15*15/2)*fvar(30)),0-floor(15*(EnemyNear(floor(fvar(36))),vel Y)+(15*15/2)*fvar(30))]
TriggerAll = P2bodydist y >= -200-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30)+fvar(32))
TriggerAll = P2bodydist y <= -1-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30)+fvar(32))
TriggerAll = P2bodydist y <= -1-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30));浮空确保 AirEnsure
Trigger1 = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
Trigger1 = power < 1000

; Lightning Strike B
[State -3, Lightning Strike]     ;天雷闪B 浮空追击 非版边
type = ChangeState
value = 1001
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = Statetype != A
TriggerAll = P2StateType = A
TriggerAll = P2StateType != L
TriggerAll = P2movetype = H && P2StateNo != [120,159]
TriggerAll = ifelse((NumEnemy=2&&(EnemyNear(0),alive)&&(EnemyNear(1),alive)),((EnemyNear(1),movetype=H)&&(EnemyNear(1),StateNo!=[120,159])),1)
TriggerAll = !inguarddist
TriggerAll = P2bodydist X > 5
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
TriggerAll = (P2StateNo != 1205) && (P2StateNo != 1225) && (P2StateNo != 1226)
;TriggerAll = frontedgebodydist < ceil(96*const(size.xscale))-39
;TriggerAll = EnemyNear(floor(fvar(36))),backedgebodydist > 40
;***************
TriggerAll = ifelse((facing*EnemyNear(floor(fvar(36))),facing)=-1,EnemyNear(floor(fvar(36))),BackEdgeBodyDist>=30 || fvar(28)>0,1)
TriggerAll = ifelse((facing*EnemyNear(floor(fvar(36))),facing)=1,EnemyNear(floor(fvar(36))),FrontEdgeBodyDist>=30 || fvar(28)<0,1)
;***************
TriggerALL = P2dist X >= ceil(96*const(size.xscale))-25+floor(ifelse(19>fvar(31),19-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
TriggerALL = P2dist X <= ceil(96*const(size.xscale))+23+floor(ifelse(19>fvar(31),19-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
;TriggerAll = P2BodyDist Y = [-200-floor(15*(EnemyNear(floor(fvar(36))),vel Y)+(15*15/2)*fvar(30)),0-floor(15*(EnemyNear(floor(fvar(36))),vel Y)+(15*15/2)*fvar(30))]
TriggerAll = P2bodydist y >= -200-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30)+fvar(32))
TriggerAll = P2bodydist y <= -1-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30)+fvar(32))
TriggerAll = P2bodydist y <= -1-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30));浮空确保 AirEnsure
Trigger1 = StateNo = 1000 && time >= 30
Trigger2 = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102

; Lightning Strike B
[State -3, Lightning Strike]     ;天雷闪B 浮空追击 版边
type = ChangeState
value = 1001
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = Statetype != A
TriggerAll = P2StateType = A
TriggerAll = P2StateType != L
TriggerAll = P2movetype = H && P2StateNo != [120,159]
TriggerAll = ifelse((NumEnemy=2&&(EnemyNear(0),alive)&&(EnemyNear(1),alive)),((EnemyNear(1),movetype=H)&&(EnemyNear(1),StateNo!=[120,159])),1)
TriggerAll = !inguarddist
TriggerAll = P2bodydist X > 5
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
TriggerAll = (P2StateNo != 1205) && (P2StateNo != 1225) && (P2StateNo != 1226)
;TriggerAll = frontedgebodydist < ceil(96*const(size.xscale))-39
;TriggerAll = EnemyNear(floor(fvar(36))),backedgebodydist <= 40
;***************
TriggerAll = -facing*EnemyNear(floor(fvar(36))),facing*fvar(28)<=0
TriggerAll = ifelse((facing*EnemyNear(floor(fvar(36))),facing)=-1,EnemyNear(floor(fvar(36))),BackEdgeBodyDist <= 30,1)
TriggerAll = ifelse((facing*EnemyNear(floor(fvar(36))),facing)=1,EnemyNear(floor(fvar(36))),FrontEdgeBodyDist <= 30,1)
;***************
TriggerALL = P2dist X >= ceil(96*const(size.xscale))-25;+floor(ifelse(15>fvar(31),15-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
TriggerALL = P2dist X <= ceil(96*const(size.xscale))+23;+floor(ifelse(15>fvar(31),15-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
;TriggerAll = P2BodyDist Y = [-200-floor(15*(EnemyNear(floor(fvar(36))),vel Y)+(15*15/2)*fvar(30)),0-floor(15*(EnemyNear(floor(fvar(36))),vel Y)+(15*15/2)*fvar(30))]
TriggerAll = P2bodydist y >= -200-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30)+fvar(32))
TriggerAll = P2bodydist y <= -1-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30)+fvar(32))
TriggerAll = P2bodydist y <= -1-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30));浮空确保 AirEnsure
Trigger1 = StateNo = 1000 && time >= 30
;Trigger2 = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102

; Lightning Strike C
[State -3, Lightning Strike]     ;天雷闪C 浮空追击 非版边
type = ChangeState
value = 1002
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = Statetype != A
TriggerAll = P2StateType = A
TriggerAll = P2StateType != L
TriggerAll = P2movetype = H && P2StateNo != [120,159]
TriggerAll = ifelse((NumEnemy=2&&(EnemyNear(0),alive)&&(EnemyNear(1),alive)),((EnemyNear(1),movetype=H)&&(EnemyNear(1),StateNo!=[120,159])),1)
TriggerAll = !inguarddist
TriggerAll = P2bodydist X > 5
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
TriggerAll = (P2StateNo != 1205) && (P2StateNo != 1225) && (P2StateNo != 1226)
;TriggerAll = frontedgebodydist < ceil(144*const(size.xscale))-39
;TriggerAll = EnemyNear(floor(fvar(36))),backedgebodydist > 40
;***************
TriggerAll = ifelse((facing*EnemyNear(floor(fvar(36))),facing)=-1,EnemyNear(floor(fvar(36))),BackEdgeBodyDist>=30 || fvar(28)>0,1)
TriggerAll = ifelse((facing*EnemyNear(floor(fvar(36))),facing)=1,EnemyNear(floor(fvar(36))),FrontEdgeBodyDist>=30 || fvar(28)<0,1)
;***************
TriggerALL = P2dist X >= ceil(144*const(size.xscale))-25+floor(ifelse(19>fvar(31),19-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
TriggerALL = P2dist X <= ceil(144*const(size.xscale))+23+floor(ifelse(19>fvar(31),19-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
;TriggerAll = P2BodyDist Y = [-200-floor(15*(EnemyNear(floor(fvar(36))),vel Y)+(15*15/2)*fvar(30)),0-floor(15*(EnemyNear(floor(fvar(36))),vel Y)+(15*15/2)*fvar(30))]
TriggerAll = P2bodydist y >= -200-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30)+fvar(32))
TriggerAll = P2bodydist y <= -1-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30)+fvar(32))
TriggerAll = P2bodydist y <= -1-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30));浮空确保 AirEnsure
Trigger1 = StateNo = 1001 && time >= 30
Trigger2 = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102

; Lightning Strike C
[State -3, Lightning Strike]     ;天雷闪C 浮空追击 版边
type = ChangeState
value = 1002
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = Statetype != A
TriggerAll = P2StateType = A
TriggerAll = P2StateType != L
TriggerAll = P2movetype = H && P2StateNo != [120,159]
TriggerAll = ifelse((NumEnemy=2&&(EnemyNear(0),alive)&&(EnemyNear(1),alive)),((EnemyNear(1),movetype=H)&&(EnemyNear(1),StateNo!=[120,159])),1)
TriggerAll = !inguarddist
TriggerAll = P2bodydist X > 5
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
TriggerAll = (P2StateNo != 1205) && (P2StateNo != 1225) && (P2StateNo != 1226)
;TriggerAll = frontedgebodydist < ceil(144*const(size.xscale))-39
;TriggerAll = EnemyNear(floor(fvar(36))),backedgebodydist <= 40
;***************
TriggerAll = -facing*EnemyNear(floor(fvar(36))),facing*fvar(28)<=0
TriggerAll = ifelse((facing*EnemyNear(floor(fvar(36))),facing)=-1,EnemyNear(floor(fvar(36))),BackEdgeBodyDist <= 30,1)
TriggerAll = ifelse((facing*EnemyNear(floor(fvar(36))),facing)=1,EnemyNear(floor(fvar(36))),FrontEdgeBodyDist <= 30,1)
;***************
TriggerALL = P2dist X >= ceil(144*const(size.xscale))-25;+floor(ifelse(15>fvar(31),15-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
TriggerALL = P2dist X <= ceil(144*const(size.xscale))+23;+floor(ifelse(15>fvar(31),15-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
;TriggerAll = P2BodyDist Y = [-200-floor(15*(EnemyNear(floor(fvar(36))),vel Y)+(15*15/2)*fvar(30)),0-floor(15*(EnemyNear(floor(fvar(36))),vel Y)+(15*15/2)*fvar(30))]
TriggerAll = P2bodydist y >= -200-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30)+fvar(32))
TriggerAll = P2bodydist y <= -1-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30)+fvar(32))
TriggerAll = P2bodydist y <= -1-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30));浮空确保 AirEnsure
Trigger1 = StateNo = 1001 && time >= 30
;Trigger2 = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102

; Lightning Strike D
[State -3, Lightning Strike]     ;天雷闪D 浮空追击 非版边
type = ChangeState
value = 1003
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = Statetype != A
TriggerAll = P2StateType = A
TriggerAll = P2StateType != L
TriggerAll = P2movetype = H && P2StateNo != [120,159]
TriggerAll = ifelse((NumEnemy=2&&(EnemyNear(0),alive)&&(EnemyNear(1),alive)),((EnemyNear(1),movetype=H)&&(EnemyNear(1),StateNo!=[120,159])),1)
TriggerAll = !inguarddist
TriggerAll = P2bodydist X > 5
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
TriggerAll = (P2StateNo != 1205) && (P2StateNo != 1225) && (P2StateNo != 1226)
;TriggerAll = frontedgebodydist > ceil(192*const(size.xscale))-39
;TriggerAll = EnemyNear(floor(fvar(36))),backedgebodydist > 40
;***************
TriggerAll = ifelse((facing*EnemyNear(floor(fvar(36))),facing)=-1,EnemyNear(floor(fvar(36))),BackEdgeBodyDist>=30 || fvar(28)>0,1)
TriggerAll = ifelse((facing*EnemyNear(floor(fvar(36))),facing)=1,EnemyNear(floor(fvar(36))),FrontEdgeBodyDist>=30 || fvar(28)<0,1)
;***************
TriggerALL = P2dist X >= ceil(192*const(size.xscale))-25+floor(ifelse(19>fvar(31),19-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
TriggerALL = P2dist X <= ceil(192*const(size.xscale))+23+floor(ifelse(19>fvar(31),19-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
;TriggerAll = P2BodyDist Y = [-200-floor(15*(EnemyNear(floor(fvar(36))),vel Y)+(15*15/2)*fvar(30)),0-floor(15*(EnemyNear(floor(fvar(36))),vel Y)+(15*15/2)*fvar(30))]
TriggerAll = P2bodydist y >= -200-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30)+fvar(32))
TriggerAll = P2bodydist y <= -1-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30)+fvar(32))
TriggerAll = P2bodydist y <= -1-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30));浮空确保 AirEnsure
Trigger1 = StateNo = 1002 && time >= 30
Trigger2 = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102

; Lightning Strike D
[State -3, Lightning Strike]     ;天雷闪D 浮空追击 版边
type = ChangeState
value = 1003
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = Statetype != A
TriggerAll = P2StateType = A
TriggerAll = P2StateType != L
TriggerAll = P2movetype = H && P2StateNo != [120,159]
TriggerAll = ifelse((NumEnemy=2&&(EnemyNear(0),alive)&&(EnemyNear(1),alive)),((EnemyNear(1),movetype=H)&&(EnemyNear(1),StateNo!=[120,159])),1)
TriggerAll = !inguarddist
TriggerAll = P2bodydist X > 5
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
TriggerAll = (P2StateNo != 1205) && (P2StateNo != 1225) && (P2StateNo != 1226)
;TriggerAll = frontedgebodydist > ceil(192*const(size.xscale))-39
;TriggerAll = EnemyNear(floor(fvar(36))),backedgebodydist <= 40
;***************
TriggerAll = -facing*EnemyNear(floor(fvar(36))),facing*fvar(28)<=0
TriggerAll = ifelse((facing*EnemyNear(floor(fvar(36))),facing)=-1,EnemyNear(floor(fvar(36))),BackEdgeBodyDist <= 30,1)
TriggerAll = ifelse((facing*EnemyNear(floor(fvar(36))),facing)=1,EnemyNear(floor(fvar(36))),FrontEdgeBodyDist <= 30,1)
;***************
TriggerALL = P2dist X >= ceil(192*const(size.xscale))-25;+floor(ifelse(15>fvar(31),15-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
TriggerALL = P2dist X <= ceil(192*const(size.xscale))+23;+floor(ifelse(15>fvar(31),15-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
;TriggerAll = P2BodyDist Y = [-200-floor(15*(EnemyNear(floor(fvar(36))),vel Y)+(15*15/2)*fvar(30)),0-floor(15*(EnemyNear(floor(fvar(36))),vel Y)+(15*15/2)*fvar(30))]
TriggerAll = P2bodydist y >= -200-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30)+fvar(32))
TriggerAll = P2bodydist y <= -1-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30)+fvar(32))
TriggerAll = P2bodydist y <= -1-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30));浮空确保 AirEnsure
Trigger1 = StateNo = 1002 && time >= 30
;Trigger2 = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102

; Lightning Strike E
[State -3, Lightning Strike]     ;天雷闪E 浮空追击 非版边
type = ChangeState
value = 1004
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = Statetype != A
TriggerAll = P2StateType = A
TriggerAll = P2StateType != L
TriggerAll = P2movetype = H && P2StateNo != [120,159]
TriggerAll = ifelse((NumEnemy=2&&(EnemyNear(0),alive)&&(EnemyNear(1),alive)),((EnemyNear(1),movetype=H)&&(EnemyNear(1),StateNo!=[120,159])),1)
TriggerAll = !inguarddist
TriggerAll = P2bodydist X > 5
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
TriggerAll = (P2StateNo != 1205) && (P2StateNo != 1225) && (P2StateNo != 1226)
;TriggerAll = frontedgebodydist < ceil(240*const(size.xscale))-39
;TriggerAll = EnemyNear(floor(fvar(36))),backedgebodydist > 40
;***************
TriggerAll = ifelse((facing*EnemyNear(floor(fvar(36))),facing)=-1,EnemyNear(floor(fvar(36))),BackEdgeBodyDist>=30 || fvar(28)>0,1)
TriggerAll = ifelse((facing*EnemyNear(floor(fvar(36))),facing)=1,EnemyNear(floor(fvar(36))),FrontEdgeBodyDist>=30 || fvar(28)<0,1)
;***************
TriggerALL = P2dist X >= ceil(240*const(size.xscale))-25+floor(ifelse(19>fvar(31),19-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
TriggerALL = P2dist X <= ceil(240*const(size.xscale))+23+floor(ifelse(19>fvar(31),19-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
;TriggerAll = P2BodyDist Y = [-200-floor(15*(EnemyNear(floor(fvar(36))),vel Y)+(15*15/2)*fvar(30)),0-floor(15*(EnemyNear(floor(fvar(36))),vel Y)+(15*15/2)*fvar(30))]
TriggerAll = P2bodydist y >= -200-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30)+fvar(32))
TriggerAll = P2bodydist y <= -1-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30)+fvar(32))
TriggerAll = P2bodydist y <= -1-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30));浮空确保 AirEnsure
Trigger1 = StateNo = 1003 && time >= 30
Trigger2 = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102

; Lightning Strike E
[State -3, Lightning Strike]     ;天雷闪E 浮空追击 版边
type = ChangeState
value = 1004
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = Statetype != A
TriggerAll = P2StateType = A
TriggerAll = P2StateType != L
TriggerAll = P2movetype = H && P2StateNo != [120,159]
TriggerAll = ifelse((NumEnemy=2&&(EnemyNear(0),alive)&&(EnemyNear(1),alive)),((EnemyNear(1),movetype=H)&&(EnemyNear(1),StateNo!=[120,159])),1)
TriggerAll = !inguarddist
TriggerAll = P2bodydist X > 5
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
TriggerAll = (P2StateNo != 1205) && (P2StateNo != 1225) && (P2StateNo != 1226)
;TriggerAll = frontedgebodydist < ceil(240*const(size.xscale))-39
;TriggerAll = EnemyNear(floor(fvar(36))),backedgebodydist <= 40
;***************
TriggerAll = -facing*EnemyNear(floor(fvar(36))),facing*fvar(28)<=0
TriggerAll = ifelse((facing*EnemyNear(floor(fvar(36))),facing)=-1,EnemyNear(floor(fvar(36))),BackEdgeBodyDist <= 30,1)
TriggerAll = ifelse((facing*EnemyNear(floor(fvar(36))),facing)=1,EnemyNear(floor(fvar(36))),FrontEdgeBodyDist <= 30,1)
;***************
TriggerALL = P2dist X >= ceil(240*const(size.xscale))-25;+floor(ifelse(15>fvar(31),15-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
TriggerALL = P2dist X <= ceil(240*const(size.xscale))+23;+floor(ifelse(15>fvar(31),15-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
;TriggerAll = P2BodyDist Y = [-200-floor(15*(EnemyNear(floor(fvar(36))),vel Y)+(15*15/2)*fvar(30)),0-floor(15*(EnemyNear(floor(fvar(36))),vel Y)+(15*15/2)*fvar(30))]
TriggerAll = P2bodydist y >= -200-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30)+fvar(32))
TriggerAll = P2bodydist y <= -1-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30)+fvar(32))
TriggerAll = P2bodydist y <= -1-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30));浮空确保 AirEnsure
Trigger1 = StateNo = 1003 && time >= 30
;Trigger2 = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102

; Lightning Strike F
[State -3, Lightning Strike]     ;天雷闪F 浮空追击  非版边
type = ChangeState
value = 1005
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = Statetype != A
TriggerAll = P2StateType = A
TriggerAll = P2StateType != L
TriggerAll = P2movetype = H && P2StateNo != [120,159]
TriggerAll = ifelse((NumEnemy=2&&(EnemyNear(0),alive)&&(EnemyNear(1),alive)),((EnemyNear(1),movetype=H)&&(EnemyNear(1),StateNo!=[120,159])),1)
TriggerAll = !inguarddist
TriggerAll = P2bodydist X > 5
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
TriggerAll = (P2StateNo != 1205) && (P2StateNo != 1225) && (P2StateNo != 1226)
;TriggerAll = frontedgebodydist < ceil(288*const(size.xscale))-39
;TriggerAll = EnemyNear(floor(fvar(36))),backedgebodydist > 40
;***************
TriggerAll = ifelse((facing*EnemyNear(floor(fvar(36))),facing)=-1,EnemyNear(floor(fvar(36))),BackEdgeBodyDist>=30 || fvar(28)>0,1)
TriggerAll = ifelse((facing*EnemyNear(floor(fvar(36))),facing)=1,EnemyNear(floor(fvar(36))),FrontEdgeBodyDist>=30 || fvar(28)<0,1)
;***************
TriggerALL = P2dist X >= ceil(288*const(size.xscale))-25+floor(ifelse(19>fvar(31),19-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
TriggerALL = P2dist X <= ceil(288*const(size.xscale))+23+floor(ifelse(19>fvar(31),19-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
;TriggerAll = P2BodyDist Y = [-200-floor(15*(EnemyNear(floor(fvar(36))),vel Y)+(15*15/2)*fvar(30)),0-floor(15*(EnemyNear(floor(fvar(36))),vel Y)+(15*15/2)*fvar(30))]
TriggerAll = P2bodydist y >= -200-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30)+fvar(32))
TriggerAll = P2bodydist y <= -1-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30)+fvar(32))
TriggerAll = P2bodydist y <= -1-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30));浮空确保 AirEnsure
Trigger1 = StateNo = 1004 && time >= 30
Trigger2 = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102

; Lightning Strike F
[State -3, Lightning Strike]     ;天雷闪F 浮空追击  版边
type = ChangeState
value = 1005
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = Statetype != A
TriggerAll = P2StateType = A
TriggerAll = P2StateType != L
TriggerAll = P2movetype = H && P2StateNo != [120,159]
TriggerAll = ifelse((NumEnemy=2&&(EnemyNear(0),alive)&&(EnemyNear(1),alive)),((EnemyNear(1),movetype=H)&&(EnemyNear(1),StateNo!=[120,159])),1)
TriggerAll = !inguarddist
TriggerAll = P2bodydist X > 5
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
TriggerAll = (P2StateNo != 1205) && (P2StateNo != 1225) && (P2StateNo != 1226)
;TriggerAll = frontedgebodydist < ceil(288*const(size.xscale))-39
;TriggerAll = EnemyNear(floor(fvar(36))),backedgebodydist <= 40
;***************
TriggerAll = -facing*EnemyNear(floor(fvar(36))),facing*fvar(28)<=0
TriggerAll = ifelse((facing*EnemyNear(floor(fvar(36))),facing)=-1,EnemyNear(floor(fvar(36))),BackEdgeBodyDist <= 30,1)
TriggerAll = ifelse((facing*EnemyNear(floor(fvar(36))),facing)=1,EnemyNear(floor(fvar(36))),FrontEdgeBodyDist <= 30,1)
;***************
TriggerALL = P2dist X >= ceil(288*const(size.xscale))-25;+floor(ifelse(15>fvar(31),15-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
TriggerALL = P2dist X <= ceil(288*const(size.xscale))+23;+floor(ifelse(15>fvar(31),15-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
;TriggerAll = P2BodyDist Y = [-200-floor(15*(EnemyNear(floor(fvar(36))),vel Y)+(15*15/2)*fvar(30)),0-floor(15*(EnemyNear(floor(fvar(36))),vel Y)+(15*15/2)*fvar(30))]
TriggerAll = P2bodydist y >= -200-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30)+fvar(32))
TriggerAll = P2bodydist y <= -1-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30)+fvar(32))
TriggerAll = P2bodydist y <= -1-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30));浮空确保 AirEnsure
Trigger1 = StateNo = 1004 && time >= 30
;Trigger2 = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102

;Super Lightning Invocation                ;<混> 浮空追击
[State -3, Super Lightning Invocation]
type = ChangeState
value = 2500
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = power >= 1000
TriggerAll = !InGuardDist
TriggerAll = !EnemyNear(floor(fvar(36))),NumProj
TriggerAll = statetype != A                ;前提:  自己非空中
TriggerAll = P2StateType != L              ;前提:  P2非倒地
TriggerAll = P2StateType = A               ;前提:  P2空中
TriggerAll = P2movetype = H && P2StateNo != [120,159]               ;前提:  P2受击
TriggerAll = EnemyNear(floor(fvar(36))),Vel Y <= 0  || P2bodydist Y <= -10-floor(11*(EnemyNear(floor(fvar(36))),vel Y)+(11*11/2)*fvar(30))
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
TriggerAll = (P2StateNo != 1205) && (P2StateNo != 1225) && (P2StateNo != 1226)
;**************
trigger1 = P2bodydist X = [-5+floor(8*(EnemyNear(floor(fvar(36))),vel X)),50-Const(size.ground.front)+floor(8*(EnemyNear(floor(fvar(36))),vel X))]
trigger1 = P2bodydist Y = [-220-floor(8*(EnemyNear(floor(fvar(36))),vel Y)+(8*8/2)*fvar(30)),0-floor(8*(EnemyNear(floor(fvar(36))),vel Y)+(40*40/2)*fvar(30))]
trigger2 = P2bodydist X = [50-Const(size.ground.front)+floor(16*(EnemyNear(floor(fvar(36))),vel X)),90-Const(size.ground.front)+floor(16*(EnemyNear(floor(fvar(36))),vel X))]
trigger2 = P2bodydist Y = [-220-floor(16*(EnemyNear(floor(fvar(36))),vel Y)+(16*16/2)*fvar(30)),0-floor(16*(EnemyNear(floor(fvar(36))),vel Y)+(40*40/2)*fvar(30))]
trigger3 = P2bodydist X = [90-Const(size.ground.front)+floor(24*(EnemyNear(floor(fvar(36))),vel X)),130-Const(size.ground.front)+floor(24*(EnemyNear(floor(fvar(36))),vel X))]
trigger3 = P2bodydist Y = [-220-floor(24*(EnemyNear(floor(fvar(36))),vel Y)+(24*24/2)*fvar(30)),0-floor(24*(EnemyNear(floor(fvar(36))),vel Y)+(40*40/2)*fvar(30))]
trigger4 = P2bodydist X = [130-Const(size.ground.front)+floor(32*(EnemyNear(floor(fvar(36))),vel X)),170-Const(size.ground.front)+floor(32*(EnemyNear(floor(fvar(36))),vel X))]
trigger4 = P2bodydist Y = [-220-floor(32*(EnemyNear(floor(fvar(36))),vel Y)+(32*32/2)*fvar(30)),0-floor(32*(EnemyNear(floor(fvar(36))),vel Y)+(40*40/2)*fvar(30))]
trigger5 = P2bodydist X = [170-Const(size.ground.front)+floor(40*(EnemyNear(floor(fvar(36))),vel X)),210-Const(size.ground.front)+floor(40*(EnemyNear(floor(fvar(36))),vel X))]
trigger5 = P2bodydist Y = [-220-floor(40*(EnemyNear(floor(fvar(36))),vel Y)+(40*40/2)*fvar(30)),0-floor(40*(EnemyNear(floor(fvar(36))),vel Y)+(40*40/2)*fvar(30))]

;Mu ni Kaerou lv1                    ;<阳光普照>浮空追击
[State -3,Mu ni Kaerou lv1]
type = ChangeState
value = 2000
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = (power >= 1000 && power < 3000) || power = 5000
TriggerAll = !inguarddist
TriggerAll = statetype != A                ;前提:  自己非空中
TriggerAll = P2StateType != L              ;前提:  P2非倒地
;TriggerAll = P2StateType = A               ;前提:  P2空中
TriggerAll = P2movetype = H && P2StateNo != [120,159]              ;前提:  P2受击
TriggerAll = (P2StateNo != 1205) && (P2StateNo != 1225) && (P2StateNo != 1226)
;TriggerAll = EnemyNear(floor(fvar(36))),Vel Y <= 0  || P2bodydist Y <= -5-floor(14*(EnemyNear(floor(fvar(36))),vel Y)+(14*14/2)*fvar(30))
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
;triggerAll = P2bodydist Y <= 0-floor(14*(EnemyNear(floor(fvar(36))),vel Y)+(14*14/2)*fvar(30))
Triggerall = P2bodydist y <= -1-floor(ifelse(13>fvar(31),13-fvar(31),0)*(fvar(29))+(ifelse(13>fvar(31),13-fvar(31),0)*13/2)*fvar(30))
TriggerAll = !EnemyNear(floor(fvar(36))),NumProj
Trigger1 = PrevStateNo = 200 && MoveHit
Trigger2 = PrevStateNo = 300 && MoveHit
Trigger3 = PrevStateNo = 330 && MoveHit
Trigger4 = Random<= var(59)*100

; Mu ni Kaerou lv2                    ;<圣光普照>浮空追击
[State -3,Mu ni Kaerou lv2]
type = ChangeState
value = 2010
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = power >= 2000
TriggerAll = statetype != A                ;前提:  自己非空中
TriggerAll = P2StateType != L              ;前提:  P2非倒地
;TriggerAll = P2StateType = A               ;前提:  P2空中
TriggerAll = P2movetype = H && P2StateNo != [120,159]              ;前提:  P2受击
;TriggerAll = EnemyNear(floor(fvar(36))),Vel Y <= 0  || P2bodydist Y <= -5-floor(15*(EnemyNear(floor(fvar(36))),vel Y)+(15*15/2)*fvar(30))
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
;triggerAll = P2bodydist Y <= 0-floor(15*(EnemyNear(floor(fvar(36))),vel Y)+(15*15/2)*fvar(30))
Triggerall = P2bodydist y <= -5-floor(ifelse(13>fvar(31),13-fvar(31),0)*(fvar(29))+(ifelse(13>fvar(31),13-fvar(31),0)*13/2)*fvar(30))
Trigger1 = PrevStateNo = 200 && MoveHit
Trigger2 = PrevStateNo = 300 && MoveHit
Trigger3 = PrevStateNo = 330 && MoveHit
Trigger4 = Random<= var(59)*100

[State -3, stand heavy Kick combo start]    ;重腿b 浮空追击
type = NULL;ChangeState
value = 250
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59)
;TriggerAll = fvar(37) = 0
;TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = StateType != A
TriggerAll = P2StateType != L
TriggerAll = P2movetype = H && P2StateNo != [120,159]
TriggerAll = EnemyNear(floor(fvar(36))),Vel Y <= 0  || P2bodydist Y <= -10-floor(4*(EnemyNear(floor(fvar(36))),vel Y)+(4*4/2)*fvar(30))
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
;Trigger1 = P2BodyDist X = [24-Const(size.ground.front),79-Const(size.ground.front)]              ;前提: 技能范围内
TriggerAll = P2BodyDist X = [-5,79-Const(size.ground.front)]              ;前提: 技能范围内
TriggerAll = P2BodyDist Y = [-115,0]
TriggerAll = ifelse((NumEnemy=2&&(EnemyNear(0),alive)&&(EnemyNear(1),alive)),((EnemyNear(1),movetype=H)&&(EnemyNear(1),StateNo!=[120,159])),1)
TriggerAll = !inguarddist
TriggerAll = !EnemyNear(floor(fvar(36))),NumProj
TriggerAll = ifelse((NumEnemy=2&&(EnemyNear(0),alive)&&(EnemyNear(1),alive)),(!(EnemyNear(1),NumProj)),1)
Trigger1 = PrevStateNo = 200 && MoveHit
Trigger2 = PrevStateNo = 300 && MoveHit
Trigger3 = PrevStateNo = 330 && MoveHit
Trigger4 = Random<= var(59)*100


[State -3, fvar(39)] ;High Kick Extend      ;重腿b 2连击 浮空追击
type = ChangeState
value = 255
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = StateType != A
TriggerAll = P2StateType != L
TriggerAll = P2StateType = A               ;前提:  P2空中
TriggerAll = P2movetype = H && P2StateNo != [120,159]
triggerAll = StateNo = 250 && Animelem >= 12
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
;Trigger1 = P2BodyDist X = [18-Const(size.ground.front),79-Const(size.ground.front)]              ;前提: 技能范围内
TriggerAll = P2BodyDist X = [-5,79-Const(size.ground.front)]              ;前提: 技能范围内
TriggerAll = P2BodyDist Y = [-164,0]
TriggerAll = ifelse((NumEnemy=2&&(EnemyNear(0),alive)&&(EnemyNear(1),alive)),((EnemyNear(1),movetype=H)&&(EnemyNear(1),StateNo!=[120,159])),1)
TriggerAll = !inguarddist
TriggerAll = !EnemyNear(floor(fvar(36))),NumProj
TriggerAll = ifelse((NumEnemy=2&&(EnemyNear(0),alive)&&(EnemyNear(1),alive)),(!(EnemyNear(1),NumProj)),1)
Trigger1 = Random<= var(59)*100

;Stand Light Punch
[State -3, Stand Light Punch]
type = ChangeState
value = 200
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = StateType != A
TriggerAll = P2StateType != L
TriggerAll = P2statetype != A
TriggerAll = P2movetype = H && P2StateNo != [120,159]
TriggerAll = !EnemyNear(floor(fvar(36))),NumProj
TriggerAll = ifelse((NumEnemy=2 && EnemyNear(0),alive && EnemyNear(1),alive),!(EnemyNear(floor(fvar(36))+1),Numproj),1)
TriggerAll = P2BodyDist Y = [-80,0]
TriggerAll = P2BodyDist X = [-5+(3*(EnemyNear(floor(fvar(36))),vel X)),53-Const(size.ground.front)+(3*(EnemyNear(floor(fvar(36))),vel X))]
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
Trigger1 = 1

;Crouching Light Punch
[State -3, Crouching Light Punch]
type = ChangeState
value = 300
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = StateType != A
TriggerAll = P2StateType != L
TriggerAll = P2statetype != A
TriggerAll = P2movetype = H && P2StateNo != [120,159]
TriggerAll = !EnemyNear(floor(fvar(36))),NumProj
TriggerAll = ifelse((NumEnemy=2 && EnemyNear(0),alive && EnemyNear(1),alive),!(EnemyNear(floor(fvar(36))+1),Numproj),1)
TriggerAll = P2BodyDist Y = [-31,0]
TriggerAll = P2BodyDist X = [-5+(3*(EnemyNear(floor(fvar(36))),vel X)),69-Const(size.ground.front)+(3*(EnemyNear(floor(fvar(36))),vel X))]
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
Trigger1 = 1

;Crouching Light Kick
[State -3, Crouching Light Kick]
type = ChangeState
value = 330
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = StateType != A
TriggerAll = P2statetype != A
TriggerAll = P2StateType != L
TriggerAll = P2movetype = H && P2StateNo != [120,159]
TriggerAll = !EnemyNear(floor(fvar(36))),NumProj
TriggerAll = ifelse((NumEnemy=2 && EnemyNear(0),alive && EnemyNear(1),alive),!(EnemyNear(floor(fvar(36))+1),Numproj),1)
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
TriggerAll = P2BodyDist Y = [-31,0]
Trigger1 = P2BodyDist X = [-5+floor(5*(EnemyNear(floor(fvar(36))),vel X)),69-Const(size.ground.front)+floor(5*(EnemyNear(floor(fvar(36))),vel X))]
Trigger1 = Random <= var(59)*100
Trigger2 = P2BodyDist X = [-5,30]
Trigger2 = EnemyNear(floor(fvar(36))),Vel X <= 0
Trigger2 = Random <= var(59)*33

; Reflector before Black Surge
[State -3, Black Surge]     ;黑色行星 浮空追击 前 光撤之盾
type = ChangeState
value = 1300
TriggerAll = fvar(6) != 1
TriggerAll = Alive
triggerall = !NumHelper(1310)
TriggerAll = var(59)
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = Statetype != A
TriggerAll = EnemyNear(floor(fvar(36))),Vel Y <= 0  || P2bodydist Y <= -5-floor(21*(EnemyNear(floor(fvar(36))),vel Y)+(21*21/2)*fvar(30))
TriggerAll = P2StateType != L
TriggerAll = P2movetype = H
TriggerAll = inguarddist || (EnemyNear(floor(fvar(36))),numproj)
TriggerAll = EnemyNear(floor(fvar(36))),stateno < 2000
TriggerAll = ifelse((NumEnemy=2 && EnemyNear(0),alive && EnemyNear(1),alive),(EnemyNear(floor(fvar(36))+1),stateno < 2000),1)
TriggerAll = !(EnemyNear(floor(fvar(36))),HitDefAttr = , HA,HP,HT)
;TriggerAll = numprojID(1105) = 0
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
TriggerAll = P2bodydist X >= 30+floor(18*(EnemyNear(floor(fvar(36))),vel X))
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
Trigger1 = P2bodydist X = [-5+floor(26*(EnemyNear(floor(fvar(36))),vel X)),62+floor(26*(EnemyNear(floor(fvar(36))),vel X))]
Trigger1 = P2BodyDist Y = [-163-floor(26*(EnemyNear(floor(fvar(36))),vel Y)+(26*26/2)*fvar(30)),0-floor(26*(EnemyNear(floor(fvar(36))),vel Y)+(26*26/2)*fvar(30))]
Trigger2 = P2bodydist X = [31+28*1+floor(32*(EnemyNear(floor(fvar(36))),vel X)),62+28*1-Const(size.ground.front)+floor(32*(EnemyNear(floor(fvar(36))),vel X))]
Trigger2 = P2BodyDist Y = [-163-floor(32*(EnemyNear(floor(fvar(36))),vel Y)+(32*32/2)*fvar(30)),0-floor(32*(EnemyNear(floor(fvar(36))),vel Y)+(32*32/2)*fvar(30))]
Trigger3 = P2bodydist X = [31+28*2+floor(38*(EnemyNear(floor(fvar(36))),vel X)),62+28*2-Const(size.ground.front)+floor(38*(EnemyNear(floor(fvar(36))),vel X))]
Trigger3 = P2BodyDist Y = [-163-floor(38*(EnemyNear(floor(fvar(36))),vel Y)+(38*38/2)*fvar(30)),0-floor(38*(EnemyNear(floor(fvar(36))),vel Y)+(38*38/2)*fvar(30))]
Trigger4 = P2bodydist X = [31+28*3+floor(44*(EnemyNear(floor(fvar(36))),vel X)),62+28*3-Const(size.ground.front)+floor(44*(EnemyNear(floor(fvar(36))),vel X))]
Trigger4 = P2BodyDist Y = [-163-floor(44*(EnemyNear(floor(fvar(36))),vel Y)+(44*44/2)*fvar(30)),0-floor(44*(EnemyNear(floor(fvar(36))),vel Y)+(44*44/2)*fvar(30))]
Trigger5 = P2bodydist X = [31+28*4+floor(50*(EnemyNear(floor(fvar(36))),vel X)),62+28*4-Const(size.ground.front)+floor(50*(EnemyNear(floor(fvar(36))),vel X))]
Trigger5 = P2BodyDist Y = [-163-floor(50*(EnemyNear(floor(fvar(36))),vel Y)+(55*55/2)*fvar(30)),0-floor(50*(EnemyNear(floor(fvar(36))),vel Y)+(50*50/2)*fvar(30))]
Trigger6 = P2bodydist X = [31+28*5+floor(56*(EnemyNear(floor(fvar(36))),vel X)),62+28*5-Const(size.ground.front)+floor(56*(EnemyNear(floor(fvar(36))),vel X))]
Trigger6 = P2BodyDist Y = [-163-floor(56*(EnemyNear(floor(fvar(36))),vel Y)+(56*56/2)*fvar(30)),0-floor(56*(EnemyNear(floor(fvar(36))),vel Y)+(56*56/2)*fvar(30))]
Trigger7 = P2bodydist X = [31+28*6+floor(62*(EnemyNear(floor(fvar(36))),vel X)),62+28*6-Const(size.ground.front)+floor(62*(EnemyNear(floor(fvar(36))),vel X))]
Trigger7 = P2BodyDist Y = [-163-floor(62*(EnemyNear(floor(fvar(36))),vel Y)+(62*62/2)*fvar(30)),0-floor(62*(EnemyNear(floor(fvar(36))),vel Y)+(62*62/2)*fvar(30))]
Trigger8 = P2bodydist X = [31+28*7+floor(68*(EnemyNear(floor(fvar(36))),vel X)),62+28*7-Const(size.ground.front)+floor(68*(EnemyNear(floor(fvar(36))),vel X))]
Trigger8 = P2BodyDist Y = [-163-floor(68*(EnemyNear(floor(fvar(36))),vel Y)+(68*68/2)*fvar(30)),0-floor(68*(EnemyNear(floor(fvar(36))),vel Y)+(68*68/2)*fvar(30))]
Trigger9 = P2bodydist X = [31+28*8+floor(74*(EnemyNear(floor(fvar(36))),vel X)),62+28*8-Const(size.ground.front)+floor(74*(EnemyNear(floor(fvar(36))),vel X))]
Trigger9 = P2BodyDist Y = [-163-floor(74*(EnemyNear(floor(fvar(36))),vel Y)+(74*74/2)*fvar(30)),0-floor(74*(EnemyNear(floor(fvar(36))),vel Y)+(74*74/2)*fvar(30))]
Trigger10 = P2bodydist X = [31+28*9+floor(81*(EnemyNear(floor(fvar(36))),vel X)),62+28*9-Const(size.ground.front)+floor(81*(EnemyNear(floor(fvar(36))),vel X))]
Trigger10 = P2BodyDist Y = [-163-floor(81*(EnemyNear(floor(fvar(36))),vel Y)+(81*81/2)*fvar(30)),0-floor(81*(EnemyNear(floor(fvar(36))),vel Y)+(81*81/2)*fvar(30))]

; Black Surge
[State -3, Black Surge]     ;黑色行星 浮空追击
type = ChangeState
value = 1100
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = Statetype != A
TriggerAll = EnemyNear(floor(fvar(36))),Vel Y <= 0  || P2bodydist Y <= -5-floor(21*(EnemyNear(floor(fvar(36))),vel Y)+(21*21/2)*fvar(30))
TriggerAll = P2StateType != L
TriggerAll = P2movetype = H
TriggerAll = P2stateno != [120,159]
TriggerAll = EnemyNear(floor(fvar(36))),stateno < 2000
TriggerAll = ifelse((NumEnemy=2 && EnemyNear(0),alive && EnemyNear(1),alive),(EnemyNear(floor(fvar(36))+1),stateno < 2000),1)
TriggerAll = !(EnemyNear(floor(fvar(36))),HitDefAttr = , HA,HP,HT)
;TriggerAll = numprojID(1105) = 0
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
TriggerAll = P2bodydist X >= 30+floor(18*(EnemyNear(floor(fvar(36))),vel X))
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
Trigger1 = P2bodydist X = [-5+floor(26*(EnemyNear(floor(fvar(36))),vel X)),62+floor(26*(EnemyNear(floor(fvar(36))),vel X))]
Trigger1 = P2BodyDist Y = [-163-floor(26*(EnemyNear(floor(fvar(36))),vel Y)+(26*26/2)*fvar(30)),0-floor(26*(EnemyNear(floor(fvar(36))),vel Y)+(26*26/2)*fvar(30))]
Trigger2 = P2bodydist X = [31+28*1+floor(32*(EnemyNear(floor(fvar(36))),vel X)),62+28*1-Const(size.ground.front)+floor(32*(EnemyNear(floor(fvar(36))),vel X))]
Trigger2 = P2BodyDist Y = [-163-floor(32*(EnemyNear(floor(fvar(36))),vel Y)+(32*32/2)*fvar(30)),0-floor(32*(EnemyNear(floor(fvar(36))),vel Y)+(32*32/2)*fvar(30))]
Trigger3 = P2bodydist X = [31+28*2+floor(38*(EnemyNear(floor(fvar(36))),vel X)),62+28*2-Const(size.ground.front)+floor(38*(EnemyNear(floor(fvar(36))),vel X))]
Trigger3 = P2BodyDist Y = [-163-floor(38*(EnemyNear(floor(fvar(36))),vel Y)+(38*38/2)*fvar(30)),0-floor(38*(EnemyNear(floor(fvar(36))),vel Y)+(38*38/2)*fvar(30))]
Trigger4 = P2bodydist X = [31+28*3+floor(44*(EnemyNear(floor(fvar(36))),vel X)),62+28*3-Const(size.ground.front)+floor(44*(EnemyNear(floor(fvar(36))),vel X))]
Trigger4 = P2BodyDist Y = [-163-floor(44*(EnemyNear(floor(fvar(36))),vel Y)+(44*44/2)*fvar(30)),0-floor(44*(EnemyNear(floor(fvar(36))),vel Y)+(44*44/2)*fvar(30))]
Trigger5 = P2bodydist X = [31+28*4+floor(50*(EnemyNear(floor(fvar(36))),vel X)),62+28*4-Const(size.ground.front)+floor(50*(EnemyNear(floor(fvar(36))),vel X))]
Trigger5 = P2BodyDist Y = [-163-floor(50*(EnemyNear(floor(fvar(36))),vel Y)+(55*55/2)*fvar(30)),0-floor(50*(EnemyNear(floor(fvar(36))),vel Y)+(50*50/2)*fvar(30))]
Trigger6 = P2bodydist X = [31+28*5+floor(56*(EnemyNear(floor(fvar(36))),vel X)),62+28*5-Const(size.ground.front)+floor(56*(EnemyNear(floor(fvar(36))),vel X))]
Trigger6 = P2BodyDist Y = [-163-floor(56*(EnemyNear(floor(fvar(36))),vel Y)+(56*56/2)*fvar(30)),0-floor(56*(EnemyNear(floor(fvar(36))),vel Y)+(56*56/2)*fvar(30))]
Trigger7 = P2bodydist X = [31+28*6+floor(62*(EnemyNear(floor(fvar(36))),vel X)),62+28*6-Const(size.ground.front)+floor(62*(EnemyNear(floor(fvar(36))),vel X))]
Trigger7 = P2BodyDist Y = [-163-floor(62*(EnemyNear(floor(fvar(36))),vel Y)+(62*62/2)*fvar(30)),0-floor(62*(EnemyNear(floor(fvar(36))),vel Y)+(62*62/2)*fvar(30))]
Trigger8 = P2bodydist X = [31+28*7+floor(68*(EnemyNear(floor(fvar(36))),vel X)),62+28*7-Const(size.ground.front)+floor(68*(EnemyNear(floor(fvar(36))),vel X))]
Trigger8 = P2BodyDist Y = [-163-floor(68*(EnemyNear(floor(fvar(36))),vel Y)+(68*68/2)*fvar(30)),0-floor(68*(EnemyNear(floor(fvar(36))),vel Y)+(68*68/2)*fvar(30))]
Trigger9 = P2bodydist X = [31+28*8+floor(74*(EnemyNear(floor(fvar(36))),vel X)),62+28*8-Const(size.ground.front)+floor(74*(EnemyNear(floor(fvar(36))),vel X))]
Trigger9 = P2BodyDist Y = [-163-floor(74*(EnemyNear(floor(fvar(36))),vel Y)+(74*74/2)*fvar(30)),0-floor(74*(EnemyNear(floor(fvar(36))),vel Y)+(74*74/2)*fvar(30))]
Trigger10 = P2bodydist X = [31+28*9+floor(81*(EnemyNear(floor(fvar(36))),vel X)),62+28*9-Const(size.ground.front)+floor(81*(EnemyNear(floor(fvar(36))),vel X))]
Trigger10 = P2BodyDist Y = [-163-floor(81*(EnemyNear(floor(fvar(36))),vel Y)+(81*81/2)*fvar(30)),0-floor(81*(EnemyNear(floor(fvar(36))),vel Y)+(81*81/2)*fvar(30))]

[State -3, Black Surge]     ;黑色行星 双人模式
type = ChangeState
value = 1100
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = TeamMode = simul
TriggerAll = numpartner
TriggerAll = partner,alive
TriggerAll = Statetype != A
TriggerAll = P2StateType != L
TriggerAll = P2Statetype = A
TriggerAll = P2movetype = H && P2StateNo != [120,159]
;TriggerAll = numprojID(1105) = 0
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
TriggerAll = !inguarddist
TriggerAll = !(EnemyNear(floor(fvar(36))),NumProj)
TriggerAll = ifelse((NumEnemy=2 && EnemyNear(0),alive && EnemyNear(1),alive),!(EnemyNear(floor(fvar(36))+1),Numproj),1)
TriggerAll = P2bodydist x = [-5,60]
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
Trigger1 = P2BodyDist Y <= -163-floor(25*(EnemyNear(floor(fvar(36))),vel Y)+(25*(25)/2)*fvar(30))

; Lightning Strike A
[State -3, Lightning Strike]     ;天雷闪A 浮空追击 版边
type = ChangeState
value = 1000
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = Statetype != A
TriggerAll = P2StateType = A
TriggerAll = P2StateType != L
TriggerAll = P2movetype = H && P2StateNo != [120,159]
TriggerAll = ifelse((NumEnemy=2&&(EnemyNear(0),alive)&&(EnemyNear(1),alive)),((EnemyNear(1),movetype=H)&&(EnemyNear(1),StateNo!=[120,159])),1)
TriggerAll = !inguarddist
TriggerAll = P2bodydist X > 5
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
TriggerAll = (P2StateNo != 1205) && (P2StateNo != 1225) && (P2StateNo != 1226)
;TriggerAll = frontedgebodydist < ceil(48*const(size.xscale))-39
;TriggerAll = EnemyNear(floor(fvar(36))),backedgebodydist <= 40
;***************
TriggerAll = -facing*EnemyNear(floor(fvar(36))),facing*fvar(28)<=0
TriggerAll = ifelse((facing*EnemyNear(floor(fvar(36))),facing)=-1,EnemyNear(floor(fvar(36))),BackEdgeBodyDist <= 30,1)
TriggerAll = ifelse((facing*EnemyNear(floor(fvar(36))),facing)=1,EnemyNear(floor(fvar(36))),FrontEdgeBodyDist <= 30,1)
;***************
TriggerALL = P2dist X >= ceil(48*const(size.xscale))-25;+floor(ifelse(15>fvar(31),15-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
TriggerALL = P2dist X <= ceil(48*const(size.xscale))+23;+floor(ifelse(15>fvar(31),15-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
;TriggerAll = P2BodyDist Y = [-200-floor(15*(EnemyNear(floor(fvar(36))),vel Y)+(15*15/2)*fvar(30)),0-floor(15*(EnemyNear(floor(fvar(36))),vel Y)+(15*15/2)*fvar(30))]
TriggerAll = P2bodydist y >= -200-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30)+fvar(32))
TriggerAll = P2bodydist y <= -1-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30)+fvar(32))
TriggerAll = P2bodydist y <= -1-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30));浮空确保 AirEnsure
Trigger1 = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102

; Lightning Strike B
[State -3, Lightning Strike]     ;天雷闪B 浮空追击 版边
type = ChangeState
value = 1001
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = Statetype != A
TriggerAll = P2StateType = A
TriggerAll = P2StateType != L
TriggerAll = P2movetype = H && P2StateNo != [120,159]
TriggerAll = ifelse((NumEnemy=2&&(EnemyNear(0),alive)&&(EnemyNear(1),alive)),((EnemyNear(1),movetype=H)&&(EnemyNear(1),StateNo!=[120,159])),1)
TriggerAll = !inguarddist
TriggerAll = P2bodydist X > 5
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
TriggerAll = (P2StateNo != 1205) && (P2StateNo != 1225) && (P2StateNo != 1226)
;TriggerAll = frontedgebodydist < ceil(96*const(size.xscale))-39
;TriggerAll = EnemyNear(floor(fvar(36))),backedgebodydist <= 40
;***************
TriggerAll = -facing*EnemyNear(floor(fvar(36))),facing*fvar(28)<=0
TriggerAll = ifelse((facing*EnemyNear(floor(fvar(36))),facing)=-1,EnemyNear(floor(fvar(36))),BackEdgeBodyDist <= 30,1)
TriggerAll = ifelse((facing*EnemyNear(floor(fvar(36))),facing)=1,EnemyNear(floor(fvar(36))),FrontEdgeBodyDist <= 30,1)
;***************
TriggerALL = P2dist X >= ceil(96*const(size.xscale))-25;+floor(ifelse(15>fvar(31),15-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
TriggerALL = P2dist X <= ceil(96*const(size.xscale))+23;+floor(ifelse(15>fvar(31),15-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
;TriggerAll = P2BodyDist Y = [-200-floor(15*(EnemyNear(floor(fvar(36))),vel Y)+(15*15/2)*fvar(30)),0-floor(15*(EnemyNear(floor(fvar(36))),vel Y)+(15*15/2)*fvar(30))]
TriggerAll = P2bodydist y >= -200-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30)+fvar(32))
TriggerAll = P2bodydist y <= -1-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30)+fvar(32))
TriggerAll = P2bodydist y <= -1-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30));浮空确保 AirEnsure
Trigger1 = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102

; Lightning Strike C
[State -3, Lightning Strike]     ;天雷闪C 浮空追击 版边
type = ChangeState
value = 1002
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = Statetype != A
TriggerAll = P2StateType = A
TriggerAll = P2StateType != L
TriggerAll = P2movetype = H && P2StateNo != [120,159]
TriggerAll = ifelse((NumEnemy=2&&(EnemyNear(0),alive)&&(EnemyNear(1),alive)),((EnemyNear(1),movetype=H)&&(EnemyNear(1),StateNo!=[120,159])),1)
TriggerAll = !inguarddist
TriggerAll = P2bodydist X > 5
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
TriggerAll = (P2StateNo != 1205) && (P2StateNo != 1225) && (P2StateNo != 1226)
;TriggerAll = frontedgebodydist < ceil(144*const(size.xscale))-39
;TriggerAll = EnemyNear(floor(fvar(36))),backedgebodydist <= 40
;***************
TriggerAll = -facing*EnemyNear(floor(fvar(36))),facing*fvar(28)<=0
TriggerAll = ifelse((facing*EnemyNear(floor(fvar(36))),facing)=-1,EnemyNear(floor(fvar(36))),BackEdgeBodyDist <= 30,1)
TriggerAll = ifelse((facing*EnemyNear(floor(fvar(36))),facing)=1,EnemyNear(floor(fvar(36))),FrontEdgeBodyDist <= 30,1)
;***************
TriggerALL = P2dist X >= ceil(144*const(size.xscale))-25;+floor(ifelse(15>fvar(31),15-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
TriggerALL = P2dist X <= ceil(144*const(size.xscale))+23;+floor(ifelse(15>fvar(31),15-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
;TriggerAll = P2BodyDist Y = [-200-floor(15*(EnemyNear(floor(fvar(36))),vel Y)+(15*15/2)*fvar(30)),0-floor(15*(EnemyNear(floor(fvar(36))),vel Y)+(15*15/2)*fvar(30))]
TriggerAll = P2bodydist y >= -200-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30)+fvar(32))
TriggerAll = P2bodydist y <= -1-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30)+fvar(32))
TriggerAll = P2bodydist y <= -1-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30));浮空确保 AirEnsure
Trigger1 = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102

; Lightning Strike D
[State -3, Lightning Strike]     ;天雷闪D 浮空追击 版边
type = ChangeState
value = 1003
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = Statetype != A
TriggerAll = P2StateType = A
TriggerAll = P2StateType != L
TriggerAll = P2movetype = H && P2StateNo != [120,159]
TriggerAll = ifelse((NumEnemy=2&&(EnemyNear(0),alive)&&(EnemyNear(1),alive)),((EnemyNear(1),movetype=H)&&(EnemyNear(1),StateNo!=[120,159])),1)
TriggerAll = !inguarddist
TriggerAll = P2bodydist X > 5
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
TriggerAll = (P2StateNo != 1205) && (P2StateNo != 1225) && (P2StateNo != 1226)
;TriggerAll = frontedgebodydist > ceil(192*const(size.xscale))-39
;TriggerAll = EnemyNear(floor(fvar(36))),backedgebodydist <= 40
;***************
TriggerAll = -facing*EnemyNear(floor(fvar(36))),facing*fvar(28)<=0
TriggerAll = ifelse((facing*EnemyNear(floor(fvar(36))),facing)=-1,EnemyNear(floor(fvar(36))),BackEdgeBodyDist <= 30,1)
TriggerAll = ifelse((facing*EnemyNear(floor(fvar(36))),facing)=1,EnemyNear(floor(fvar(36))),FrontEdgeBodyDist <= 30,1)
;***************
TriggerALL = P2dist X >= ceil(192*const(size.xscale))-25;+floor(ifelse(15>fvar(31),15-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
TriggerALL = P2dist X <= ceil(192*const(size.xscale))+23;+floor(ifelse(15>fvar(31),15-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
;TriggerAll = P2BodyDist Y = [-200-floor(15*(EnemyNear(floor(fvar(36))),vel Y)+(15*15/2)*fvar(30)),0-floor(15*(EnemyNear(floor(fvar(36))),vel Y)+(15*15/2)*fvar(30))]
TriggerAll = P2bodydist y >= -200-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30)+fvar(32))
TriggerAll = P2bodydist y <= -1-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30)+fvar(32))
TriggerAll = P2bodydist y <= -1-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30));浮空确保 AirEnsure
Trigger1 = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102

; Lightning Strike E
[State -3, Lightning Strike]     ;天雷闪E 浮空追击 版边
type = ChangeState
value = 1004
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = Statetype != A
TriggerAll = P2StateType = A
TriggerAll = P2StateType != L
TriggerAll = P2movetype = H && P2StateNo != [120,159]
TriggerAll = ifelse((NumEnemy=2&&(EnemyNear(0),alive)&&(EnemyNear(1),alive)),((EnemyNear(1),movetype=H)&&(EnemyNear(1),StateNo!=[120,159])),1)
TriggerAll = !inguarddist
TriggerAll = P2bodydist X > 5
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
TriggerAll = (P2StateNo != 1205) && (P2StateNo != 1225) && (P2StateNo != 1226)
;TriggerAll = frontedgebodydist < ceil(240*const(size.xscale))-39
;TriggerAll = EnemyNear(floor(fvar(36))),backedgebodydist <= 40
;***************
TriggerAll = -facing*EnemyNear(floor(fvar(36))),facing*fvar(28)<=0
TriggerAll = ifelse((facing*EnemyNear(floor(fvar(36))),facing)=-1,EnemyNear(floor(fvar(36))),BackEdgeBodyDist <= 30,1)
TriggerAll = ifelse((facing*EnemyNear(floor(fvar(36))),facing)=1,EnemyNear(floor(fvar(36))),FrontEdgeBodyDist <= 30,1)
;***************
TriggerALL = P2dist X >= ceil(240*const(size.xscale))-25;+floor(ifelse(15>fvar(31),15-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
TriggerALL = P2dist X <= ceil(240*const(size.xscale))+23;+floor(ifelse(15>fvar(31),15-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
;TriggerAll = P2BodyDist Y = [-200-floor(15*(EnemyNear(floor(fvar(36))),vel Y)+(15*15/2)*fvar(30)),0-floor(15*(EnemyNear(floor(fvar(36))),vel Y)+(15*15/2)*fvar(30))]
TriggerAll = P2bodydist y >= -200-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30)+fvar(32))
TriggerAll = P2bodydist y <= -1-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30)+fvar(32))
TriggerAll = P2bodydist y <= -1-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30));浮空确保 AirEnsure
Trigger1 = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102


; Lightning Strike F
[State -3, Lightning Strike]     ;天雷闪F 浮空追击  版边
type = ChangeState
value = 1005
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = Statetype != A
TriggerAll = P2StateType = A
TriggerAll = P2StateType != L
TriggerAll = P2movetype = H && P2StateNo != [120,159]
TriggerAll = ifelse((NumEnemy=2&&(EnemyNear(0),alive)&&(EnemyNear(1),alive)),((EnemyNear(1),movetype=H)&&(EnemyNear(1),StateNo!=[120,159])),1)
TriggerAll = !inguarddist
TriggerAll = P2bodydist X > 5
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
TriggerAll = (P2StateNo != 1205) && (P2StateNo != 1225) && (P2StateNo != 1226)
;TriggerAll = frontedgebodydist < ceil(288*const(size.xscale))-39
;TriggerAll = EnemyNear(floor(fvar(36))),backedgebodydist <= 40
;***************
TriggerAll = -facing*EnemyNear(floor(fvar(36))),facing*fvar(28)<=0
TriggerAll = ifelse((facing*EnemyNear(floor(fvar(36))),facing)=-1,EnemyNear(floor(fvar(36))),BackEdgeBodyDist <= 30,1)
TriggerAll = ifelse((facing*EnemyNear(floor(fvar(36))),facing)=1,EnemyNear(floor(fvar(36))),FrontEdgeBodyDist <= 30,1)
;***************
TriggerALL = P2dist X >= ceil(288*const(size.xscale))-25;+floor(ifelse(15>fvar(31),15-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
TriggerALL = P2dist X <= ceil(288*const(size.xscale))+23;+floor(ifelse(15>fvar(31),15-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
;TriggerAll = P2BodyDist Y = [-200-floor(15*(EnemyNear(floor(fvar(36))),vel Y)+(15*15/2)*fvar(30)),0-floor(15*(EnemyNear(floor(fvar(36))),vel Y)+(15*15/2)*fvar(30))]
TriggerAll = P2bodydist y >= -200-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30)+fvar(32))
TriggerAll = P2bodydist y <= -1-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30)+fvar(32))
TriggerAll = P2bodydist y <= -1-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30));浮空确保 AirEnsure
Trigger1 = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102

;━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
;AI movement           ;AI移动 敌方倒地时
;━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
[State -3, I am The Omnipresence]
type = ChangeState
value = 2800
TriggerAll = fvar(6) != 1
;**************环境变量
TriggerAll = var(59)
TriggerAll = RoundState = 2
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
;**************自我条件
TriggerAll = power >= 3000
TriggerAll = statetype != A
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100
;**************对手条件
TriggerAll = P2StateType = L
TriggerAll = EnemyNear(floor(fvar(36))),ctrl = 0
TriggerAll = EnemyNear(floor(fvar(36))),AnimTime <= -1
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************额外特殊条件
;**************分支条件
Trigger1 = EnemyNear(floor(fvar(36))),stateno = [5100,5119]


;中段 <神指>
[State -3, mirror1]
type = ChangeState
value = 1200
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59) &&  var(59) < 13
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = StateType != A
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
TriggerAll = EnemyNear(floor(fvar(36))),AnimTime = -9        ;来不及防御
triggerAll = P2bodydist X = [15,67-Const(size.ground.front)]
Trigger1 = p2stateno = 5120

[State -3, roll back]
type = ChangeState
value = 275
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = StateType != A
TriggerAll = p2statetype = L
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
;**************反应速度及频率意识
TriggerAll = Random<=var(59)*85
;**************
TriggerAll = BackEdgeBodyDist >= 50
Trigger1 = p2bodydist X = [-10,35]
Trigger2 = p2stateno = 5120

[State -3, roll fwd]
type = null;ChangeState
value = 271
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = StateType != A
TriggerAll = p2statetype = L
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
;**************反应速度及频率意识
TriggerAll = Random<=var(59)*85
;**************
TriggerAll = BackEdgeBodyDist < 50
Trigger1 = p2bodydist X = [-10,35]
Trigger2 = p2stateno = 5120

[State -3, 停止]
type = ChangeState
value = 0
ctrl = 1
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = StateType != A
TriggerAll = p2statetype = L
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
;**************反应速度及频率意识
TriggerAll = Random<=var(59)*85
;**************
TriggerAll = p2statetype = L
Trigger1 = p2bodydist X <= 45
Trigger2 = p2StateNo = 5120

[State -3, ダッシュ]
type = ChangeState
value = 100
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = StateType != A
TriggerAll = p2statetype = L
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3)
TriggerAll = StateNo != 100
TriggerAll = p2StateNo != 5120
TriggerAll = Random<=var(59)*100
Trigger1 = p2bodydist X = [50,120]

[State -3, dash back]
type = ChangeState
value = 105
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = StateType != A
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
;**************反应速度及频率意识
TriggerAll = Random<=var(59)*85
;**************
TriggerAll = BackEdgeBodyDist >= 50
TriggerAll = p2bodydist X = [-10,35]
Trigger1 = p2statetype = L
Trigger2 = p2movetype = H && P2BodyDist Y <= -163-floor(15*(EnemyNear(floor(fvar(36))),vel Y)+(15*(15)/2)*fvar(30))

;━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
;ガ`ド
;━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
;ガ`ドキャンセルふっwばし   ; Guard Cancel Body toss
[State -3, Guard Cancel Body toss]
type = ChangeState
value = 265
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = Var(59)
TriggerAll = RoundState = 2
TriggerAll = statetype != A
TriggerAll = EnemyNear(floor(fvar(36))),AnimTime <= -14
TriggerAll = P2bodydist X = [-5+floor(14*(EnemyNear(floor(fvar(36))),vel X)),51-Const(size.ground.front)+floor(14*(EnemyNear(floor(fvar(36))),vel X))]
TriggerAll = P2bodydist y = [-130-floor(19*(EnemyNear(floor(fvar(36))),vel Y)+(14*(14)/2)*fvar(30)),0-floor(14*(EnemyNear(floor(fvar(36))),vel Y)+(14*(14)/2)*fvar(30))]
Triggerall = (stateno = [120,159]) && (power >= 2000)
Trigger1 = Random <= var(59)*10

[State -3, Air Body toss]
type = null;ChangeState
value = 460
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = Var(59)
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = statetype = A
TriggerAll = P2bodydist X = [-10,59]
TriggerAll = P2bodydist y = [-116,80]
TriggerAll = ctrl
;**************反应速度及频率意识
TriggerAll = Random<=var(59)*85
;**************
Trigger1 = P2MoveType != H

;━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
;AI移动 敌方挨打时
;━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
;stand near
[State -3, stand near]
type = ChangeState
value = 0
ctrl = 1
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = StateType != A
TriggerAll = P2StateType != L
TriggerAll = P2StateType = A
TriggerAll = P2MoveType = H
;**************反应速度及频率意识
TriggerAll = Random<=var(59)*85
;**************
TriggerAll = P2bodydist X <= 45
Trigger1 = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102

;AI walk fwd  near
[State -3, walk]
type = ChangeState
value = 100
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = StateType != A
TriggerAll = P2StateType != L
TriggerAll = P2MoveType = H
TriggerAll = StateNo != 100
;**************反应速度及频率意识
TriggerAll = Random<=var(59)*85
;**************
TriggerAll = (P2bodydist X = [50,175]) || (var(59) >= 13 && P2bodydist X >= 50)
Trigger1 = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3)

;stand far
[State -3, stand far]
type = ChangeState
value = 0
ctrl = 1
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59) && var(59) < 13
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = StateType != A
TriggerAll = P2StateType != L
TriggerAll = P2MoveType = H
;**************反应速度及频率意识
TriggerAll = Random<=var(59)*85
;**************
TriggerAll = P2bodydist X = [180,200]
Trigger1 = ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102

;AI walk fwd far
[State -3, walk far]
type = ChangeState
value = 100
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = StateType != A
TriggerAll = P2StateType != L
TriggerAll = P2MoveType = H
TriggerAll = StateNo != 100
;**************反应速度及频率意识
TriggerAll = Random<=var(59)*85
;**************
TriggerAll = P2bodydist X >= 205
Trigger1 = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3)

;━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
;近身站立攻击（非追击）
;━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
;Super Lightning Invocation                 ;<混> 起手无敌 近程
[State -3, Super Lightning Invocation]
type = null;ChangeState
value = 2500
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59) && var(59) < 13
TriggerAll = RoundState = 2
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = power >= 1000
TriggerAll = !InGuardDist
TriggerAll = !EnemyNear(floor(fvar(36))),NumProj
TriggerAll = statetype != A                ;前提:  自己非空中
TriggerAll = P2StateType != L              ;前提:  P2非倒地
TriggerAll = P2moveType = A               ;前提:  P2攻击
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
TriggerAll = p2bodydist X = [-5,40]                  ;前提:  自己可控,刚从倒地起身
TriggerAll = EnemyNear(floor(fvar(36))),AnimTime <= -11              ;无视防御 此行不写
TriggerAll = EnemyNear(floor(fvar(36))),StateNo != [120,159]
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
trigger1 = P2bodydist Y = [-220-floor(11*(EnemyNear(floor(fvar(36))),vel Y)+(11*(11)/2)*fvar(30)),0]

;Soul Extraction DM                    ;<掏心> 无敌12tick 近程
[State -3, Soul Extraction DM]
type = ChangeState
value = 2100
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = RoundState = 2
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = power >= 1000
TriggerAll = statetype != A                ;前提:  自己非空中
TriggerAll = P2StateType != L              ;前提:  P2非倒地
TriggerAll = P2moveType != H               ;前提:  P2非受击
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102  ;前提:  自己可控,刚从倒地起身
TriggerAll = p2bodydist X = [-25,25]
TriggerAll = EnemyNear(floor(fvar(36))),AnimTime <= -14              ;无视防御 此行不写
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
triggerAll = EnemyNear(floor(fvar(36))),Vel X >= 0
triggerAll = EnemyNear(floor(fvar(36))),ctrl = 0
Triggerall = (Random<= 555) || (life/lifemax <= 0.45)
trigger1 = p2statetype = A
trigger1 = P2dist X >= -75+floor(ifelse(19>fvar(31),19-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
trigger1 = P2dist X <= 75+floor(ifelse(19>fvar(31),19-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
trigger1 = P2bodydist Y >= -80-floor(ifelse(19>fvar(31),19-fvar(31),0)*fvar(29)+(ifelse(19>fvar(31),19-fvar(31),0)*19/2)*fvar(30))
trigger2 = p2statetype != A
trigger2 = P2dist X >= -75+floor(ifelse(19>fvar(31),19-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
trigger2 = P2dist X <= 75+floor(ifelse(19>fvar(31),19-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))


;前投げ    C投技
[State -3, C throw]
Type = ChangeState
value = 280
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = StateType != A
TriggerAll = P2StateType != A
TriggerAll = P2StateType != L
TriggerAll = P2MoveType != H
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3)
TriggerAll = stateno != 100
TriggerAll = BackEdgeBodyDist < 60
TriggerAll = p2bodydist X = [-5,15]
Trigger1 = Random <= var(59)*40
Trigger2 = (P2StateNo=[120,159])
Trigger3 = var(59) > 11

;後ろ投げ
[State -3, D throw]
Type = ChangeState
value = 295
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = StateType != A
TriggerAll = P2StateType != A
TriggerAll = P2StateType != L
TriggerAll = P2MoveType != H
TriggerAll = stateno != 100
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3)
TriggerAll = BackEdgeBodyDist >= 60
TriggerAll = p2bodydist X = [-5,15]
Trigger1 = Random <= var(59)*40
Trigger2 = (P2StateNo=[120,159])
Trigger3 = var(59) > 11

;Stand Light Punch
[State -3, Stand Light Punch]
type = ChangeState
value = 200
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = StateType != A
TriggerAll = P2StateType != L
TriggerAll = P2MoveType != A || (P2MoveType = A && facing*EnemyNear(floor(fvar(36))),facing=1 && stateno < 2000)
;TriggerAll = p2bodydist X > 15
;TriggerAll = !EnemyNear(floor(fvar(36))),NumProj
TriggerAll = ifelse((NumEnemy=2 && EnemyNear(0),alive && EnemyNear(1),alive),!(EnemyNear(floor(fvar(36))+1),Numproj),1)
TriggerAll = EnemyNear(floor(fvar(36))),StateNo != [120,159]
TriggerAll = EnemyNear(floor(fvar(36))),AnimTime <= -3
TriggerAll = EnemyNear(floor(fvar(36))),Ctrl = 0
TriggerAll = P2statetype != A
;TriggerAll = P2statetype != C
TriggerAll = P2BodyDist Y = [-80,0]
TriggerAll = P2BodyDist X = [-5,53-Const(size.ground.front)+(3*(EnemyNear(floor(fvar(36))),vel X))]
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
Trigger1 = 1

;Crouching Light Punch
[State -3, Crouching Light Punch]
type = ChangeState
value = 300
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = StateType != A
TriggerAll = P2StateType != L
TriggerAll = P2MoveType != A || (P2MoveType = A && facing*EnemyNear(floor(fvar(36))),facing=1 && stateno < 2000)
;TriggerAll = p2bodydist X > 15
;TriggerAll = !EnemyNear(floor(fvar(36))),NumProj
TriggerAll = ifelse((NumEnemy=2 && EnemyNear(0),alive && EnemyNear(1),alive),!(EnemyNear(floor(fvar(36))+1),Numproj),1)
TriggerAll = EnemyNear(floor(fvar(36))),StateNo != [120,159]
TriggerAll = EnemyNear(floor(fvar(36))),AnimTime <= -3
TriggerAll = EnemyNear(floor(fvar(36))),Ctrl = 0
TriggerAll = P2statetype != A
;TriggerAll = P2statetype = S
TriggerAll = P2BodyDist Y = [-31,0]
TriggerAll = P2BodyDist X = [-5,69-Const(size.ground.front)+(3*(EnemyNear(floor(fvar(36))),vel X))]
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
Trigger1 = 1

;下段 <神指>
[State -3, mirror3]
type = ChangeState
value = 1220
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59) && var(59) < 13
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = StateType != A
TriggerAll = P2StateType != L
TriggerAll = P2MoveType != A || (P2MoveType = A && facing*EnemyNear(floor(fvar(36))),facing=1 && stateno < 2000)
TriggerAll = p2bodydist X > 15
TriggerAll = EnemyNear(floor(fvar(36))),AnimTime <= -8
TriggerAll = EnemyNear(floor(fvar(36))),ctrl = 0
TriggerAll = !EnemyNear(floor(fvar(36))),NumProj
TriggerAll = !EnemyNear(floor(fvar(36))),hitdefattr = SCA, AP
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
triggerAll = P2bodydist X <= 67-Const(size.ground.front)+floor(8*(EnemyNear(floor(fvar(36))),vel X))
triggerAll = P2bodydist Y = [-136-floor(8*(EnemyNear(floor(fvar(36))),vel Y)+(8*8/2)*fvar(30)),0]
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
Trigger1 = 1


; Lightning Strike A
[State -3, Lightning Strike]     ;天雷闪A 近身站立攻击（非追击） 非版边
type = ChangeState
value = 1000
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59) && var(59) < 13
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = Statetype != A
TriggerAll = EnemyNear(floor(fvar(36))),Vel Y < 0  || P2bodydist Y <= -5-floor(21*(EnemyNear(floor(fvar(36))),vel Y)+(21*21/2)*fvar(30))
TriggerAll = P2StateType != L
TriggerAll = P2movetype != H
TriggerAll = ifelse((NumEnemy=2&&(EnemyNear(0),alive)&&(EnemyNear(1),alive)),((EnemyNear(1),movetype=H)&&(EnemyNear(1),StateNo!=[120,159])),1)
TriggerAll = !inguarddist
TriggerAll = P2bodydist X > 5
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
;TriggerAll = frontedgebodydist < ceil(48*const(size.xscale))-39
;TriggerAll = EnemyNear(floor(fvar(36))),backedgebodydist > 40
;***************
TriggerAll = ifelse((facing*EnemyNear(floor(fvar(36))),facing)=-1,EnemyNear(floor(fvar(36))),BackEdgeBodyDist>=30 || fvar(28)>0,1)
TriggerAll = ifelse((facing*EnemyNear(floor(fvar(36))),facing)=1,EnemyNear(floor(fvar(36))),FrontEdgeBodyDist>=30 || fvar(28)<0,1)
;***************
TriggerAll = EnemyNear(floor(fvar(36))),AnimTime <= -21
TriggerAll = EnemyNear(floor(fvar(36))),Vel X < 0
TriggerALL = P2dist X >= ceil(48*const(size.xscale))-26+floor(ifelse(19>fvar(31),19-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
TriggerALL = P2dist X <= ceil(48*const(size.xscale))+22+floor(ifelse(19>fvar(31),19-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
;TriggerAll = P2BodyDist Y = [-200-floor(15*(EnemyNear(floor(fvar(36))),vel Y)+(15*15/2)*fvar(30)),0-floor(15*(EnemyNear(floor(fvar(36))),vel Y)+(15*15/2)*fvar(30))]
TriggerAll = P2bodydist y >= -200-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30)+fvar(32))
TriggerAll = P2bodydist y <= -5-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30)+fvar(32))
TriggerAll = P2bodydist y <= -5-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30));浮空确保 AirEnsure
Trigger1 = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102


; Lightning Strike A
[State -3, Lightning Strike]     ;天雷闪A 近身站立攻击（非追击） 版边
type = ChangeState
value = 1000
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59) && var(59) < 13
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = Statetype != A
TriggerAll = EnemyNear(floor(fvar(36))),Vel Y < 0  || P2bodydist Y <= -5-floor(21*(EnemyNear(floor(fvar(36))),vel Y)+(21*21/2)*fvar(30))
TriggerAll = P2StateType != L
TriggerAll = P2movetype != H
TriggerAll = ifelse((NumEnemy=2&&(EnemyNear(0),alive)&&(EnemyNear(1),alive)),((EnemyNear(1),movetype=H)&&(EnemyNear(1),StateNo!=[120,159])),1)
TriggerAll = !inguarddist
TriggerAll = P2bodydist X > 5
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
;TriggerAll = frontedgebodydist < ceil(48*const(size.xscale))-39
;TriggerAll = EnemyNear(floor(fvar(36))),backedgebodydist <= 40
;***************
TriggerAll = -facing*EnemyNear(floor(fvar(36))),facing*fvar(28)<=0
TriggerAll = ifelse((facing*EnemyNear(floor(fvar(36))),facing)=-1,EnemyNear(floor(fvar(36))),BackEdgeBodyDist <= 30,1)
TriggerAll = ifelse((facing*EnemyNear(floor(fvar(36))),facing)=1,EnemyNear(floor(fvar(36))),FrontEdgeBodyDist <= 30,1)
;***************
TriggerAll = EnemyNear(floor(fvar(36))),AnimTime <= -21
TriggerAll = EnemyNear(floor(fvar(36))),Vel X < 0
TriggerALL = P2dist X >= ceil(48*const(size.xscale))-26;+floor(ifelse(15>fvar(31),15-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
TriggerALL = P2dist X <= ceil(48*const(size.xscale))+22;+floor(ifelse(15>fvar(31),15-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
;TriggerAll = P2BodyDist Y = [-200-floor(15*(EnemyNear(floor(fvar(36))),vel Y)+(15*15/2)*fvar(30)),0-floor(15*(EnemyNear(floor(fvar(36))),vel Y)+(15*15/2)*fvar(30))]
TriggerAll = P2bodydist y >= -200-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30)+fvar(32))
TriggerAll = P2bodydist y <= -5-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30)+fvar(32))
TriggerAll = P2bodydist y <= -5-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30));浮空确保 AirEnsure
Trigger1 = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102


; Lightning Strike B
[State -3, Lightning Strike]     ;天雷闪B 近身站立攻击（非追击） 非版边
type = ChangeState
value = 1001
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59) && var(59) < 13
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = Statetype != A
TriggerAll = EnemyNear(floor(fvar(36))),Vel Y < 0  || P2bodydist Y <= -5-floor(21*(EnemyNear(floor(fvar(36))),vel Y)+(21*21/2)*fvar(30))
TriggerAll = P2StateType != L
TriggerAll = P2movetype != H
TriggerAll = ifelse((NumEnemy=2&&(EnemyNear(0),alive)&&(EnemyNear(1),alive)),((EnemyNear(1),movetype=H)&&(EnemyNear(1),StateNo!=[120,159])),1)
TriggerAll = !inguarddist
TriggerAll = P2bodydist X > 5
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
;TriggerAll = frontedgebodydist < ceil(96*const(size.xscale))-39
;TriggerAll = EnemyNear(floor(fvar(36))),backedgebodydist > 40
;***************
TriggerAll = ifelse((facing*EnemyNear(floor(fvar(36))),facing)=-1,EnemyNear(floor(fvar(36))),BackEdgeBodyDist>=30 || fvar(28)>0,1)
TriggerAll = ifelse((facing*EnemyNear(floor(fvar(36))),facing)=1,EnemyNear(floor(fvar(36))),FrontEdgeBodyDist>=30 || fvar(28)<0,1)
;***************
TriggerAll = EnemyNear(floor(fvar(36))),AnimTime <= -21
TriggerAll = EnemyNear(floor(fvar(36))),Vel X < 0
TriggerALL = P2dist X >= ceil(96*const(size.xscale))-26+floor(ifelse(19>fvar(31),19-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
TriggerALL = P2dist X <= ceil(96*const(size.xscale))+22+floor(ifelse(19>fvar(31),19-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
;TriggerAll = P2BodyDist Y = [-200-floor(15*(EnemyNear(floor(fvar(36))),vel Y)+(15*15/2)*fvar(30)),0-floor(15*(EnemyNear(floor(fvar(36))),vel Y)+(15*15/2)*fvar(30))]
TriggerAll = P2bodydist y >= -200-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30)+fvar(32))
TriggerAll = P2bodydist y <= -5-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30)+fvar(32))
TriggerAll = P2bodydist y <= -5-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30));浮空确保 AirEnsure
Trigger1 = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
Trigger2 = StateNo = 1000 && time >= 30


; Lightning Strike B
[State -3, Lightning Strike]     ;天雷闪B 近身站立攻击（非追击） 版边
type = ChangeState
value = 1001
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59) && var(59) < 13
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = Statetype != A
TriggerAll = EnemyNear(floor(fvar(36))),Vel Y < 0  || P2bodydist Y <= -5-floor(21*(EnemyNear(floor(fvar(36))),vel Y)+(21*21/2)*fvar(30))
TriggerAll = P2StateType != L
TriggerAll = P2movetype != H
TriggerAll = ifelse((NumEnemy=2&&(EnemyNear(0),alive)&&(EnemyNear(1),alive)),((EnemyNear(1),movetype=H)&&(EnemyNear(1),StateNo!=[120,159])),1)
TriggerAll = !inguarddist
TriggerAll = P2bodydist X > 5
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
;TriggerAll = frontedgebodydist < ceil(96*const(size.xscale))-39
;TriggerAll = EnemyNear(floor(fvar(36))),backedgebodydist <= 40
;***************
TriggerAll = -facing*EnemyNear(floor(fvar(36))),facing*fvar(28)<=0
TriggerAll = ifelse((facing*EnemyNear(floor(fvar(36))),facing)=-1,EnemyNear(floor(fvar(36))),BackEdgeBodyDist <= 30,1)
TriggerAll = ifelse((facing*EnemyNear(floor(fvar(36))),facing)=1,EnemyNear(floor(fvar(36))),FrontEdgeBodyDist <= 30,1)
;***************
TriggerAll = EnemyNear(floor(fvar(36))),AnimTime <= -21
TriggerAll = EnemyNear(floor(fvar(36))),Vel X < 0
TriggerALL = P2dist X >= ceil(96*const(size.xscale))-26;+floor(ifelse(15>fvar(31),15-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
TriggerALL = P2dist X <= ceil(96*const(size.xscale))+22;+floor(ifelse(15>fvar(31),15-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
;TriggerAll = P2BodyDist Y = [-200-floor(15*(EnemyNear(floor(fvar(36))),vel Y)+(15*15/2)*fvar(30)),0-floor(15*(EnemyNear(floor(fvar(36))),vel Y)+(15*15/2)*fvar(30))]
TriggerAll = P2bodydist y >= -200-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30)+fvar(32))
TriggerAll = P2bodydist y <= -5-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30)+fvar(32))
TriggerAll = P2bodydist y <= -5-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30));浮空确保 AirEnsure
Trigger1 = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
Trigger2 = StateNo = 1000 && time >= 30


; Lightning Strike C
[State -3, Lightning Strike]     ;天雷闪C 近身站立攻击（非追击） 非版边
type = ChangeState
value = 1002
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59) && var(59) < 13
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = Statetype != A
TriggerAll = EnemyNear(floor(fvar(36))),Vel Y < 0  || P2bodydist Y <= -5-floor(21*(EnemyNear(floor(fvar(36))),vel Y)+(21*21/2)*fvar(30))
TriggerAll = P2StateType != L
TriggerAll = P2movetype != H
TriggerAll = ifelse((NumEnemy=2&&(EnemyNear(0),alive)&&(EnemyNear(1),alive)),((EnemyNear(1),movetype=H)&&(EnemyNear(1),StateNo!=[120,159])),1)
TriggerAll = !inguarddist
TriggerAll = P2bodydist X > 5
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
;TriggerAll = frontedgebodydist < ceil(144*const(size.xscale))-39
;TriggerAll = EnemyNear(floor(fvar(36))),backedgebodydist > 40
;***************
TriggerAll = ifelse((facing*EnemyNear(floor(fvar(36))),facing)=-1,EnemyNear(floor(fvar(36))),BackEdgeBodyDist>=30 || fvar(28)>0,1)
TriggerAll = ifelse((facing*EnemyNear(floor(fvar(36))),facing)=1,EnemyNear(floor(fvar(36))),FrontEdgeBodyDist>=30 || fvar(28)<0,1)
;***************
TriggerAll = EnemyNear(floor(fvar(36))),AnimTime <= -21
TriggerAll = EnemyNear(floor(fvar(36))),Vel X < 0
TriggerALL = P2dist X >= ceil(144*const(size.xscale))-26+floor(ifelse(19>fvar(31),19-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
TriggerALL = P2dist X <= ceil(144*const(size.xscale))+22+floor(ifelse(19>fvar(31),19-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
;TriggerAll = P2BodyDist Y = [-200-floor(15*(EnemyNear(floor(fvar(36))),vel Y)+(15*15/2)*fvar(30)),0-floor(15*(EnemyNear(floor(fvar(36))),vel Y)+(15*15/2)*fvar(30))]
TriggerAll = P2bodydist y >= -200-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30)+fvar(32))
TriggerAll = P2bodydist y <= -5-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30)+fvar(32))
TriggerAll = P2bodydist y <= -5-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30));浮空确保 AirEnsure
Trigger1 = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
Trigger2 = StateNo = 1001 && time >= 30


; Lightning Strike C
[State -3, Lightning Strike]     ;天雷闪C 近身站立攻击（非追击） 版边
type = ChangeState
value = 1002
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59) && var(59) < 13
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = Statetype != A
TriggerAll = EnemyNear(floor(fvar(36))),Vel Y < 0  || P2bodydist Y <= -5-floor(21*(EnemyNear(floor(fvar(36))),vel Y)+(21*21/2)*fvar(30))
TriggerAll = P2StateType != L
TriggerAll = P2movetype != H
TriggerAll = ifelse((NumEnemy=2&&(EnemyNear(0),alive)&&(EnemyNear(1),alive)),((EnemyNear(1),movetype=H)&&(EnemyNear(1),StateNo!=[120,159])),1)
TriggerAll = !inguarddist
TriggerAll = P2bodydist X > 5
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
;TriggerAll = frontedgebodydist < ceil(144*const(size.xscale))-39
;TriggerAll = EnemyNear(floor(fvar(36))),backedgebodydist <= 40
;***************
TriggerAll = -facing*EnemyNear(floor(fvar(36))),facing*fvar(28)<=0
TriggerAll = ifelse((facing*EnemyNear(floor(fvar(36))),facing)=-1,EnemyNear(floor(fvar(36))),BackEdgeBodyDist <= 30,1)
TriggerAll = ifelse((facing*EnemyNear(floor(fvar(36))),facing)=1,EnemyNear(floor(fvar(36))),FrontEdgeBodyDist <= 30,1)
;***************
TriggerAll = EnemyNear(floor(fvar(36))),AnimTime <= -21
TriggerAll = EnemyNear(floor(fvar(36))),Vel X < 0
TriggerALL = P2dist X >= ceil(144*const(size.xscale))-26;+floor(ifelse(15>fvar(31),15-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
TriggerALL = P2dist X <= ceil(144*const(size.xscale))+22;+floor(ifelse(15>fvar(31),15-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
;TriggerAll = P2BodyDist Y = [-200-floor(15*(EnemyNear(floor(fvar(36))),vel Y)+(15*15/2)*fvar(30)),0-floor(15*(EnemyNear(floor(fvar(36))),vel Y)+(15*15/2)*fvar(30))]
TriggerAll = P2bodydist y >= -200-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30)+fvar(32))
TriggerAll = P2bodydist y <= -5-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30)+fvar(32))
TriggerAll = P2bodydist y <= -5-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30));浮空确保 AirEnsure
Trigger1 = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
Trigger2 = StateNo = 1001 && time >= 30


; Lightning Strike D
[State -3, Lightning Strike]     ;天雷闪D 近身站立攻击（非追击） 非版边
type = ChangeState
value = 1003
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59) && var(59) < 13
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = Statetype != A
TriggerAll = EnemyNear(floor(fvar(36))),Vel Y < 0  || P2bodydist Y <= -5-floor(21*(EnemyNear(floor(fvar(36))),vel Y)+(21*21/2)*fvar(30))
TriggerAll = P2StateType != L
TriggerAll = P2movetype != H
TriggerAll = ifelse((NumEnemy=2&&(EnemyNear(0),alive)&&(EnemyNear(1),alive)),((EnemyNear(1),movetype=H)&&(EnemyNear(1),StateNo!=[120,159])),1)
TriggerAll = !inguarddist
TriggerAll = P2bodydist X > 5
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
;TriggerAll = frontedgebodydist > ceil(192*const(size.xscale))-39
;TriggerAll = EnemyNear(floor(fvar(36))),backedgebodydist > 40
;***************
TriggerAll = ifelse((facing*EnemyNear(floor(fvar(36))),facing)=-1,EnemyNear(floor(fvar(36))),BackEdgeBodyDist>=30 || fvar(28)>0,1)
TriggerAll = ifelse((facing*EnemyNear(floor(fvar(36))),facing)=1,EnemyNear(floor(fvar(36))),FrontEdgeBodyDist>=30 || fvar(28)<0,1)
;***************
TriggerAll = EnemyNear(floor(fvar(36))),AnimTime <= -21
TriggerALL = P2dist X >= ceil(192*const(size.xscale))-26+floor(ifelse(19>fvar(31),19-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
TriggerALL = P2dist X <= ceil(192*const(size.xscale))+22+floor(ifelse(19>fvar(31),19-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
;TriggerAll = P2BodyDist Y = [-200-floor(15*(EnemyNear(floor(fvar(36))),vel Y)+(15*15/2)*fvar(30)),0-floor(15*(EnemyNear(floor(fvar(36))),vel Y)+(15*15/2)*fvar(30))]
TriggerAll = P2bodydist y >= -200-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30)+fvar(32))
TriggerAll = P2bodydist y <= -5-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30)+fvar(32))
TriggerAll = P2bodydist y <= -5-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30));浮空确保 AirEnsure
Trigger1 = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
Trigger2 = StateNo = 1002 && time >= 30


; Lightning Strike D
[State -3, Lightning Strike]     ;天雷闪D 近身站立攻击（非追击） 版边
type = ChangeState
value = 1003
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59) && var(59) < 13
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = Statetype != A
TriggerAll = EnemyNear(floor(fvar(36))),Vel Y < 0  || P2bodydist Y <= -5-floor(21*(EnemyNear(floor(fvar(36))),vel Y)+(21*21/2)*fvar(30))
TriggerAll = P2StateType != L
TriggerAll = P2movetype != H
TriggerAll = ifelse((NumEnemy=2&&(EnemyNear(0),alive)&&(EnemyNear(1),alive)),((EnemyNear(1),movetype=H)&&(EnemyNear(1),StateNo!=[120,159])),1)
TriggerAll = !inguarddist
TriggerAll = P2bodydist X > 5
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
;TriggerAll = frontedgebodydist > ceil(192*const(size.xscale))-39
;TriggerAll = EnemyNear(floor(fvar(36))),backedgebodydist <= 40
;***************
TriggerAll = -facing*EnemyNear(floor(fvar(36))),facing*fvar(28)<=0
TriggerAll = ifelse((facing*EnemyNear(floor(fvar(36))),facing)=-1,EnemyNear(floor(fvar(36))),BackEdgeBodyDist <= 30,1)
TriggerAll = ifelse((facing*EnemyNear(floor(fvar(36))),facing)=1,EnemyNear(floor(fvar(36))),FrontEdgeBodyDist <= 30,1)
;***************
TriggerAll = EnemyNear(floor(fvar(36))),AnimTime <= -21
TriggerALL = P2dist X >= ceil(192*const(size.xscale))-26;+floor(ifelse(15>fvar(31),15-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
TriggerALL = P2dist X <= ceil(192*const(size.xscale))+22;+floor(ifelse(15>fvar(31),15-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
;TriggerAll = P2BodyDist Y = [-200-floor(15*(EnemyNear(floor(fvar(36))),vel Y)+(15*15/2)*fvar(30)),0-floor(15*(EnemyNear(floor(fvar(36))),vel Y)+(15*15/2)*fvar(30))]
TriggerAll = P2bodydist y >= -200-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30)+fvar(32))
TriggerAll = P2bodydist y <= -5-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30)+fvar(32))
TriggerAll = P2bodydist y <= -5-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30));浮空确保 AirEnsure
Trigger1 = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
Trigger2 = StateNo = 1002 && time >= 30


; Lightning Strike E
[State -3, Lightning Strike]     ;天雷闪E 近身站立攻击（非追击） 非版边
type = ChangeState
value = 1004
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59) && var(59) < 13
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = Statetype != A
TriggerAll = EnemyNear(floor(fvar(36))),Vel Y < 0  || P2bodydist Y <= -5-floor(21*(EnemyNear(floor(fvar(36))),vel Y)+(21*21/2)*fvar(30))
TriggerAll = P2StateType != L
TriggerAll = P2movetype != H
TriggerAll = ifelse((NumEnemy=2&&(EnemyNear(0),alive)&&(EnemyNear(1),alive)),((EnemyNear(1),movetype=H)&&(EnemyNear(1),StateNo!=[120,159])),1)
TriggerAll = !inguarddist
TriggerAll = P2bodydist X > 5
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
;TriggerAll = frontedgebodydist < ceil(240*const(size.xscale))-39
;TriggerAll = EnemyNear(floor(fvar(36))),backedgebodydist > 40
;***************
TriggerAll = ifelse((facing*EnemyNear(floor(fvar(36))),facing)=-1,EnemyNear(floor(fvar(36))),BackEdgeBodyDist>=30 || fvar(28)>0,1)
TriggerAll = ifelse((facing*EnemyNear(floor(fvar(36))),facing)=1,EnemyNear(floor(fvar(36))),FrontEdgeBodyDist>=30 || fvar(28)<0,1)
;***************
TriggerAll = EnemyNear(floor(fvar(36))),AnimTime <= -21
TriggerALL = P2dist X >= ceil(240*const(size.xscale))-26+floor(ifelse(19>fvar(31),19-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
TriggerALL = P2dist X <= ceil(240*const(size.xscale))+22+floor(ifelse(19>fvar(31),19-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
;TriggerAll = P2BodyDist Y = [-200-floor(15*(EnemyNear(floor(fvar(36))),vel Y)+(15*15/2)*fvar(30)),0-floor(15*(EnemyNear(floor(fvar(36))),vel Y)+(15*15/2)*fvar(30))]
TriggerAll = P2bodydist y >= -200-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30)+fvar(32))
TriggerAll = P2bodydist y <= -5-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30)+fvar(32))
TriggerAll = P2bodydist y <= -5-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30));浮空确保 AirEnsure
Trigger1 = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
Trigger2 = StateNo = 1003 && time >= 30


; Lightning Strike E
[State -3, Lightning Strike]     ;天雷闪E 近身站立攻击（非追击） 版边
type = ChangeState
value = 1004
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59) && var(59) < 13
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = Statetype != A
TriggerAll = EnemyNear(floor(fvar(36))),Vel Y < 0  || P2bodydist Y <= -5-floor(21*(EnemyNear(floor(fvar(36))),vel Y)+(21*21/2)*fvar(30))
TriggerAll = P2StateType != L
TriggerAll = P2movetype != H
TriggerAll = ifelse((NumEnemy=2&&(EnemyNear(0),alive)&&(EnemyNear(1),alive)),((EnemyNear(1),movetype=H)&&(EnemyNear(1),StateNo!=[120,159])),1)
TriggerAll = !inguarddist
TriggerAll = P2bodydist X > 5
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
;TriggerAll = frontedgebodydist < ceil(240*const(size.xscale))-39
;TriggerAll = EnemyNear(floor(fvar(36))),backedgebodydist <= 40
;***************
TriggerAll = -facing*EnemyNear(floor(fvar(36))),facing*fvar(28)<=0
TriggerAll = ifelse((facing*EnemyNear(floor(fvar(36))),facing)=-1,EnemyNear(floor(fvar(36))),BackEdgeBodyDist <= 30,1)
TriggerAll = ifelse((facing*EnemyNear(floor(fvar(36))),facing)=1,EnemyNear(floor(fvar(36))),FrontEdgeBodyDist <= 30,1)
;***************
TriggerAll = EnemyNear(floor(fvar(36))),AnimTime <= -21
TriggerALL = P2dist X >= ceil(240*const(size.xscale))-26;+floor(ifelse(15>fvar(31),15-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
TriggerALL = P2dist X <= ceil(240*const(size.xscale))+22;+floor(ifelse(15>fvar(31),15-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
;TriggerAll = P2BodyDist Y = [-200-floor(15*(EnemyNear(floor(fvar(36))),vel Y)+(15*15/2)*fvar(30)),0-floor(15*(EnemyNear(floor(fvar(36))),vel Y)+(15*15/2)*fvar(30))]
TriggerAll = P2bodydist y >= -200-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30)+fvar(32))
TriggerAll = P2bodydist y <= -5-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30)+fvar(32))
TriggerAll = P2bodydist y <= -5-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30));浮空确保 AirEnsure
Trigger1 = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
Trigger2 = StateNo = 1003 && time >= 30


; Lightning Strike F
[State -3, Lightning Strike]     ;天雷闪F 近身站立攻击（非追击）  非版边
type = ChangeState
value = 1005
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59) && var(59) < 13
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = Statetype != A
TriggerAll = EnemyNear(floor(fvar(36))),Vel Y < 0  || P2bodydist Y <= -5-floor(21*(EnemyNear(floor(fvar(36))),vel Y)+(21*21/2)*fvar(30))
TriggerAll = P2StateType != L
TriggerAll = P2movetype != H
TriggerAll = ifelse((NumEnemy=2&&(EnemyNear(0),alive)&&(EnemyNear(1),alive)),((EnemyNear(1),movetype=H)&&(EnemyNear(1),StateNo!=[120,159])),1)
TriggerAll = !inguarddist
TriggerAll = P2bodydist X > 5
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
;TriggerAll = frontedgebodydist < ceil(288*const(size.xscale))-39
;TriggerAll = EnemyNear(floor(fvar(36))),backedgebodydist > 40
;***************
TriggerAll = ifelse((facing*EnemyNear(floor(fvar(36))),facing)=-1,EnemyNear(floor(fvar(36))),BackEdgeBodyDist>=30 || fvar(28)>0,1)
TriggerAll = ifelse((facing*EnemyNear(floor(fvar(36))),facing)=1,EnemyNear(floor(fvar(36))),FrontEdgeBodyDist>=30 || fvar(28)<0,1)
;***************
TriggerAll = EnemyNear(floor(fvar(36))),AnimTime <= -21
TriggerALL = P2dist X >= ceil(288*const(size.xscale))-26+floor(ifelse(19>fvar(31),19-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
TriggerALL = P2dist X <= ceil(288*const(size.xscale))+22+floor(ifelse(19>fvar(31),19-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
;TriggerAll = P2BodyDist Y = [-200-floor(15*(EnemyNear(floor(fvar(36))),vel Y)+(15*15/2)*fvar(30)),0-floor(15*(EnemyNear(floor(fvar(36))),vel Y)+(15*15/2)*fvar(30))]
TriggerAll = P2bodydist y >= -200-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30)+fvar(32))
TriggerAll = P2bodydist y <= -5-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30)+fvar(32))
TriggerAll = P2bodydist y <= -5-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30));浮空确保 AirEnsure
Trigger1 = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
Trigger2 = StateNo = 1004 && time >= 30


; Lightning Strike F
[State -3, Lightning Strike]     ;天雷闪F 近身站立攻击（非追击）  版边
type = ChangeState
value = 1005
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59) && var(59) < 13
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = Statetype != A
TriggerAll = EnemyNear(floor(fvar(36))),Vel Y < 0  || P2bodydist Y <= -5-floor(21*(EnemyNear(floor(fvar(36))),vel Y)+(21*21/2)*fvar(30))
TriggerAll = P2StateType != L
TriggerAll = P2movetype != H
TriggerAll = ifelse((NumEnemy=2&&(EnemyNear(0),alive)&&(EnemyNear(1),alive)),((EnemyNear(1),movetype=H)&&(EnemyNear(1),StateNo!=[120,159])),1)
TriggerAll = !inguarddist
TriggerAll = P2bodydist X > 5
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
;TriggerAll = frontedgebodydist < ceil(288*const(size.xscale))-39
;TriggerAll = EnemyNear(floor(fvar(36))),backedgebodydist <= 40
;***************
TriggerAll = -facing*EnemyNear(floor(fvar(36))),facing*fvar(28)<=0
TriggerAll = ifelse((facing*EnemyNear(floor(fvar(36))),facing)=-1,EnemyNear(floor(fvar(36))),BackEdgeBodyDist <= 30,1)
TriggerAll = ifelse((facing*EnemyNear(floor(fvar(36))),facing)=1,EnemyNear(floor(fvar(36))),FrontEdgeBodyDist <= 30,1)
;***************
TriggerAll = EnemyNear(floor(fvar(36))),AnimTime <= -21
TriggerALL = P2dist X >= ceil(288*const(size.xscale))-26;+floor(ifelse(15>fvar(31),15-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
TriggerALL = P2dist X <= ceil(288*const(size.xscale))+22;+floor(ifelse(15>fvar(31),15-fvar(31),0)*(-facing*EnemyNear(floor(fvar(36))),facing*fvar(28)))
;TriggerAll = P2BodyDist Y = [-200-floor(15*(EnemyNear(floor(fvar(36))),vel Y)+(15*15/2)*fvar(30)),0-floor(15*(EnemyNear(floor(fvar(36))),vel Y)+(15*15/2)*fvar(30))]
TriggerAll = P2bodydist y >= -200-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30)+fvar(32))
TriggerAll = P2bodydist y <= -5-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30)+fvar(32))
TriggerAll = P2bodydist y <= -5-floor(ifelse(15>fvar(31),15-fvar(31),0)*(fvar(29))+(ifelse(15>fvar(31),15-fvar(31),0)*15/2)*fvar(30));浮空确保 AirEnsure
Trigger1 = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
Trigger2 = StateNo = 1004 && time >= 30


; Reflector before Black Surge
[State -3, Black Surge]     ;黑色行星 攻击 前 光撤之盾
type = ChangeState
value = 1300
TriggerAll = fvar(6) != 1
TriggerAll = Alive
triggerall = !NumHelper(1310)
TriggerAll = var(59) && var(59) < 13
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = Statetype != A
TriggerAll = EnemyNear(floor(fvar(36))),Vel Y <= 0  || P2bodydist Y <= -5-floor(21*(EnemyNear(floor(fvar(36))),vel Y)+(21*21/2)*fvar(30))
TriggerAll = P2StateType != L
TriggerAll = P2movetype != H
TriggerAll = inguarddist || (EnemyNear(floor(fvar(36))),numproj)
TriggerAll = EnemyNear(floor(fvar(36))),stateno < 2000 || EnemyNear(floor(fvar(36))),movetype = I
TriggerAll = ifelse((NumEnemy=2 && EnemyNear(0),alive && EnemyNear(1),alive),(EnemyNear(floor(fvar(36))+1),stateno < 2000) || EnemyNear(floor(fvar(36))+1),movetype = I,1)
TriggerAll = !(EnemyNear(floor(fvar(36))),HitDefAttr = , HA,HP,HT)
;TriggerAll = numprojID(1105) = 0
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
TriggerAll = P2bodydist X >= 80+floor(18*(EnemyNear(floor(fvar(36))),vel X))
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
TriggerAll = p2stateno != 5120
TriggerAll = !(p2stateno >= 2000 && P2bodydist X >= 180)
Trigger1 = P2bodydist X = [-5+floor(26*(EnemyNear(floor(fvar(36))),vel X)),62+floor(26*(EnemyNear(floor(fvar(36))),vel X))]
Trigger1 = P2BodyDist Y = [-163-floor(26*(EnemyNear(floor(fvar(36))),vel Y)+(26*26/2)*fvar(30)),0-floor(26*(EnemyNear(floor(fvar(36))),vel Y)+(26*26/2)*fvar(30))]
Trigger2 = P2bodydist X = [31+28*1+floor(32*(EnemyNear(floor(fvar(36))),vel X)),62+28*1-Const(size.ground.front)+floor(32*(EnemyNear(floor(fvar(36))),vel X))]
Trigger2 = P2BodyDist Y = [-163-floor(32*(EnemyNear(floor(fvar(36))),vel Y)+(32*32/2)*fvar(30)),0-floor(32*(EnemyNear(floor(fvar(36))),vel Y)+(32*32/2)*fvar(30))]
Trigger3 = P2bodydist X = [31+28*2+floor(38*(EnemyNear(floor(fvar(36))),vel X)),62+28*2-Const(size.ground.front)+floor(38*(EnemyNear(floor(fvar(36))),vel X))]
Trigger3 = P2BodyDist Y = [-163-floor(38*(EnemyNear(floor(fvar(36))),vel Y)+(38*38/2)*fvar(30)),0-floor(38*(EnemyNear(floor(fvar(36))),vel Y)+(38*38/2)*fvar(30))]
Trigger4 = P2bodydist X = [31+28*3+floor(44*(EnemyNear(floor(fvar(36))),vel X)),62+28*3-Const(size.ground.front)+floor(44*(EnemyNear(floor(fvar(36))),vel X))]
Trigger4 = P2BodyDist Y = [-163-floor(44*(EnemyNear(floor(fvar(36))),vel Y)+(44*44/2)*fvar(30)),0-floor(44*(EnemyNear(floor(fvar(36))),vel Y)+(44*44/2)*fvar(30))]
Trigger5 = P2bodydist X = [31+28*4+floor(50*(EnemyNear(floor(fvar(36))),vel X)),62+28*4-Const(size.ground.front)+floor(50*(EnemyNear(floor(fvar(36))),vel X))]
Trigger5 = P2BodyDist Y = [-163-floor(50*(EnemyNear(floor(fvar(36))),vel Y)+(55*55/2)*fvar(30)),0-floor(50*(EnemyNear(floor(fvar(36))),vel Y)+(50*50/2)*fvar(30))]
Trigger6 = P2bodydist X = [31+28*5+floor(56*(EnemyNear(floor(fvar(36))),vel X)),62+28*5-Const(size.ground.front)+floor(56*(EnemyNear(floor(fvar(36))),vel X))]
Trigger6 = P2BodyDist Y = [-163-floor(56*(EnemyNear(floor(fvar(36))),vel Y)+(56*56/2)*fvar(30)),0-floor(56*(EnemyNear(floor(fvar(36))),vel Y)+(56*56/2)*fvar(30))]
Trigger7 = P2bodydist X = [31+28*6+floor(62*(EnemyNear(floor(fvar(36))),vel X)),62+28*6-Const(size.ground.front)+floor(62*(EnemyNear(floor(fvar(36))),vel X))]
Trigger7 = P2BodyDist Y = [-163-floor(62*(EnemyNear(floor(fvar(36))),vel Y)+(62*62/2)*fvar(30)),0-floor(62*(EnemyNear(floor(fvar(36))),vel Y)+(62*62/2)*fvar(30))]
Trigger8 = P2bodydist X = [31+28*7+floor(68*(EnemyNear(floor(fvar(36))),vel X)),62+28*7-Const(size.ground.front)+floor(68*(EnemyNear(floor(fvar(36))),vel X))]
Trigger8 = P2BodyDist Y = [-163-floor(68*(EnemyNear(floor(fvar(36))),vel Y)+(68*68/2)*fvar(30)),0-floor(68*(EnemyNear(floor(fvar(36))),vel Y)+(68*68/2)*fvar(30))]
Trigger9 = P2bodydist X = [31+28*8+floor(74*(EnemyNear(floor(fvar(36))),vel X)),62+28*8-Const(size.ground.front)+floor(74*(EnemyNear(floor(fvar(36))),vel X))]
Trigger9 = P2BodyDist Y = [-163-floor(74*(EnemyNear(floor(fvar(36))),vel Y)+(74*74/2)*fvar(30)),0-floor(74*(EnemyNear(floor(fvar(36))),vel Y)+(74*74/2)*fvar(30))]
Trigger10 = P2bodydist X = [31+28*9+floor(81*(EnemyNear(floor(fvar(36))),vel X)),62+28*9-Const(size.ground.front)+floor(81*(EnemyNear(floor(fvar(36))),vel X))]
Trigger10 = P2BodyDist Y = [-163-floor(81*(EnemyNear(floor(fvar(36))),vel Y)+(81*81/2)*fvar(30)),0-floor(81*(EnemyNear(floor(fvar(36))),vel Y)+(81*81/2)*fvar(30))]

; Black Surge
[State -3, Black Surge]     ;黑色行星 攻击
type = ChangeState
value = 1100
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59) && var(59) < 13
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = Statetype != A
TriggerAll = EnemyNear(floor(fvar(36))),Vel Y <= 0  || P2bodydist Y <= -5-floor(21*(EnemyNear(floor(fvar(36))),vel Y)+(21*21/2)*fvar(30))
TriggerAll = P2StateType != L
TriggerAll = P2movetype != H
TriggerAll = EnemyNear(floor(fvar(36))),stateno < 2000 || EnemyNear(floor(fvar(36))),movetype = I
TriggerAll = ifelse((NumEnemy=2 && EnemyNear(0),alive && EnemyNear(1),alive),(EnemyNear(floor(fvar(36))+1),stateno < 2000) || EnemyNear(floor(fvar(36))+1),movetype = I,1)
TriggerAll = !(EnemyNear(floor(fvar(36))),HitDefAttr = , HA,HP,HT)
;TriggerAll = numprojID(1105) = 0
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
TriggerAll = P2bodydist X >= 80+floor(18*(EnemyNear(floor(fvar(36))),vel X))
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
TriggerAll = p2stateno != 5120
TriggerAll = !(p2stateno >= 2000 && P2bodydist X >= 180)
Trigger1 = P2bodydist X = [-5+floor(26*(EnemyNear(floor(fvar(36))),vel X)),62+floor(26*(EnemyNear(floor(fvar(36))),vel X))]
Trigger1 = P2BodyDist Y = [-163-floor(26*(EnemyNear(floor(fvar(36))),vel Y)+(26*26/2)*fvar(30)),0-floor(26*(EnemyNear(floor(fvar(36))),vel Y)+(26*26/2)*fvar(30))]
Trigger2 = P2bodydist X = [31+28*1+floor(32*(EnemyNear(floor(fvar(36))),vel X)),62+28*1-Const(size.ground.front)+floor(32*(EnemyNear(floor(fvar(36))),vel X))]
Trigger2 = P2BodyDist Y = [-163-floor(32*(EnemyNear(floor(fvar(36))),vel Y)+(32*32/2)*fvar(30)),0-floor(32*(EnemyNear(floor(fvar(36))),vel Y)+(32*32/2)*fvar(30))]
Trigger3 = P2bodydist X = [31+28*2+floor(38*(EnemyNear(floor(fvar(36))),vel X)),62+28*2-Const(size.ground.front)+floor(38*(EnemyNear(floor(fvar(36))),vel X))]
Trigger3 = P2BodyDist Y = [-163-floor(38*(EnemyNear(floor(fvar(36))),vel Y)+(38*38/2)*fvar(30)),0-floor(38*(EnemyNear(floor(fvar(36))),vel Y)+(38*38/2)*fvar(30))]
Trigger4 = P2bodydist X = [31+28*3+floor(44*(EnemyNear(floor(fvar(36))),vel X)),62+28*3-Const(size.ground.front)+floor(44*(EnemyNear(floor(fvar(36))),vel X))]
Trigger4 = P2BodyDist Y = [-163-floor(44*(EnemyNear(floor(fvar(36))),vel Y)+(44*44/2)*fvar(30)),0-floor(44*(EnemyNear(floor(fvar(36))),vel Y)+(44*44/2)*fvar(30))]
Trigger5 = P2bodydist X = [31+28*4+floor(50*(EnemyNear(floor(fvar(36))),vel X)),62+28*4-Const(size.ground.front)+floor(50*(EnemyNear(floor(fvar(36))),vel X))]
Trigger5 = P2BodyDist Y = [-163-floor(50*(EnemyNear(floor(fvar(36))),vel Y)+(55*55/2)*fvar(30)),0-floor(50*(EnemyNear(floor(fvar(36))),vel Y)+(50*50/2)*fvar(30))]
Trigger6 = P2bodydist X = [31+28*5+floor(56*(EnemyNear(floor(fvar(36))),vel X)),62+28*5-Const(size.ground.front)+floor(56*(EnemyNear(floor(fvar(36))),vel X))]
Trigger6 = P2BodyDist Y = [-163-floor(56*(EnemyNear(floor(fvar(36))),vel Y)+(56*56/2)*fvar(30)),0-floor(56*(EnemyNear(floor(fvar(36))),vel Y)+(56*56/2)*fvar(30))]
Trigger7 = P2bodydist X = [31+28*6+floor(62*(EnemyNear(floor(fvar(36))),vel X)),62+28*6-Const(size.ground.front)+floor(62*(EnemyNear(floor(fvar(36))),vel X))]
Trigger7 = P2BodyDist Y = [-163-floor(62*(EnemyNear(floor(fvar(36))),vel Y)+(62*62/2)*fvar(30)),0-floor(62*(EnemyNear(floor(fvar(36))),vel Y)+(62*62/2)*fvar(30))]
Trigger8 = P2bodydist X = [31+28*7+floor(68*(EnemyNear(floor(fvar(36))),vel X)),62+28*7-Const(size.ground.front)+floor(68*(EnemyNear(floor(fvar(36))),vel X))]
Trigger8 = P2BodyDist Y = [-163-floor(68*(EnemyNear(floor(fvar(36))),vel Y)+(68*68/2)*fvar(30)),0-floor(68*(EnemyNear(floor(fvar(36))),vel Y)+(68*68/2)*fvar(30))]
Trigger9 = P2bodydist X = [31+28*8+floor(74*(EnemyNear(floor(fvar(36))),vel X)),62+28*8-Const(size.ground.front)+floor(74*(EnemyNear(floor(fvar(36))),vel X))]
Trigger9 = P2BodyDist Y = [-163-floor(74*(EnemyNear(floor(fvar(36))),vel Y)+(74*74/2)*fvar(30)),0-floor(74*(EnemyNear(floor(fvar(36))),vel Y)+(74*74/2)*fvar(30))]
Trigger10 = P2bodydist X = [31+28*9+floor(81*(EnemyNear(floor(fvar(36))),vel X)),62+28*9-Const(size.ground.front)+floor(81*(EnemyNear(floor(fvar(36))),vel X))]
Trigger10 = P2BodyDist Y = [-163-floor(81*(EnemyNear(floor(fvar(36))),vel Y)+(81*81/2)*fvar(30)),0-floor(81*(EnemyNear(floor(fvar(36))),vel Y)+(81*81/2)*fvar(30))]

;Crouching Light Kick
[State -3, Crouching Light Kick]
type = ChangeState
value = 330
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = StateType != A
TriggerAll = P2StateType != L
TriggerAll = P2statetype = S || P2statetype = C
TriggerAll = P2MoveType = I || (P2MoveType = A && facing*EnemyNear(floor(fvar(36))),facing=1 && stateno < 2000)
TriggerAll = p2bodydist X > 15
;TriggerAll = !EnemyNear(floor(fvar(36))),NumProj
TriggerAll = EnemyNear(floor(fvar(36))),StateNo != [120,159]
TriggerAll = EnemyNear(floor(fvar(36))),AnimTime <= -3
;TriggerAll = EnemyNear(floor(fvar(36))),Ctrl = 0
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
TriggerAll = P2BodyDist Y = [-31,0]
Trigger1 = P2BodyDist X = [-5+floor(5*(EnemyNear(floor(fvar(36))),vel X)),69-Const(size.ground.front)+floor(5*(EnemyNear(floor(fvar(36))),vel X))]
Trigger1 = Random <= var(59)*100
Trigger2 = P2BodyDist X = [-5,30]
Trigger2 = EnemyNear(floor(fvar(36))),Vel X <= 0
Trigger2 = Random <= var(59)*33

;Crouching Heavy Kick
[State -3, Crouching Heavy Kick]
type = ChangeState
value = 350
TriggerAll = fvar(6) != 1
TriggerAll = fvar(6) = 0
TriggerAll = Alive
TriggerAll = var(59) && var(59) < 13
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = StateType != A
TriggerAll = P2StateType != L
TriggerAll = P2MoveType = I || (P2MoveType = A && facing*EnemyNear(floor(fvar(36))),facing=1 && stateno < 2000)
TriggerAll = p2bodydist X > 15
;TriggerAll = !EnemyNear(floor(fvar(36))),NumProj
TriggerAll = EnemyNear(floor(fvar(36))),AnimTime <= -3
;TriggerAll = EnemyNear(floor(fvar(36))),Ctrl = 0
TriggerAll = P2statetype != A
TriggerAll = P2statetype = S
TriggerAll = EnemyNear(floor(fvar(36))),stateno = [120,155]
TriggerAll = EnemyNear(floor(fvar(36))),power < 1000
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
TriggerAll = P2BodyDist Y = [-25,0]
Trigger1 = P2BodyDist X = [-5+floor(10*(EnemyNear(floor(fvar(36))),vel X)),129-Const(size.ground.front)+floor(10*(EnemyNear(floor(fvar(36))),vel X))]
Trigger1 = Random <= var(59)*100
Trigger2 = P2BodyDist X = [-5,30]
Trigger2 = EnemyNear(floor(fvar(36))),Vel X <= 0
Trigger2 = Random <= var(59)*33


;━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
;时间停止 time stop
;━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
[State -3, VarSet]
type = VarSet
TriggerAll = var(59)
TriggerAll = fvar(7) = 1
;TriggerAll = ctrl
triggerAll = P2bodydist Y = [-120,0]
trigger1 = P2bodydist X = [15,35]
trigger2 = P2bodydist X = [-15,35]
;trigger2 = backedgebodydist <= 15
fv = 7
value = 2
;ignorehitpause =

[State -3, VarSet]
type = VarSet
TriggerAll = var(59)
TriggerAll = fvar(7) = 1
trigger1 = P2bodydist Y < -120
fv = 7
value = 4
;ignorehitpause =

[State -3, VarSet]
type = VarSet
TriggerAll = var(59)
TriggerAll = fvar(7) = 2
trigger1 = p2stateno != [120,159]
;trigger2 = stateno = 1200
;trigger3 = stateno = 1210
;trigger4 = stateno = 1220
fv = 7
value = 3
;ignorehitpause =


;Striker Shermie
[State -3, Shermie]
type = ChangeState
value = 1601
Triggerall = var(40) != -1 ;总开关
TriggerAll = (palno = [7,12]) || ((palno=[1,6]) && var(58)=1 && floor(var(42)/100)%10=1)
;**************环境变量
TriggerAll = var(59)
TriggerAll = RoundState = 2
;**************自我条件
TriggerAll = statetype != A
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
;**************额外特殊条件
TriggerAll = !fvar(22)
;**************分支条件
trigger1 = fvar(6) = 1
trigger1 = P2bodydist X = [-5,70] ;fvar(7) = 3

;Striker Yashiro
[State -3, Yashiro]
type = ChangeState
value = 1602
Triggerall = var(40) != -1 ;总开关
TriggerAll = (palno = [7,12]) || ((palno=[1,6]) && var(58)=1 && floor(var(42)/100)%10=1)
;**************环境变量
TriggerAll = var(59)
TriggerAll = RoundState = 2
;**************自我条件
TriggerAll = statetype != A
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
;**************额外特殊条件
TriggerAll = !fvar(21)
;**************分支条件
trigger1 = fvar(6) = 1
trigger1 = P2bodydist X = [-5,70] ;fvar(7) = 3

;Striker Chris
[State -3, Chris]
type = ChangeState
value = 1600
Triggerall = var(40) != -1 ;总开关
triggerall = (palno = [7,12]) || ((palno=[1,6]) && var(58)=1 && floor(var(42)/100)%10=1)
;**************环境变量
TriggerAll = var(59)
TriggerAll = RoundState = 2
;**************自我条件
TriggerAll = statetype != A
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
;**************额外特殊条件
TriggerAll = !fvar(20)
;**************分支条件
trigger1 = fvar(6) = 1
trigger1 = P2bodydist X = [-5,70] ;fvar(7) = 3

;Striker Geonitz
[State -3, Geonitz]
type = ChangeState
value = 1603
Triggerall = var(40) != -1 ;总开关
triggerall = (palno = [7,12]) || ((palno=[1,6]) && var(58)=1 && floor(var(42)/100)%10=1)
;**************环境变量
TriggerAll = var(59)
TriggerAll = RoundState = 2
;**************自我条件
TriggerAll = statetype != A
triggerall = p2statetype != A
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
;**************额外特殊条件
TriggerAll = !fvar(23)
;**************分支条件
trigger1 = fvar(6) = 1
trigger1 = P2bodydist X = [-5,70] ;fvar(7) = 3


[State -3, dodge]
type = ChangeState
value = 270
TriggerAll = fvar(6) = 1
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = StateType != A
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
TriggerAll = fvar(5) <= 1000.0/540.0*60
TriggerAll = (life < EnemyNear(floor(fvar(36))),life) || (life < (lifemax/2))
Trigger1 = inguarddist
Trigger2 = EnemyNear(floor(fvar(36))),movetype=A || ifelse((NumEnemy=2 && EnemyNear(0),alive && EnemyNear(1),alive),EnemyNear(floor(fvar(36))+1),movetype=A,0)
Trigger3 = EnemyNear(floor(fvar(36))),Numproj || ifelse((NumEnemy=2 && EnemyNear(0),alive && EnemyNear(1),alive),(EnemyNear(floor(fvar(36))+1),Numproj),0)

[State -3, reflector]
type = ChangeState
value = 1300
TriggerAll = fvar(6) = 1
TriggerAll = fvar(7) = [2,4]
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = StateType != A
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
;TriggerAll = fvar(5) <= 1000.0/420.0
Trigger1 = !numhelper(2015) && !numhelper(2005)
trigger1 = power < 1000
Trigger1 = numhelper(1103)>=2

[State -3, Mu ni kaero]
type = ChangeState
value = 2010
TriggerAll = fvar(6) = 1
TriggerAll = fvar(7) = [2,4]
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = StateType != A
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
;TriggerAll = fvar(5) <= 1000.0/420.0
Trigger1 = !numhelper(2015)
trigger1 = power >= 2000


[State -3, Mu ni kaero]
type = ChangeState
value = 2000
TriggerAll = fvar(6) = 1
TriggerAll = fvar(7) = [2,4]
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = StateType != A
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
;TriggerAll = fvar(5) <= 1000.0/420.0
Trigger1 = !numhelper(2005)
trigger1 = power >= 1000


[State -3, 停止]
type = ChangeState
value = 0
ctrl = 1
TriggerAll = fvar(6) = 1
TriggerAll = fvar(7) = 1 || fvar(7) = 4
triggerAll = P2bodydist Y = [-120,0]
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = StateType != A
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
Trigger1 = p2bodydist X = [15,30]
trigger2 = P2bodydist X = [-15,30]
trigger2 = backedgebodydist <= 15
trigger3 = P2bodydist X < -5

[State -3, ダッシュ]
type = ChangeState
value = 100
TriggerAll = fvar(6) = 1
TriggerAll = fvar(7) = 1
triggerAll = P2bodydist Y = [-120,0]
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = StateType != A
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3)
TriggerAll = StateNo != 100
Trigger1 = p2bodydist X >= 30

[State -3, dash back]
type = ChangeState
value = 19
TriggerAll = fvar(6) = 1
;TriggerAll = fvar(7) = 1 || fvar(7) = 4
TriggerAll = fvar(7) = 4
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = StateType != A
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
Trigger1 = p2bodydist X <= 15
trigger1 = backedgebodydist > 15

[State -3, mirror1]
type = null;ChangeState
value = 1400
TriggerAll = fvar(6) = 1
TriggerAll = fvar(7) = 2
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = StateType != A
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
Trigger1 = p2movetype = A
Trigger1 = EnemyNear(floor(fvar(36))),hitdefattr = SCA,NA,SA,HA

[State -3, mirror1]
type = ChangeState
value = 1200
TriggerAll = fvar(6) = 1
TriggerAll = fvar(7) = [2,3]
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = StateType != A
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
Trigger1 = p2statetype = C
Trigger1 = p2stateno = [150,159]

[State -3, mirror1]
type = ChangeState
value = 1220
TriggerAll = fvar(6) = 1
TriggerAll = fvar(7) = [2,3]
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = StateType != A
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
Trigger1 = p2statetype != C
Trigger1 = p2statetype != A
Trigger1 = p2stateno = [150,159]

[State -3, mirror1]
type = ChangeState
value = 1210
TriggerAll = fvar(6) = 1
TriggerAll = fvar(7) = [2,3]
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = StateType != A
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
Trigger1 = p2statetype = A
Trigger1 = p2stateno = [150,159]

; Black Surge
[State -3, Black Surge]
type = ChangeState
value = 1100
TriggerAll = fvar(6) = 1
TriggerAll = fvar(7) = 3
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = StateType != A
Trigger1 = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102

; Lightning Strike A
[State -3, Lightning Strike]
type = ChangeState
value = 1000
TriggerAll = fvar(6) = 1
TriggerAll = fvar(7) = 4
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = StateType != A
Trigger1 = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
Trigger1 = P2bodydist X = [ceil(48*const(size.xscale))-25,ceil(48*const(size.xscale))+23]

; Lightning Strike B
[State -3, Lightning Strike]
type = ChangeState
value = 1001
TriggerAll = fvar(6) = 1
TriggerAll = fvar(7) = 4
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = StateType != A
Trigger1 = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
Trigger1 = P2bodydist X = [ceil(96*const(size.xscale))-25,ceil(96*const(size.xscale))+23]

; Lightning Strike C
[State -3, Lightning Strike]
type = ChangeState
value = 1002
TriggerAll = fvar(6) = 1
TriggerAll = fvar(7) = 4
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = StateType != A
Trigger1 = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
Trigger1 = P2bodydist X = [ceil(144*const(size.xscale))-25,ceil(144*const(size.xscale))+23]

; Lightning Strike D
[State -3, Lightning Strike]
type = ChangeState
value = 1003
TriggerAll = fvar(6) = 1
TriggerAll = fvar(7) = 4
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = StateType != A
Trigger1 = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
Trigger1 = P2bodydist X = [ceil(192*const(size.xscale))-25,ceil(192*const(size.xscale))+23]

; Lightning Strike E
[State -3, Lightning Strike]
type = ChangeState
value = 1004
TriggerAll = fvar(6) = 1
TriggerAll = fvar(7) = 4
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = StateType != A
Trigger1 = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
Trigger1 = P2bodydist X = [ceil(240*const(size.xscale))-25,ceil(240*const(size.xscale))+23]

; Lightning Strike F
[State -3, Lightning Strike]
type = ChangeState
value = 1005
TriggerAll = fvar(6) = 1
TriggerAll = fvar(7) = 4
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = StateType != A
Trigger1 = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
Trigger1 = P2bodydist X = [ceil(288*const(size.xscale))-25,ceil(288*const(size.xscale))+23]

;━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
;闪避   应对攻击
;━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
;前o急回避
[State -3, roll fwd]
type = ChangeState
value = 271
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = StateType != A
TriggerAll = RoundState = 2
;TriggerAll = P2StateType != L
TriggerAll = EnemyNear(floor(fvar(36))),movetype=A || ifelse((NumEnemy=2 && EnemyNear(0),alive && EnemyNear(1),alive),EnemyNear(floor(fvar(36))+1),movetype=A,0)
TriggerAll = inguarddist
TriggerAll = !(EnemyNear(floor(fvar(36))),HitDefAttr = ,AT)
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
Trigger1 = P2bodydist X <= 94 ;80+14
Trigger1 = EnemyNear(floor(fvar(36))),ctrl = 0
Trigger1 = EnemyNear(floor(fvar(36))),animtime < -31
Trigger2 = P2bodydist X > 94
Trigger2 = backEdgeBodydist <= 15

;后o急回避
[State -3, roll back]
type = ChangeState
value = 275
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = StateType != A
TriggerAll = RoundState = 2
;TriggerAll = P2StateType != L
TriggerAll = EnemyNear(floor(fvar(36))),movetype=A || ifelse((NumEnemy=2 && EnemyNear(0),alive && EnemyNear(1),alive),EnemyNear(floor(fvar(36))+1),movetype=A,0)
TriggerAll = inguarddist
TriggerAll = !(EnemyNear(floor(fvar(36))),HitDefAttr = ,AT)
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
Trigger1 = P2bodydist X <= 188 ;94*2

;原地回避
[State -3, dodge]
type = ChangeState
value = ifelse(var(59)<13,120,ifelse((!EnemyNear(floor(fvar(36))),ctrl && P2bodydist X > 15),270,120))
ctrl = 1
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59)
TriggerAll = StateType != A
TriggerAll = RoundState = 2
;TriggerAll = P2StateType != L
TriggerAll = EnemyNear(floor(fvar(36))),movetype=A || ifelse((NumEnemy=2 && EnemyNear(0),alive && EnemyNear(1),alive),EnemyNear(floor(fvar(36))+1),movetype=A,0)
TriggerAll = inguarddist
TriggerAll = !(EnemyNear(floor(fvar(36))),HitDefAttr = ,AT)
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
Trigger1 = 1

;━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
;远程站立攻击
;━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
; Reflector            ;光澈之盾 飞行道具反射
[State -3, Black Surge]
type = ChangeState
value = 1300
TriggerAll = fvar(6) != 1
TriggerAll = Alive
triggerall = !NumHelper(1310)
TriggerAll = var(59) && var(59) < 13
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = Statetype != A
TriggerAll = P2StateType != L
TriggerAll = EnemyNear(floor(fvar(36))),numproj > 0 || EnemyNear(floor(fvar(36))),numHelper > 0
TriggerAll = EnemyNear(floor(fvar(36))),StateNo <= 2000
TriggerAll = EnemyNear(floor(fvar(36))),hitdefattr != SCA, HA,HP
TriggerAll = inguarddist
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102 || stateno = [120,159]
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
Trigger1 = P2bodydist x >= 120

; Reflector before Black Surge
[State -3, Black Surge]     ;黑色行星 攻击 前 光撤之盾
type = ChangeState
value = 1300
TriggerAll = fvar(6) != 1
TriggerAll = Alive
triggerall = !NumHelper(1310)
TriggerAll = var(59) && var(59) < 13
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = Statetype != A
TriggerAll = P2StateType != L
TriggerAll = EnemyNear(floor(fvar(36))),Vel Y <= 0  || P2bodydist Y <= -5-floor(21*(EnemyNear(floor(fvar(36))),vel Y)+(21*21/2)*fvar(30))
TriggerAll = inguarddist || p2movetype = A || p2movetype = I
TriggerAll = EnemyNear(floor(fvar(36))),stateno < 2000 || EnemyNear(floor(fvar(36))),movetype = I
TriggerAll = ifelse((NumEnemy=2 && EnemyNear(0),alive && EnemyNear(1),alive),(EnemyNear(floor(fvar(36))+1),stateno < 2000) || EnemyNear(floor(fvar(36))+1),movetype = I,1)
TriggerAll = ifelse((NumEnemy=2 && EnemyNear(0),alive && EnemyNear(1),alive),(EnemyNear(floor(fvar(36))+1),stateno < 2000),1)
TriggerAll = !(EnemyNear(floor(fvar(36))),HitDefAttr = , HA,HP,AT)
;TriggerAll = numprojID(1105) = 0
;TriggerAll = P2StateNo != [120,159]
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
TriggerAll = p2stateno != 5120
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
Trigger1 = P2BodyDist X >= 120+floor(10*(EnemyNear(floor(fvar(36))),vel X))
Trigger1 = P2BodyDist Y = [-163-floor(21*(EnemyNear(floor(fvar(36))),vel Y)+(21*21/2)*fvar(30)),0-floor(21*(EnemyNear(floor(fvar(36))),vel Y)+(21*21/2)*fvar(30))]
Trigger2 = EnemyNear(floor(fvar(36))),Vel X < 0
Trigger2 = EnemyNear(floor(fvar(36))),ctrl = 0
Trigger2 = P2BodyDist X >= 60+floor(10*(EnemyNear(floor(fvar(36))),vel X))
Trigger2 = P2BodyDist Y = [-163-floor(21*(EnemyNear(floor(fvar(36))),vel Y)+(21*21/2)*fvar(30)),0-floor(21*(EnemyNear(floor(fvar(36))),vel Y)+(21*21/2)*fvar(30))]

; Black Surge
[State -3, Black Surge]
type = ChangeState
value = 1100
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59) && var(59) < 13
TriggerAll = fvar(37) = 0
TriggerAll = fvar(39) = 0
TriggerAll = RoundState = 2
TriggerAll = Statetype != A
TriggerAll = P2StateType != L
TriggerAll = EnemyNear(floor(fvar(36))),Vel Y <= 0  || P2bodydist Y <= -5-floor(21*(EnemyNear(floor(fvar(36))),vel Y)+(21*21/2)*fvar(30))
TriggerAll = !inguarddist
TriggerAll = EnemyNear(floor(fvar(36))),stateno < 2000 || EnemyNear(floor(fvar(36))),movetype = I
TriggerAll = ifelse((NumEnemy=2 && EnemyNear(0),alive && EnemyNear(1),alive),(EnemyNear(floor(fvar(36))+1),stateno < 2000) || EnemyNear(floor(fvar(36))+1),movetype = I,1)
TriggerAll = !(EnemyNear(floor(fvar(36))),HitDefAttr = , HA,HP,HT)
;TriggerAll = numprojID(1105) = 0
;TriggerAll = P2StateNo != [120,159]
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
TriggerAll = p2stateno != 5120
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
Trigger1 = P2BodyDist X >= 120+floor(10*(EnemyNear(floor(fvar(36))),vel X))
Trigger1 = P2BodyDist Y = [-163-floor(21*(EnemyNear(floor(fvar(36))),vel Y)+(21*21/2)*fvar(30)),0-floor(21*(EnemyNear(floor(fvar(36))),vel Y)+(21*21/2)*fvar(30))]
Trigger2 = EnemyNear(floor(fvar(36))),Vel X < 0
Trigger2 = EnemyNear(floor(fvar(36))),ctrl = 0
Trigger2 = P2BodyDist X >= 60+floor(10*(EnemyNear(floor(fvar(36))),vel X))
Trigger2 = P2BodyDist Y = [-163-floor(21*(EnemyNear(floor(fvar(36))),vel Y)+(21*21/2)*fvar(30)),0-floor(21*(EnemyNear(floor(fvar(36))),vel Y)+(21*21/2)*fvar(30))]


;━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
;AI level 13 全局防御
;━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
;原地防御
[State -3, guard]
type = ChangeState
value = ifelse((!EnemyNear(floor(fvar(36))),ctrl && p2bodydist X > 15),275,120)
ctrl = 1
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59) >= 13
TriggerAll = StateType != A
TriggerAll = RoundState = 2
;TriggerAll = P2StateType != L
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
Trigger1 = stateno = 0
Trigger2 = stateno = 10
Trigger3 = stateno = 11
Trigger4 = stateno = 12
Trigger1 = stateno = 20

;闪避
[State -3, guard]
type = ChangeState
value = 275
TriggerAll = fvar(6) != 1
TriggerAll = Alive
TriggerAll = var(59) >= 13
TriggerAll = StateType != A
TriggerAll = RoundState = 2
;TriggerAll = P2StateType != L
TriggerAll = Ctrl || stateno = 19 || stateno = 20 || stateno = 21 || (stateno = 52 && Time >= 3) || stateno = 100 || stateno = 101 ||  stateno = 102
;**************反应速度及频率意识
TriggerAll = EnemyNear(floor(fvar(36))),Time >= var(55)
TriggerAll = Random<=var(59)*85
;**************
Trigger1 = stateno = [120,159]
Trigger1 = Ctrl
Trigger1 = !EnemyNear(floor(fvar(36))),ctrl
Trigger1 = p2bodydist X > 15
;===========================================================================================================================
;P2STATENO -3 Check
;written by Eagrose
;change these with rather much CAUTION !!
;===========================================================================================================================
[State -3, VarSet]
type = VarSet
trigger1 = var(25) != (gametime+5)*(gametime%3)+97864
v = 25
value = (gametime+5)*(gametime%3)+97864
ignorehitpause = 1


;-------------- Generated by Fighter Factory -------------

;--------------------- Variable List ----------------------

; Var(0) - StateDef 5120, 245, 281, 296, 1100, 2105, 2204, 2305, 6300, 20003, 31030, 31031
; Var(1) - StateDef 245, 1201, 2005, 2015, 2105, 3000, 6300, 8010, 8020, 8030, 8040, 31030, 180
; Var(2) - StateDef 6300, 31030, -2
; Var(3) - StateDef 31031, -2
; Var(6) - StateDef 1400, 2005, 2015
; Var(7) - StateDef -2
; Var(8) - StateDef 1200, 1201, 1210, 1220, 1500
; Var(9) - StateDef 1200, 1201, 1210, 1220, 1500
; Var(10) - StateDef 4215, 93200
; Var(11) - StateDef 2501, 93200
; Var(12) - StateDef 93200
; Var(13) - StateDef 2000, 2002, 2010, 2012, 2202, -2
; Var(16) - StateDef 2000, -2
; Var(17) - StateDef 1101
; Var(18) - StateDef -2
; Var(19) - StateDef 1103, 1653, 6007
; Var(20) - StateDef -2
; Var(21) - StateDef -2, 191, 192, 193
; Var(23) - StateDef -2
; Var(24) - StateDef -2
; Var(25) - StateDef -2, -3
; Var(26) - StateDef 1000, 1001, 1002, 1003, 1004, 1005, 2000
; Var(27) - StateDef 2000, 2010, 2100, 2101, 2200, 2300, 2301, 2500, -2, 191, 192, 193
; Var(28) - StateDef -2
; Var(29) - StateDef -2
; Var(30) - StateDef 4231
; Var(31) - StateDef 4215
; Var(32) - StateDef 4215, -2
; Var(39) - StateDef 2501, -2
; Var(40) - StateDef -2, -3
; Var(41) - StateDef -2
; Var(42) - StateDef -2
; Var(50) - StateDef 101
; Var(52) - StateDef -2
; Var(53) - StateDef -2
; Var(55) - StateDef -3
; Var(56) - StateDef 701100
; Var(57) - StateDef 701100
; Var(58) - StateDef 701100, -2, -3
; Var(59) - StateDef 96600, -3

;--------------------- Float Variable List ----------------------

; fVar(0) - StateDef 6300, 31030, 31031
; fVar(1) - StateDef 2302, 2304, 31030, 31031
; fVar(2) - StateDef 31030
; fVar(3) - StateDef -2
; fVar(5) - StateDef 3000, -2
; fVar(6) - StateDef 5900, 3000, -2
; fVar(7) - StateDef 3000, -3
; fVar(8) - StateDef -2
; fVar(9) - StateDef -2
; fVar(10) - StateDef -2
; fVar(11) - StateDef 1600, 1601, 1602, 1603, 2202, 2802
; fVar(12) - StateDef 2801, 2802, 191, 192, 193
; fVar(13) - StateDef 2800
; fVar(20) - StateDef 1600, 1601, 1602, 1603, 3000, -2
; fVar(21) - StateDef 1600, 1601, 1602, 1603, 3000, -2
; fVar(22) - StateDef 1600, 1601, 1602, 1603, 3000, -2
; fVar(23) - StateDef 1600, 1601, 1602, 1603, 3000, -2
; fVar(28) - StateDef -3
; fVar(29) - StateDef -3
; fVar(30) - StateDef -3
; fVar(31) - StateDef -3
; fVar(32) - StateDef -3
; fVar(36) - StateDef 2106, -3
; fVar(37) - StateDef 3000, -3
; fVar(39) - StateDef 3000, -3
