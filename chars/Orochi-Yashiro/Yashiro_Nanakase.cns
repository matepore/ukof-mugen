;>>>>>>>>>>>>>>>>>>>>>>=======================<<<<<<<<<<<<<<<<<<<<<<|
;||||||||||||||||||||||Yashiro Nanakase's CNS |||||||||||||||||||||||
;>>>>>>>>>>>>>>>>>>>>>>=======================<<<<<<<<<<<<<<<<<<<<<<|
;===================================================================|
;                              var List                             |
;===================================================================|
;var(0)  = 2-in-1 / 1 unique mode: 0 = Normal Yashiro only          |
;                                  1 = Orochi Yashiro only          |
;                                  2 = All 2 modes available        |
;var(1)  = Yashiro Select: 0 = Normal; 1 = Orochi                   |
;var(2)  = Yashiro Sound moves: 1 = weak; 2 = medium; 3 = strong    |
;   |_ and... General var for Special/DM/SDM/HSDM Checkers          |
;   |_ and... Long Jump Checker                                     |
;var(3)  = Normal Combo Checker Var                                 |
;var(4)  = Small Jump Checker Var                                   |
;var(5)  = Damage Adjust Code Var                                   |
;var(6)  = Throw Limitter Code Var - Single                         |
;var(7)  = Juggle Code Var                                          |
;var(8)  = Burn Explod Var                                          |
;var(9)  = AI Main Var                                              |
;var(10) = Left/Right Side Checker                                  |
;var(11) = Guard Crush Counter                                      |
;var(12) = Guard Crush Limitter                                     |
;var(13) = Dizzy CountDown                                          |
;var(14) = Dizzy Recovery                                           |
;var(15) = MAX Timer                                                |
;var(16) = MAX Mode Power Limitter                                  |
;var(17) = MAX Timer Going out                                      |
;var(18) = MAX Cancel Checker                                       |
;var(19) = Throw Limitter Code Var - Super                          |
;var(20) = Reserved                                                 |
;var(21) = AI Level (Editable in Settings.CNS)                      |
;var(22) = AI Projectile Optimization                               |
;var(23) = AI Roll/Dodge Optimization                               |
;var(24) = AI Enemy Size Detector                                   |
;var(25) = AI "in the Enemy's back" detector                        |
;var(26) = Winquote Language Setting                                |
;var(27) = Crouching/Standing Guard Detector                        |
;var(28) = Ankoku Jigoku Gokuraku Otoshi Cancel Checker             |
;var(50) = Multi-Roll preventing var                                |
;var(51) = Drago Groove Selector: 0 = MAX mode; 1 = NO MAX mode     |
;var(52) = AI guard detector                                        |
;var(53) = AI variations: 0 = aggressive                            |
;                         1 = defensive                             |
;                         2 = power charger                         |
;                         3 = grappler                              |
;var(54) = Damage adjust code limiter                               |
;var(55) = Unfair Detector System                                   |
;var(56) = Winane AI Var - 1                                        |
;var(57) = Winane AI Var - 2                                        |
;var(58) = Winane AI Var - 3                                        |
;-------------------------------------------------------------------|
;fvar(0)  = YoungMing's KOF Cornerpush var code                     |
;===================================================================|
;                             Sound List                            |
;===================================================================|
;Channel 0 = Basic Effects                                          |
;Channel 1 = Yashiro's Voice                                        |
;Channel 2 = Move Sound                                             |
;Channel 3 = Effects like run, dash...                              |
;Channel 4 = Gethit Sounds                                          |
;Channel 5 = DM/SDM/HSDM Sounds                                     |
;===================================================================|

[Data]
Life = 3000
Power= 5000
Attack = 100
Defence = 100
Fall.Defence_Up = 90
Liedown.Time = 20
AirJuggle = 15
SparkNo = S8000
Guard.SparkNo = S8010
KO.Echo = 0
Volume = 255
IntPersistIndex = 1,9,15,21,56,57,58
FloatPersistIndex = 0

[Size]
xScale = 1          
yScale = 1          
Ground.Back = 15     
Ground.Front = 16   
Air.Back = 12        
Air.Front = 12       
Attack.Dist = 160
Proj.Attack.Dist = 90
z.width = 3
head.pos = -8, -107
mid.pos = -1, -73
shadowoffset = 0
draw.offset = 0,0
proj.doscale = 1

[Velocity]
walk.fwd  = 2.4
walk.back = -2.3
run.fwd  = 5.2
run.back = -15,-4
jump.neu = 0,-9
jump.back = -3,-9
jump.fwd = 3,-9
runjump.back = -5,-10
runjump.fwd = 5,-10
airjump.neu = 0,-9
airjump.back = -3
airjump.fwd = 3

[Movement]
airjump.num = 0
airjump.height = 35
yaccel = .54
stand.friction = .83
crouch.friction = .82


;============================================================================
; Basic States
;============================================================================
;----------------------------
;----- Win Pose 1 All -------
;----------------------------
[Statedef 180]
Type = S
Ctrl = 0
Velset = 0
Sprpriority = 1
Anim = 180+3*var(1)

[State 180, 1]; Win Screen
type = Helper
trigger1 = !NumHelper(9998)
trigger1 = MatchOver
Trigger1 = !Numpartner
stateno = 9998
postype = left
pos = 0,0
name = "Win Screen"
id = 9998

[State 180,0]
type = AssertSpecial
trigger1 = Time < 200
trigger2 = Time < 250
trigger2 = var(1)
flag = roundnotover

[State 191, 9]
Type = Changestate
TriggerAll = !Time
TriggerAll = Command !="holdx"
TriggerAll = Command !="holda"
Trigger1 = Command !="holdz"
Trigger1 = Command !="holdc"
Trigger1 = Random < 333
Trigger2 = Command = "holdy"
Trigger3 = Command = "holdb"
Value = 181

[State 191, 9]
Type = Changestate
TriggerAll = !Time
TriggerAll = Command !="holdx"
TriggerAll = Command !="holda"
Trigger1 = Command !="holdy"
Trigger1 = Command !="holdb"
Trigger1 = Random > 666
Trigger2 = Command = "holdz"
Trigger3 = Command = "holdc"
Value = 182

[State 191, 1]
Type = PlaySnd
Trigger1 = AnimElem = 2
Value = 180+var(1),0
Channel = 1

[State 191, 1]
Type = PlaySnd
Triggerall = var(1)
Trigger1 = AnimElem = 2
Trigger2 = AnimElem = 22
Value = 191,0
Channel = 3

[State 191, 1]
Type = EnvShake
Trigger1 = AnimElem = 2, >= 0
Trigger1 = Timemod = 5, 0
Trigger1 = AnimElem = 49, < 0
Trigger1 = var(1)
Time = 5
Ampl = -2
freq = 25

[State 191, 1]
Type = PlaySnd
Trigger1 = AnimElem = 53
Value = 181,1
Channel = 1

;----------------------------
;----- Win Pose 2 All -------
;----------------------------
[Statedef 181]
Type = S
Ctrl = 0
Anim = 181+3*var(1)
Velset = 0

[State 180,0]
type = AssertSpecial
trigger1 = Time < 200
flag = roundnotover

[State 191, 1]
Type = PlaySnd
Trigger1 = AnimElem = 5
Trigger1 = !var(1)
Value = 180,1
Channel = 1

[State 191, 1]
Type = PlaySnd
Trigger1 = Time = 25
Trigger1 = var(1)
Value = 770,0
Channel = 1

[State 191, 1]
Type = PlaySnd
Triggerall = var(1)
Trigger1 = Time = 25
Trigger2 = Time = 85
Trigger3 = Time = 145
Value = 191,0
Channel = 3

[State 191, 1]
Type = EnvShake
Trigger1 = Time >= 25
Trigger1 = Timemod = 5, 0
Trigger1 = var(1)
Time = 5
Ampl = -2
freq = 25

;----------------------------
;----- Win Pose 3 All -------
;----------------------------
[Statedef 182]
Type = S
Ctrl = 0
Anim = 182+3*var(1)
Velset = 0

[State 180,0]
type = AssertSpecial
trigger1 = Time < 180
flag = roundnotover

[State 191, 1]
Type = PlaySnd
Trigger1 = AnimElem = 4
Trigger1 = !var(1)
Value = 180,2
Channel = 1

[State 191, 1]
Type = PlaySnd
Trigger1 = AnimElem = 4
Trigger1 = var(1)
Value = 0,3
Channel = 1

;----------------------------
;---------- Intro -----------
;----------------------------
[Statedef 191]
Type = S
Ctrl = 0
Anim = 190
Velset = 0

[State 191, Change Intro]
Type = ChangeAnim
Trigger1 = !Time
value = 190+(random > 500)+2*var(1)

[State 750, Left LV]
Type = Explod
Trigger1 = var(10) = 1
Trigger1 = Time = 1
Anim = ifelse(var(21) < 0, 8600, ifelse(var(21) > 8, 8609, 8600+var(21)))
ID =  8600
PosType = Left
Pos = 27,200
BindTime = -1
Ontop = 1
OwnPal = 1

[State 750, Right LV]
Type = Explod
Trigger1 = var(10) = 2
Trigger1 = Time = 1
Anim = ifelse(var(21) < 0, 8600, ifelse(var(21) > 8, 8609, 8600+var(21)))
ID =  8600
PosType = Right
Pos = -27,200
BindTime = -1
Ontop = 1
OwnPal = 1

[State 191, 1]
Type = AssertSpecial
Trigger1 = 1
flag = intro

[State 191, 1]
Type = Changestate
TriggerAll = Time = 1
Trigger1 = p2Name = "Chris"
Trigger2 = p2Name = "Shermie"
Trigger3 = p2Name = "Iori"
Trigger4 = p2Name = "Yagami"
Trigger5 = p2Name = "Iori Yagami"
Trigger6 = p2Name = "Goenitz"
Trigger7 = p2Name = "Leopold Goenitz"
value = 192

[State 191, 1]
Type = PlaySnd
Trigger1 = AnimElem = 2
Trigger1 = Anim != 194
Value = 190, ifelse(var(1), 2, 0)+(Anim = 193)
Channel = 1

[State 191, 1]
Type = StateTypeSet
Trigger1 = AnimElem = 17
Trigger1 = Anim = 190
StateType = A
Physics = N

[State 191, 1]
Type = PlaySnd
Trigger1 = AnimElem = 16
Trigger1 = Anim = 190
Value = 190, 1
Channel = 1

[State 191, 1]
Type = PlaySnd
Trigger1 = AnimElem = 19
Trigger1 = Anim = 190
Value = 50, 1
Channel = 3

[State 191, 1]
Type = VelSet
Trigger1 = AnimElem = 17
Trigger1 = Anim = 190
y = -9

[State 191, 1]
Type = Gravity
Trigger1 = AnimElem = 17, > 0
Trigger1 = Anim = 190

[State 191, 1]
Type = PosSet
Trigger1 = AnimElem = 17, > 0
Trigger1 = Anim = 190
Trigger1 = vel y > 0
Trigger1 = pos y >= 0
y = 0

[State 191, 1]
Type = VelSet
Trigger1 = AnimElem = 17, > 0
Trigger1 = Anim = 190
Trigger1 = vel y > 0
Trigger1 = pos y >= 0
y = 0

[State 191, 1]
Type = ChangeAnim
Trigger1 = AnimElem = 17, > 0
Trigger1 = Anim = 190
Trigger1 = vel y >= 0
Trigger1 = pos y >= 0
Value = 194

[State 191, 1]
Type = PlaySnd
Trigger1 = AnimElem = 1
Trigger1 = Anim = 194
Trigger2 = Anim = 191
Trigger2 = AnimElem = 17 || AnimElem = 22 || AnimElem = 27
Value = 52, 0
Channel = 3

[State -3, OTG FX]
type = Explod
Trigger1 = AnimElem = 1
Trigger1 = Anim = 194
anim = 8300
pos = 0,0
bindtime = 1
ownpal = 1
sprpriority = -3

[State -3, OTG FX]
type = Explod
Trigger1 = AnimElem = 7
Trigger1 = Anim = 192
Trigger2 = AnimElem = 11
Trigger2 = Anim = 193
anim = 8310
pos = 0,0
bindtime = 1
ownpal = 1
sprpriority = -3

[State -3, OTG FX]
type = Explod
Trigger1 = AnimElem = 7
Trigger1 = Anim = 192
Trigger2 = AnimElem = 11
Trigger2 = Anim = 193
anim = 8320
pos = 0,0
bindtime = 1
ownpal = 1
sprpriority = 3

[State 191, 1]
Type = PlaySnd
TriggerAll = Anim = 192
Trigger1 = Time = 2
Trigger2 = Time = 62
Value = 191, 0
Channel = 3

[State 3000, DM GND FX]
Type = Explod
trigger1 = Time = 2
trigger1 = Anim = 192
anim = 3050
ID = 3050
PosType = p1
Ownpal = 1
SprPriority = -2
BindTime = -1
RemoveTime = 90
RemoveOnGetHit = 1
IgnoreHitPause = 1
pos = -10,0

[State 3000, DM GND FX]
Type = Explod
trigger1 = Time = 2
trigger1 = Anim = 192
anim = 3060
ID = 3060
PosType = p1
Ownpal = 1
SprPriority = 2
BindTime = -1
RemoveTime = 90
RemoveOnGetHit = 1
IgnoreHitPause = 1
pos = -10,0

[State 191, 1]
Type = PlaySnd
Trigger1 = AnimElem = 9, = 3
Trigger1 = Anim = 192
Trigger2 = AnimElem = 12
Trigger2 = Anim = 193
Value = ifelse(anim = 192, 850,191),(anim = 193)
Channel = 3

[State 191, 1]
Type = EnvShake
Trigger1 = Time = 2
Trigger1 = Anim = 192
Time = 120
Ampl = 2

[State 191, 1]
Type = EnvShake
Trigger1 = AnimElem = 8
Trigger1 = Anim = 192
Trigger2 = AnimElem = 12
Trigger2 = Anim = 193
Time = 20
Ampl = 4
Phase = 2

[State 191, 9]
Type = ChangeState
Trigger1 = !AnimTime
Value = 0

;----------------------------
; Intro VS Iori/Chris/Shermie
;----------------------------
[Statedef 192]
Type = S
Ctrl = 0
Anim = 196
Velset = 0

[State 192, 1]
Type = ChangeAnim
TriggerAll = !Time
Trigger1 = p2Name = "Chris"
Trigger2 = p2Name = "Shermie"
value = 197+(p2Name = "Chris")

[State 192, 1]
Type = ChangeAnim
TriggerAll = !Time
Trigger1 = p2Name = "Goenitz"
Trigger2 = p2Name = "Leopold Goenitz"
value = 199

[State 191, 1]
Type = AssertSpecial
Trigger1 = 1
flag = intro

[State 182,PlaySnd]
type = PlaySnd
trigger1 = Anim = 196
trigger1 = AnimElem = 3
trigger2 = Anim = 197
trigger2 = AnimElem = 4
trigger3 = Anim = [198,199]
trigger3 = AnimElem = 5
value = 190, 4+(p2Name = "Shermie")+2*(p2Name = "Chris"||p2Name = "Goenitz"||p2Name = "Leopold Goenitz")

[State 191, 9]
Type = ChangeState
Trigger1 = !AnimTime
Value = 0

;----------------------------
;----------- Taunt ----------
;----------------------------
[Statedef 195]
Type = S
MoveType = A
Physics = S
Anim = 195
Velset = 0
Ctrl = 0

[State 195, 1]
Type = PlaySnd
Trigger1 = AnimElem = 1, = 1
Value = 195,var(1)
Channel = 1

[State 195, Aof2 style]
Type = TargetPowerAdd
Trigger1 = Timemod = 5,0
Value = -30

[State 195, 2]
Type = Ctrlset
Trigger1 = !var(9)
Trigger1 = Time > 20
Value = 1

[State 195, 9]
Type = ChangeState
Trigger1 = !AnimTime
Value = 0
Ctrl=1

;-----------------------------------
;----------- Weak Punch ------------
;-----------------------------------
[Statedef 200]
Type = S
MoveType = A
Physics = S
Anim = 200+5*(P2BodyDist x <= 15)
Velset = 0
Ctrl = 0
Juggle  = 8

[State 200, Sound Set]
Type = varSet
Trigger1 = !Time
var(2) = 0

[State 200, Hitdef]
Type = HitDef
Trigger1 = AnimElem = 2
attr = S, NA
damage = 20
AnimType = Light
getpower = 30,15
givepower = 15,8
Guardflag = M
Hitflag = MA
pauseTime = 8,10
SparkNo = S8000
Guard.SparkNo = S8010
sparkxy = -15,-75-25*(anim = 205)
HitSound = S5,0
GuardSound = S6,0
ground.Type = High
ground.SlideTime = 9
ground.HitTime  = 9
ground.Velocity = -5
Air.Velocity = -4,-5
yAccel = .5
Ground.CornerPush.Veloff = 0;-7
Air.CornerPush.Veloff = 0;-7

[State 200, Over]
Type = ChangeState
Trigger1 = !AnimTime
Value = 0
Ctrl = 1

;-----------------------------------
;------------ Weak Kick ------------
;-----------------------------------
[Statedef 210]
Type = S
MoveType = A
Physics = S
Anim = 210+5*(P2BodyDist x <= 35)
Velset = 0
Ctrl = 0
Juggle  = 8

[State 200, Sound Set]
Type = varSet
Trigger1 = !Time
var(2) = 0

[State 200, Hitdef]
Type = HitDef
Trigger1 = Anim = 210
Trigger1 = AnimElem = 2
attr = S, NA
damage = 25
AnimType = Light
getpower = 30,15
givepower = 15,8
Guardflag = M
Hitflag = MA
pauseTime = 8,10
SparkNo = S8000
Guard.SparkNo = S8010
sparkxy = -15,-75
HitSound = S5,1
GuardSound = S6,0
ground.Type = Low
ground.SlideTime = 9
ground.HitTime  = 9
ground.Velocity = -5.5
Air.Velocity = -4,-5
yAccel = .5
Ground.CornerPush.Veloff = 0;-7.5
Air.CornerPush.Veloff = 0;-7.5

[State 200, Hitdef]
Type = HitDef
Trigger1 = Anim = 215
Trigger1 = AnimElem = 2
attr = S, NA
damage = 25
AnimType = Light
getpower = 30,15
givepower = 15,8
Guardflag = L
Hitflag = MA
pauseTime = 8,10
SparkNo = S8000
Guard.SparkNo = S8010
sparkxy = -15,-25
HitSound = S5,1
GuardSound = S6,0
ground.Type = Low
ground.SlideTime = 9
ground.HitTime  = 9
ground.Velocity = -5.5
Air.Velocity = -4,-5
yAccel = .5
Ground.CornerPush.Veloff = 0;-7.5
Air.CornerPush.Veloff = 0;-7.5

[State 200, Over]
Type = ChangeState
Trigger1 = !AnimTime
Value = 0
Ctrl = 1

;-----------------------------------
;---------- Medium Punch -----------
;-----------------------------------
[Statedef 220]
Type = S
MoveType = A
Physics = S
Anim = 220+5*(P2BodyDist x <= 20)
Velset = 0
Ctrl = 0
Juggle  = 8

[State 225,PosAdd]
type = PosAdd
triggerAll = Anim = 220
trigger1 = AnimElem = 1
trigger2 = AnimElem = 2
trigger3 = AnimElem = 3
trigger4 = AnimElem = 4
trigger5 = AnimElem = 4, = 1
x = 5

[State 200, Sound Set]
Type = varSet
Trigger1 = !Time
var(2) = 1

[State 200, Hitdef]
Type = HitDef
Trigger1 = AnimElem = 3
attr = S, NA
damage = 40
AnimType = Medium
getpower = 60,30
givepower = 30,15
Guardflag = M
Hitflag = MA
pauseTime = 9,11
SparkNo = S8001
Guard.SparkNo = S8011
sparkxy = -30,-80
HitSound = S5,2
GuardSound = S6,0
ground.Type = High
ground.SlideTime = 14
ground.HitTime = 14
ground.Velocity = -7
Air.Velocity = -4,-5
yAccel = .5
Ground.CornerPush.Veloff = 0;-11
Air.CornerPush.Veloff = 0;-11

[State 200, Over]
Type = ChangeState
Trigger1 = !AnimTime
Value = 0
Ctrl = 1

;-----------------------------------
;---------- Medium Kick ------------
;-----------------------------------
[Statedef 230]
Type = S
MoveType = A
Physics = S
Anim = 230+5*(P2BodyDist x <= 30)
Velset = 0
Ctrl = 0
Juggle  = 8

[State 210,PosAdd]
type = PosAdd
triggerAll = Anim = 230
trigger1 = AnimElem = 2
trigger2 = AnimElem = 3
trigger3 = AnimElem = 4
x = 5

[State 200, Sound Set]
Type = varSet
Trigger1 = !Time
var(2) = 1

[State 200, Hitdef]
Type = HitDef
Trigger1 = AnimElem = 3
attr = S, NA
damage = 50
AnimType = Medium
getpower = 60,30
givepower = 30,15
Guardflag = M
Hitflag = MA
pauseTime = 9,11
SparkNo = S8001
Guard.SparkNo = S8011
sparkxy = -15,-80-25*(Anim = 230)
HitSound = S5,3
GuardSound = S6,0
ground.Type = High
ground.SlideTime = 14
ground.HitTime = 14
ground.Velocity = -7.5
Air.Velocity = -4,-5
yAccel = .5
Ground.CornerPush.Veloff = 0;-11.5
Air.CornerPush.Veloff = 0;-11.5


[State 200, Over]
Type = ChangeState
Trigger1 = !AnimTime
Value = 0
Ctrl = 1

;-----------------------------------
;---------- Strong Punch -----------
;-----------------------------------
[Statedef 240]
Type = S
MoveType = A
Physics = S
Anim = 240+5*(P2BodyDist x <= 30)
Velset = 0
Ctrl = 0
Juggle  = 8

[State 200, Sound Set]
Type = varSet
Trigger1 = !Time
var(2) = 2

[State 200, ChangeAnim]
Type = ChangeAnim
Trigger1 = !Time
Trigger1 = PrevStateNo = 220
Value = 240

[State 200, Hitdef]
Type = HitDef
Trigger1 = AnimElem = 4
attr = S, NA
damage = 80+20*(Anim = 245)
AnimType = Heavy
getpower = 120,60
givepower = 30,15
Guardflag = M
Hitflag = MA
pauseTime = 10,12
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,-75
HitSound = S5,4
GuardSound = S6,0
ground.Type = Low
ground.SlideTime = 17
ground.HitTime = 17
ground.Velocity = -9
Air.Velocity = -4,-5
yAccel = .5
Ground.CornerPush.Veloff = 0;-15
Air.CornerPush.Veloff = 0;-15
EnvShake.Time = 5

[State 200, Over]
Type = ChangeState
Trigger1 = !AnimTime
Value = 0
Ctrl = 1

;-----------------------------------
;---------- Strong Kick ------------
;-----------------------------------
[Statedef 250]
Type = S
MoveType = A
Physics = S
Anim = 250+5*(P2BodyDist x <= 25)
Velset = 0
Ctrl = 0
Juggle  = 8

[State 200, Sound Set]
Type = varSet
Trigger1 = !Time
var(2) = 2

[State 200, Hitdef]
Type = HitDef
Trigger1 = Anim = 250
Trigger1 = AnimElem = 4
attr = S, NA
damage = 100
AnimType = Heavy
getpower = 120,60
givepower = 60,30
Guardflag = M
Hitflag = MA
pauseTime = 10,12
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,-95
HitSound = S5,5
GuardSound = S6,0
ground.Type = High
ground.SlideTime = 17
ground.HitTime = 17
ground.Velocity = -9.5
Air.Velocity = -4,-5
yAccel = .5
EnvShake.Time = 5
Ground.CornerPush.Veloff = 0;-11.5
Air.CornerPush.Veloff = 0;-11.5

[State 200, Hitdef]
Type = HitDef
Trigger1 = Anim = 255
Trigger1 = AnimElem = 3
attr = S, NA
damage = 80
AnimType = Heavy
getpower = 120,60
givepower = 60,30
Guardflag = M
Hitflag = MA
pauseTime = 10,12
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,-45
HitSound = S5,5
GuardSound = S6,0
ground.Type = Low
ground.SlideTime = 17
ground.HitTime = 17
ground.Velocity = -9.5
Air.Velocity = -4,-5
yAccel = .5
EnvShake.Time = 5
Ground.CornerPush.Veloff = 0;-11.5
Air.CornerPush.Veloff = 0;-11.5

[State 200, Over]
Type = ChangeState
Trigger1 = !AnimTime
Value = 0
Ctrl = 1

;-----------------------------------
;-------- KnockDown Attack ---------
;-----------------------------------
[Statedef 260]
Type = S
MoveType = A
Physics = S
Anim = 260+(prevstateno = [150,152])
Velset = 0
Ctrl = 0
Juggle  = 8
Poweradd = -1000*(prevstateno = [150,152])

[State 700, Cancel0]
type = VarAdd
Trigger1 = !Time
trigger1 = prevstateno = [150,152]
var(16) = -1000

[State 700, Cancel1]
type = pause
Trigger1 = !Time
trigger1 = prevstateno = [150,152]
time = 3
movetime = 3

[State 700, Cancel2]
type = envcolor
Trigger1 = !Time
trigger1 = prevstateno = [150,152]
time = 2
value= 255,255,255

[State 700, Cancel3]
type = Explod
Trigger1 = !Time
trigger1 = prevstateno = [150,152]
anim = 730
pos = 20,-60
postype = p1
pausemovetime = 9999
bindtime = 1
ownpal = 1
persistent = 0
ontop = 1

[State 700, Cancel4]
type = NotHitBy
Trigger1 = AnimElem = 5, < 0
trigger1 = prevstateno = [150,152]
value= SCA


[State 700, Cancel4]
type = Velset
Trigger1 = AnimElem = 4
x = 10

[State 700, Cancel4]
type = Velset
Trigger1 = AnimElem = 5, = 1
x = 0

[State 700, Cancel4]
type = posAdd
Trigger1 = AnimElem = 6
x = 10

[State 700, width]
type = width
Trigger1 = 1
edge = 30,0

[State 200, Sound Set]
Type = varSet
Trigger1 = !Time
var(2) = 2

[State 200, Hitdef]
Type = HitDef
trigger1 = prevstateno != [150,152]
Trigger1 = AnimElem = 4
attr = S, NA
damage = 120
AnimType = back
getpower = 120,60
givepower = 30,15
Guardflag = M
Hitflag = MA
pauseTime = 11,13
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,-70
HitSound = S5,6
GuardSound = S6,0
ground.Type = High
ground.SlideTime = 17
ground.HitTime = 17
ground.Velocity = -3,-7.5
Guard.Velocity = -11.5
Air.Velocity = -3,-7
yAccel = .5
Ground.CornerPush.Veloff = 0;-15.5
Air.CornerPush.Veloff = 0;-15.5
EnvShake.Time = 15
Fall = 1
Fall.Recover = !var(55)
Fall.RecoverTime = 35

[State 200, Hitdef]
Type = HitDef
Trigger1 = prevstateno = [150,152]
Trigger1 = AnimElem = 4
attr = S, SA
damage = 60
AnimType = DiagUp
getpower = 0,0
givepower = 30,15
Guardflag = M
Hitflag = MA
pauseTime = 11,13
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,-70
HitSound = S5,6
GuardSound = S6,0
ground.Type = High
ground.SlideTime = 17
ground.HitTime = 17
ground.Velocity = -4,-6.5
Guard.Velocity = -11.5
Air.Velocity = -4,-6
yAccel = .45
Ground.CornerPush.Veloff = 0;-15.5
Air.CornerPush.Veloff = 0;-15.5
EnvShake.Time = 15
Fall = 1
Fall.Recover = !var(55)
Fall.RecoverTime = 35

[State 200, Over]
Type = ChangeState
Trigger1 = !AnimTime
Value = 0
Ctrl = 1

;-----------------------------------
;---------- Regret Bash ------------
;-----------------------------------
[Statedef 300]
Type = S
MoveType = A
Physics = S
Anim = 300+5*(prevStateNo = [200,450])
Velset = 0
Ctrl = 0
Juggle  = 8


[State 300, Move on]
type = PosAdd
trigger1 = AnimElem = 2
trigger2 = AnimElem = 7
x = 15

[State 300, Move on]
type = PosAdd
trigger1 = AnimElem = 4
trigger2 = AnimElem = 5
x = 20

[State 300, Move on]
type = PosAdd
trigger1 = AnimElem = 8
x = 10

[State 200, Sound Set]
Type = PlaySND
Trigger1 = Time = 1
value = 0,3
channel = 1

[State 200, Sound Set]
Type = PlaySND
Trigger1 = AnimElem = 3
value = 1,2
channel = 3

[State 200, Quake]
Type = EnvShake
Trigger1 = AnimElem = 8
Time = 15
Ampl = 6
ignorehitpause = 1

[State 200, Sound Set]
Type = PlaySND
Trigger1 = AnimElem = 8
value = 850,0
channel = 4

[State -3, OTG FX]
type = Explod
Trigger1 = AnimElem = 8
anim = 8300
pos = 60,0
bindtime = 1
ownpal = 1
sprpriority = -3
PauseMoveTime = 99
SuperMoveTime = 99
ignorehitpause = 1

[State 200, Hitdef]
Type = HitDef
Trigger1 = PrevStateno != [200,450]
Trigger1 = AnimElem = 8
attr = S, NA
damage = 100
AnimType = Hard
getpower = 120,60
givepower = 60,30
Guardflag = H
Hitflag = MAFD
pauseTime = 12,8
guard.pauseTime = 12,12
SparkNo = S8001
Guard.SparkNo = S8011
sparkxy = -15,-55
HitSound = S5,6
GuardSound = S6,0
ground.Type = Low
ground.SlideTime = 17
ground.HitTime = 17
ground.Velocity = 0
down.velocity = 0,0
guard.Velocity = -9.5
Air.Velocity = -4,5
yAccel = 5
Ground.CornerPush.Veloff = 0
Air.CornerPush.Veloff = 0
Fall = 1
Fall.Recover = 0

[State 200, Hitdef]
Type = HitDef
Trigger1 = PrevStateno = [200,450]
Trigger1 = AnimElem = 8
attr = S, NA
damage = 50
AnimType = Hard
getpower = 120,60
givepower = 60,30
Guardflag = M
Hitflag = MAFD
pauseTime = 12,12
SparkNo = S8001
Guard.SparkNo = S8011
sparkxy = -15,-55
HitSound = S5,6
GuardSound = S6,0
ground.Type = Low
ground.SlideTime = 17
ground.HitTime = 17
ground.Velocity = -9.5
Air.Velocity = -4,5
yAccel = .5
Ground.CornerPush.Veloff = 0
Air.CornerPush.Veloff = 0
Air.Fall = 1
Fall.Recover = 0

[State 200, Over]
Type = ChangeState
Trigger1 = !AnimTime
Value = 0
Ctrl = 1

;-----------------------------------
;--------- Step Side Kick ----------
;-----------------------------------
[Statedef 310]
Type = S
MoveType = A
Physics = S
Anim = 310
Velset = 0
Ctrl = 0
Juggle  = 8

[State -3, Attack Voice]
type = PlaySnd
Trigger1 = Animelem = 2
Value = 0,1
Channel = 1

[State -3, Attack Voice]
type = PlaySnd
Trigger1 = Animelem = 3
Value = 1,2
Channel = 3

[State 310,Move on]
type = PosAdd
trigger1 = AnimElem = 1
x = 16

[State 310,Move on]
type = PosAdd
trigger1 = AnimElem = 3
x = 14

[State 700,PosAdd]
type = PosAdd
trigger1 = AnimElem = 11
x = -10

[State 700,PosAdd]
type = PosAdd
trigger1 = AnimElem = 13
x = -10

[State 200, Hitdef]
Type = HitDef
Trigger1 = AnimElem = 3
attr = S, NA
damage = 80
AnimType = Medium
getpower = 120,60
givepower = 60,30
Guardflag = M
Hitflag = MA
pauseTime = 10,12
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -5,-75
HitSound = S5,5
GuardSound = S6,0
ground.Type = High
ground.SlideTime = 17
ground.HitTime = 17
ground.Velocity = -9.5
Air.Velocity = -4,-5
yAccel = .5
Ground.CornerPush.Veloff = 0;-15.5
Air.CornerPush.Veloff = 0;-15.5
Envshake.time = 5
Air.Fall = 1
Fall.Recover = !var(55)
Fall.RecoverTime = 42

[State 200, Over]
Type = ChangeState
Trigger1 = !AnimTime
Value = 0
Ctrl = 1

;-----------------------------------
;------- Crouch Weak Punch ---------
;-----------------------------------
[Statedef 400]
Type = C
MoveType = A
Physics = C
Anim = 400
Velset = 0
Ctrl = 0
Juggle  = 8

[State 200, Sound Set]
Type = varSet
Trigger1 = !Time
var(2) = 0

[State 200, Hitdef]
Type = HitDef
Trigger1 = AnimElem = 2
attr = C, NA
damage = 20
AnimType = Light
getpower = 30,15
givepower = 15,8
Guardflag = M
Hitflag = MA
pauseTime = 8,10
SparkNo = S8000
Guard.SparkNo = S8010
sparkxy = -15,-60
HitSound = S5,0
GuardSound = S6,0
ground.Type = Low
ground.SlideTime = 9
ground.HitTime  = 9
ground.Velocity = -5
Air.Velocity = -4,-5
yAccel = .5
Ground.CornerPush.Veloff = 0;-7
Air.CornerPush.Veloff = 0;-7

[State 200, Over]
Type = ChangeState
Trigger1 = !AnimTime
Value = 11
Ctrl = 1

;-----------------------------------
;-------- Crouch Weak Kick ---------
;-----------------------------------
[Statedef 410]
Type = C
MoveType = A
Physics = C
Anim = 410
Velset = 0
Ctrl = 0
Juggle  = 8

[State 200, Sound Set]
Type = varSet
Trigger1 = !Time
var(2) = 0

[State 200, Hitdef]
Type = HitDef
Trigger1 = AnimElem = 2
attr = C, NA
damage = 25
AnimType = Light
getpower = 30,15
givepower = 15,8
Guardflag = L
Hitflag = MA
pauseTime = 8,10
SparkNo = S8000
Guard.SparkNo = S8010
sparkxy = -15,-10
HitSound = S5,1
GuardSound = S6,0
ground.Type = Low
ground.SlideTime = 9
ground.HitTime  = 9
ground.Velocity = -5.5
Air.Velocity = -4,-5
yAccel = .5
Ground.CornerPush.Veloff = 0;-7.5
Air.CornerPush.Veloff = 0;-7.5

[State 200, Over]
Type = ChangeState
Trigger1 = !AnimTime
Value = 11
Ctrl = 1

;-----------------------------------
;------ Crouch Medium Punch --------
;-----------------------------------
[Statedef 420]
Type = C
MoveType = A
Physics = C
Anim = 420
Velset = 0
Ctrl = 0
Juggle  = 8

[State 200, Sound Set]
Type = varSet
Trigger1 = !Time
var(2) = 1

[State 200, Hitdef]
Type = HitDef
Trigger1 = AnimElem = 3
attr = C, NA
damage = 40
AnimType = Medium
getpower = 60,30
givepower = 30,15
Guardflag = M
Hitflag = MA
pauseTime = 9,11
SparkNo = S8001
Guard.SparkNo = S8011
sparkxy = -15,-95
HitSound = S5,2
GuardSound = S6,0
ground.Type = Low
ground.SlideTime = 14
ground.HitTime = 14
ground.Velocity = -7
Air.Velocity = -3.5,-6
yAccel = .5
Ground.CornerPush.Veloff = 0;-11
Air.CornerPush.Veloff = 0;-11

[State 200, Over]
Type = ChangeState
Trigger1 = !AnimTime
Value = 11
Ctrl = 1

;-----------------------------------
;------- Crouch Medium Kick --------
;-----------------------------------
[Statedef 430]
Type = C
MoveType = A
Physics = C
Anim = 430
Velset = 0
Ctrl = 0
Juggle  = 8

[State 200, Sound Set]
Type = varSet
Trigger1 = !Time
var(2) = 1

[State 200, Hitdef]
Type = HitDef
Trigger1 = AnimElem = 3
attr = C, NA
damage = 50
AnimType = Medium
getpower = 60,30
givepower = 30,15
Guardflag = L
Hitflag = MA
pauseTime = 9,11
SparkNo = S8001
Guard.SparkNo = S8011
sparkxy = -15,-10
HitSound = S5,3
GuardSound = S6,0
ground.Type = Low
ground.SlideTime = 14
ground.HitTime = 14
ground.Velocity = -7.5
Air.Velocity = -4,-5
yAccel = .5
Ground.CornerPush.Veloff = 0;-11.5
Air.CornerPush.Veloff = 0;-11.5

[State 200, Over]
Type = ChangeState
Trigger1 = !AnimTime
Value = 11
Ctrl = 1

;-----------------------------------
;------ Crouch Strong Punch --------
;-----------------------------------
[Statedef 440]
Type = C
MoveType = A
Physics = C
Anim = 440
Velset = 0
Ctrl = 0
Juggle  = 8

[State 200, Sound Set]
Type = varSet
Trigger1 = !Time
var(2) = 2

[State 200, Hitdef]
Type = HitDef
Trigger1 = AnimElem = 3
attr = C, NA
damage = 80
AnimType = Heavy
getpower = 120,60
givepower = 30,15
Guardflag = M
Hitflag = MA
pauseTime = 10,12
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,-95
HitSound = S5,4
GuardSound = S6,0
ground.Type = High
ground.SlideTime = 17
ground.HitTime = 17
ground.Velocity = -9
Air.Velocity = -3.5,-6
yAccel = .5
Ground.CornerPush.Veloff = 0;-15
Air.CornerPush.Veloff = 0;-15
EnvShake.Time = 5

[State 200, Over]
Type = ChangeState
Trigger1 = !AnimTime
Value = 11
Ctrl = 1

;-----------------------------------
;------- Crouch Strong Kick --------
;-----------------------------------
[Statedef 450]
Type = C
MoveType = A
Physics = C
Anim = 450
Velset = 0
Ctrl = 0
Juggle  = 8

[State 200, Sound Set]
Type = varSet
Trigger1 = !Time
var(2) = 2

[State 200, Hitdef]
Type = HitDef
Trigger1 = AnimElem = 6
Trigger2 = AnimElem = 8
Trigger2 = !MoveHit
attr = C, NA
damage = 80
AnimType = Medium
getpower = 120,30
givepower = 60,15
Guardflag = L
Hitflag = MA
pauseTime = 10,12
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,-35
HitSound = S5,5
GuardSound = S6,0
ground.Type = Trip
ground.SlideTime = 17
ground.HitTime = 17
Guard.Velocity = -9.5
ground.Velocity = -3,-6.5
Air.Velocity = -3,-6
yAccel = .5
Ground.CornerPush.Veloff = 0;-15.5
Air.CornerPush.Veloff = 0;-15.5
EnvShake.Time = 5
Fall = 1
Fall.Recover = !var(55)
Fall.RecoverTime = 30

[State 200, Over]
Type = ChangeState
Trigger1 = !AnimTime
Value = 11
Ctrl = 1

;-----------------------------------
;------- Aerial Weak Punch ---------
;-----------------------------------
[Statedef 600]
Type = A
MoveType = A
Physics = A
Anim = 600
Ctrl = 0
Juggle  = 8

[State 200, Sound Set]
Type = varSet
Trigger1 = !Time
var(2) = 0

[State 200, Hitdef]
Type = HitDef
Trigger1 = AnimElem = 4
attr = A, NA
damage = 20
AnimType = Light
getpower = 30,15
givepower = 15,8
Guardflag = HA
Hitflag = MA
pauseTime = 8,10
SparkNo = S8000
Guard.SparkNo = S8010
sparkxy = -15,-55
HitSound = S5,0
GuardSound = S6,0
ground.Type = Low
ground.SlideTime = 10
ground.HitTime  = 10
ground.Velocity = -5
Air.Velocity = -4,-5
yAccel = .5
Ground.CornerPush.Veloff = 0;-5
Air.CornerPush.Veloff = 0;-5

;-----------------------------------
;-------- Aerial Weak Kick ---------
;-----------------------------------
[Statedef 610]
Type = A
MoveType = A
Physics = A
Anim = 610
Ctrl = 0
Juggle  = 8

[State 200, Sound Set]
Type = varSet
Trigger1 = !Time
var(2) = 0

[State 200, Hitdef]
Type = HitDef
Trigger1 = AnimElem = 4
attr = A, NA
damage = 25
AnimType = Light
getpower = 30,15
givepower = 15,8
Guardflag = HA
Hitflag = MA
pauseTime = 8,10
SparkNo = S8000
Guard.SparkNo = S8010
sparkxy = -15,-90
HitSound = S5,1
GuardSound = S6,0
ground.Type = High
ground.SlideTime = 10
ground.HitTime  = 10
ground.Velocity = -5.5
Air.Velocity = -4,-5
yAccel = .5
Ground.CornerPush.Veloff = 0;-5.5
Air.CornerPush.Veloff = 0;-5.5

;-----------------------------------
;------ Aerial Medium Punch --------
;-----------------------------------
[Statedef 620]
Type = A
MoveType = A
Physics = A
Anim = 620
Ctrl = 0
Juggle  = 8

[State 200, Sound Set]
Type = varSet
Trigger1 = !Time
var(2) = 1


[State 200, Hitdef]
Type = HitDef
Trigger1 = AnimElem = 4
attr = A, NA
damage = 40
AnimType = Medium
getpower = 60,30
givepower = 30,15
Guardflag = HA
Hitflag = MA
pauseTime = 9,11
SparkNo = S8001
Guard.SparkNo = S8011
sparkxy = -15,-35
HitSound = S5,2
GuardSound = S6,0
ground.Type = Low
ground.SlideTime = 10
ground.HitTime = 10
ground.Velocity = -7
Air.Velocity = -4,-5
yAccel = .5
Ground.CornerPush.Veloff = 0;-7
Air.CornerPush.Veloff = 0;-7

;-----------------------------------
;------- Aerial Medium Kick --------
;-----------------------------------
[Statedef 630]
Type = A
MoveType = A
Physics = A
Anim = 630
Ctrl = 0
Juggle  = 8

[State 200, Sound Set]
Type = varSet
Trigger1 = !Time
var(2) = 1

[State 200, Hitdef]
Type = HitDef
Trigger1 = AnimElem = 4
attr = A, NA
damage = 50
AnimType = Medium
getpower = 60,30
givepower = 30,15
Guardflag = HA
Hitflag = MA
pauseTime = 9,11
SparkNo = S8001
Guard.SparkNo = S8011
sparkxy = -15,-100
HitSound = S5,3
GuardSound = S6,0
ground.Type = High
ground.SlideTime = 10
ground.HitTime = 10
ground.Velocity = -6.5
Air.Velocity = -4,-5
yAccel = .5
Ground.CornerPush.Veloff = 0;-6.5
Air.CornerPush.Veloff = 0;-6.5

;-----------------------------------
;------ Aerial Strong Punch --------
;-----------------------------------
[Statedef 640]
Type = A
MoveType = A
Physics = A
Anim = 640
Ctrl = 0
Juggle  = 8

[State 200, Sound Set]
Type = varSet
Trigger1 = !Time
var(2) = 2

[State 200, Hitdef]
Type = HitDef
Trigger1 = AnimElem = 4
attr = A, NA
damage = 80
AnimType = Heavy
getpower = 120,60
givepower = 30,15
Guardflag = HA
Hitflag = MA
pauseTime = 10,12
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,-60
HitSound = S5,4
GuardSound = S6,0
ground.Type = Low
ground.SlideTime = 10
ground.HitTime  = 10
ground.Velocity = -7
Air.Velocity = -4,-5
yAccel = .5
Ground.CornerPush.Veloff = 0;-7
Air.CornerPush.Veloff = 0;-7
EnvShake.Time = 5

;-----------------------------------
;------- Aerial Strong Kick --------
;-----------------------------------
[Statedef 650]
Type = A
MoveType = A
Physics = A
Anim = 650
Ctrl = 0
Juggle  = 8

[State 200, Sound Set]
Type = varSet
Trigger1 = !Time
var(2) = 2

[State 200, Hitdef]
Type = HitDef
Trigger1 = AnimElem = 4
attr = A, NA
damage = 80
AnimType = Medium
getpower = 120,60
givepower = 30,15
Guardflag = HA
Hitflag = MA
pauseTime = 10,12
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,-65
HitSound = S5,5
GuardSound = S6,0
ground.Type = High
ground.SlideTime = 10
ground.HitTime  = 10
Guard.Velocity = -7.5
ground.Velocity = -7.5
Air.Velocity = -4,-5
yAccel = .5
Ground.CornerPush.Veloff = 0;-7.5
Air.CornerPush.Veloff = 0;-7.5
EnvShake.Time = 5

;-----------------------------------
;-------- KnockDown Attack ---------
;-----------------------------------
[Statedef 660]
Type = A
MoveType = A
Physics = A
Anim = 660
Ctrl = 0
Juggle  = 8

[State 200, Sound Set]
Type = varSet
Trigger1 = !Time
var(2) = 2

[State 200, Hitdef]
Type = HitDef
Trigger1 = AnimElem = 2
attr = A, NA
damage = 120
AnimType = Up
getpower = 120,60
givepower = 30,15
Guardflag = MA
Hitflag = MA
pauseTime = 11,13
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,-100
HitSound = S5,6
GuardSound = S6,0
ground.Type = High
ground.SlideTime = 17
ground.HitTime = 17
ground.Velocity = -3,-7.5
Guard.Velocity = -8
Air.Velocity = -3,-7
yAccel = .5
Ground.CornerPush.Veloff = 0;-15.5
Air.CornerPush.Veloff = 0;-15.5
EnvShake.Time = 15
Fall = 1
Fall.Recover = !var(55)
Fall.RecoverTime = 35

;-----------------------------------
;------- Ten'ma Kuujin Kyaku -------
;-----------------------------------
[Statedef 670]
Type = A
MoveType = A
Physics = N
Anim = 670
Ctrl = 0
Juggle  = 8
Velset = 0,0

[State 200, Sound Set]
Type = PlaySND
Trigger1 = Time = 1
value = 0,0
channel = 1

[State 200, Sound Set]
Type = PlaySND
Trigger1 = Time = 1
value = 1,2
channel = 3

[State 200, Sound Set]
Type = velSet
Trigger1 = AnimElem = 3
x = 5.5
y = 8.5

[State 200, Hitdef]
Type = HitDef
Trigger1 = AnimElem = 3
attr = A, NA
damage = 60
AnimType = Medium
getpower = 60,30
givepower = 30,15
Guardflag = HA
Hitflag = MA
pauseTime = 9,11
SparkNo = S8001
Guard.SparkNo = S8011
sparkxy = -15,-30
HitSound = S5,3
GuardSound = S6,0
ground.Type = Low
ground.SlideTime = 13
ground.HitTime = 13
ground.Velocity = -7.5
Air.Velocity = -4,-5
yAccel = .5
Guard.CornerPush.Veloff = 0;-7.5
Air.Fall = 1
Fall.Recover = !var(55)
Fall.RecoverTime = 35

[State 670, End]
Type = ChangeState
Trigger1 = pos Y >= 0
value = 52

;============================================================================
; Groove Moves
;============================================================================
;-----------------------------------
;------ KoF'98 Style Roll fwd ------
;-----------------------------------
[statedef 700]
type = S
movetype = I
physics = N
anim = 700
ctrl = 0
velset = 0,0
Poweradd = -1000*(prevstateno = [150,152])

[State 700, Cancel0]
type = VarAdd
Trigger1 = !Time
trigger1 = prevstateno = [150,152]
var(16) = -1000

[State 700, Cancel1]
type = pause
Trigger1 = !Time
trigger1 = prevstateno = [150,152]
time = 3

[State 700, Cancel2]
type = envcolor
Trigger1 = !Time
trigger1 = prevstateno = [150,152]
time = 2
value= 255,255,255

[State 700, AI Roll Limit]
type = VarSet
Trigger1 = !Time
trigger1 = var(9)
var(23) = 1

[State 700, Cancel3]
type = Explod
Trigger1 = !Time
trigger1 = prevstateno = [150,152]
anim = 730
pos = 10,-80
postype = p1
pausemovetime = 9999
bindtime = 1
ownpal = 1
persistent = 0
ontop = 1

[State 700, Ryu voice]
Type = PlaySnd
Trigger1 = !Time
Value = 0,1
Channel = 1

[State 700, HitBy]
Type = HitBy
trigger1 = AnimElem = 10, <= 2
Trigger2 = PrevStateNo = [150,152]
Value = SCA, AT

[State 700, Frame]
type = AfterImage
trigger1 = Time = 3
time = 7
PalBright = 0, 0, 0
PalAdd = 0, 0, 0
PalMul = 1,1,1
Length = 6
PalContrast = 255,255,255

[State 700, To Background]
type = SprPriority
trigger1 = Time = 3
value = -2

[State 700, VelSet]
type = VelSet
trigger1 = AnimElem = 3
x = 5.7+(PrevStateno = [100,101])+(PrevStateNo = [150,152])

[State 700, Fricction]
type = VelAdd
trigger1 = AnimElem = 3, >= 0
trigger1 = AnimElem = 10, < 0
x = -.1

[State 700, Stop]
type = VelSet
trigger1 = AnimElem = 10, >= 0
x = 0

[State 700, To Background2]
type = PlayerPush
trigger1 = Time < 24
value = 0

[State 700, To Background 3]
type = PlayerPush
trigger1 = Time >= 24
value = 1

[State 700, End]
type = ChangeState
trigger1 = !AnimTime
trigger1 = var(9)
trigger1 = p2bodydist x = [0,50]
value = 440

[State 700, End]
type = ChangeState
trigger1 = !AnimTime
value = 0
ctrl = 1

;-----------------------------------
;----- KoF'98 Style Roll Back ------
;-----------------------------------
[statedef 710]
type = S
movetype = I
physics = N
anim = 710
ctrl = 0
velset = 0,0
Poweradd = -1000*(prevstateno = [150,152])

[State 700, Cancel0]
type = VarAdd
Trigger1 = !Time
trigger1 = prevstateno = [150,152]
var(16) = -1000

[State 700, Ryu voice]
Type = PlaySnd
Trigger1 = !Time
Value = 0,1
Channel = 1

[State 700, Cancel1]
type = pause
Trigger1 = !Time
trigger1 = prevstateno = [150,152]
time = 3

[State 700, Cancel2]
type = envcolor
Trigger1 = !Time
trigger1 = prevstateno = [150,152]
time = 2
value= 255,255,255


[State 700, Cancel3]
type = Explod
Trigger1 = !Time
trigger1 = prevstateno = [150,152]
anim = 730
pos = 10,-80
postype = p1
pausemovetime = 9999
bindtime = 1
ownpal = 1
persistent = 0
ontop = 1

[State 700, HitBy]
Type = HitBy
trigger1 = AnimElem = 10, <= 2
Trigger2 = PrevStateNo = [150,152]
Value = SCA, AT

[State 700, Frame]
type = AfterImage
trigger1 = Time = 3
time = 5
PalBright = 0, 0, 0
PalAdd = 0, 0, 0
PalMul = 1,1,1
Length = 6
PalContrast = 255,255,255

[State 700, To Background]
type = SprPriority
trigger1 = Time = 3
value = -2

[State 700, VelSet]
type = VelSet
trigger1 = AnimElem = 3
x = -6.5

[State 700, Fricction]
type = VelAdd
trigger1 = AnimElem = 3, >= 0
trigger1 = AnimElem = 10, < 0
x = .1


[State 700, Stop]
type = VelSet
trigger1 = AnimElem = 10, >= 0
x = 0

[State 700, To Background2]
type = PlayerPush
trigger1 = Time < 24
value = 0

[State 700, To Background 3]
type = PlayerPush
trigger1 = Time >= 24
value = 1

[State 700, End]
type = ChangeState
trigger1 = !AnimTime
value = 0
ctrl = 1

;-----------------------------------
;-------- KoF'95 Style Dodge -------
;-----------------------------------
[statedef 720]
type = S
movetype = I
physics = N
anim = 720
ctrl = 0
velset = 0,0

[State 700, Ryu voice]
Type = PlaySnd
Trigger1 = !Time
Value = 0,1
Channel = 1

[State 700, HitBy]
Type = HitBy
Trigger1 = 1
Value = SCA, AT


[State 700, Frame]
type = AfterImage
trigger1 = Time = 3
time = 5
PalBright = 0, 0, 0
PalAdd = 0, 0, 0
PalMul = 1,1,1
Length = 6
PalContrast = 255,255,255

[State 700, To Background]
type = SprPriority
trigger1 = !Time
value = -2

[State 700, To Background2]
type = PlayerPush
trigger1 = 1
value = 0

[State 700, End]
type = ChangeState
trigger1 = !AnimTime
value = 0
ctrl = 1

;-----------------------------------
;---------- Dodge Attack -----------
;-----------------------------------
[Statedef 730]
Type = S
MoveType = A
Physics = S
Anim = 725
Velset = 0
Ctrl = 0
Juggle  = 8

[State -3, Attack Voice]
type = PlaySnd
Trigger1 = Time = 1
Value = 0,2
Channel = 1

[State -3, Attack FXSound]
type = PlaySnd
Trigger1 = AnimElem = 2
Value = 1,2
Channel = 2

[State -3, Step]
type = PosAdd
Trigger1 = AnimElem = 2
x = 18

[State 200, Hitdef]
Type = HitDef
Trigger1 = AnimElem = 4
attr = S, NA
damage = 80
AnimType = Heavy
getpower = 120,60
givepower = 30,15
Guardflag = MA
Hitflag = MA
pauseTime = 10,12
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,-70
HitSound = S5,4
GuardSound = S6,0
ground.Type = Low
ground.SlideTime = 17
ground.HitTime = 17
ground.Velocity = -9
Air.Velocity = -4,-5
yAccel = .5
Ground.CornerPush.Veloff = 0;-15
Air.CornerPush.Veloff = 0;-15
EnvShake.Time = 5

[State 200, Over]
Type = ChangeState
Trigger1 = !AnimTime
Value = 0
Ctrl = 1

;-----------------------------------
;------- KoF'98/2K2 MAX timer ------
;-----------------------------------
[Statedef 750]
type = S
movetype = I
physics = S
anim = 750+var(1)
velset = 0
ctrl = 0

[State 750, DM effect]
Type = Explod
Trigger1 = Time = 7
Anim = 760
BindTime = 1
OwnPal = 1
SprPriority = 2
PosType = p1
Pos = 0, 0

[State 750, earthquake]
type = EnvShake
trigger1 = time = 7
time = 10
freq = 45
ampl = -6

[State 750, sound]
type = PlaySnd
trigger1 = Time = 0
value = 750,(prevstateno = [200,599])
channel = 5

[State 750, subtract 1 powerbar]
type = poweradd
trigger1 = Time = 0
value = -1000-1000*(prevstateno = [200,599])

[State 750, set power]
Type = varSet
Trigger1 = !Time
var(16) = power

[State 1000, geese voice]
type = PlaySnd
trigger1 = time = 3
value = 0,2
channel = 1

[State 750, Left Timer]
Type = Explod
Trigger1 = var(10) = 1
Trigger1 = !Time
Anim = 8230
ID =  8230
PosType = Left
Pos = 25,210
BindTime = -1
RemoveTime = -1
SprPriority = 6
OwnPal = 1

[State 750, Right Timer]
Type = Explod
Trigger1 = var(10) = 2
Trigger1 = !Time
Anim = 8231
ID =  8230
PosType = Right
Pos = -25,210
BindTime = -1
RemoveTime = -1
SprPriority = 6
OwnPal = 1

[State 750, Left Meter]
Type = Explod
Trigger1 = var(10) = 1
Trigger1 = !Time
Anim = 8232
ID =  8231
PosType = Left
Pos = 25,210
BindTime = -1
RemoveTime = -1
SprPriority = 7
OwnPal = 1

[State 750, Right Meter]
Type = Explod
Trigger1 = var(10) = 2
Trigger1 = !Time
Anim = 8232
ID =  8231
PosType = Right
Pos = -25,210
BindTime = -1
RemoveTime = -1
Facing = -1
SprPriority = 7
OwnPal = 1

[State 750, timer countdown]
type = varset
trigger1 = !time
var(15) = 1000

[State 750, Timer explod var]
type = varset
trigger1 = !time
var(17) = 20

[State 790, AI end]
type = ChangeState
trigger1 = var(9) > 4
trigger1 = !Time
Trigger1 = prevstateno =[200,599]
value = 100

[State 750, end1]
type = ChangeState
trigger1 = Time = 1 && prevstateno =[200,599]
trigger1 = command = "holdfwd"
value = 100

[State 750, end2]
type = ChangeState
trigger1 = Time = 1 && prevstateno =[200,599]
value = ifelse(command = "holdup",40,ifelse(command = "holddown",11,0))
ctrl = ifelse(command = "holdup",0,1)

[State 750, end3]
type = ChangeState
trigger1 = !AnimTime
value = 0
ctrl = 1

;-----------------------------------
;- KoF Series Extra Power Charging -
;-----------------------------------
[statedef 770]
type    = S
movetype= I
physics = S
juggle  = 0
poweradd= 0
ctrl = 0
velset = 0,0
anim = 770+var(1)
sprpriority = 0

[State 800, Sound]
type = playsnd
trigger1 = !Time
value = 770,0
Channel = 6

[State 800, Sound]
type = playsnd
trigger1 = AnimElem = 3
value = 770,1
channel = 7
volume = 120

[State 810, Powerup]
type = powerAdd
triggerall = power < const(data.power)
trigger1 = time > 7
value = 10

[State 3000, 1]
type = Explod
trigger1 = AnimElem = 3
anim = 2000
Id = 8400
bindtime = -1
ownpal = 1
postype = p1
pos = 0,0
removetime = -1

[State 3000, 1]
type = Explod
trigger1 = AnimElem = 3
anim = 8400
Id = 8400
bindtime = -1
ownpal = 1
sprpriority = 2
postype = p1
pos = 0,0
removetime = -1

[State -1, End]
type = ChangeState
triggerall = !var(9)
triggerall = time > 7
trigger1 = command != "holdx"
trigger2 = command != "holdy"
trigger3 = power >= const(data.power)
value = 775

[State -1, CPU end]
type = ChangeState
triggerall = var(9)
triggerall = time > 7
trigger1 = p2bodydist x <= 140
trigger1 = p2movetype != H
trigger1 = p2statetype != L
trigger2 = power >= const(data.power)
trigger3 = p2movetype = A
trigger4 = Enemy, numproj
value = 775

;-----------------------------------
;----- KoF Power Charging End ------
;-----------------------------------
[statedef 775]
type    = S
movetype= I
physics = S
juggle  = 0
poweradd= 0
ctrl = 0
velset = 0,0
anim = 775+var(1)
sprpriority = 0

[State 800, Sound]
type = playsnd
trigger1 = !Time
trigger1 = power >= const(data.power)
value = 750,0
Channel = 1

[State -1, End]
type = ChangeState
trigger1 = !AnimTime
value = 0
Ctrl = 1

;============================================================================
; Throws
;============================================================================
;-----------------------------------
;------- Lever Blow / Baku ---------
;-----------------------------------
[Statedef 800]
type = S
movetype= A
physics = S
juggle = 8
velset = 0,0
ctrl = 0
anim = 800

[State 1000, Power set]
Type = varSet
Trigger1 = !Time
var(2) = IfElse(command = "z",1,0)

[State 800, 1]
type = HitDef
Trigger1 = !var(6)
Trigger1 = !Time
attr = S, NT
hitflag = M-
priority = 5, Miss
sparkno = S8220
sparkxy = -25+100*(command="holdback"),-70
HitSound = S800,0
sprpriority = 1
p1facing = ifelse (command = "holdback", -1, 1)
p2facing = 1
p1stateno = 801
p2stateno = 802
Fall = 1
Fall.Recover = !var(55)
snap = 20, 0

[State 800, 2]
type = ChangeState
Trigger1 = !AnimTime
Trigger1 = !var(9)
Trigger1 = !var(2)
Trigger1 = command = "holdfwd"
value = 300

[State 800, 2]
type = ChangeState
Trigger1 = !AnimTime
value = 220+20*var(2)

;----------------------------------------------------------------------
[Statedef 801]
type = S
movetype= A
physics = N
anim = 801
poweradd = 0
SprPriority = 1

[State 810, Bind 1]
type = Width
trigger1 = !Time
Edge = 40,0

[State 900, Escape Varset]
type = varset
Trigger1 = time = 0
Trigger2 = time = 8
var(2) = 0

[State 311, Escape Command]
type = varset
Triggerall = prevstateno != 815
Triggerall = prevstateno != [950,960]
TriggerAll = Time = [0,7]
trigger1 = target, command = "x" || target, command = "y"|| target, command = "z"
trigger2 = target, command = "a" || target, command = "b"|| target, command = "c"
var(2) = 1

[State 311, SVC Pause]
type = pause
Trigger1 = prevstateno = [950,960]
Trigger1 = !Time
time = 8

[State 301, Escape p1]
type = changestate
Trigger1 = Time = [5,7]
trigger1 = var(2) = 1
value = 910

[State 301, Escape Enemy]
type = targetstate
Trigger1 = Time = [5,7]
trigger1 = var(2) = 1
value = 911

[State 810, Bind 1]
type = PlaySnd
trigger1 = AnimElem = 5
Value = 0, 0
Channel = 1

[State 810, Bind 1]
type = PlaySnd
trigger1 = AnimElem = 6
Value = 1, 2
Channel = 2

[State 810, Bind 1]
type = TargetBind
trigger1 = AnimElem = 1, >= 0
trigger1 = AnimElem = 2, < 0
pos = 35, 0

[State 200, Hitdef]
Type = HitDef
Trigger1 = AnimElem = 8
attr = S, NT
damage = 120
AnimType = Hard
Fall.AnimType = Hard
getpower = 0,0
givepower = 0,0
Guardflag =
Hitflag = MAF
pauseTime = 8,17
SparkNo = S8002
sparkxy = -30,-85
HitSound = S5,6
ground.Type = Low
ground.SlideTime = 17
ground.HitTime = 17
ground.Velocity = -4,-7.5
Air.Velocity = -4,-7
yAccel = .5
Ground.cornerpush.veloff = 0;-15.5
Air.cornerpush.veloff = 0;-15.5
Fall = 1
Fall.Recover = !var(55)
Fall.RecoverTime = 35
EnvShake.Time = 25
EnvShake.Ampl = 7
Snap = 35, -30
NumHits = 0

[State 810, State End]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;----------------------------------------------------------------------
[Statedef 802]
type = A
movetype = H
physics = N
velset = 0,0

[State 820, 1]
type = ChangeAnim2
Trigger1 = Time = 0
value = 802

[State 820, 1]
type = PlayerPush
Trigger1 = 1
Value = 0


[State 821, 4] ;Hit ground
type = SelfState
trigger1 = !AnimTime
value = ifelse(pos y < 0, 5070, 0)

;-----------------------------------
;------ Hatchet Throw / Beki -------
;-----------------------------------
[Statedef 810]
type = S
movetype= A
physics = S
juggle = 8
ctrl = 0
anim = 800
Velset = 0,0

[State 1000, Power set]
Type = varSet
Trigger1 = !Time
var(2) = IfElse(command = "c",1,0)

[State 810, 1]
type = HitDef
Trigger1 = !var(6)
Trigger1 = !Time
attr = S, NT
hitflag = M-
priority = 5, Miss
sparkno = S8220
sparkxy = -25+100*(command="holdfwd"),-70
HitSound = S800,0
sprpriority = 1
p1facing = ifelse (command = "holdfwd", -1, 1)
p2facing = 1
p1stateno = 811
p2stateno = 814
fall = 1
snap = 40, 0

[State 800, 2]
type = ChangeState
Trigger1 = !AnimTime
Trigger1 = !var(2)
Trigger1 = !var(9)
Trigger1 = command = "holdfwd"
value = 310

[State 800, 2]
type = ChangeState
Trigger1 = !AnimTime
value = 230+20*var(2)

;----------------------------------------------------------------------
[Statedef 811]
movetype= A
physics = N
anim = 811
poweradd = 0
sprpriority = 1
Velset = 0,0

[State 900, Escape Varset]
type = varset
Trigger1 = time = 0
Trigger2 = time = 8
var(2) = 0

[State 311, Escape Command]
type = varset
Triggerall = prevstateno != 815
Triggerall = prevstateno != [950,960]
TriggerAll = Time = [0,7]
trigger1 = target, command = "x" || target, command = "y"|| target, command = "z"
trigger2 = target, command = "a" || target, command = "b"|| target, command = "c"
var(2) = 1

[State 301, Escape p1]
type = changestate
Trigger1 = Time = [5,7]
trigger1 = var(2) = 1
value = 910

[State 301, Escape Enemy]
type = targetstate
Trigger1 = Time = [5,7]
trigger1 = var(2) = 1
value = 911

[State 311, SVC Pause]
type = pause
Trigger1 = prevstateno = [950,960]
Trigger1 = !Time
time = 8

[State 810, Out of corners]
type = Width
trigger1 = AnimElem = 1
Edge = 50,0

[State 810, Out of corners]
type = Width
trigger1 = AnimElem = 7
Edge = 0,120

[State 810, Bind 1]
type = PlaySnd
trigger1 = AnimElem = 3
Value = 0, 2
Channel = 1

[State 810, Bind 1]
type = PlaySnd
trigger1 = AnimElem = 4
Value = 820, 0
Channel = 3

[State 820, Bind 1]
type = TargetBind
trigger1 = AnimElem = 1, >= 0
trigger1 = AnimElem = 2, < 0
pos = 55, 0

[State 820, Bind 2]
type = TargetBind
trigger1 = AnimElem = 2, >= 0
trigger1 = AnimElem = 3, < 0
pos = 35, -125

[State 820, Bind 3]
type = TargetBind
trigger1 = AnimElem = 3, >= 0
trigger1 = AnimElem = 4, < 0
pos = 25, -150

[State 820, Bind 4]
type = TargetBind
trigger1 = AnimElem = 4, >= 0
trigger1 = AnimElem = 5, < 0
pos = 25, -148

[State 820, Bind 5]
type = TargetBind
trigger1 = AnimElem = 5, >= 0
trigger1 = AnimElem = 6, < 0
pos = 0, -125


[State 820, Bind 10]
type = TargetBind
trigger1 = AnimElem = 6, >= 0
trigger1 = AnimElem = 7, < 0
pos = -10, -110

[State 820, Bind 10]
type = TargetBind
trigger1 = AnimElem = 7, >= 0
trigger1 = AnimElem = 8, < 0
pos = -85, -100

[State 820, Bind 10]
type = TargetBind
trigger1 = AnimElem = 8, >= 0
trigger1 = AnimElem = 9, < 0
pos = -100, 0

[State -3, OTG FX]
type = Explod
Trigger1 = AnimElem = 8
anim = 8310
pos = -100,0
bindtime = 1
ownpal = 1
sprpriority = -3
PauseMoveTime = 99
SuperMoveTime = 99

[State -3, OTG FX]
type = Explod
Trigger1 = AnimElem = 8
anim = 8320
pos = -100,0
bindtime = 1
ownpal = 1
sprpriority = 3
PauseMoveTime = 99
SuperMoveTime = 99

[State -3, OTG FX]
type = EnvShake
Trigger1 = AnimElem = 8
Time = 18
Ampl = 4

[State 820, Hurt]
type = TargetLifeAdd
trigger1 = AnimElem = 8, = 4
value = -125

[State 810, Bind 1]
type = PlaySnd
trigger1 = AnimElem = 8, = 4
Value = 850, 0
Channel = 2

[State 810, Bind 2]
type = Turn
trigger1 = AnimElem = 12

[State 820, State End]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;----------------------------------------------------------------------
[Statedef 814]
type = A
movetype = H
physics = N
velset = 0,0

[State 820, 1]
type = ChangeAnim2
Trigger1 = !Time
value = 814

[State 820, 1]
type = Velset
Trigger1 = AnimElem = 6, = 6
x = 3.5
y = -4.5

[State 821, 1] ;Gravity
type = VelAdd
Trigger1 = AnimElem = 6, > 6
y = .5


[State 821, 4] ;Hit ground
type = SelfState
TriggerAll = AnimElem = 6, > 6
triggerAll = Vel Y > 0
triggerAll = Pos Y >= -25
triggerAll = Alive
triggerAll = CanRecover
trigger1 = command = "recovery"
value = 5201

[State 821, 4] ;Hit ground
type = SelfState
TriggerAll = AnimElem = 6, > 6
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
value = 5100

;============================================================================
; Custom Gethit by groove States
;============================================================================
;----------------------------
;-------- Guard crush -------
;----------------------------
[Statedef 900]
type = S
movetype = I
physics = S
anim = 900
ctrl = 0

[State -2, 3]
type = Explod
trigger1 = var(10) = 1
trigger1 = !time
anim = 8210
postype = left
bindtime = -1
ownpal = 1
ontop = 1
ignorehitpause = 1
pos = 60,65

[State -2, 3]
type = Explod
trigger1 = var(10) = 2
trigger1 = !time
anim = 8210
postype = right
bindtime = -1
ownpal = 1
ontop = 1
ignorehitpause = 1
pos = -60,65

[State 9100, 2]
type = ChangeAnim
trigger1 = AnimElem = 2, >= 0
trigger1 = GetHitVar(HitTime) > 0
value = 900
Elem = 2
ignorehitpause = 1

[State 9100, 2]
type = Envcolor
trigger1 = Time = 0
value = 248,248,248
time = 3
under = 1
ignorehitpause = 1

[State 9100, 3]
type = Varset
trigger1 = time = 0
var(11) = 0
ignorehitpause = 1

[State 9100, 4]
type = Envshake
trigger1 = time = 0
time = 8
ignorehitpause = 1

[State 9100, 5]
type = Velset
trigger1 = time >= 3
trigger1 = time <= 10
x = -3
ignorehitpause = 1

[State 9100, 6]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1
ignorehitpause = 1


;----------------------------
;-------- Grab Escape -------
;----------------------------
[Statedef 910]
type    = S
movetype= I
physics = S
velset = 0,0
anim = 900
ctrl = 0

[State 911, Invincible]
type = nothitby
trigger1 = 1
value = sca

[State 805, 2]
type = Playsnd
trigger1 = !time
Value = 5000,0

[State 3318, 6]
type = velset
trigger1 = time = 5
x = -8

[State 3318, 6]
type = targetstate
trigger1 = !time
value = 911

[State 305, Dust]
type = makedust
Trigger1 = 1
pos = 0,0
spacing = 3

[State 305, END]
type = changestate
Trigger1 = !AnimTime
Trigger2 = !Enemy, AnimTime
value = 0
ctrl = 1

;----------------------------
;---- Grab Escape p2state ---
;----------------------------
[Statedef 911]
type    = S
movetype= I
physics = S
velset = 0,0
ctrl = 0

[State 911, stay on the floor]
type = posset
trigger1 = time = 0
y = 0

[State 911, Speed]
type = velset
trigger1 = time = 5
trigger1 = enemy,backedgebodydist < 3
x = -8

[State 911, Invincible]
type = nothitby
trigger1 = 1
value = sca

[State 911, Sander];anim for compatibility with Sander 71113 chars
type = changeanim
trigger1 = selfanimexist(306)
Trigger1 = time = 0
value = 306

[State 911, Generic]
type = changeanim
trigger1 = !selfanimexist(306)
trigger1 = selfanimexist(200)
Trigger1 = Time = 0
value = 200

[State 911, Generic];if anim 200 doesn't exist
type = changeanim
trigger1 = !selfanimexist(306)
trigger1 = !selfanimexist(200)
Trigger1 = !Time
value = 5000

[State 911, END]
type = selfstate
Trigger1 = !AnimTime
Trigger2 = time  >= 25
value = 0
ctrl = 1

;-----------------------------------
;------ SVC Lever Blow / Baku ------
;-----------------------------------
[Statedef 950]
type = S
movetype= A
physics = S
juggle = 8
velset = 0,0
ctrl = 0
anim = 950

[State 800, 1]
type = HitDef
Trigger1 = !var(6)
Trigger1 = !Time
attr = S, NT
hitflag = M-
priority = 5, Miss
sparkno = S8220
sparkxy = -25+100*(command = "holdback"),-70
HitSound = S800,0
sprpriority = 1
p1facing = ifelse (command = "holdback", -1, 1)
p2facing = 1
p1stateno = 801
p2stateno = 802
Fall = 1
Fall.Recover = !var(55)

[State 800, 9]
type = poweradd
trigger1 = !var(15)
trigger1 = animelem = 2
value = -300

[State 800, 9]
type = varadd
trigger1 = var(15)
trigger1 = animelem = 2
var(15) = -250

[State 800, 2]
type = ChangeState
Trigger1 = !AnimTime
value = 0
Ctrl = 1

;-----------------------------------
;---- SVC Hatchet Throw / Beki -----
;-----------------------------------
[Statedef 960]
type = S
movetype= A
physics = S
juggle = 8
velset = 0,0
ctrl = 0
anim = 950

[State 800, 1]
type = HitDef
Trigger1 = !var(6)
Trigger1 = !Time
attr = S, NT
hitflag = M-
priority = 5, Miss
sparkno = S8220
sparkxy = -25+100*(command = "holdfwd"),-70
HitSound = S800,0
p1facing = ifelse (command = "holdfwd", -1, 1)
sprpriority = 1
p2facing = 1
p1stateno = 811
p2stateno = 814
Fall = 1
Fall.Recover = !var(55)

[State 800, 9]
type = poweradd
trigger1 = !var(15)
trigger1 = animelem = 2
value = -300

[State 800, 9]
type = varadd
trigger1 = var(15)
trigger1 = animelem = 2
var(15) = -250

[State 800, 2]
type = ChangeState
Trigger1 = !AnimTime
value = 0
Ctrl = 1

;============================================================================
; Super Moves
;============================================================================
;-----------------------------------
;----------- Jet Counter -----------
;-----------------------------------
[Statedef 1000]
Type = S
MoveType = A
Physics = N
Anim = 1000
VelSet = 0,0
Ctrl = 0
PowerAdd = 100
SprPriority = 1

[State -1, Cancel Combo]
Type = Varadd
Trigger1 = var(15)
Trigger1 = !time
Trigger1 = prevstateno = [1000, 1900]
IgnoreHitPause = 1
var(15) = -200

[State 3000, PALFX]
type = PalFX
Trigger1 = gametime%2 = 0
Trigger1 = time <= 7
ignorehitpause = 1
Trigger1 = prevstateno = [1000, 1900]
time = 1
add = 255,255,255
sinadd = -100,-100,-100, 2
ignorehitpause = 1

[State 1000, buffer setting1]
Type = varSet
Trigger1 = !Time
Trigger1 = helper(2000),var(1) > helper(2000), var(2)
Trigger1 = helper(2000),var(1) > helper(2000), var(3)
var(2) = 0

[State 1000, buffer setting2]
Type = varSet
Trigger1 = !Time
Trigger1 = helper(2000),var(2) > helper(2000), var(1)
Trigger1 = helper(2000),var(2) > helper(2000), var(3)
var(2) = 1

[State 1000, buffer setting3]
Type = varSet
Trigger1 = !Time
Trigger1 = helper(2000),var(3) > helper(2000), var(1)
Trigger1 = helper(2000),var(3) > helper(2000), var(2)
var(2) = 2

[State 1000, Power Set]
Type = varSet
TriggerAll = !Time
Trigger1 = command="x"
Trigger2 = command="y"
Trigger3 = command="z"
var(2) = IfElse(command = "y",1,IfElse(Command = "z",2,0))

[State 1000, Power set]
Type = varSet
Trigger1 = !Time
Trigger1 = var(9)
var(2) = 1

[State 1000, Power set]
Type = varSet
Trigger1 = !Time
Trigger1 = var(9)
Trigger1 = EnemyNear, StateNo = [120,155]
Trigger1 = p2StateType = C
var(2) = 2

[State 1000, Power set]
Type = varSet
Trigger1 = !Time
Trigger1 = var(9)
Trigger1 = prevStateNo = 400
var(2) = 0

[State 1000, Power set]
Type = ChangeAnim
Trigger1 = !Time
Value = 1000+var(2)

[State 1000, Yashiro Voice]
type = PlaySnd
Trigger1 = AnimElem = 1, = 1
value = 1000,0
Channel = 1

[State 1000, Yashiro Voice]
type = PlaySnd
Trigger1 = AnimElem = 4
value = 1050,0
Channel = 3

[State 1000, Velset]
type = VelSet
Trigger1 = AnimElem = 3
x = 11

[State 1000, NotHitBy]
type = NotHitBy
Trigger1 = var(2)
Trigger1 = AnimElem = 6, >= 0
Trigger1 = AnimElem = 7, < 0
Value = SCA

[State 1000, VelMul]
type = VelMul
Trigger1 = AnimElem = 3, > 0
x = .92

[State 1000, VelStop]
type = VelSet
Trigger1 = !var(2)
Trigger1 = AnimElem = 9
Trigger2 = AnimElem = 11
x = 0

[State 1000, PosAdd]
type = PosAdd
Trigger1 = AnimElem = 15
Trigger2 = AnimElem = 17
x = 20

[State 3020, 2]
Type = Explod
Trigger1 = AnimElem = 3
Anim = 7900
PosType = p1
Ownpal = 1
SprPriority = 3
BindTime = 1
IgnoreHitPause = 1
Pos = 0,0

[State 200, Hitdef]
Type = HitDef
Trigger1 = !var(2)
Trigger1 = AnimElem = 9
attr = S, SA
damage = 100,10
AnimType = Heavy
Fall.AnimType = Heavy
getpower = 60,30
givepower = 30,15
Guardflag = MA
Hitflag = MA
pauseTime = 10,12
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,-85
HitSound = S5,6
GuardSound = S6,0
ground.Type = Low
ground.SlideTime = 17
ground.HitTime = 17
ground.Velocity = -3.5,-6
guard.Velocity = -9.5
Air.Velocity = -3.5,-5.5
yAccel = .5
Ground.CornerPush.Veloff = 0;-15.5
Air.CornerPush.Veloff = 0;-15.5
EnvShake.Time = 10
Fall = 1
Fall.Recover = !var(55)
Fall.RecoverTime = 35

[State 200, Hitdef]
Type = HitDef
Trigger1 = var(2) = 1
Trigger1 = AnimElem = 9
attr = S, SA
damage = 80,8
AnimType = Heavy
getpower = 60,30
givepower = 30,15
Guardflag = MA
Hitflag = MA
pauseTime = 10,12
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,-85
HitSound = S5,6
GuardSound = S6,0
ground.Type = High
ground.SlideTime = 17
ground.HitTime = 17
ground.Velocity = -9.5
Air.Velocity = -4,-4.5
yAccel = .5
Ground.CornerPush.Veloff = 0;-15.5
Air.CornerPush.Veloff = 0;-15.5
EnvShake.Time = 10
Air.Fall = 1
Fall.Recover = !var(55)
Fall.RecoverTime = 35

[State 200, Hitdef]
Type = HitDef
Trigger1 = var(2) = 2
Trigger1 = AnimElem = 14
attr = S, SA
damage = 120,12
AnimType = Heavy
getpower = 60,30
givepower = 30,15
Guardflag = HA
Hitflag = MA
pauseTime = 10,12
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,-45
HitSound = S5,6
GuardSound = S6,0
ground.Type = Low
ground.SlideTime = 17
ground.HitTime = 17
ground.Velocity = -9.5
Air.Velocity = -4,-6
yAccel = .5
Ground.CornerPush.Veloff = 0;-15.5
Air.CornerPush.Veloff = 0;-15.5
EnvShake.Time = 10
Air.Fall = 1
Fall.Recover = !var(55)
Fall.RecoverTime = 35

[State 1000, 9]
type = Varset
trigger1 = !Time
var(4) = 0

[State 1000, 9]
type = Varset
trigger1 = AnimElem = 6, > 0
trigger1 = Command = "Jet Counter"
var(4) = ifelse(command = "x", 1, ifelse(command = "y", 2,3))
persistent = 0

[State 1000, 9]
type = Varset
trigger1 = var(9)
trigger1 = moveguarded
var(4) = 1
persistent = 0

[State 1000, 9]
type = VarRandom
trigger1 = var(2) != 2
trigger1 = var(9)
trigger1 = movehit
v = 4
range = 1,3
persistent = 0

[State 1000, 9]
type = VarSet
trigger1 = var(2) = 2
trigger1 = var(9)
trigger1 = movehit
var(4) = 3
persistent = 0

[State 1000, 9]
type = Varset
triggerAll = var(9)
triggerAll = movehit
triggerAll = var(2) != 2
trigger1 = enemynear, backedgedist < 15
trigger2 = enemynear, frontedgedist < 15
trigger3 = power >= 1000
trigger3 = Life < p2life || life < 400 || power > 3000
trigger4 = var(15)
var(4) = 2
persistent = 0

[State 1000, 9]
type = Varset
trigger1 = var(9)
trigger1 = var(4) = 2
trigger1 = var(2) = 2
trigger1 = power < 1000
trigger1 = enemynear, backedgedist > 20
var(4) = 3
persistent = 0

[State 1000, 9]
type = ChangeState
triggerAll = MoveContact
triggerAll = var(4)
trigger1 = var(2) = 1
trigger1 = AnimElem = 11, > 0
trigger1 = AnimElem = 12, < 0
trigger2 = var(2) = 2
trigger2 = AnimElem = 15, > 0
trigger2 = AnimElem = 16, < 0
value = 1010

[State 1000, 9]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;-----------------------------------
;-------- Jet Counter Still --------
;-----------------------------------
[Statedef 1010]
Type = S
MoveType = A
Physics = S
VelSet = 0
Ctrl = 0
PowerAdd = 0
SprPriority = 1

[State 1000, Power set]
Type = ChangeAnim
Trigger1 = !Time
Trigger1 = Anim = 1001
value = 1009+var(4)

[State 1000, Power set]
Type = ChangeAnim
Trigger1 = !Time
Trigger1 = Anim = 1002
value = ifelse(var(4) = 3, 1014, 1013)

[State 1000, Yashiro Voice]
type = PlaySnd
Trigger1 = AnimElem = 2
value = 1000,1
Channel = 1

[State 1000, PosAdd]
type = PosAdd
Trigger1 = Anim = [1013,1014]
Trigger1 = AnimElem = 2
x = 20

[State 200, Hitdef]
Type = HitDef
TriggerAll = AnimElem = 5
Trigger1 = Anim = 1010
Trigger2 = Anim = 1013
attr = S, SA
damage = 80,8
AnimType = Heavy
getpower = 60,30
givepower = 30,15
Guardflag = MA
Hitflag = MA
pauseTime = 16,18
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,-85
HitSound = S5,6
GuardSound = S6,0
ground.Type = High
ground.SlideTime = 17
ground.HitTime = 17
ground.Velocity = -9.5
Air.Velocity = -4,-4.5
yAccel = .5
Ground.CornerPush.Veloff = 0;-15.5
Air.CornerPush.Veloff = 0;-15.5
EnvShake.Time = 15
Air.Fall = 1
Fall.Recover = !var(55)
Fall.RecoverTime = 35

[State 200, Hitdef]
Type = HitDef
Trigger1 = Anim != 1013
Trigger1 = var(4) > 1
Trigger1 = AnimElem = 5
attr = S, SA
damage = 80-20*(Anim = 1011),8-2*(Anim = 1011)
AnimType = Up
getpower = 60,30
givepower = 30,15
Guardflag = M
Hitflag = MA
pauseTime = 16,16
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,-85
HitSound = S5,6
GuardSound = S6,0
ground.Type = High
ground.SlideTime = 17
ground.HitTime = 17
ground.Velocity = -1.5, -11+(Anim = 1014)
guard.Velocity = -9.5
Air.Velocity = -1.5,-10+(Anim = 1014)
yAccel = .5
Ground.CornerPush.Veloff = 0
Air.CornerPush.Veloff = 0
EnvShake.Time = 15
Fall = 1
Fall.Recover = !var(55)
Fall.RecoverTime = 55

[State 1000, Juggle set]
Type = varSet
Trigger1 = MoveHit
Trigger1 = Anim != 1013
Trigger1 = Anim != 1010
var(7) = 1
ignorehitpause = 1

[State 1000, Juggle set]
Type = MoveHitReset
Trigger1 = MoveContact

[State 1000, 9]
type = ChangeState
trigger1 = !AnimTime
value = 0
ctrl = 1

;-----------------------------------
;----------- Upper Duel ------------
;-----------------------------------
[Statedef 1100]
Type = S
MoveType = A
Physics = N
Anim = 1100
VelSet = 0
Ctrl = 0
PowerAdd = 125
Juggle = 8

[State -1, Cancel Combo]
Type = Varadd
Trigger1 = var(15)
Trigger1 = !time
Trigger1 = prevstateno = [1000, 1900]
IgnoreHitPause = 1
var(15) = -200

[State 3000, PALFX]
type = PalFX
Trigger1 = gametime%2 = 0
Trigger1 = time <= 7
ignorehitpause = 1
Trigger1 = prevstateno = [1000, 1900]
time = 1
add = 255,255,255
sinadd = -100,-100,-100, 2
ignorehitpause = 1

[State 1000, buffer setting1]
Type = varSet
Trigger1 = !Time
Trigger1 = helper(2000),var(1) > helper(2000), var(2)
Trigger1 = helper(2000),var(1) > helper(2000), var(3)
var(2) = 0

[State 1000, buffer setting2]
Type = varSet
Trigger1 = !Time
Trigger1 = helper(2000),var(2) > helper(2000), var(1)
Trigger1 = helper(2000),var(2) > helper(2000), var(3)
var(2) = 1

[State 1000, buffer setting3]
Type = varSet
Trigger1 = !Time
Trigger1 = helper(2000),var(3) > helper(2000), var(1)
Trigger1 = helper(2000),var(3) > helper(2000), var(2)
var(2) = 2

[State 1000, Power Set]
Type = varSet
TriggerAll = !Time
Trigger1 = command="x"
Trigger2 = command="y"
Trigger3 = command="z"
var(2) = IfElse(command = "y",1,IfElse(Command = "z",2,0))

[State 1100, Upper set AI 1]
Type = varSet
Trigger1 = !Time
Trigger1 = var(9)
Trigger1 = p2StateType != A
var(2) = 2

[State 1100, Upper set AI 2]
Type = varSet
Trigger1 = !Time
Trigger1 = var(9)
Trigger1 = p2StateType = A
var(2) = 1

[State 1100, Upper set AI 2]
Type = varSet
Trigger1 = !Time
Trigger1 = var(9)
Trigger1 = p2StateNo = [1000,4999]
var(2) = 2

[State 1000, Upper set 1]
Type = ChangeAnim
Trigger1 = !Time
value = 1100+var(2)

[State 1100, Invincible]
type = NotHitBy
Trigger1 = animelem = 2, < 0
value = SCA
IgnoreHitPause = 1

[State 1100, Yashiro Voice]
type = PlaySnd
Trigger1 = AnimElem = 1, = 1
value = 1100,0
Channel = 1

[State 1100, Yashiro Voice]
type = PlaySnd
Trigger1 = AnimElem = 3
value = 1,2
Channel = 3

[State 1100, Parry]
type = reversaldef
Trigger1 = AnimElem = 1, > 0
Trigger1 = AnimElem = 3, <= 0
reversal.attr = SCA, AA, AP
attr = S, HP
hitflag = MAFDP
priority = 9, hit
pausetime = 10,12
sparkno = S8012
sparkxy = 10,0
hitsound = S6,0
numhits = 0
persistent = 1
ignorehitpause = 1

[State 1100, Hit Reset]
type = MoveHitReset
Trigger1 = MoveContact
Trigger1 = AnimElem = 3, < 0
IgnoreHitPause = 1

[State 1100, First Hit]
Type = HitDef
Trigger1 = AnimElem = 4
attr = S, SA
damage = 70+10*(var(2) = 1),7+(var(2) = 1)
animtype = Heavy
fall.animtype = Back
getpower = 60,30
givepower = 30,15
guardflag = M
hitflag = MA
pausetime = 12,8
sparkno = S8002
guard.sparkno = S8012
sparkxy = -15,-75-30*(var(2) = 1)
hitsound = S5,6
guardsound = S6,0
ground.type = low
ground.slidetime = 22
ground.hittime  = 22
ground.velocity = 0, -10.5*(var(2) < 2)
ground.CornerPush.Veloff = 0
guard.CornerPush.Veloff = 0
air.velocity = 0,-9.5
yAccel = .55
Fall = (var(2) < 2)
Air.Fall = 1
Fall.Recover = !var(55)
Fall.RecoverTime = 35
EnvShake.Time = 10

[State 1000, Juggle set]
Type = varSet
TriggerAll = MoveHit
Trigger1 = AnimElem = 4, > 0
var(7) = 1
ignorehitpause = 1

[State 1000, 9]
type = ChangeState
Trigger1 = AnimElem = 6
Trigger1 = MoveContact
value = 1101

[State 1000, 9]
type = ChangeState
Trigger1 = !AnimTime
value = 0
Ctrl = 1

;-----------------------------------
;--------- Upper Duel Hit ----------
;-----------------------------------
[Statedef 1101]
Type = S
MoveType = A
Physics = N
Anim = 1110
VelSet = 0
Ctrl = 0
PowerAdd = 0
Juggle = 8

[State 1100, First Hit]
Type = HitDef
Trigger1 = AnimElem = 3
attr = S, SA
damage    = 30,3
animtype = Heavy
Fall.animtype = Heavy
getpower = 20,10
givepower = 10,5
guardflag = M
hitflag = MA
pausetime = 12,12
sparkno = S8002
guard.sparkno = S8012
sparkxy = -15,-60
hitsound = S5,6
guardsound = S6,0
ground.type = low
ground.slidetime = 17
ground.hittime  = 17
guard.slidetime = 17
guard.hittime = 17
guard.ctrltime = 17
ground.velocity = 0, -10.5
ground.CornerPush.Veloff = 0
guard.CornerPush.Veloff = 0
air.velocity = 0,-9.5
yAccel = .5
Fall = 1
Air.Fall = 1
Fall.Recover = !var(55)
Fall.RecoverTime = 35
EnvShake.Time = 10

[State 1000, Juggle set]
Type = varSet
Trigger1 = MoveHit
Trigger1 = AnimElem = 4, < 0
var(7) = 1
ignorehitpause = 1

[State 1100, change to air]
Type = StateTypeSet
Trigger1 = AnimElem = 5
StateType = A

[State 1100, Air Velocity]
Type = VelSet
Trigger1 = AnimElem = 5
x = 3
y = -6-2*var(2)

[State -3, Jump Sound]
type = PlaySnd
Trigger1 = AnimElem = 5
Value = 50,1
Channel = 2
IgnoreHitPause = 1

[State 1100, reduce x Vel]
Type = VelSet
Trigger1 = Vel Y > -1
Trigger1 = AnimElem = 5, > 0
x = 0

[State 1100, Gravity]
Type = Gravity
Trigger1 = AnimElem = 5, > 0

[State 1100, Third Hit]
Type = HitDef
Trigger1 = AnimElem = 5
attr = A, SA
damage = 40,4
animtype = Up
getpower = 30,15
givepower = 15,8
guardflag = MA
hitflag = MA
pausetime = 10,12
sparkno = S8002
guard.sparkno = S8012
sparkxy = -15,-125
hitsound = S5,6
guardsound = S6,0
ground.type = High
ground.slidetime = 20
ground.hittime  = 20
guard.slidetime = 17
guard.hittime = 17
guard.ctrltime = 17
guard.velocity = -9.3
ground.velocity = -4.5, -8.5
air.velocity = -4.5,-7.5
ground.CornerPush.Veloff = 0;0
guard.CornerPush.Veloff = 0;-11.3
yAccel = .5
Fall = 1
Fall.Recover = (!var(55) && var(2) < 2)
Fall.RecoverTime = 35
EnvShake.Time = 10

[State 3020, 2]
Type = MovehitReset
Trigger1 = Movecontact

[State 1000, 9]
type = ChangeState
Trigger1 = Vel y > -1
Trigger1 = AnimElem = 5, > 0
value = 1102

;-------- Upper Duel Hit - Part 2 -------
[Statedef 1102]
Type = A
MoveType = I
Physics = N
Anim = 1111
Ctrl = 0
PowerAdd = 0
VelSet = 0

[State 3000, SDM Set]
Type = BgPalFx
Trigger1 = prevStateNo = 3103
InvertAll = 1
Color = 6
Time = 3
IgnoreHitPause = 1

[State 3020, After Set]
type = AfterImagetime
trigger1 = 1
time = 2
ignorehitpause = 1

[State 1100, Gravity]
Type = Gravity
Trigger1 = 1

[State 1101, End]
type = ChangeState
Trigger1 = Pos y >= 0
value = 1103

;-------- Upper Duel Hit - Part 3 -------
[Statedef 1103]
Type = S
MoveType = I
Physics = N
Anim = 1112
Ctrl = 0
PowerAdd = 0
VelSet = 0,0

[State 1100, PosSet]
Type = PosSet
Trigger1 = !time
y = 0

[State 1100, PosSet]
Type = ChangeAnim
Trigger1 = !time
Trigger1 = prevstateno = 1422
value = 1423

[State 1100, PosSet]
Type = ChangeAnim
Trigger1 = !time
Trigger1 = prevstateno = 1712
value = 1714

[State 1000, 9]
type = ChangeState
Trigger1 = !AnimTime
value = 0
Ctrl = 1

;-----------------------------------
;------- Missile Might Bash --------
;-----------------------------------
[Statedef 1200]
Type = S
MoveType = A
Physics = N
Anim = 1200
VelSet = 0
Ctrl = 0
PowerAdd = 100
Juggle = 8

[State -1, Cancel Combo]
Type = Varadd
Trigger1 = var(15)
Trigger1 = !time
Trigger1 = prevstateno = [1000, 1900]
IgnoreHitPause = 1
var(15) = -200

[State 3000, PALFX]
type = PalFX
Trigger1 = gametime%2 = 0
Trigger1 = time <= 7
ignorehitpause = 1
Trigger1 = prevstateno = [1000, 1900]
time = 1
add = 255,255,255
sinadd = -100,-100,-100, 2
ignorehitpause = 1

[State 1000, buffer setting1]
Type = varSet
Trigger1 = !Time
Trigger1 = helper(2000),var(1) > helper(2000), var(2)
Trigger1 = helper(2000),var(1) > helper(2000), var(3)
var(2) = 0

[State 1000, buffer setting2]
Type = varSet
Trigger1 = !Time
Trigger1 = helper(2000),var(2) > helper(2000), var(1)
Trigger1 = helper(2000),var(2) > helper(2000), var(3)
var(2) = 1

[State 1000, buffer setting3]
Type = varSet
Trigger1 = !Time
Trigger1 = helper(2000),var(3) > helper(2000), var(2)
Trigger1 = helper(2000),var(3) > helper(2000), var(2)
var(2) = 2

[State 1000, Power Set]
Type = varSet
TriggerAll = !Time
Trigger1 = command="x"
Trigger2 = command="y"
Trigger3 = command="z"
var(2) = IfElse(command = "y",1,IfElse(Command = "z",2,0))

[State 1000, Power Set]
Type = varRandom
Trigger1 = !Time
Trigger1 = var(9)
v = 2
range = 0,2

[State 1000, Power set]
Type = varSet
Trigger1 = !Time
Trigger1 = var(9)
Trigger1 = prevStateNo = 400
var(2) = 0

[State 1000, Power Set]
Type = ChangeAnim
Trigger1 = !Time
value = 1200+var(2)

[State 1000, Yashiro Voice]
type = PlaySnd
Trigger1 = AnimElem = 2
value = 1200,0
Channel = 1

[State 1000, Yashiro Voice]
type = PlaySnd
Trigger1 = !var(2)
Trigger1 = AnimElem = 12
Trigger2 = var(2) = 1
Trigger2 = AnimElem = 27
Trigger3 = var(2) = 2
Trigger3 = AnimElem = 21, = 1
value = 1200,1
Channel = 1

[State 1200, Speed]
Type = VelSet
Trigger1 = var(2) != 2
Trigger1 = AnimElem = 5
Trigger2 = var(2) = 1
Trigger2 = AnimElem = 12
Trigger3 = var(2) = 1
Trigger3 = AnimElem = 20
x = 8

[State 1200, Speed]
Type = VelSet
TriggerAll = var(2) = 2
Trigger1 = AnimElem = 4
Trigger2 = AnimElem = 8
Trigger3 = AnimElem = 16
Trigger4 = AnimElem = 21
x = 1

[State 1200, fricction]
Type = VelMul
Trigger1 = vel x
x = .84

[State 1200, fricction]
Type = VelSet
Trigger1 = !var(2)
Trigger1 = AnimElem = 12
Trigger2 = var(2) = 1
Trigger2 = AnimElem = 27
x = 0

[State 1200, FX Snd]
Type = PlaySnd
TriggerAll = var(2) != 2
Trigger1 = AnimElem = 5
Trigger2 = AnimElem = 13
Trigger3 = AnimElem = 20
Trigger4 = AnimElem = 28
Value = 1, 1
Channel = 3

[State 1200, FX Snd]
Type = PlaySnd
TriggerAll = var(2) = 2
Trigger1 = AnimElem = 4, = 2
Trigger2 = AnimElem = 10
Trigger3 = AnimElem = 16, = 2
Trigger4 = AnimElem = 22
Value = 1, 2
Channel = 3

[State 200, Hitdef]
Type = HitDef
Trigger1 = var(2) != 2
Trigger1 = AnimElem = 5
Trigger2 = var(2) = 1
Trigger2 = AnimElem = 22
attr = S, SA
damage = 60-20*(var(2) = 1),6-2*(var(2) = 1)
AnimType = Heavy
getpower = 30,15
givepower = 15,8
Guardflag = MA
Hitflag = MA
pauseTime = 10,12
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,-85
HitSound = S5,4
GuardSound = S6,0
ground.Type = Low
ground.SlideTime = 17
ground.HitTime = 17
ground.Velocity = 0
Air.Velocity = -4,-5
yAccel = .5
Ground.CornerPush.Veloff = 0;-15
Air.CornerPush.Veloff = 0;-15
Air.Fall = 1
Fall.Recover = !var(55)
Fall.RecoverTime = 42

[State 200, Hitdef]
Type = HitDef
Trigger1 = var(2) = 1
Trigger1 = AnimElem = 14
attr = S, SA
damage = 60-20*(var(2) = 1),6-2*(var(2) = 1)
AnimType = Heavy
getpower = 30,15
givepower = 15,8
Guardflag = MA
Hitflag = MA
pauseTime = 10,12
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,-75
HitSound = S5,4
GuardSound = S6,0
ground.Type = High
ground.SlideTime = 17
ground.HitTime = 17
ground.Velocity = 0
Air.Velocity = -4,-5
yAccel = .5
Ground.CornerPush.Veloff = 0;-15
Air.CornerPush.Veloff = 0;-15
Air.Fall = 1
Fall.Recover = !var(55)
Fall.RecoverTime = 42

[State 200, Hitdef]
Type = HitDef
Trigger1 = !var(2)
Trigger1 = AnimElem = 13
Trigger2 = var(2) = 1
Trigger2 = AnimElem = 28
attr = S, SA
damage = 60-20*(var(2) = 1),6-2*(var(2) = 1)
AnimType = Up
getpower = 30,15
givepower = 15,10
Guardflag = MA
Hitflag = MA
pauseTime = 10,12
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,-85
HitSound = S5,6
GuardSound = S6,0
ground.Type = High
ground.SlideTime = 17
ground.HitTime = 17
ground.Velocity = -2.5, -8.5
guard.Velocity = -9.5
Air.Velocity = -2.5,-7.5
yAccel = .5
Ground.CornerPush.Veloff = 0;-15.5
Air.CornerPush.Veloff = 0;-15.5
EnvShake.Time = 15
Fall = 1
Fall.Recover = !var(55)
Fall.RecoverTime = 55

[State 200, Hitdef]
Type = HitDef
TriggerAll = var(2) = 2
Trigger1 = AnimElem = 5
Trigger2 = AnimElem = 17
attr = S, SA
damage = 40,4
AnimType = Heavy
getpower = 30,15
givepower = 15,8
Guardflag = MA
Hitflag = MA
pauseTime = 10,12
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,-85
HitSound = S5,4
GuardSound = S6,0
ground.Type = High
ground.SlideTime = 17
ground.HitTime = 17
ground.Velocity = 0
Air.Velocity = -4,-5
yAccel = .5
Ground.CornerPush.Veloff = 0;-15
Air.CornerPush.Veloff = 0;-15
Air.Fall = 1
Fall.Recover = !var(55)
Fall.RecoverTime = 42

[State 200, Hitdef]
Type = HitDef
Trigger1 = var(2) = 2
Trigger1 = AnimElem = 10
attr = S, SA
damage = 40,4
AnimType = Heavy
getpower = 30,15
givepower = 15,8
Guardflag = MA
Hitflag = MA
pauseTime = 10,12
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,-75
HitSound = S5,4
GuardSound = S6,0
ground.Type = Low
ground.SlideTime = 17
ground.HitTime = 17
ground.Velocity = 0
Air.Velocity = -4,-5
yAccel = .5
Ground.CornerPush.Veloff = 0
Air.CornerPush.Veloff = 0
Air.Fall = 1
Fall.Recover = !var(55)
Fall.RecoverTime = 42

[State 200, Quake]
Type = EnvShake
Trigger1 = var(2) = 2
Trigger1 = AnimElem = 22
Time = 20
Ampl = 6
ignorehitpause = 1

[State 200, Hitdef]
Type = HitDef
Trigger1 = var(2) = 2
Trigger1 = AnimElem = 22
attr = S, SA
damage = 40,4
AnimType = Back
getpower = 30,15
givepower = 15,10
Guardflag = MA
Hitflag = MA
pauseTime = 10,12
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,-85
HitSound = S5,6
GuardSound = S6,0
ground.Type = High
ground.SlideTime = 17
ground.HitTime = 17
ground.Velocity = -4, -5.5
Air.Velocity = -4,-4.5
yAccel = .5
Ground.CornerPush.Veloff = 0
Air.CornerPush.Veloff = 0
Fall = 1
Fall.Recover = !var(55)
Fall.RecoverTime = 55
guard.Velocity = -9.5

[State 1200, End]
Type = ChangeState
Trigger1 = !AnimTime
Value = 0
Ctrl = 1

;-----------------------------------
;------ Sledgehammer Startup -------
;-----------------------------------
[Statedef 1300]
Type = S
MoveType = I
Physics = N
Anim = 1300
Ctrl = 0
PowerAdd = 120
Juggle = 8
Velset = 0,0,0

[State -1, Cancel Combo]
Type = Varadd
Trigger1 = var(15)
Trigger1 = !time
Trigger1 = prevstateno = [1000, 1900]
IgnoreHitPause = 1
var(15) = -200

[State 3000, PALFX]
type = PalFX
Trigger1 = gametime%2 = 0
Trigger1 = time <= 7
ignorehitpause = 1
Trigger1 = prevstateno = [1000, 1900]
time = 1
add = 255,255,255
sinadd = -100,-100,-100, 2
ignorehitpause = 1

[State 1000, buffer setting1]
Type = varSet
Trigger1 = !Time
Trigger1 = helper(2000),var(4) > helper(2000), var(5)
Trigger1 = helper(2000),var(4) > helper(2000), var(6)
var(2) = 0

[State 1000, buffer setting2]
Type = varSet
Trigger1 = !Time
Trigger1 = helper(2000),var(5) > helper(2000), var(4)
Trigger1 = helper(2000),var(5) > helper(2000), var(6)
var(2) = 1

[State 1000, buffer setting3]
Type = varSet
Trigger1 = !Time
Trigger1 = helper(2000),var(6) > helper(2000), var(4)
Trigger1 = helper(2000),var(6) > helper(2000), var(5)
var(2) = 2

[State 1000, Power Set]
Type = varSet
TriggerAll = !Time
Trigger1 = command="a"
Trigger2 = command="b"
Trigger3 = command="c"
var(2) = IfElse(command = "b",1,IfElse(Command = "c" || var(9),2,0))

[State 1000, AI Power Set]
Type = varSet
Trigger1 = !Time
Trigger1 = var(9)
var(2) = IfElse(p2bodydist x > 135, 2,IfElse(p2bodydist x > 108, 1,0))

[State 1000, Power set]
type = ChangeAnim
Trigger1 = !Time
value = 1300+var(2)

[State 1000, Yashiro Voice]
type = PlaySnd
Trigger1 = AnimElem = 2
value = 1300,0
Channel = 1

[State 1300, Vel]
Type = StateTypeSet
Trigger1 = AnimElem = 3
StateType = A

[State 1300, Vel]
Type = VelSet
Trigger1 = AnimElem = 3
y = -6.5-.75*var(2)
x = 4.5+.5*var(2)

[State 1300, Gravity]
Type = Gravity
Trigger1 = AnimElem = 3, > 0

[State 1300, FX Snd]
Type = PlaySnd
Trigger1 = AnimElem = 3
Value = 50, 1
Channel = 3

[State 1300, Invincible]
Type = NotHitBy
Trigger1 = AnimElem = 4, < 4
Value = SCA

[State 1200, End]
type = ChangeState
Trigger1 = Vel y > -3
Trigger1 = AnimElem = 3, > 0
value = 1301

;-----------------------------------
;------- Sledgehammer Attack -------
;-----------------------------------
[Statedef 1301]
Type = A
MoveType = A
Physics = N
Anim = 1310
Ctrl = 0
Juggle  = 8

[State 1000, Power set]
type = ChangeAnim
Trigger1 = !Time
Trigger1 = var(2) = 2
value = 1311

[State 200, Sound Set]
Type = PlaySND
Trigger1 = AnimElem = 2
value = 1,2

[State 200, gravity]
Type = Gravity
Trigger1 = 1

[State 200, Hitdef]
Type = HitDef
Trigger1 = AnimElem = 4
attr = A, SA
damage = 100+15*var(2)
AnimType = Heavy
Fall.AnimType = Heavy
getpower = 60,30
givepower = 30,15
Guardflag = H
Hitflag = MA
pauseTime = 10,12
guard.pauseTime = 10,12
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,-45
HitSound = S5,6
GuardSound = S6,0
ground.Type = Low
ground.SlideTime = 17
ground.HitTime = 17
ground.Velocity = -5, 20
Guard.Velocity = -9.5
Air.Velocity = -5, 20
yAccel = .5
Ground.CornerPush.Veloff = 0
Air.CornerPush.Veloff = 0
EnvShake.Time = 15
Fall.EnvShake.Time = 20
Fall.Envshake.Ampl = -6
Fall = 1
Fall.Recover = 0

[State 200, Over]
Type = TargetState
Trigger1 = MoveHit
Trigger1 = p2StateNo != 1350
Value = 1350
Persistent = 0

[State 200, Over]
Type = ChangeState
Trigger1 = Pos y >= 0
Trigger1 = Vel y >= 0
Value = 1302

;------ Sledgehammer Hit - Part 3 -----
[Statedef 1302]
Type = S
MoveType = I
Physics = N
Anim = 1320+(var(2) = 2)
Ctrl = 0
PowerAdd = 0
VelSet = 0,0

[State 1100, PosSet]
Type = PosSet
Trigger1 = !time
y = 0

[State -3, Landing Sound]
type = PlaySnd
Trigger1 = !Time
Value = ifelse(var(2) = 2, 850,52),0
Channel = 3

[State -3, OTG FX]
type = Explod
Trigger1 = !Time
Trigger1 = var(2) != 2
anim = 8300
pos = 0,0
bindtime = 1
ownpal = 1
sprpriority = -3
PauseMoveTime = 99
SuperMoveTime = 99

[State -3, OTG FX]
type = Explod
Trigger1 = !Time
Trigger1 = var(2) = 2
anim = 8310
pos = 45,0
bindtime = 1
ownpal = 1
sprpriority = -3
PauseMoveTime = 99
SuperMoveTime = 99

[State -3, OTG FX]
type = Explod
Trigger1 = !Time
Trigger1 = var(2) = 2
anim = 8320
pos = 45,0
bindtime = 1
ownpal = 1
sprpriority = 3
PauseMoveTime = 99
SuperMoveTime = 99

[State 200, Quake]
Type = EnvShake
Trigger1 = !Time
Trigger1 = var(2) = 2
Time = 15
Ampl = -6
ignorehitpause = 1

[State 1000, 9]
type = ChangeState
Trigger1 = !AnimTime
value = 0
Ctrl = 1

;-----------------------------------
;------- Hit by Sledgehammer -------
;-----------------------------------
[Statedef 1350]
type = A
movetype= H
physics = N
velset = 0,0

[State 6000, Change by HitType1]
type = ChangeAnim
trigger1 = !Time
trigger1 = GetHitVar(animtype) != [3,5]
value = ifelse((GetHitVar(airtype) = 1),5000,5010) + GetHitVar(animtype)

[State 6000, Change by HitType2]
type = ChangeAnim
trigger1 = !Time
trigger1 = GetHitVar(animtype) = [3,5]
value = 5012

[State 6000, Change by HitType3]
type = ChangeAnim
trigger1 = !Time
trigger1 = (GetHitVar(animtype) = [4,5]) && (SelfAnimExist(5047 + GetHitVar(animtype)))
value = 5047 + GetHitVar(animtype) ;5051 - 4 + type

[State 6000, Change by HitType4]
type = ChangeAnim
trigger1 = Time > 0
value = anim

[State 6000, end]
type = ChangeState
trigger1 = HitShakeOver
value = 1351

[State 6000, FFB Light]
type = ForceFeedback
trigger1 = anim = 5000
trigger2 = anim = 5010
persistent = 0
time = 6
waveform = square

[State 6000, FFB Medium]
type = ForceFeedback
trigger1 = anim = 5001
trigger2 = anim = 5011
persistent = 0
time = 8
waveform = sinesquare
ampl = 110,-1,-.3

[State 6000, FFB Hard]
type = ForceFeedback
trigger1 = anim = 5012
trigger2 = anim = 5002
trigger3 = anim = 5030
trigger4 = anim = [5051,5059]
persistent = 0
time = 15
waveform = sinesquare
ampl = 140

;---------------------------------------------------------------------------
[Statedef 1351]
type = A
movetype= H
physics = N
ctrl = 0

[State 6001, Change by HitType1]
type = Changeanim
trigger1 = !Time
trigger1 = anim = 5012
value = 5030

[State 6001, HitVelAdd]
type = VelAdd
trigger1 = 1
y = GetHitVar(yaccel)

[State 6001, HitVelSet]
type = HitVelSet
trigger1 = !Time
x = 1
y = 1

[State 5050, 6]
type = ChangeState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= ifelse((anim = [5051,5059]) || (anim = [5061,5069]), 0, 25)
value = 1360

[State 6001, end2]
type = ChangeState
trigger1 = AnimTime = 0
value = 1352

;---------------------------------------------------------------------------
[Statedef 1352]
type = A
movetype= H
physics = N

[State 6000, Change by HitType1]
type = ChangeAnim
trigger1 = !Time
trigger1 = SelfAnimExist(5035)
trigger1 = Anim != [5051,5059]
trigger1 = Anim != 5090
value = 5035

[State 6002, HitVelAdd]
type = VelAdd
trigger1 = 1
y = GetHitVar(yaccel)

[State 5050, 6]
type = ChangeState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= ifelse((anim = [5051,5059]) || (anim = [5061,5069]), 0, 25)
value = 1360

[State 6003, End2]
type = ChangeState
trigger1 = HitOver
trigger2 = AnimTime = 0
trigger3 = Time = 0
trigger3 = Anim != 5035
value = 1353

;---------------------------------------------------------------------------

[Statedef 1353]
type = A
movetype= H
physics = N

[State 6000, Change by HitType1]
type = ChangeAnim
trigger1 = AnimTime = 0
trigger1 = Anim = 5035
trigger2 = Time = 0
trigger2 = Anim != 5035
trigger2 = (Anim != [5051, 5059]) && (Anim != [5061, 5069])
trigger2 = Anim != 5090
value = 5050

[State 6000, Change by HitType2]
type = ChangeAnim
trigger1 = anim = [5050,5059]
trigger1 = Vel Y >= ifelse(anim = 5050, 1, -2)
trigger1 = SelfAnimExist(anim+10)
value = anim+10
persistent = 0

[State 6003, HitVelAdd]
type = VelAdd
trigger1 = 1
y = GetHitVar(yaccel)

[State 5050, 6]
type = ChangeState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= ifelse((anim = [5051,5059]) || (anim = [5061,5069]), 0, 25)
value = 1360

;---------------------------------------------------------------------------
; HIT_LIEDOWN
[Statedef 1360]
type    = L
movetype= H
physics = N

[State 5110, EnvShake]
type = FallEnvShake
trigger1 = !Time

[State 5110, 1]
type = ChangeAnim2
trigger1 = !Time
value = 1350

[State 5110, 4]
type = HitFallDamage
trigger1 = !Time

[State 5110, 5]
type = PosSet
trigger1 = !Time
y = 0

[State 5110, 5]
type = VelSet
trigger1 = !Time
y = 0

[State 5110, 6]
type = PlaySnd
trigger1 = !Time
value = F7, 2

[State 5110, 7]
type = GameMakeAnim
trigger1 = !Time
value = 62
pos = 0, 0

[State 5110, 7]
type = Makedust
trigger1 = vel X < -1
trigger2 = vel X > 1
spacing = 3


[State 5110, 11] ;If just died
type = SelfState
trigger1 = !AnimTime
value = ifelse(alive, 5120, 5150)

[State 5110, 12]
type = VarSet
trigger1 = SysVar(0)
trigger1 = !Time
sysvar(0) = 0

[State 5110, 13] ;Friction
type = VelMul
trigger1 = 1
x = 0.9

[State 5110, 14]
type = ForceFeedback
trigger1 = alive
trigger1 = !Time
time = 8
ampl = 240
waveform = sine

[State 5110, 15]
type = ForceFeedback
trigger1 = !alive
trigger1 = !Time
ampl = 200, 7, -.467
time = 30
waveform = sine

;-----------------------------------
;--------- Niragu Daichi -----------
;-----------------------------------
[Statedef 1400]
Type = S
MoveType = A
Physics = S
Anim = 1400
Velset = 0,0
Ctrl = 0
PowerAdd = 50
Sprpriority = 1

[State -1, Cancel Combo]
Type = Varadd
Trigger1 = var(15)
Trigger1 = !time
Trigger1 = prevstateno = [1000, 1900]
IgnoreHitPause = 1
var(15) = -200

[State 3000, PALFX]
type = PalFX
Trigger1 = gametime%2 = 0
Trigger1 = time <= 7
ignorehitpause = 1
Trigger1 = prevstateno = [1000, 1900]
time = 1
add = 255,255,255
sinadd = -100,-100,-100, 2
ignorehitpause = 1

[State 1000, buffer setting1]
Type = varSet
Trigger1 = !Time
Trigger1 = helper(2000),var(1) > helper(2000), var(2)
Trigger1 = helper(2000),var(1) > helper(2000), var(3)
var(2) = 0

[State 1000, buffer setting2]
Type = varSet
Trigger1 = !Time
Trigger1 = helper(2000),var(2) > helper(2000), var(1)
Trigger1 = helper(2000),var(2) > helper(2000), var(3)
var(2) = 1

[State 1000, buffer setting3]
Type = varSet
Trigger1 = !Time
Trigger1 = helper(2000),var(3) > helper(2000), var(1)
Trigger1 = helper(2000),var(3) > helper(2000), var(2)
var(2) = 2

[State 1000, Power Set]
Type = varSet
TriggerAll = !Time
Trigger1 = command="x"
Trigger2 = command="y"
Trigger3 = command="z"
var(2) = IfElse(command = "y",1,IfElse(Command = "z",2,0))

[State 1000, Power set]
Type = varrandom
Trigger1 = !Time
Trigger1 = var(9)
v = 2
range = (prevStateNo = 300),2

[State 1000, Power set]
Type = varSet
Trigger1 = !Time
Trigger1 = var(9)
Trigger1 = Life < p2life || life < 400 || power > 3000
trigger1 = power >= 2000
var(2) = 1

[State 1000, Invincibility]
type = NotHitBy
Trigger1 = AnimElem = 4, < 0
value = SCA
IgnoreHitPause = 1
Persistent = 1

[State 1000, Yashiro Voice]
type = PlaySnd
Trigger1 = AnimElem = 3
Trigger1 = var(2) != 2
value = 1400,0
Channel = 1

[State 1000, Yashiro Voice]
type = PlaySnd
Trigger1 = AnimElem = 4
Trigger1 = var(2) = 2
value = 0,2
Channel = 1

[State 800, 1]
type = HitDef
Trigger1 = p2dist x < 75
Trigger1 = AnimElem = 3
Trigger1 = PrevStateNo != [200,2000]
Trigger1 = !var(6)
attr = S, ST
hitflag = M-
priority = 7, Miss
sparkno = -1
sparkxy = -15,-70
HitSound = S800,1
sprpriority = 1
p1facing = 1
p2facing = 1
p1stateno = 1410+(var(2) > 0)
p2stateno = 1412+(var(2) > 0)
Fall = 0
Fall.Recover = 0
fall.EnvShake.time = 22
fall.EnvShake.ampl = -9
Fall.damage = floor(80*((10-var(5))*.1))
ID = 1400

[State 800, 1]
type = HitDef
Trigger1 = p2dist x < 55
Trigger1 = !var(19)
Trigger1 = AnimElem = 3
Trigger1 = PrevStateNo = [200,2000]
attr = S, ST
hitflag = M
priority = 7, Miss
sparkno = -1
sparkxy = -15,-70
HitSound = S800,1
sprpriority = 1
p1facing = 1
p2facing = 1
p1stateno = 1410+(var(2) > 0)
p2stateno = 1412+(var(2) > 0)
Fall = 0
Fall.Recover = 0
fall.EnvShake.time = 10
fall.EnvShake.freq =  45
fall.EnvShake.ampl = -8
Fall.damage = floor(80*((10-var(5))*.1))
ID = 1400

[State 1000, Invincibility]
type = NotHitBy
Trigger1 = AnimElem = 3, <= 0
value = SCA

[State 200, Over]
Type = ChangeState
Trigger1 = !Animtime
Value = 0
Ctrl = 1

;-----------------------------------
;-- Niragu Daichi Type 1 start up --
;-----------------------------------
[Statedef 1410]
Type = S
MoveType = A
Physics = N
Anim = 1410
Ctrl = 0
PowerAdd = 100
SprPriority = 1
Velset = 0,0

[State 1031, 4]
type = Width
trigger1 = AnimElem = 1
edge = 70,0

[State 1400, Targetbind]
type = Targetbind
trigger1 = AnimElem = 1, >= 0
trigger1 = AnimElem = 3, < 0
pos = 60,0

[State 1400, bindtoTarget]
type = bindtoTarget
trigger1 = AnimElem = 3, >= 0
trigger1 = AnimElem = 11, < 0
pos = 0,5, head

[State -3, OTG FX]
type = Explod
Trigger1 = AnimElem = 3
anim = 8220
pos = 0,0
bindtime = 1
ownpal = 1
Ontop = 1
PauseMoveTime = 99
SuperMoveTime = 99

[State 1400, Targetbind]
type = PosSet
trigger1 = AnimElem = 11
y = 0

[State 1400, Targetbind]
type = PosAdd
trigger1 = AnimElem = 11
x = 60

[State 1400, Targetbind]
type = Targetbind
trigger1 = AnimElem = 11, > 0
pos = -60,0

[State 200, Over]
Type = ChangeState
Trigger1 = !Animtime
Value = 1420

;-----------------------------------
;-- Niragu Daichi Type 2 start up --
;-----------------------------------
[Statedef 1411]
Type = S
MoveType = A
Physics = N
Anim = 1411
Ctrl = 0
PowerAdd = 100
SprPriority = 1
Velset = 0,0

[State 1031, 4]
type = Width
trigger1 = AnimElem = 1
edge = 30,0

[State 1031, 4]
type = PlaySnd
trigger1 = AnimElem = 5
trigger1 = var(2) = 2
value = 0,2
channel = 1

[State 1031, 4]
type = PlaySnd
trigger1 = AnimElem = 10
value = 820,0
channel = 3

[State -3, OTG FX]
type = Explod
Trigger1 = AnimElem = 3
anim = 8220
pos = 45,-55
bindtime = 1
ownpal = 1
Ontop = 1
PauseMoveTime = 99
SuperMoveTime = 99

[State 1400, Targetbind]
type = Targetbind
trigger1 = AnimElem = 1, >= 0
trigger1 = AnimElem = 4, < 0
pos = 30,0

[State 1400, bindtoTarget]
type = bindtoTarget
trigger1 = AnimElem = 4, >= 0
trigger1 = AnimElem = 9, < 0
pos = 0,10, head

[State 1400, Targetbind]
type = PosSet
trigger1 = AnimElem = 9
y = 0

[State 1400, Targetbind]
type = PosAdd
trigger1 = AnimElem = 9
x = 50

[State 1400, Targetbind]
type = Targetbind
trigger1 = AnimElem = 9, > 0
trigger1 = AnimElem = 10, < 0
pos = -50,0

[State 1400, Targetbind]
type = PosAdd
trigger1 = AnimElem = 10
x = 20

[State -3, Landing Sound]
type = PlaySnd
trigger1 = AnimElem = 10
Value = 52,0
Channel = 3

[State -3, OTG FX]
type = Explod
trigger1 = AnimElem = 10
anim = 8300
pos = 0,0
bindtime = 1
ownpal = 1
sprpriority = -3
PauseMoveTime = 99
SuperMoveTime = 99

[State 1400, Targetbind]
type = Targetbind
trigger1 = AnimElem = 10, >= 0
trigger1 = AnimElem = 11, < 0
pos = -10,-115

[State 1400, Targetbind]
type = Targetbind
trigger1 = AnimElem = 11, >= 0
trigger1 = AnimElem = 12, < 0
pos = 0,-105

[State -3, OTG FX]
type = Explod
trigger1 = AnimElem = 12
anim = 8300
pos = 0,0
bindtime = 1
ownpal = 1
sprpriority = -3

[State -3, Sound]
type = PLaySnd
trigger1 = AnimElem = 12
value = 850,1
channel = 3

[State -3, OTG FX]
type = Explod
trigger1 = AnimElem = 12
anim = 8002
pos = -5,-60
bindtime = 1
ownpal = 1
facing = -1
OnTop = 1

[State 1400, Shake]
type = EnvShake
trigger1 = AnimElem = 12
time = 25
Ampl = 6

[State 1400, Hurt]
type = TargetLifeadd
trigger1 = AnimElem = 12
value = -floor((50+50*(var(2) = 2))*((10-var(5))*.1))
kill = 0

[State 1400, Targetbind]
type = Targetbind
trigger1 = AnimElem = 12, >= 0
trigger1 = AnimElem = 15, < 0
pos = 0,-55

[State 1400, Targetbind]
type = Targetbind
trigger1 = AnimElem = 15, >= 0
pos = -60,0

[State 200, Over]
Type = ChangeState
Trigger1 = !Animtime
Value = 1420+(var(2) = 2)

;-----------------------------------
;- Niragu Daichi Type 1 startup P2 -
;-----------------------------------
[Statedef 1412]
Type = S
MoveType = H
Physics = S
Ctrl = 0
PowerAdd = 0
SprPriority = -1
Velset = 0,0

[State 1031, 4]
type = ChangeAnim2
trigger1 = !Time
value = 1412

[State 1031, 4]
type = Width
trigger1 = AnimElem = 1
edge = 0,70

[State 1031, 4]
type = Width
trigger1 = Time > 24
edge = 70,0

[State 200, Over]
Type = SelfState
Trigger1 = !Animtime
Value = 0
Ctrl = 1

;-----------------------------------
;- Niragu Daichi Type 1 startup P2 -
;-----------------------------------
[Statedef 1413]
Type = S
MoveType = H
Physics = S
Ctrl = 0
PowerAdd = 0
SprPriority = -1
Velset = 0,0

[State 1031, 4]
type = ChangeAnim2
trigger1 = !Time
value = 1413

[State 200, Over]
Type = SelfState
Trigger1 = !Animtime
Value = 5100

;-----------------------------------
;--- Niragu Daichi Type 1 ending ---
;-----------------------------------
[Statedef 1420]
Type = S
MoveType = A
Physics = N
Anim = 1420
Ctrl = 0
PowerAdd = 0
SprPriority = 1
Velset = 0,0

[State 1420, targetstate]
type = TargetState
trigger1 = !Time
value = 1425

[State 1420, Posadd]
type = PosAdd
trigger1 = !Time
trigger1 = PrevStateNo = 1411
x = 20

[State -3, Landing Sound]
type = PlaySnd
Trigger1 = AnimElem = 1, = 1
trigger1 = PrevStateNo != 1411
Value = 52,0
Channel = 3

[State -3, OTG FX]
type = Explod
Trigger1 = AnimElem = 1, = 1
trigger1 = PrevStateNo != 1411
anim = 8300
pos = 0,0
bindtime = 1
ownpal = 1
sprpriority = -3
PauseMoveTime = 99
SuperMoveTime = 99

[State 1420, width1]
type = Width
trigger1 = AnimElem = 5, < 0
edge = 0,80

[State 1031, 4]
type = Width
trigger1 = AnimElem = 5, >= 0
trigger1 = AnimElem = 6, < 0
edge = 0,70

[State 1031, 4]
type = Width
trigger1 = AnimElem = 6
edge = 60,0

[State 1400, Targetbind]
type = Targetbind
trigger1 = AnimElem = 1, >= 0
trigger1 = AnimElem = 4, < 0
pos = -70,0

[State 1400, Targetbind]
type = Targetbind
trigger1 = AnimElem = 4, >= 0
trigger1 = AnimElem = 5, < 0
pos = -60,-100

[State 1400, Targetbind]
type = Targetbind
trigger1 = AnimElem = 5, >= 0
trigger1 = AnimElem = 6, < 0
pos = -50,-100

[State 1400, Targetbind]
type = Targetbind
trigger1 = AnimElem = 6, >= 0
trigger1 = AnimElem = 7, < 0
pos = 20,-100

[State 1400, snd]
type = PlaySND
trigger1 = AnimElem = 7
value = 820,0
channel = 3

[State 1031, 4]
type = Width
trigger1 = AnimElem = 9, > 0
edge = 40,0

[State 1400, Posadd]
type = PosAdd
trigger1 = AnimElem = 9
x = 15

[State 1400, Targetbind]
type = PosAdd
trigger1 = AnimElem = 10
trigger2 = AnimElem = 11
trigger3 = AnimElem = 12
x = 20

[State 200, Over]
Type = ChangeState
Trigger1 = !Animtime
Trigger1 = var(9)
Value = 100

[State 200, Over]
Type = ChangeState
Trigger1 = !Animtime
Value = 0
Ctrl = 1

;-----------------------------------
;-- Niragu Daichi Type 2 jumping ---
;-----------------------------------
[Statedef 1421]
Type = A
MoveType = A
Physics = N
Anim = 1421
Ctrl = 0
PowerAdd = 0
SprPriority = 1
Velset = 0,0

[State 1420, targetstate]
type = TargetState
trigger1 = !Time
value = 1426

[State 1400, Targetbind]
type = Targetbind
trigger1 = AnimElem = 1, >= 0
trigger1 = AnimElem = 4, < 0
pos = -70,0

[State 1400, Targetbind]
type = Velset
trigger1 = AnimElem = 4
x = 3
y = -12

[State 1031, 4]
type = PlaySnd
trigger1 = AnimElem = 4
value = 50,1
channel = 2

[State 1400, Targetbind]
type = Targetbind
trigger1 = AnimElem = 4, >= 0
pos = -30,-80

[State 1400, Targetbind]
type = Gravity
trigger1 = AnimElem = 4, >= 0

[State 200, Over]
Type = ChangeState
trigger1 = AnimElem = 4, >= 0
trigger1 = vel y > -4
Value = 1422

;-----------------------------------
;- Niragu Daichi Type 2 launching --
;-----------------------------------
[Statedef 1422]
Type = A
MoveType = A
Physics = N
Anim = 1422
Ctrl = 0
PowerAdd = 0
SprPriority = 1

[State 1031, 4]
type = width
trigger1 = 1
edge = 50,0

[State 1031, 4]
type = PlaySnd
trigger1 = AnimElem = 1
value = 0,0
channel = 1

[State 1031, 4]
type = PlaySnd
trigger1 = AnimElem = 1
value = 820,0
channel = 3

[State 1420, targetstate]
type = TargetState
trigger1 = !Time
value = 1427

[State 1400, Targetbind]
type = Targetbind
trigger1 = AnimElem = 1, >= 0
trigger1 = AnimElem = 2, < 0
pos = -60,-80

[State 1400, Targetbind]
type = Targetbind
trigger1 = AnimElem = 2, >= 0
trigger1 = AnimElem = 3, < 0
pos = 25,-120

[State 1400, Targetbind]
type = Targetbind
trigger1 = AnimElem = 3
pos = 30,-50

[State 1400, Targetbind]
type = Gravity
trigger1 = 1

[State 200, Over]
Type = ChangeState
trigger1 = pos y >= 0
trigger1 = vel y > 0
Value = 1103

;-----------------------------------
;- Niragu Daichi Type 1 Ending P2 --
;-----------------------------------
[Statedef 1425]
Type = A
MoveType = H
Physics = N
Ctrl = 0
PowerAdd = 0
SprPriority = -1
Velset = 0,0

[State 1031, 4]
type = ChangeAnim2
trigger1 = !Time
value = 1425

[State 1031, 4]
type = Velset
trigger1 = Time = 26
x = -3
y = -18

[State 1031, 4]
type = VelAdd
trigger1 = Time > 26
y = .65

[State 200, Over]
Type = SelfState
Trigger1 = Time > 26
Trigger1 = vel y > 0
Trigger1 = Pos y >= 0
Value = 5100

;-----------------------------------
;- Niragu Daichi Type 2 Jumping P2 -
;-----------------------------------
[Statedef 1426]
Type = A
MoveType = H
Physics = N
Ctrl = 0
PowerAdd = 0
SprPriority = -1
Velset = 0,0

[State 1031, 4]
type = ChangeAnim2
trigger1 = !Time
value = 1426

[State 200, Over]
Type = SelfState
Trigger1 = Time > 100
Value = 5070

;-----------------------------------
; Niragu Daichi Type 2 launching P2
;-----------------------------------
[Statedef 1427]
Type = A
MoveType = H
Physics = N
Ctrl = 0
PowerAdd = 0
SprPriority = -1
Velset = 0,0

[State 1031, 4]
type = ChangeAnim2
trigger1 = !Time
value = 1427

[State 1031, 4]
type = Velset
trigger1 = AnimElem = 3, = 1
x = -10
y = 25

[State 200, Over]
Type = SelfState
trigger1 = AnimElem = 3, > 1
Trigger1 = vel y > 0
Trigger1 = Pos y >= 0
Value = 5100

;-----------------------------------
;---------- Musebu Daichi ----------
;-----------------------------------
[Statedef 1500]
Type = S
MoveType = A
Physics = S
Anim = 1500
Velset = 0,0
Ctrl = 0
PowerAdd = 50
Sprpriority = 1

[State -1, Cancel Combo]
Type = Varadd
Trigger1 = var(15)
Trigger1 = !time
Trigger1 = prevstateno = [1000, 1900]
IgnoreHitPause = 1
var(15) = -200

[State 3000, PALFX]
type = PalFX
Trigger1 = gametime%2 = 0
Trigger1 = time <= 7
ignorehitpause = 1
Trigger1 = prevstateno = [1000, 1900]
time = 1
add = 255,255,255
sinadd = -100,-100,-100, 2
ignorehitpause = 1

[State 1000, buffer setting1]
Type = varSet
Trigger1 = !Time
Trigger1 = helper(2000),var(1) > helper(2000), var(2)
Trigger1 = helper(2000),var(1) > helper(2000), var(3)
var(2) = 0

[State 1000, buffer setting2]
Type = varSet
Trigger1 = !Time
Trigger1 = helper(2000),var(2) > helper(2000), var(1)
Trigger1 = helper(2000),var(2) > helper(2000), var(3)
var(2) = 1

[State 1000, buffer setting3]
Type = varSet
Trigger1 = !Time
Trigger1 = helper(2000),var(3) > helper(2000), var(1)
Trigger1 = helper(2000),var(3) > helper(2000), var(2)
var(2) = 2

[State 1000, Power Set]
Type = varSet
TriggerAll = !Time
Trigger1 = command="x"
Trigger2 = command="y"
Trigger3 = command="z"
var(2) = IfElse(command = "y",1,IfElse(Command = "z",2,0))

[State 1000, Power set]
Type = varSet
Trigger1 = !Time
Trigger1 = var(9)
var(2) = 2

[State 1000, Yashiro Voice]
type = PlaySnd
Trigger1 = AnimElem = 1, = 1
value = 0,0
Channel = 1

[State 800, 1]
type = HitDef
Trigger1 = p2dist x < 75
Trigger1 = !Time
Trigger1 = PrevStateNo != [200,2000]
Trigger1 = !var(6)
attr = S, ST
hitflag = M-
priority = 6, Miss
sparkno = -1
sparkxy = -15,-90
HitSound = S800,1
sprpriority = 1
p1facing = 1
p2facing = 1
p1stateno = 1501
p2stateno = 1505
Fall = 1
Fall.Recover = 0
ID = 1400

[State 800, 1]
type = HitDef
Trigger1 = p2dist x < 75
Trigger1 = !var(19)
Trigger1 = !Time
Trigger1 = PrevStateNo = [200,2000]
attr = S, ST
hitflag = M
priority = 6, Miss
sparkno = -1
sparkxy = -15,-90
HitSound = S800,1
sprpriority = 1
p1facing = 1
p2facing = 1
p1stateno = 1501
p2stateno = 1505
Fall = 1
Fall.Recover = 0
ID = 1400

[State 200, Over]
Type = ChangeState
Trigger1 = !Animtime
Value = 0
Ctrl = 1

;-----------------------------------
;------ Musebu Daichi success ------
;-----------------------------------
[Statedef 1501]
Type = A
MoveType = A
physics = N
anim = 1501
poweradd = 100
sprpriority = 1
Velset = 0,0

[State -3, OTG FX]
type = Explod
Trigger1 = AnimElem = 2
anim = 8220
pos = 30,-135
bindtime = 1
ownpal = 1
Ontop = 1
PauseMoveTime = 99
SuperMoveTime = 99

[State 810, Out of corners]
type = Width
trigger1 = AnimElem = 1
trigger2 = AnimElem = 13
trigger3 = AnimElem = 26, >= 0
Edge = 50,0

[State 810, Out of corners]
type = Width
trigger1 = AnimElem = 7
trigger2 = AnimElem = 21
Edge = 0,120

[State 810, Bind 1]
type = PlaySnd
trigger1 = AnimElem = 3
trigger1 = !var(2)
trigger2 = var(2)
trigger2 = AnimElem = 7 || AnimElem = 13 || AnimElem = 21
Value = 1500, 0
Channel = 1

[State 810, Bind 1]
type = PlaySnd
trigger1 = AnimElem = 5
trigger2 = AnimElem = 12
trigger3 = AnimElem = 19
Value = 820, 0
Channel = 3

[State 820, Bind 1]
type = TargetBind
trigger1 = AnimElem = 1, >= 0
trigger1 = AnimElem = 2, < 0
pos = 55, 0

[State 820, Bind 2]
type = TargetBind
trigger1 = AnimElem = 2, >= 0
trigger1 = AnimElem = 3, < 0
pos = 35, -125

[State 820, Bind 3]
type = TargetBind
trigger1 = AnimElem = 3, >= 0
trigger1 = AnimElem = 4, < 0
pos = 25, -150

[State 820, Bind 4]
type = TargetBind
trigger1 = AnimElem = 4, >= 0
trigger1 = AnimElem = 5, < 0
pos = 25, -148

[State 820, Bind 5]
type = TargetBind
trigger1 = AnimElem = 5, >= 0
trigger1 = AnimElem = 6, < 0
pos = 0, -125


[State 820, Bind 10]
type = TargetBind
trigger1 = AnimElem = 6, >= 0
trigger1 = AnimElem = 7, < 0
trigger2 = AnimElem = 20, >= 0
trigger2 = AnimElem = 21, < 0
pos = -10, -110

[State 820, Bind 10]
type = TargetBind
trigger1 = AnimElem = 7, >= 0
trigger1 = AnimElem = 8, < 0
trigger2 = AnimElem = 21, >= 0
trigger2 = AnimElem = 22, < 0
pos = -85, -100

[State 820, Bind 10]
type = TargetBind
trigger1 = AnimElem = 8, >= 0
trigger1 = AnimElem = 10, < 0
trigger2 = AnimElem = 22, >= 0
trigger2 = AnimElem = 24, < 0
pos = -100, 0

[State 820, Bind 5]
type = TargetBind
trigger1 = AnimElem = 10, >= 0
trigger1 = AnimElem = 11, < 0
trigger2 = AnimElem = 24, >= 0
trigger2 = AnimElem = 25, < 0
pos = -80, 0

[State 820, Bind 5]
type = TargetBind
trigger1 = AnimElem = 11, >= 0
trigger1 = AnimElem = 12, < 0
trigger2 = AnimElem = 25, >= 0
trigger2 = AnimElem = 26, < 0
pos = -75, -40

[State 820, Bind 5]
type = TargetBind
trigger1 = AnimElem = 12, >= 0
trigger1 = AnimElem = 13, < 0
pos = -75, -85

[State 820, Bind 5]
type = TargetBind
trigger1 = AnimElem = 13, >= 0
trigger1 = AnimElem = 14, < 0
pos = -10, -115

[State 820, Bind 5]
type = TargetBind
trigger1 = AnimElem = 14, >= 0
trigger1 = AnimElem = 19, < 0
pos = 20, 0

[State 820, Bind 5]
type = TargetBind
trigger1 = AnimElem = 19, >= 0
trigger1 = AnimElem = 20, < 0
pos = 30, -65

[State 820, Bind 5]
type = Sprpriority
trigger1 = AnimElem = 16
value = -2

[State 820, Bind 5]
type = Sprpriority
trigger1 = AnimElem = 19
value = 1

[State -3, OTG FX]
type = Explod
Trigger1 = AnimElem = 8
trigger2 = AnimElem = 14
Trigger3 = AnimElem = 22
anim = 7910
pos = 125*(Animelem = 14)-100,10
bindtime = 1
ownpal = 1
sprpriority = 4
PauseMoveTime = 99
SuperMoveTime = 99

[State -3, OTG FX]
type = Explod
Trigger1 = AnimElem = 8
trigger2 = AnimElem = 14
Trigger3 = AnimElem = 22
anim = 7920
pos = 125*(Animelem = 14)-100,10
bindtime = 1
ownpal = 1
sprpriority = 3
PauseMoveTime = 99
SuperMoveTime = 99

[State -3, OTG FX]
type = EnvShake
Trigger1 = AnimElem = 8
trigger2 = AnimElem = 14
Trigger3 = AnimElem = 22
Time = 12+2*var(2)
Ampl = -6-var(2)

[State 820, Hurt]
type = TargetLifeAdd
trigger1 = AnimElem = 8
trigger2 = AnimElem = 14
trigger3 = AnimElem = 22
value = -floor((30+7*var(2))*((10-var(5))*.1))
kill = 0

[State 810, Bind 1]
type = PlaySnd
trigger1 = AnimElem = 8
trigger2 = AnimElem = 14
trigger3 = AnimElem = 22
Value = 850, var(2)
Channel = 2

[State 3000, Dream Cancel 2]
type = ChangeState
TriggerAll = power >= 1000+1000*(var(15) = 0)
TriggerAll = AnimElem = 14, > 0
TriggerAll = AnimElem = 20, < 0
Trigger1 = Command = "Ankoku Jigoku Gokuraku Otoshi"
Trigger2 = var(9)
Trigger2 = p2life > 150
Trigger2 = Life < p2life || life < 400 || power > 3000 || var(15)
Trigger2 = AnimElem = 16
Trigger2 = random < 100*var(9)
Value = 3220

[State 810, Bind 1]
type = PosAdd
trigger1 = AnimElem = 26
x = -45

[State 1031, 4]
type = PlaySnd
trigger1 = AnimElem = 26
value = 50,1
channel = 2

[State 810, Bind 1]
type = Velset
trigger1 = AnimElem = 26
x = 2
y = -9-var(2)

[State 810, Bind 1]
type = Gravity
trigger1 = AnimElem = 26, > 0

[State 820, Bind 5]
type = TargetBind
trigger1 = AnimElem = 26, >= 0
trigger1 = AnimElem = 27, < 0
pos = -35, -75

[State 820, Bind 5]
type = TargetBind
trigger1 = AnimElem = 27, >= 0
trigger1 = AnimElem = 28, < 0
pos = -25, -105

[State 820, Bind 5]
type = TargetBind
trigger1 = AnimElem = 28, >= 0
pos = 25, -125

[State 820, State End]
type = ChangeState
trigger1 = AnimElem = 28, >= 0
trigger1 = Pos y >= 0
trigger1 = Vel y > 0
value = 1502

;-----------------------------------
;---- Musebu Daichi - Drop Down ----
;-----------------------------------
[Statedef 1502]
Type = A
MoveType = A
Physics = N
Anim = 1502
VelSet = 0,0
Ctrl = 0
PowerAdd = 0

[State 1000, width]
type = width
Trigger1 = 1
Edge = 20,0

[State 1000, width]
type = TargetState
Trigger1 = !Time
Value = 1506

[State 1000, Posset]
type = Posset
Trigger1 = !Time
y = 0

[State 810, Bind 1]
type = PlaySnd
trigger1 = AnimElem = 1
Value = 1500, 0
Channel = 1

[State 810, Bind 1]
type = PlaySnd
trigger1 = AnimElem = 1
Value = 820, 0
Channel = 3

[State -3, OTG FX]
type = Explod
Trigger1 = AnimElem = 1, = 1
anim = 7910
pos = 20,10
bindtime = 1
ownpal = 1
sprpriority = 4
PauseMoveTime = 99
SuperMoveTime = 99

[State -3, OTG FX]
type = Explod
Trigger1 = AnimElem = 1, = 1
anim = 7920
pos = 20,10
bindtime = 1
ownpal = 1
sprpriority = 3
PauseMoveTime = 99
SuperMoveTime = 99

[State -3, OTG FX]
type = EnvShake
Trigger1 = AnimElem = 1, = 1
Time = 12+2*var(2)
Ampl = -6-var(2)

[State 820, Hurt]
type = TargetLifeAdd
Trigger1 = AnimElem = 1, = 1
value = -floor((30+7*var(2))*((10-var(5))*.1))

[State 810, Bind 1]
type = PlaySnd
Trigger1 = AnimElem = 1, = 1
Value = 850, var(2)
Channel = 4

[State 1000, bind]
type = Targetbind
Trigger1 = AnimElem = 1, >= 0
Trigger1 = AnimElem = 2, < 0
pos = 20,0

[State 1100, Air Velocity]
Type = VelSet
Trigger1 = AnimElem = 2
x = 2
y = -6-1.5*var(2)

[State -3, Jump Sound]
type = PlaySnd
Trigger1 = AnimElem = 2
Value = 50,1
Channel = 2
IgnoreHitPause = 1

[State 1100, Gravity]
Type = Gravity
Trigger1 = AnimElem = 2, > 0

[State 1000, 9]
type = ChangeState
Trigger1 = Vel y > 0
Trigger1 = Pos y >= 0
Trigger1 = AnimElem = 2, > 0
value = 1103

;-----------------------------------
;-------- Musebu Daichi P2 ---------
;-----------------------------------
[Statedef 1505]
Type = A
MoveType = H
Physics = N
VelSet = 0
Ctrl = 0
PowerAdd = 50

[State -1, Cancel Combo]
Type = ChangeAnim2
Trigger1 = !time
Value = 1505


[State 1200, End]
type = ChangeState
Trigger1 = Time > 200
value = 5070

;-----------------------------------
;---- Musebu Daichi P2 dropdown ----
;-----------------------------------
[Statedef 1506]
Type = A
MoveType = H
Physics = N
VelSet = 0
Ctrl = 0
PowerAdd = 50

[State -1, Cancel Combo]
Type = Turn
Trigger1 = !time

[State -1, Cancel Combo]
Type = ChangeAnim2
Trigger1 = !time
Value = 1506

[State -1, Cancel Combo]
Type = Velset
Trigger1 = AnimElem = 2
x = 3.5
y = -5

[State -1, Cancel Combo]
Type = Posadd
Trigger1 = AnimElem = 3
x = 50

[State -1, Cancel Combo]
Type = Veladd
Trigger1 = AnimElem = 2, > 0
y = .5

[State 1200, End]
type = SelfState
Trigger1 = Vel y > 0
Trigger1 = Pos y >= 0
Trigger1 = AnimElem = 2, > 0
value = 5100

;-----------------------------------
;------ Kujiku Daichi Startup ------
;-----------------------------------
[Statedef 1600]
Type = S
MoveType = I
Physics = N
Anim = 1600
Ctrl = 0
PowerAdd = 50
Juggle = 8
Velset = 0,0,0
Sprpriority = 1

[State -1, Cancel Combo]
Type = Varadd
Trigger1 = var(15)
Trigger1 = !time
Trigger1 = prevstateno = [1000, 1900]
IgnoreHitPause = 1
var(15) = -200

[State 3000, PALFX]
type = PalFX
Trigger1 = gametime%2 = 0
Trigger1 = time <= 7
ignorehitpause = 1
Trigger1 = prevstateno = [1000, 1900]
time = 1
add = 255,255,255
sinadd = -100,-100,-100, 2
ignorehitpause = 1

[State 1000, buffer setting1]
Type = varSet
Trigger1 = !Time
Trigger1 = helper(2000),var(1) > helper(2000), var(2)
Trigger1 = helper(2000),var(1) > helper(2000), var(3)
var(2) = 0

[State 1000, buffer setting2]
Type = varSet
Trigger1 = !Time
Trigger1 = helper(2000),var(2) > helper(2000), var(1)
Trigger1 = helper(2000),var(2) > helper(2000), var(3)
var(2) = 1

[State 1000, buffer setting3]
Type = varSet
Trigger1 = !Time
Trigger1 = helper(2000),var(3) > helper(2000), var(1)
Trigger1 = helper(2000),var(3) > helper(2000), var(2)
var(2) = 2

[State 1000, Power Set]
Type = varSet
TriggerAll = !Time
Trigger1 = command="x"
Trigger2 = command="y"
Trigger3 = command="z"
var(2) = IfElse(command = "y",1,IfElse(Command = "z" || var(9),2,0))

[State 1000, AI Power Set]
Type = varSet
Trigger1 = !Time
Trigger1 = var(9)
var(2) = IfElse(p2bodydist x > 160, 2,IfElse(p2bodydist x > 130, 1,0))

[State 1000, Yashiro Voice]
type = PlaySnd
Trigger1 = AnimElem = 2
value = 50,1
Channel = 2

[State 1300, Vel]
Type = StateTypeSet
Trigger1 = AnimElem = 2
StateType = A

[State 1300, Vel]
Type = VelSet
Trigger1 = AnimElem = 2
x = 3+var(2)
y = -7-1.5*var(2)

[State 1300, Gravity]
Type = Veladd
Trigger1 = AnimElem = 2, > 0
y = .4+.05*var(2)

[State 1300, Gravity]
Type = Width
Trigger1 = AnimElem = 2, > 0
Edge = 10,0

[State 1300, Gravity]
Type = PlayerPush
Trigger1 = P2StateType != A
Trigger1 = !var(2)
Value = 0

[State 1200, End]
type = ChangeState
Trigger1 = Vel y > -2
Trigger1 = AnimElem = 2, > 0
value = 1601

;-----------------------------------
;----- Kujiku Daichi descending ----
;-----------------------------------
[Statedef 1601]
Type = A
MoveType = A
Physics = N
Anim = 1601
Ctrl = 0
Juggle  = 8
Sprpriority = 1

[State 1300, Gravity]
Type = PlayerPush
Trigger1 = P2StateType != A
Trigger1 = AnimElem = 2, < 0
Trigger1 = !var(2)
Value = 0

[State 1300, Gravity]
Type = Width
Trigger1 = 1
Edge = 10,0

[State 1300, Gravity]
Type = Veladd
Trigger1 = 1
y = .4+.05*var(2)

[State 800, 1]
type = HitDef
Trigger1 = !var(6)
attr = A, ST
hitflag = M-
priority = 1, Miss
sparkno = -1
sparkxy = -15,-35
HitSound = S800,1
sprpriority = 1
p1facing = 1
p2facing = 1
p1stateno = 1610
p2stateno = 1611
Fall = 0
ID = 1400

[State 200, Over]
Type = ChangeState
Trigger1 = Pos y >= 0
Trigger1 = Vel y >= 0
Value = 1602

;------ Kujiku Daichi landing ------
[Statedef 1602]
Type = S
MoveType = I
Physics = N
Anim = 1602
Ctrl = 0
PowerAdd = 0
VelSet = 0,0

[State 1100, PosSet]
Type = PosSet
Trigger1 = !time
y = 0

[State -3, Landing Sound]
type = PlaySnd
Trigger1 = !Time
Value = 52,0
Channel = 3

[State -3, OTG FX]
type = Explod
Trigger1 = !Time
anim = 8300
pos = 0,0
bindtime = 1
ownpal = 1
sprpriority = -3
PauseMoveTime = 99
SuperMoveTime = 99


[State 1000, 9]
type = ChangeState
Trigger1 = !AnimTime
value = 0
Ctrl = 1

;-----------------------------------
;-- Kujiku Daichi Type 1 succeded --
;-----------------------------------
[Statedef 1610]
Type = S
MoveType = A
Physics = N
Anim = 1610
Ctrl = 0
PowerAdd = 50
SprPriority = 1
Velset = 0,0

[State -3, FX]
type = Explod
Trigger1 = AnimElem = 1, = 1
anim = 8220
pos = 0,0
bindtime = 1
ownpal = 1
Ontop = 1
PauseMoveTime = 99
SuperMoveTime = 99

[State 1031, 4]
type = PlaySND
trigger1 = AnimElem = 1
Value = 1600,0
Channel = 1

[State 1031, 4]
type = Width
trigger1 = AnimElem = 1
edge = 50,0

[State 1400, bindtoTarget]
type = bindtoTarget
trigger1 = AnimElem = 1, >= 0
trigger1 = AnimElem = 8, < 0
pos = 0,5, head


[State 1400, Targetbind]
type = PosSet
trigger1 = AnimElem = 8
y = 0

[State 1400, Targetbind]
type = PosAdd
trigger1 = AnimElem = 8
x = 60

[State 1400, Targetbind]
type = Turn
trigger1 = AnimElem = 9

[State -3, Landing Sound]
type = PlaySnd
trigger1 = AnimElem = 9
Value = 52,0
Channel = 3

[State -3, OTG FX]
type = Explod
trigger1 = AnimElem = 9
anim = 8300
pos = 0,0
bindtime = 1
ownpal = 1
sprpriority = -3
PauseMoveTime = 99
SuperMoveTime = 99

[State 200, Over]
Type = ChangeState
Trigger1 = !Animtime
Trigger1 = var(9)
Value = 1615

[State 200, Over]
Type = ChangeState
Trigger1 = !Animtime
Value = 0
Ctrl = 1

;-----------------------------------
;---- Kujiku Daichi succeded P2 ----
;-----------------------------------
[Statedef 1611]
Type = S
MoveType = H
Physics = S
Ctrl = 0
PowerAdd = 0
SprPriority = -1
Velset = 0,0

[State 1031, 4]
type = ChangeAnim2
trigger1 = !Time
value = 1611

[State 1031, 4]
type = Width
trigger1 = AnimElem = 1
edge = 0,60

[State 1031, 4]
type = Width
trigger1 = AnimElem = 2, > 0
edge = 60,0

[State 200, Over]
Type = SelfState
Trigger1 = !Animtime
Value = 0
Ctrl = 1

;-----------------------------------
;--- Run Fwd After Kujiku Daichi ---
;-----------------------------------
[Statedef 1615]
Type    = S
MoveType = I
Physics = S
Anim = 100
SprPriority = 2
Velset = 0,0
Ctrl = 0

[State 100, Velocity]
Type = VelSet
Trigger1 = AnimElemTime(2) >= 0
x = Const(Velocity.Run.Fwd.x)

[State 100, jump]
Type = ChangeState
trigger1 = !var(9)
Trigger1 = Command = "holdup"
Value = 40

[State 100, Sound]
Type = PlaySnd
Trigger1 = AnimElem = 3  || AnimElem = 7
Value = 100,0
Channel = 3

[State 100, AI End]
type = ChangeState
trigger1 = time >= 8
value = 200

;----------------------------------
;---------- Odoru Daichi ----------
;----------------------------------
[Statedef 1700]
Type = S
MoveType = A
Physics = N
Anim = 1700
Velset = 0,0
Ctrl = 0
PowerAdd = 50
Sprpriority = 1

[State -1, Cancel Combo]
Type = Varadd
Trigger1 = var(15)
Trigger1 = !time
Trigger1 = prevstateno = [1000, 1900]
IgnoreHitPause = 1
var(15) = -200

[State 3000, PALFX]
type = PalFX
Trigger1 = gametime%2 = 0
Trigger1 = time <= 7
ignorehitpause = 1
Trigger1 = prevstateno = [1000, 1900]
time = 1
add = 255,255,255
sinadd = -100,-100,-100, 2
ignorehitpause = 1

[State 1000, buffer setting1]
Type = varSet
Trigger1 = !Time
Trigger1 = helper(2000),var(4) > helper(2000), var(5)
Trigger1 = helper(2000),var(4) > helper(2000), var(6)
var(2) = 0

[State 1000, buffer setting2]
Type = varSet
Trigger1 = !Time
Trigger1 = helper(2000),var(5) > helper(2000), var(4)
Trigger1 = helper(2000),var(5) > helper(2000), var(6)
var(2) = 1

[State 1000, buffer setting3]
Type = varSet
Trigger1 = !Time
Trigger1 = helper(2000),var(6) > helper(2000), var(4)
Trigger1 = helper(2000),var(6) > helper(2000), var(5)
var(2) = 2

[State 1000, Power Set]
Type = varSet
TriggerAll = !Time
Trigger1 = command="a"
Trigger2 = command="b"
Trigger3 = command="c"
var(2) = IfElse(command = "b",1,IfElse(Command = "c",2,0))

[State 1000, Power set]
Type = varSet
Trigger1 = !Time
Trigger1 = var(9)
var(2) = 0

[State 1000, Power set]
Type = ChangeAnim
Trigger1 = !Time
Value = 1700+var(2)

[State 1000, Yashiro Voice]
type = PlaySnd
Trigger1 = AnimElem = 1, = 1
value = 1700,0
Channel = 1

[State 1000, Dash FX]
type = PlaySnd
Trigger1 = AnimElem = 3, = 4
value = 105,0
Channel = 3

[State 1000, Dash]
type = Velset
Trigger1 = AnimElem = 3
x = 10

[State 1000, fricction]
type = VelMul
Trigger1 = AnimElem = 5, >= 0
Trigger1 = AnimElem = 7, < 0
x = .96

[State 1000, Stop]
type = Velset
Trigger1 = AnimElem = 7
x = 0

[State 1000, Yashiro Voice]
type = PlaySnd
Trigger1 = AnimElem = 10
Trigger1 = !var(2)
Trigger2 = AnimElem = 8, = 2
Trigger2 = var(2)
value = 1700,1
Channel = 1

[State 800, 1]
type = HitDef
Trigger1 = p2dist x < 75
Trigger1 = AnimElem = 7
Trigger1 = !var(6)
Trigger1 = PrevStateNo != [200,2000]
attr = S, ST
hitflag = M-
priority = 1, Miss
sparkno = S8220
sparkxy = -15,-70
HitSound = S800,1
sprpriority = 1
p1facing = 1
p2facing = 1
p1stateno = 1710
p2stateno = 1715
Fall = 1
Fall.Recover = 0
ID = 1400

[State 800, 1]
type = HitDef
Trigger1 = p2dist x < 75
Trigger1 = !var(19)
Trigger1 = AnimElem = 7
Trigger1 = PrevStateNo = [200,2000]
attr = S, ST
hitflag = M
priority = 1, Miss
sparkno = S8220
sparkxy = -15,-70
HitSound = S800,1
sprpriority = 1
p1facing = 1
p2facing = 1
p1stateno = 1710
p2stateno = 1715
Fall = 1
Fall.Recover = 0
ID = 1400

[State 200, Over]
Type = ChangeState
Trigger1 = !Animtime
Value = 0
Ctrl = 1

;-----------------------------------
;----- Odoru Daichi p1 jumping -----
;-----------------------------------
[Statedef 1710]
Type = A
MoveType = A
Physics = N
Anim = 1710
Ctrl = 0
PowerAdd = 70
SprPriority = 1
Velset = 0,0

[State 1400, Width]
type = Width
trigger1 = !Time
edge = 60,0

[State 1400, Targetbind]
type = Targetbind
trigger1 = AnimElem = 1, >= 0
trigger1 = AnimElem = 2, < 0
pos = 20,0

[State 1400, PosAdd]
type = PosAdd
trigger1 = AnimElem = 2
x = 50

[State 1400, Targetbind]
type = Targetbind
trigger1 = AnimElem = 2, >= 0
trigger1 = AnimElem = 3, < 0
pos = -30,0

[State 1400, PosAdd]
type = PosAdd
trigger1 = AnimElem = 3
x = 10

[State 1400, Targetbind]
type = Targetbind
trigger1 = AnimElem = 3, >= 0
trigger1 = AnimElem = 4, < 0
pos = -40,0

[State 1400, Velset]
type = Velset
trigger1 = AnimElem = 4
x = 3
y = -7-2.5*var(2)

[State 1031, 4]
type = PlaySnd
trigger1 = AnimElem = 4
value = 50,1
channel = 2

[State 1400, Targetbind]
type = Targetbind
trigger1 = AnimElem = 4, >= 0
pos = -20,-70

[State 1400, Targetbind]
type = Gravity
trigger1 = AnimElem = 4, >= 0

[State 200, Over]
Type = ChangeState
trigger1 = AnimElem = 4, >= 0
trigger1 = vel y > -3
Value = 1711

;-----------------------------------
;----- Odoru Daichi descending -----
;-----------------------------------
[Statedef 1711]
Type = A
MoveType = A
Physics = N
Anim = 1711
Ctrl = 0
PowerAdd = 0
SprPriority = 1

[State 1400, Width]
type = Width
trigger1 = 1
edge = 30,0

[State 1400, TargetState]
type = TargetState
trigger1 = !Time
Value = 1716

[State 1400, Targetbind]
type = Targetbind
trigger1 = AnimElem = 1, >= 0
trigger1 = AnimElem = 2, < 0
pos = 5,-85

[State 1400, Targetbind]
type = Targetbind
trigger1 = AnimElem = 2, >= 0
pos = 20,-80

[State 1400, Targetbind]
type = Gravity
trigger1 = 1

[State 200, Over]
Type = ChangeState
trigger1 = AnimElem = 2, > 0
trigger1 = Pos Y >= 0
Value = 1712

;-----------------------------------
;------ Odoru Daichi dropdown ------
;-----------------------------------
[Statedef 1712]
Type = A
MoveType = A
Physics = N
Anim = 1712+(var(2) > 0)
Ctrl = 0
PowerAdd = 0
SprPriority = 1
velset = 0,0,0

[State 1400, Width]
type = Width
trigger1 = 1
edge = 30,0

[State 1400, TargetState]
type = TargetState
trigger1 = !Time
Value = 1717

[State 1400, Targetbind]
type = Targetbind
trigger1 = AnimElem = 1, >= 0
trigger1 = AnimElem = 3, < 0
pos = 35,-10

[State 1000, Posset]
type = Posset
Trigger1 = !Time
y = 0

[State 810, Bind 1]
type = PlaySnd
trigger1 = AnimElem = 1, = 1
Value = 850, var(2)
Channel = 3

[State -3, OTG FX]
type = Explod
Trigger1 = AnimElem = 1, = 1
anim = 7910
pos = 35,10
bindtime = 1
ownpal = 1
sprpriority = 4
PauseMoveTime = 99
SuperMoveTime = 99

[State -3, OTG FX]
type = Explod
Trigger1 = AnimElem = 1, = 1
anim = 7920
pos = 35,10
bindtime = 1
ownpal = 1
sprpriority = 3
PauseMoveTime = 99
SuperMoveTime = 99

[State -3, OTG FX]
type = EnvShake
Trigger1 = AnimElem = 1, = 1
Time = 14+3*var(2)
Ampl = -6-var(2)

[State 820, Hurt]
type = TargetLifeAdd
Trigger1 = AnimElem = 1, = 1
value = -floor((125+25*var(2))*((10-var(5))*.1))

[State 3000, Dream Cancel 2]
type = ChangeState
TriggerAll = power >= 1000+1000*(!var(15))
TriggerAll = AnimElem = 2, > 0
TriggerAll = AnimElem = 4, < 0
Trigger1 = Command = "Araburu Daichi 97"
Trigger2 = var(9)
Trigger2 = p2life > 150
Trigger2 = random < 100*var(9)
Trigger2 = Life < p2life || life < 400 || power > 3000 || var(15)
Trigger2 = AnimElem = 2, = 4
Value = 3405

[State 1000, PosAdd]
type = PosAdd
Trigger1 = AnimElem = 4
x = 30

[State 1031, 4]
type = PlaySnd
Trigger1 = var(2) > 0
Trigger1 = AnimElem = 5
value = 50,1
channel = 2

[State 1000, Velset]
type = Velset
Trigger1 = var(2) > 0
Trigger1 = AnimElem = 5
x = 2.5
y = -5-2*var(2)

[State 1000, Gravity]
type = Gravity
Trigger1 = var(2) > 0
Trigger1 = AnimElem = 5, > 0

[State 1000, PosAdd]
type = PosAdd
TriggerAll = !var(2)
Trigger1 = AnimElem = 5
Trigger2 = AnimElem = 6
x = 20

[State 1000, PosAdd]
type = PosAdd
TriggerAll = !var(2)
Trigger1 = AnimElem = 7
x = 11

[State 200, Over]
Type = ChangeState
trigger1 = !AnimTime
trigger1 = !var(2)
trigger2 = AnimElem = 5, > 0
trigger2 = pos y >= 0
trigger2 = vel y > 0
trigger2 = var(2)
Value = ifelse(var(2), 1103, 0)
Ctrl = (!var(2))

;-----------------------------------
;--------- Odoru Daichi P2 ---------
;-----------------------------------
[Statedef 1715]
Type = A
MoveType = H
Physics = N
VelSet = 0
Ctrl = 0
PowerAdd = 50

[State -1, Cancel Combo]
Type = ChangeAnim2
Trigger1 = !time
Value = 1715

[State 1200, End]
type = SelfState
Trigger1 = Time > 120
value = 5070

;-----------------------------------
;--- Odoru Daichi P2 descending ----
;-----------------------------------
[Statedef 1716]
Type = A
MoveType = H
Physics = N
VelSet = 0
Ctrl = 0
PowerAdd = 0

[State -1, Cancel Combo]
Type = ChangeAnim2
Trigger1 = !time
Value = 1716

[State 1200, End]
type = SelfState
Trigger1 = Time > 120
value = 5070

;-----------------------------------
;---- Odoru Daichi P2 dropdown ----
;-----------------------------------
[Statedef 1717]
Type = A
MoveType = H
Physics = N
VelSet = 0
Ctrl = 0
PowerAdd = 0

[State -1, Cancel Combo]
Type = ChangeAnim2
Trigger1 = !time
Value = 1717

[State -1, Cancel Combo]
Type = Velset
Trigger1 = AnimElem = 2
x = -3.5
y = -5

[State -1, Cancel Combo]
Type = Posadd
Trigger1 = AnimElem = 4
x = -50

[State -1, Cancel Combo]
Type = Veladd
Trigger1 = AnimElem = 2, > 0
y = .5

[State 1200, End]
type = SelfState
Trigger1 = Vel y > 0
Trigger1 = Pos y >= 0
Trigger1 = AnimElem = 2, > 0
value = 5100

;============================================================================
; Danger Moves/Super Danger Moves
;============================================================================
;-----------------------------------
;---------- Final Impact -----------
;-----------------------------------
[Statedef 3000]
Type = S
MoveType = A
Physics = N
Anim = 3000+10*var(1)
VelSet = 0
Ctrl = 0
PowerAdd = 0
Juggle = 8

[State 3000,SCancel1]
type = Explod
trigger1 = time =10 && prevstateno = [1000,2000]
anim = 11100+10*(prevstateno = 1000)
pos = 65,75
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -1
bindtime = -1
ownpal = 1
removeongethit = 1

[State 3000,SCancel2]
type = Explod
trigger1 = !time && prevstateno = [1000,2000]
anim = 11101
pos = 0,75
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -2
bindtime = -1
ownpal = 1
removeongethit = 1

[State 3000,SCancel3]
type = Explod
trigger1 = !time && (prevstateno = [1010,2000])
anim = 11102
pos = 0,75
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -3
bindtime = -1
ownpal = 1
removeongethit = 1

[State -1, Cancel Combo]
Type = Poweradd
Trigger1 = !time
Trigger1 = prevstateno = [1000, 1900]
IgnoreHitPause = 1
value = -1000

[State 3000, PALFX]
type = PalFX
Trigger1 = timemod = 2,0
Trigger1 = time <= 15
ignorehitpause = 1
Trigger1 = prevstateno = [1000, 1900]
time = 1
add = 255,255,255
sinadd = -100,-100,-100, 2
ignorehitpause = 1

[State 3000, SDM Set]
Type = AssertSpecial
Trigger1 = AnimElem = 1, = 1
Flag = NoBG
Flag2 = NoFG
time = 26+16*(PrevStateNo = [1000, 2000])

[State 3000, SDM Set]
Type = EnvColor
Trigger1 = AnimElem = 1, = 1
Value = 255*(prevstateno = 1000),0,0
Under = 1
time = 26+16*(PrevStateNo = [1000, 2000])

[State 3000, SDM Set]
Type = varSet
Trigger1 = !Time
var(2) = 0

[State 3000, Power Charging set]
Type = varSet
Trigger1 = !Time
var(4) = 0

[State 3000, SDM Set]
Type = varSet
TriggerAll = !Time
TriggerAll = Power >= 1000+1000*var(51)
TriggerAll = var(15) || var(51)
Trigger1 = Command = "2punches"
Trigger2 = helper(2000), var(7)
Trigger3 = var(9)
Trigger3 = p2Life > 200
var(2) = 1

[State 3000, SDM Set]
Type = BgPalFx
Trigger1 = var(2)
InvertAll = 1
Color = 6
Time = 3
IgnoreHitPause = 1

[State 3000, SDM Set]
Type = PowerAdd
Trigger1 = !Time
Trigger1 = !var(15)
value = -1000

[State 3000, SDM Set]
Type = VarSet
Trigger1 = !Time
Trigger1 = var(15)
var(15) = 1

[State 3000, DM Pause]
type = superpause
trigger1 = animelem = 1, = 1
time = 26+16*(PrevStateNo = [1000, 2000])
anim = -1
darken = 1
poweradd = -1000*var(2)
movetime = 26
persistent = 0
ontop = 1
p2defmul = 1

[State 3000, DM FX Sound]
type = PlaySnd
Trigger1 = AnimElem = 1, = 1
Value = 8000, var(2)
Channel = 5
IgnoreHitPause = 1

[State 3000, DM FX1]
Type = Explod
trigger1 = animelem = 1, = 1
anim = 8100+10*var(2)
PosType = p1
Ownpal = 1
SprPriority = -2
BindTime = -1
IgnoreHitPause = 1
Pos = -15,-65*(!var(1))
RemoveOnGetHit = 1
PauseMoveTime = 99
SuperMoveTime = 99

[State 3000, DM FX 2]
Type = Explod
trigger1 = animelem = 1, = 1
anim = 8101+10*var(2)
PosType = p1
Ownpal = 1
SprPriority = 2
BindTime = -1
IgnoreHitPause = 1
Pos = -15,-65*(!var(1))
RemoveOnGetHit = 1
PauseMoveTime = 99
SuperMoveTime = 99

[State 1000, Yashiro Voice1]
type = PlaySnd
Trigger1 = !var(1)
Trigger1 = AnimElem = 1, = 1
value = 3000,0
Channel = 1

[State 3000, DM GND FX]
Type = Explod
trigger1 = animelem = 4, = 2
trigger1 = !var(1)
trigger2 = animelem = 5
trigger2 = var(1)
anim = 3050+var(2)
ID = 3050
PosType = p1
Ownpal = 1
SprPriority = -2
BindTime = -1
RemoveTime = -1
RemoveOnGetHit = 1
IgnoreHitPause = 1
Pos = -20*var(1), 5*var(1)

[State 3000, DM GND FX]
Type = Explod
trigger1 = animelem = 5
trigger1 = var(1)
anim = 3060+var(2)
ID = 3060
PosType = p1
Ownpal = 1
SprPriority = 5
BindTime = -1
RemoveTime = -1
RemoveOnGetHit = 1
IgnoreHitPause = 1
Pos = -20*var(1), 5*var(1)

[State 191, 1]
Type = PlaySnd
trigger1 = animelem = 4, = 2
trigger1 = !var(1)
trigger2 = animelem = 4, = 62
trigger2 = !var(1)
trigger3 = animelem = 8, = 2
trigger3 = var(1)
trigger4 = animelem = 8, = 62
trigger4 = var(1)
Value = 191, 0
Channel = 3

[State 191, 1]
Type = PlaySnd
trigger1 = animelem = 8, = 2
trigger1 = var(1)
Value = 770, 0
Channel = 1

[State 1000, Building Power]
type = VarAdd
TriggerAll = !var(1)
Trigger1 = AnimElem = 9
Trigger2 = AnimElem = 17
Trigger3 = AnimElem = 31
Trigger4 = !AnimTime
var(4) = 1

[State 1000, Building Power]
type = VarAdd
TriggerAll = var(1)
Trigger1 = AnimElem = 12
Trigger2 = AnimElem = 24
Trigger3 = AnimElem = 36
Trigger4 = !AnimTime
var(4) = 1

[State 1000, 9]
type = ChangeState
TriggerAll = var(9)
Trigger1 = !var(1)
trigger1 = AnimElem = 4, > 0
Trigger1 = p2bodydist y > -75-15*var(2)
Trigger1 = EnemyNear, vel y > 0
Trigger2 = !var(1)
trigger2 = AnimElem = 4, > 0
Trigger2 = p2StateType != A
Trigger2 = prevStateNo = [200,599]
Trigger3 = var(1)
trigger3 = AnimElem = 20
trigger3 = Numtarget
value = 3001

[State 1000, 9]
type = ChangeState
Trigger1 = !var(9)
Trigger1 = var(1)
trigger1 = AnimElem = 8, > 0
trigger1 = Command != "holdx"
trigger1 = Command != "holdy"
trigger1 = Command != "holdz"
value = 3001

[State 1000, 9]
type = ChangeState
Trigger1 = !var(9)
Trigger1 = !var(1)
trigger1 = AnimElem = 4, > 0
trigger1 = Command != "holdx"
trigger1 = Command != "holdy"
trigger1 = Command != "holdz"
trigger2 = !AnimTime
value = 3001

;-----------------------------------
;------ Final Impact Release -------
;-----------------------------------
[Statedef 3001]
Type = S
MoveType = A
Physics = S
Anim = 3001+var(2)
VelSet = 12*(!var(1)), 0
Ctrl = 0
PowerAdd = 0
Juggle = 8

[State 3000, DM GND FX]
Type = ChangeAnim
trigger1 = !Time
trigger1 = var(1)
Value = 3011

[State 3000, DM GND FX]
Type = RemoveExplod
trigger1 = !Time
ID = 3050

[State 3000, DM GND FX]
Type = RemoveExplod
trigger1 = !Time
ID = 3060

[State 191, 1]
Type = PlaySnd
trigger1 = !var(1)
trigger1 = !Time
trigger2 = var(1)
trigger2 = AnimElem = 8
Value = 3000, 2+var(1)
Channel = 3

[State 3000, After]
type = AfterImage
trigger1 = !var(1)
trigger1 = !time
time = 2
palmul = .65,.65,.75
palbright = 30,30,30
palcontrast = 120,120,220
timegap = 1
framegap = 5
Trans = add1
color = 6

[State 3020, After Set]
type = AfterImagetime
trigger1 = !var(1)
trigger1 = AnimElem = 5, < 0
time = 2
ignorehitpause=1

[State 3000, After]
type = PosAdd
triggerAll = !var(1)
trigger1 = AnimElem = 2
trigger2 = AnimElem = 3
x = 15+5*(AnimElem = 3)

[State 3000, After]
type = Velset
trigger1 = !var(1)
trigger1 = AnimElem = 5
x = 0

[State 3000, SDM Set]
Type = BgPalFx
Trigger1 = var(2)
InvertAll = 1
Color = 6
Time = 3
IgnoreHitPause = 1


[State 3000, DM FX Sound]
type = PlaySnd
trigger1 = !var(1)
Trigger1 = AnimElem = 3
trigger2 = var(1)
Trigger2 = AnimElem = 8
Value = 3000+100*var(1), (!var(1))
Channel = 1
IgnoreHitPause = 1

[State 1000, 3]
type = HitDef
trigger1 = !var(1)
trigger1 = var(4) < 4
trigger1 = AnimElem = 3
attr = S, HA
damage = 250+50*var(4)+150*var(2), 25+5*var(4)+15*var(2)
animtype = DiagUp
getpower = 0,0
givepower = 120,60
guardflag = M
hitflag = MA
pausetime = 17,17
sparkno = S8002
guard.sparkno = S8050
sparkxy = -15,-70
hitsound = S5,7
guardsound = S6,0
ground.type = High
air.type = high
ground.slidetime = 17
ground.hittime  = 17
air.hittime = 30
guard.slidetime = 17
guard.hittime = 17
guard.ctrltime = 17
ground.velocity = -5, -6.5
air.velocity = -5,-5.5
Fall = 1
Fall.Recover = 0
Envshake.Time = 25
EnvShake.Ampl = 8
yAccel = .5

[State 1000, 3]
type = HitDef
trigger1 = !var(1)
trigger1 = var(4) >= 4
trigger1 = AnimElem = 3
attr = S, HA
damage = 400+150*var(2), 40+15*var(2)
animtype = DiagUp
getpower = 0,0
givepower = 120,60
guardflag =
hitflag = MA
pausetime = 17,17
sparkno = S8002
guard.sparkno = S8050
sparkxy = -15,-70
hitsound = S5,7
guardsound = S6,0
ground.type = High
air.type = high
ground.slidetime = 17
ground.hittime  = 17
air.hittime = 30
guard.slidetime = 17
guard.hittime = 17
guard.ctrltime = 17
ground.velocity = -5, -6.5
air.velocity = -5,-5.5
Fall = 1
Fall.Recover = 0
Envshake.Time = 25
EnvShake.Ampl = 8
yAccel = .5

[State 1000, 3]
type = Projectile
trigger1 = var(1)
trigger1 = var(4) < 4
trigger1 = AnimElem = 7, = 1
attr = S, HP
ProjAnim = 3070+var(2)
ProjHitAnim = 3070+var(2)
ProjCancelAnim = 3070+var(2)
ProjRemAnim = 3070+var(2)
Projremove = 0
ProjremoveTime = 21
ProjPriority = 9999
damage = 300+50*var(4)+150*var(2), 25+5*var(4)+15*var(2)
animtype = Back
getpower = 0,0
givepower = 120,60
guardflag = M
hitflag = MA
pausetime = 3,12
sparkno = S8002
guard.sparkno = S8050
sparkxy = floor(p2dist x)+15,-90
hitsound = S5,7
guardsound = S6,0
ground.type = High
air.type = Low
ground.slidetime = 17
ground.hittime  = 17
air.hittime = 30
guard.slidetime = 17
guard.hittime = 17
guard.ctrltime = 17
ground.velocity = -3.5, -7.5
air.velocity = -3.5,-6.5
Fall = 1
Fall.Recover = 0
Envshake.Time = 25
EnvShake.Ampl = 8
yAccel = .5
ProjID = 3200
ID = 3200

[State 1000, 3]
type = Projectile
trigger1 = var(1)
trigger1 = var(4) >= 4
trigger1 = AnimElem = 7, = 1
attr = S, HP
ProjAnim = 3070+var(2)
ProjHitAnim = 3070+var(2)
ProjCancelAnim = 3070+var(2)
ProjRemAnim = 3070+var(2)
Projremove = 0
ProjremoveTime = 21
ProjPriority = 9999
damage = 500+150*var(2), 40+15*var(2)
animtype = DiagUp
getpower = 0,0
givepower = 120,60
guardflag =
hitflag = MA
pausetime = 3,12
sparkno = S8002
guard.sparkno = S8050
sparkxy = floor(p2dist x)+15,-90
hitsound = S5,7
guardsound = S6,0
ground.type = High
air.type = Low
ground.slidetime = 17
ground.hittime  = 17
air.hittime = 30
guard.slidetime = 17
guard.hittime = 17
guard.ctrltime = 17
ground.velocity = -5,-6.5
air.velocity = -5,-5.5
Fall = 1
Fall.Recover = 0
Envshake.Time = 25
EnvShake.Ampl = 8
yAccel = .6
ProjID = 3200
ID = 3200

[State 1000, 9]
type = EnvColor
trigger1 = MoveHit
trigger2 = ProjHit(3200) = 1
value = 255,255,255
time = 5
under = 1
IgnoreHitPause = 1
Persistent = 0

[State 3000,  Dream Cancel]
type = ChangeState
TriggerAll = power >= 3000
triggerAll = ProjHit(3200) = 1, = [1,30]
TriggerAll = Life <= Const(Data.Life)/4
TriggerAll = !var(2)
TriggerAll = var(4) <= 3
Trigger1 = Command = "Armageddon"
Trigger2 = helper(2000), var(10)
Trigger3 = var(9)
trigger3 = ProjHit(3200) = 1, = 4
Trigger3 = p2life > 250
Value = 4100

[State 1000, 9]
type = ChangeState
trigger1 = !AnimTime
value = 0
ctrl = 1


;-----------------------------------
;------- Million Bash Stream -------
;-----------------------------------
[Statedef 3100]
Type = S
MoveType = A
Physics = S
Anim = 3100
VelSet = 0,0
Ctrl = 0
PowerAdd = 0
Juggle = 8

[State 3000,SCancel1]
type = Explod
trigger1 = time =10 && prevstateno = [1000,2000]
anim = 11100+10*(prevstateno = 1000)
pos = 65,75
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -1
bindtime = -1
ownpal = 1
removeongethit = 1

[State 3000,SCancel2]
type = Explod
trigger1 = !time && prevstateno = [1000,2000]
anim = 11101
pos = 0,75
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -2
bindtime = -1
ownpal = 1
removeongethit = 1

[State 3000,SCancel3]
type = Explod
trigger1 = !time && (prevstateno = [1010,2000])
anim = 11102
pos = 0,75
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -3
bindtime = -1
ownpal = 1
removeongethit = 1

[State -1, Cancel Combo]
Type = Poweradd
Trigger1 = !time
Trigger1 = prevstateno = [1000, 1900]
IgnoreHitPause = 1
value = -1000

[State 3000, PALFX]
type = PalFX
Trigger1 = timemod = 2,0
Trigger1 = time <= 15
ignorehitpause = 1
Trigger1 = prevstateno = [1000, 1900]
time = 1
add = 255,255,255
sinadd = -100,-100,-100, 2
ignorehitpause = 1

[State 3000, SDM Set]
Type = AssertSpecial
Trigger1 = AnimElem = 1, = 1
Flag = NoBG
Flag2 = NoFG
time = 26+16*(PrevStateNo = [1000, 2000])

[State 3000, SDM Set]
Type = EnvColor
Trigger1 = AnimElem = 1, = 1
Value = 255*(prevstateno = 1000),0,0
Under = 1
time = 26+16*(PrevStateNo = [1000, 2000])

[State 3000, After]
type = AfterImage
trigger1 = AnimElem = 5
time = 2
palmul = .65,.65,.75
palbright = 30,30,30
palcontrast = 120,120,220
timegap = 1
framegap = 4
Trans = add1
color = 0

[State 3020, After Set]
type = AfterImagetime
trigger1 = 1
time = 2
ignorehitpause = 1

[State 3000, SDM Set]
Type = varSet
Trigger1 = !Time
var(2) = 0

[State 3000, SDM Set]
Type = varSet
TriggerAll = !Time
TriggerAll = Power >= 1000+1000*var(51)
TriggerAll = var(15) || var(51)
Trigger1 = Command = "2punches"
Trigger2 = helper(2000), var(7)
Trigger3 = var(9)
Trigger3 = p2Life > 300
var(2) = 1

[State 3000, SDM Set]
Type = ChangeAnim
Trigger1 = !Time
Trigger1 = var(2)
value = 3101

[State 3000, SDM Set]
Type = BgPalFx
Trigger1 = var(2)
InvertAll = 1
Color = 6
Time = 3
IgnoreHitPause = 1

[State 3000, SDM Set]
Type = PowerAdd
Trigger1 = !Time
Trigger1 = !var(15)
value = -1000

[State 3000, SDM Set]
Type = VarSet
Trigger1 = !Time
Trigger1 = var(15)
var(15) = 1

[State 3000, DM Pause]
type = superpause
trigger1 = animelem = 1, = 1
time = 26+16*(PrevStateNo = [1000, 2000])
anim = -1
pos = -10,-130
darken = 1
poweradd = -1000*var(2)
movetime = 26
persistent = 0
ontop = 1
p2defmul = 1

[State 3000, DM FX Sound]
type = PlaySnd
Trigger1 = AnimElem = 1, = 1
Value = 8000, var(2)
Channel = 5
IgnoreHitPause = 1

[State 3000, DM FX1]
Type = Explod
trigger1 = animelem = 1, = 1
anim = 8100+10*var(2)
PosType = p1
Ownpal = 1
SprPriority = -2
BindTime = -1
IgnoreHitPause = 1
Pos = -25,-100
RemoveOnGetHit = 1
PauseMoveTime = 99
SuperMoveTime = 99

[State 3000, DM FX 2]
Type = Explod
trigger1 = animelem = 1, = 1
anim = 8101+10*var(2)
PosType = p1
Ownpal = 1
SprPriority = 2
BindTime = -1
IgnoreHitPause = 1
Pos = -25,-100
RemoveOnGetHit = 1
PauseMoveTime = 99
SuperMoveTime = 99

[State 1000, Yashiro Voice1]
type = PlaySnd
Trigger1 = AnimElem = 3
value = 3100,0
Channel = 1

[State 1000, Move Sound]
type = PlaySnd
trigger1 = AnimElem = 7
trigger2 = AnimElem = 12
trigger3 = AnimElem = 19
trigger4 = AnimElem = 24
value = 1,1
Channel = 3

[State 3100, Velset]
type = VelSet
trigger1 = AnimElem = 7
trigger2 = AnimElem = 12
trigger3 = AnimElem = 19
trigger4 = AnimElem = 24
x = 7

[State 200, Hitdef]
Type = HitDef
Trigger1 = AnimElem = 9
Trigger2 = AnimElem = 21
attr = S, HA
damage = 25-5*var(2),2-var(2)
AnimType = Heavy
getpower = 0,0
givepower = 10,5
Guardflag = MA
Hitflag = MA
pauseTime = 8-4*var(2),10-4*var(2)
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,-90
HitSound = S5,6
GuardSound = S6,0
ground.Type = Low
ground.SlideTime = 17
ground.HitTime = 17
ground.Velocity = 0
Air.Velocity = -4,-5
yAccel = .5
Ground.CornerPush.Veloff = 0
Air.CornerPush.Veloff = 0
Air.Fall = 1
Fall.Recover = !var(55)
Fall.RecoverTime = 42

[State 200, Hitdef]
Type = HitDef
Trigger1 = AnimElem = 13
Trigger2 = AnimElem = 25
attr = S, HA
damage = 25-5*var(2),2-var(2)
AnimType = Heavy
getpower = 0,0
givepower = 10,5
Guardflag = MA
Hitflag = MA
pauseTime = 8-4*var(2),10-4*var(2)
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,-65
HitSound = S5,6
GuardSound = S6,0
ground.Type = High
ground.SlideTime = 17
ground.HitTime = 17
ground.Velocity = 0
Air.Velocity = -4,-5
yAccel = .5
Ground.CornerPush.Veloff = 0
Air.CornerPush.Veloff = 0
Air.Fall = 1
Fall.Recover = !var(55)
Fall.RecoverTime = 42

[State 1000, 9]
type = EnvColor
trigger1 = MoveHit
value = 255,255,255
time = 1
Under = 1
IgnoreHitPause = 1

[State 1000, Mash code 1]
type = Varset
trigger1 = !Time
var(4) = 0

[State 1000, Mash code 2]
type = VarSet
triggerAll = !var(4)
triggerAll = AnimElem = 17, > 0
trigger1 = Command = "mashing punches"
trigger2 = var(9)
var(4) = 1

[State 3000,  Dream Cancel]
type = ChangeState
Trigger1 = MoveContact
Trigger1 = power >= 3000
Trigger1 = Command = "[ERROR] CODE 2002" || helper(2000), var(10)
Trigger1 = Life <= Const(Data.Life)/4
Trigger1 = !var(2)
Value = 4000

[State 1000, 9]
type = MoveHitReset
trigger1 = MoveContact

[State 1000, 9]
type = ChangeState
trigger1 = !AnimTime
value = ifelse(var(4), 3101,3102)

;-----------------------------------
; Million Bash Stream mashing hits -
;-----------------------------------
[Statedef 3101]
Type = S
MoveType = A
Physics = S
Anim = 3110
Ctrl = 0
PowerAdd = 0
Juggle = 8

[State 3020, After Set]
type = AfterImagetime
trigger1 = 1
time = 2
ignorehitpause = 1

[State 3000, SDM Set]
Type = BgPalFx
Trigger1 = var(2)
InvertAll = 1
Color = 6
Time = 3
IgnoreHitPause = 1

[State 1000, Power Set]
Type = varSet
Trigger1 = !Time
var(4) = 0

[State 1000, Power Set]
Type = ChangeAnim
Trigger1 = !Time
Trigger1 = var(2)
value = 3111

[State 1200, Speed]
Type = VelSet
Trigger1 = AnimElem = 3
Trigger2 = AnimElem = 8
x = 7

[State 1200, FX Snd]
Type = PlaySnd
Trigger1 = AnimElem = 3
Trigger2 = AnimElem = 8
Value = 1, 1
Channel = 3

[State 200, Hitdef]
Type = HitDef
Trigger1 = AnimElem = 5
attr = S, HA
damage = 20-5*var(2),2-var(2)
AnimType = Heavy
getpower = 0,0
givepower = 10,5
Guardflag = MA
Hitflag = MA
pauseTime = 8-4*var(2),10-4*var(2)
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,-90
HitSound = S5,6
GuardSound = S6,0
ground.Type = Low
ground.SlideTime = 17
ground.HitTime = 17
ground.Velocity = 0
Air.Velocity = -4,-5
yAccel = .5
Ground.CornerPush.Veloff = 0
Air.CornerPush.Veloff = 0
Air.Fall = 1
Fall.Recover = !var(55)
Fall.RecoverTime = 42

[State 200, Hitdef]
Type = HitDef
Trigger1 = AnimElem = 9
attr = S, HA
damage = 20-5*var(2),2-var(2)
AnimType = Heavy
getpower = 0,0
givepower = 10,5
Guardflag = MA
Hitflag = MA
pauseTime = 8-4*var(2),10-4*var(2)
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,-65
HitSound = S5,6
GuardSound = S6,0
ground.Type = High
ground.SlideTime = 17
ground.HitTime = 17
ground.Velocity = 0
Air.Velocity = -4,-5
yAccel = .5
Ground.CornerPush.Veloff = 0
Air.CornerPush.Veloff = 0
Air.Fall = 1
Fall.Recover = !var(55)
Fall.RecoverTime = 42

[State 1000, 9]
type = EnvColor
trigger1 = MoveHit
value = 255,255,255
time = 1
Under = 1
IgnoreHitPause = 1

[State 1000, ADD MOAR HITS!!!]
Type = varadd
TriggerAll = var(4) < 4+4*var(2)
trigger1 = Command = "mashing punches"
trigger2 = var(9)
var(4) = 1

[State 3000,  Dream Cancel]
type = ChangeState
TriggerAll = MoveContact
TriggerAll = power >= 3000
TriggerAll = Life <= Const(Data.Life)/4
TriggerAll = !var(2)
Trigger1 = Command = "[ERROR] CODE 2002"
Trigger2 = helper(2000), var(10)
Trigger3 = var(9)
Trigger3 = Time > 48
Value = 4000

[State 1000, Reset]
Type = MoveHitReset
trigger1 = MoveContact

[State 1200, End]
Type = ChangeState
TriggerAll = !AnimTime
Trigger1 = Time >= 27*var(4)
Trigger1 = !var(2)
Trigger2 = Time >= 12*var(4)
Trigger2 = var(2)
Value = 3102

;----------------------------------
;-- Million Bash Stream Finisher --
;----------------------------------
[Statedef 3102]
Type = S
MoveType = A
Physics = N
Anim = 3120
VelSet = 0
Ctrl = 0
PowerAdd = 0
Juggle = 8

[State 3000, SDM Set]
Type = BgPalFx
Trigger1 = var(2)
InvertAll = 1
Color = 6
Time = 3
IgnoreHitPause = 1

[State 1100, Yashiro Voice]
type = PlaySnd
Trigger1 = AnimElem = 1, = 1
value = 1200,1
Channel = 1

[State 1100, Yashiro Voice]
type = PlaySnd
Trigger1 = AnimElem = 3
value = 1,2
Channel = 3


[State 1100, First Hit]
Type = HitDef
Trigger1 = AnimElem = 3
Trigger1 = var(2)
Trigger2 = AnimElem = 4
Trigger2 = !var(2)
attr = S, HA
damage    = 157,16
animtype = Heavy
fall.animtype = Back
getpower = 0,0
givepower = 30,15
guardflag = M
hitflag = MA
pausetime = 26,26
sparkno = S8002
guard.sparkno = S8012
sparkxy = -15,-75
hitsound = S5,6
guardsound = S6,0
ground.type = Low
ground.slidetime = 22
ground.hittime  = 22
ground.velocity = -9.5
ground.CornerPush.Veloff = 0
guard.CornerPush.Veloff = 0
air.velocity = -2,-.5
yAccel = .5
Fall = (!var(2))
Air.Fall = 1
Fall.Recover = !var(55)
Fall.RecoverTime = 35
EnvShake.Time = 25
P2Facing = 1

[State 1000, 9]
type = TargetState
trigger1 = MoveHit
trigger1 = !var(2)
value = 3150
ignoreHitpause = 1
Persistent = 0


[State 1000, 9]
type = EnvColor
trigger1 = MoveHit
value = 255,255,255
time = 18
Under = 1
IgnoreHitPause = 1
persistent = 0

[State 1000, 9]
type = ChangeState
Trigger1 = MoveContact
Trigger1 = var(2)
value = 3103

[State 1000, Reset]
Type = MoveHitReset
trigger1 = MoveContact

[State 1000, 9]
type = ChangeState
Trigger1 = !AnimTime
value = 0
Ctrl = 1

;-----------------------------------
; Million Bash Stream SDM Finisher -
;-----------------------------------
[Statedef 3103]
Type = S
MoveType = A
Physics = N
Anim = 1110
VelSet = 0
Ctrl = 0
PowerAdd = 0
Juggle = 0

[State 3000, SDM Set]
Type = BgPalFx
Trigger1 = var(2)
InvertAll = 1
Color = 6
Time = 3
IgnoreHitPause = 1

[State 3020, After Set]
type = AfterImagetime
trigger1 = 1
time = 2
ignorehitpause = 1

[State 1100, First Hit]
Type = HitDef
Trigger1 = AnimElem = 3
attr = S, HA
damage    = 100,10
animtype = Heavy
Fall.animtype = Heavy
getpower = 0,0
givepower = 10,5
guardflag = M
hitflag = MA
pausetime = 25,27
sparkno = S8002
guard.sparkno = S8012
sparkxy = -15,-60
hitsound = S5,6
guardsound = S6,0
ground.type = High
ground.slidetime = 17
ground.hittime  = 17
guard.slidetime = 17
guard.hittime = 17
guard.ctrltime = 17
ground.velocity = 0
air.velocity = -1.5,-9.5
yAccel = .5
Air.Fall = 1
Fall.Recover = 0
Fall.RecoverTime = 35
EnvShake.Time = 22

[State 1000, Juggle set]
Type = varSet
Trigger1 = MoveHit
Trigger1 = AnimElem = 4, < 0
var(7) = 1
ignorehitpause = 1

[State 1100, change to air]
Type = StateTypeSet
Trigger1 = AnimElem = 5
StateType = A

[State 1100, Air Velocity]
Type = VelSet
Trigger1 = AnimElem = 5
x = 3
y = -10

[State -3, Jump Sound]
type = PlaySnd
Trigger1 = AnimElem = 5
Value = 50,1
Channel = 2
IgnoreHitPause = 1

[State 1100, reduce x Vel]
Type = VelSet
Trigger1 = Vel Y > -1
Trigger1 = AnimElem = 5, > 0
x = 0

[State 1100, Gravity]
Type = Gravity
Trigger1 = AnimElem = 5, > 0

[State 1100, Third Hit]
Type = HitDef
Trigger1 = AnimElem = 5
attr = A, HA
damage = 60,6
animtype = Up
getpower = 0,0
givepower = 15,8
guardflag = MA
hitflag = MA
pausetime = 10,12
sparkno = S8002
guard.sparkno = S8012
sparkxy = -15,-125
hitsound = S5,6
guardsound = S6,0
ground.type = High
ground.slidetime = 20
ground.hittime  = 20
guard.slidetime = 17
guard.hittime = 17
guard.ctrltime = 17
guard.velocity = -9.3
ground.velocity = -4.5, -8.5
air.velocity = -4.5,-7.5
ground.CornerPush.Veloff = 0;0
guard.CornerPush.Veloff = 0;-11.3
yAccel = .5
Fall = 1
Fall.Recover = (!var(55) && var(2) < 2)
Fall.RecoverTime = 35
EnvShake.Time = 22
P2Facing = 1

[State 1000, 9]
type = TargetState
trigger1 = MoveHit
trigger1 = AnimElem = 5, > 0
value = 3150
ignoreHitpause = 1
Persistent = 0

[State 1000, 9]
type = EnvColor
trigger1 = MoveHit
value = 255,255,255
time = 1
Under = 1
IgnoreHitPause = 1

[State 3020, 2]
Type = MovehitReset
Trigger1 = Movecontact

[State 1000, 9]
type = ChangeState
Trigger1 = Vel y > -1
Trigger1 = AnimElem = 5, > 0
value = 1102

;-----------------------------------
;----------- p2 Spinning -----------
;-----------------------------------
[Statedef 3150]
Type = A
Movetype = H
Physics = N
Ctrl = 0
Velset = 0,0,0

[STate 3200, Change to hit anim]
type = Changeanim2
trigger1 = !Time
value = 3150

[State 3200,Speed]
type = velset
Trigger1 = AnimElem = 2
x = -1.5
y = -17
persistent = 0

[State 3200, Gravity]
type = veladd
trigger1 = AnimElem = 2, > 0
y = .7

[State 3200,end]
type = EnvShake
trigger1 = Pos Y >= 0
Trigger1 = Vel Y > 0
Trigger1 = AnimElem = 2, > 0
Time = 25
Ampl = 6

[State 3200,end]
type = selfstate
trigger1 = Pos Y >= 0
Trigger1 = Vel Y > 0
Trigger1 = AnimElem = 2, > 0
value = 5100
;-----------------------------------
;- Ankoku Jigoku Goukuraku Otoshi --
;-----------------------------------
[Statedef 3200]
Type = S
MoveType = A
Physics = S
Anim = 3200
VelSet = 0
Ctrl = 0
PowerAdd = 0
Juggle = 8

[State 3000, SDM Set]
Type = Varset
Trigger1 = !Time
var(2) = 0

[State 3000, SDM Set]
Type = Varset
Trigger1 = !Time
var(28) = 0

[State 3000, SDM Set]
Type = Varset
Trigger1 = !Time
Trigger1 = PrevStateNo = [1100, 2000]
var(28) = 1

[State 3000, SDM Set]
Type = Varset
Trigger1 = !Time
Trigger1 = PrevStateNo = [1000, 1010]
var(28) = 2

[State 3000, SDM Set]
Type = Varset
TriggerAll = !Time
TriggerAll = var(15) || var(51)
TriggerAll = Power >= 1000+1000*var(51)
Trigger1 = !var(9)
Trigger1 = Command = "2punches"
Trigger2 = helper(2000),var(7)
Trigger2 = !var(9)
Trigger3 = var(9)
Trigger3 = p2Life > 250
trigger3 = !(life <= const(data.life)/4 && power >= 3000+1000*(!var(15)))
var(2) = 1

[State 800, 1]
type = HitDef
Triggerall = p2dist x < 75
Trigger1 = PrevStateNo != [200,2000]
Trigger1 = !var(6)
Trigger1 = !Time
attr = S, HT
hitflag = M-
fall.animtype = heavy
ground.type = low
ground.hittime = 60
priority = 7, Miss
sparkno = -1
sparkxy = -30,-70
HitSound = -1
sprpriority = 1
p1facing = 1
p2facing = 1
p1stateno = 3201
p2stateno = 3210
NumHits = 0
ID = 3200

[State 800, 1]
type = HitDef
Triggerall = p2dist x < 75
Trigger1 = PrevStateNo = [200,2000]
Trigger1 = !var(19)
Trigger1 = !Time
attr = S, HT
hitflag = M
fall.animtype = heavy
priority = 1, Miss
ground.type = low
ground.hittime = 60
sparkno = -1
sparkxy = -30,-70
HitSound = -1
sprpriority = 1
p1facing = 1
p2facing = 1
p1stateno = 3201
p2stateno = 3210
NumHits = 0
ID = 3200

[State -1, Cancel Combo]
Type = Poweradd
Trigger1 = time = 1
Trigger1 = prevstateno = [1000, 2000]
IgnoreHitPause = 1
value = -1000

[State 3000, PALFX]
type = PalFX
Trigger1 = timemod = 2,1
Trigger1 = time <= 15
ignorehitpause = 1
trigger1 = prevstateno = [1000, 2000]
time = 1
add = 255,255,255
sinadd = -100,-100,-100, 2
ignorehitpause = 1

[State 3000,SCancel1]
type = Explod
trigger1 = time =10 && prevstateno = [1000,2000]
anim = 11100+10*(prevstateno = [1000,1010])
pos = 65,75
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -1
bindtime = -1
ownpal = 1
removeongethit = 1

[State 3000,SCancel2]
type = Explod
trigger1 = time = 1 && prevstateno = [1000,2000]
anim = 11101
pos = 0,75
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -2
bindtime = -1
ownpal = 1
removeongethit = 1

[State 3000,SCancel3]
type = Explod
trigger1 = time = 1 && prevstateno = [1100,2000]
anim = 11102
pos = 0,75
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -3
bindtime = -1
ownpal = 1
removeongethit = 1

[State 3000, SDM Set]
Type = AssertSpecial
Trigger1 = AnimElem = 1, = 1
Flag = NoBG
Flag2 = NoFG
time = 26+16*(PrevStateNo = [1000, 2000])

[State 3000, SDM Set]
Type = EnvColor
Trigger1 = AnimElem = 1, = 1
Value = 255*(PrevStateNo = [1000,1010]),0,0
Under = 1
time = 26+16*(PrevStateNo = [1000, 2000])

[State 3000, SDM Set]
Type = BgPalFx
Trigger1 = var(2)
InvertAll = 1
Time = 3
Color = 6
IgnoreHitPause = 1

[State 3000, SDM Set]
Type = PowerAdd
Trigger1 = Time = 1
Trigger1 = !var(15)
value = -1000

[State 3000, SDM Set]
Type = VarSet
Trigger1 = Time = 1
Trigger1 = var(15)
var(15) = 1

[State 3000, DM Pause]
type = superpause
trigger1 = animelem = 1, = 1
time = 26+16*(PrevStateNo = [1000, 2000])
anim = -1
darken = 1
poweradd = -1000*var(2)
movetime = 26
persistent = 0
ontop = 1
p2defmul = 1

[State 3000, DM FX Sound]
type = PlaySnd
Trigger1 = AnimElem = 1, = 1
Value = 8000, var(2)
Channel = 5
IgnoreHitPause = 1

[State 3000, DM FX1]
Type = Explod
trigger1 = animelem = 4
anim = 8100+10*var(2)
PosType = p1
Ownpal = 1
SprPriority = -2
BindTime = -1
IgnoreHitPause = 1
Pos = 9,-145
RemoveOnGetHit = 1
PauseMoveTime = 99
SuperMoveTime = 99

[State 3000, DM FX 2]
Type = Explod
trigger1 = animelem = 4
anim = 8101+10*var(2)
PosType = p1
Ownpal = 1
SprPriority = 2
BindTime = -1
IgnoreHitPause = 1
Pos = 9,-145
RemoveOnGetHit = 1
PauseMoveTime = 99
SuperMoveTime = 99

[State 1000, 9]
type = ChangeState
Trigger1 = !AnimTime
value = 0
Ctrl = 1

;-----------------------------------
;Ankoku Jigoku Gokuraku Otoshi P1(1)
;-----------------------------------
[Statedef 3201]
Type = S
MoveType = A
Physics = N
Anim = 3201
VelSet = 0
Ctrl = 0
PowerAdd = 0

[State -1, Cancel Combo]
Type = Poweradd
Trigger1 = !time
Trigger1 = var(28)
IgnoreHitPause = 1
value = -1000

[State 3000, PALFX]
type = PalFX
Trigger1 = timemod = 2,0
Trigger1 = time <= 15
ignorehitpause = 1
trigger1 = var(28)
time = 1
add = 255,255,255
sinadd = -100,-100,-100, 2
ignorehitpause = 1

[State 3000,SCancel1]
type = Explod
trigger1 = time =10 && var(28)
anim = 11100+10*(var(28) = 2)
pos = 65,75
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -1
bindtime = -1
ownpal = 1
removeongethit = 1

[State 3000,SCancel2]
type = Explod
trigger1 = time = 1 && var(28)
anim = 11101
pos = 0,75
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -2
bindtime = -1
ownpal = 1
removeongethit = 1

[State 3000,SCancel3]
type = Explod
trigger1 = time = 1 && var(28) = 1
anim = 11102
pos = 0,75
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -3
bindtime = -1
ownpal = 1
removeongethit = 1

[State 3000, SDM Set]
Type = AssertSpecial
Trigger1 = AnimElem = 1, = 1
Flag = NoBG
Flag2 = NoFG
time = 26+16*(var(28) > 0)

[State 3000, SDM Set]
Type = EnvColor
Trigger1 = AnimElem = 3
Value = 255*(var(28) = 2),0,0
Under = 1
time = 26+16*(var(28) > 0)

[State 3000, SDM Set]
Type = BgPalFx
Trigger1 = var(2)
InvertAll = 1
Time = 3
Color = 6
IgnoreHitPause = 1

[State 3000, SDM Set]
Type = PowerAdd
Trigger1 = !Time
Trigger1 = !var(15)
value = -1000

[State 3000, SDM Set]
Type = VarSet
Trigger1 = !Time
Trigger1 = var(15)
var(15) = 1

[State 3000, DM FX Sound]
type = PlaySnd
Trigger1 = AnimElem = 3
Value = 8000, var(2)
Channel = 5
IgnoreHitPause = 1

[State 3000, Yashiro's voice]
type = PlaySnd
Trigger1 = AnimElem = 3
Value = 3200, 0
Channel = 1
IgnoreHitPause = 1

[State 3000, DM Pause]
type = superpause
trigger1 = animelem = 3
time = 26+16*(var(28) > 0)
anim = -1
darken = 1
poweradd = -1000*var(2)
movetime = 26
persistent = 0
ontop = 1
p2defmul = 1

[State 3000, DM FX Sound]
type = PlaySnd
Trigger1 = AnimElem = 1, = 1
Value = 8000, var(2)
Channel = 5
IgnoreHitPause = 1

[State 3000, DM FX1]
Type = Explod
trigger1 = animelem = 3
anim = 8100+10*var(2)
PosType = p1
Ownpal = 1
SprPriority = -2
BindTime = -1
IgnoreHitPause = 1
Pos = 30,-140
RemoveOnGetHit = 1
PauseMoveTime = 99
SuperMoveTime = 99

[State 3000, DM FX 2]
Type = Explod
trigger1 = animelem = 3
anim = 8101+10*var(2)
PosType = p1
Ownpal = 1
SprPriority = 2
BindTime = -1
IgnoreHitPause = 1
Pos = 30,-140
RemoveOnGetHit = 1
PauseMoveTime = 99
SuperMoveTime = 99

[State 820, Bind 1]
type = TargetBind
trigger1 = AnimElem = 1, >= 0
trigger1 = AnimElem = 2, < 0
pos = 55, 0

[State 820, Bind 2]
type = TargetBind
trigger1 = AnimElem = 2, >= 0
trigger1 = AnimElem = 3, < 0
pos = 35, -125

[State 820, Bind 3]
type = TargetBind
trigger1 = AnimElem = 3, >= 0
trigger1 = AnimElem = 4, < 0
pos = 25, -150

[State 3000, kick FX SND]
type = PlaySnd
Trigger1 = AnimElem = 6
Value = 1, 2
Channel = 3
IgnoreHitPause = 1

[State 3029, 2]
type = HitDef
trigger1 = animelem = 8
attr = S, HT
damage = 40,4
animtype = Heavy
getpower = 0
givepower = 30,15
guardflag =
hitflag = MAFD+
pausetime = 10,12
guard.pausetime = 10,12
sparkno = S8002
guard.sparkno = S8012
sparkxy = -15,-45
hitsound = S5,6
guardsound = S6,0
ground.type = low
ground.slidetime = 10
ground.hittime = 17
ground.velocity = 0,0
air.velocity = 0,0
fall = 1
fall.recover = 0
EnvShake.time = 18
EnvShake.freq =  45
EnvShake.ampl = -6
P2StateNo = 3250
Maxdist = 0, 0
ID = 3200
Kill = 0

[State 800, 1]
type = EnvColor
Trigger1 = MoveHit
Value = 255,255,255
Under = 1
Time = 3
IgnoreHitpause = 1
Persistent = 0

[State 800, 1]
type = MoveHitReset
Trigger1 = MoveContact

[State 800, 1]
type = HitDef
Trigger1 = AnimElem = 17
attr = C, HT
hitflag = FD+
priority = 5, Miss
sparkno = -1
sparkxy = -15,-15
HitSound = S800,1
sprpriority = -1
p1facing = 1
p2facing = 1
p1stateno = 3202
p2stateno = 3211
Fall = 1
Fall.Recover = 0
fall.EnvShake.time = 10
fall.EnvShake.freq =  45
fall.EnvShake.ampl = -8
Fall.damage = 57
ID = 3200
ChainID = 3200

[State 1000, 9]
type = ChangeState
Trigger1 = !AnimTime
value = 0
Ctrl = 1

;-----------------------------------
;Ankoku Jigoku Gokuraku Otoshi P1(2)
;-----------------------------------
[Statedef 3202]
Type = A
MoveType = A
physics = N
anim = 3202+var(2)
poweradd = 0
sprpriority = 1
Velset = 0,0

[State 3000, SDM Set]
Type = BgPalFx
Trigger1 = var(2)
InvertAll = 1
Time = 3
Color = 6
IgnoreHitPause = 1

[State -3, OTG FX]
type = Explod
Trigger1 = AnimElem = 1
anim = 8220
pos = 50,-5
bindtime = 1
ownpal = 1
Ontop = 1
PauseMoveTime = 99
SuperMoveTime = 99

[State 810, Bind 1]
type = PosAdd
trigger1 = AnimElem = 2
x = -24

[State 810, Out of corners]
type = Width
trigger1 = AnimElem = 2
trigger2 = AnimElem = 14
trigger3 = AnimElem = 28
trigger4 = AnimElem = 42
trigger5 = AnimElem = 56
Edge = 60,0

[State 810, Out of corners]
type = Width
trigger1 = AnimElem = 7
trigger2 = AnimElem = 21
trigger3 = AnimElem = 35
trigger4 = AnimElem = 49
Edge = 0,120

[State 810, Bind 1]
type = PlaySnd
trigger1 = AnimElem = 5
trigger2 = AnimElem = 12
trigger3 = AnimElem = 19
trigger4 = AnimElem = 26
trigger5 = AnimElem = 33
trigger6 = AnimElem = 40
trigger7 = AnimElem = 47
trigger7 = var(2)
trigger8 = AnimElem = 54
Value = 820, 0
Channel = 3

[State 820, Bind 1]
type = TargetBind
trigger1 = AnimElem = 1, >= 0
trigger1 = AnimElem = 2, < 0
pos = 60, -5

[State 820, Bind 2]
type = TargetBind
trigger1 = AnimElem = 2, >= 0
trigger1 = AnimElem = 3, < 0
pos = 80, -5

[State 820, Bind 3]
type = TargetBind
trigger1 = AnimElem = 3, >= 0
trigger1 = AnimElem = 4, < 0
pos = 65, -20

[State 820, Bind 4]
type = TargetBind
trigger1 = AnimElem = 4, >= 0
trigger1 = AnimElem = 5, < 0
pos = 50, -10

[State 820, Bind 5]
type = TargetBind
trigger1 = AnimElem = 5, >= 0
trigger1 = AnimElem = 6, < 0
pos = 45, -70

[State 820, Bind 10]
type = TargetBind
trigger1 = AnimElem = 6, >= 0
trigger1 = AnimElem = 7, < 0
trigger2 = AnimElem = 20, >= 0
trigger2 = AnimElem = 21, < 0
trigger3 = AnimElem = 34, >= 0
trigger3 = AnimElem = 35, < 0
trigger4 = AnimElem = 48, >= 0
trigger4 = AnimElem = 49, < 0
pos = -10, -110

[State 820, Bind 10]
type = TargetBind
trigger1 = AnimElem = 7, >= 0
trigger1 = AnimElem = 8, < 0
trigger2 = AnimElem = 21, >= 0
trigger2 = AnimElem = 22, < 0
trigger3 = AnimElem = 35, >= 0
trigger3 = AnimElem = 36, < 0
trigger4 = AnimElem = 49, >= 0
trigger4 = AnimElem = 50, < 0
pos = -85, -100

[State 820, Bind 10]
type = TargetBind
trigger1 = AnimElem = 8, >= 0
trigger1 = AnimElem = 10, < 0
trigger2 = AnimElem = 22, >= 0
trigger2 = AnimElem = 24, < 0
trigger3 = AnimElem = 36, >= 0
trigger3 = AnimElem = 38, < 0
trigger4 = AnimElem = 50, >= 0
trigger4 = AnimElem = 52, < 0
pos = -100, 0

[State 820, Bind 5]
type = TargetBind
trigger1 = AnimElem = 10, >= 0
trigger1 = AnimElem = 11, < 0
trigger2 = AnimElem = 24, >= 0
trigger2 = AnimElem = 25, < 0
trigger3 = AnimElem = 38, >= 0
trigger3 = AnimElem = 39, < 0
trigger4 = AnimElem = 52, >= 0
trigger4 = AnimElem = 53, < 0
pos = -80, 0

[State 820, Bind 5]
type = TargetBind
trigger1 = AnimElem = 11, >= 0
trigger1 = AnimElem = 12, < 0
trigger2 = AnimElem = 25, >= 0
trigger2 = AnimElem = 26, < 0
trigger3 = AnimElem = 39, >= 0
trigger3 = AnimElem = 40, < 0
trigger4 = AnimElem = 53, >= 0
trigger4 = AnimElem = 54, < 0
pos = -75, -40

[State 820, Bind 5]
type = TargetBind
trigger1 = AnimElem = 12, >= 0
trigger1 = AnimElem = 13, < 0
trigger2 = AnimElem = 26, >= 0
trigger2 = AnimElem = 27, < 0
trigger3 = AnimElem = 40, >= 0
trigger3 = AnimElem = 41, < 0
trigger4 = AnimElem = 54, >= 0
trigger4 = AnimElem = 55, < 0
pos = -75, -85

[State 820, Bind 5]
type = TargetBind
trigger1 = AnimElem = 13, >= 0
trigger1 = AnimElem = 14, < 0
trigger2 = AnimElem = 27, >= 0
trigger2 = AnimElem = 28, < 0
trigger3 = AnimElem = 41, >= 0
trigger3 = AnimElem = 42, < 0
trigger4 = AnimElem = 55, >= 0
trigger4 = AnimElem = 56, < 0
pos = -10, -115

[State 820, Bind 5]
type = TargetBind
trigger1 = AnimElem = 14, >= 0
trigger1 = AnimElem = 19, < 0
trigger2 = AnimElem = 28, >= 0
trigger2 = AnimElem = 33, < 0
trigger3 = AnimElem = 42, >= 0
trigger3 = AnimElem = 47, < 0
Trigger3 = var(2)
pos = 20, 0

[State 820, Bind 5]
type = TargetBind
trigger1 = AnimElem = 19, >= 0
trigger1 = AnimElem = 20, < 0
trigger2 = AnimElem = 33, >= 0
trigger2 = AnimElem = 34, < 0
trigger3 = AnimElem = 47, >= 0
trigger3 = AnimElem = 48, < 0
Trigger3 = var(2)
pos = 30, -65

[State 820, Bind 5]
type = Sprpriority
trigger1 = AnimElem = 1, >= 0
trigger1 = AnimElem = 6, < 0
trigger2 = AnimElem = 16, >= 0
trigger2 = AnimElem = 19, < 0
trigger3 = AnimElem = 30, >= 0
trigger3 = AnimElem = 33, < 0
trigger4 = AnimElem = 44, >= 0
trigger4 = AnimElem = 47, < 0
trigger4 = var(2)
value = -2

[State 820, Bind 5]
type = Sprpriority
trigger1 = AnimElem = 6
trigger2 = AnimElem = 19
trigger3 = AnimElem = 33
trigger4 = AnimElem = 47
value = 1

[State -3, OTG back FX]
type = Explod
Trigger1 = AnimElem = 8
Trigger2 = AnimElem = 22
Trigger3 = AnimElem = 36
Trigger4 = AnimElem = 50
anim = 7910
pos = -100,10
bindtime = 1
ownpal = 1
sprpriority = 4
PauseMoveTime = 99
SuperMoveTime = 99

[State -3, OTG front FX]
type = Explod
Trigger1 = AnimElem = 14
trigger2 = AnimElem = 28
Trigger3 = AnimElem = 42
Trigger3 = var(2)
anim = 7910
pos = 25,10
bindtime = 1
ownpal = 1
sprpriority = 4
PauseMoveTime = 99
SuperMoveTime = 99

[State -3, OTG back dust]
type = Explod
Trigger1 = AnimElem = 8
Trigger2 = AnimElem = 22
Trigger3 = AnimElem = 36
Trigger4 = AnimElem = 50
anim = 7920
pos = -100,10
bindtime = 1
ownpal = 1
sprpriority = 3
PauseMoveTime = 99
SuperMoveTime = 99

[State -3, OTG front dust]
type = Explod
Trigger1 = AnimElem = 14
trigger2 = AnimElem = 28
Trigger3 = AnimElem = 42
Trigger3 = var(2)
anim = 7920
pos = 25,10
bindtime = 1
ownpal = 1
sprpriority = 3
PauseMoveTime = 99
SuperMoveTime = 99

[State -3, OTG FX]
type = EnvShake
Trigger1 = AnimElem = 8
trigger2 = AnimElem = 14
Trigger3 = AnimElem = 22
Trigger4 = AnimElem = 28
Trigger5 = AnimElem = 36
Trigger6 = AnimElem = 42
Trigger6 = var(2)
Trigger7 = AnimElem = 50
Trigger7 = var(2)
Time = 18
Ampl = -8


[State 800, 1]
type = EnvColor
Trigger1 = AnimElem = 1
Trigger2 = AnimElem = 8
trigger3 = AnimElem = 14
Trigger4 = AnimElem = 22
Trigger5 = AnimElem = 28
Trigger6 = AnimElem = 36
Trigger7 = AnimElem = 42
Trigger7 = var(2)
Trigger8 = AnimElem = 50
Trigger8 = var(2)
Trigger9 = ProjHit(3200) = 1
Value = 255,255,255
Under = 1
IgnoreHitpause = 1
Time = 3

[State 820, Hurt]
type = TargetLifeAdd
Trigger1 = AnimElem = 8
trigger2 = AnimElem = 14
Trigger3 = AnimElem = 22
Trigger4 = AnimElem = 28
Trigger5 = AnimElem = 36
Trigger6 = AnimElem = 42
Trigger6 = var(2)
Trigger7 = AnimElem = 50
Trigger7 = var(2)
value = floor(-40*((10-var(5))*.1))
kill = 0

[State 820, Hurt]
type = TargetState
Trigger1 = AnimElem = 42
trigger1 = !var(2)
Trigger2 = AnimElem = 56
trigger2 = var(2)
value = 3212

[State 820, Hurt]
type = TargetLifeAdd
Trigger1 = AnimElem = 42
Trigger1 = !var(2)
Trigger2 = AnimElem = 56
Trigger2 = var(2)
value = floor(-25*((10-var(5))*.1))

[State 810, Bind 1]
type = PlaySnd
Trigger1 = AnimElem = 8
trigger2 = AnimElem = 14
Trigger3 = AnimElem = 22
Trigger4 = AnimElem = 28
Trigger5 = AnimElem = 36
Trigger6 = AnimElem = 42
Trigger6 = var(2)
Trigger7 = AnimElem = 50
Trigger7 = var(2)
Value = 850, 0
Channel = 2

[State 810, Bind 1]
type = PosAdd
trigger1 = AnimElem = 46
trigger1 = !var(2)
trigger2 = AnimElem = 47
trigger2 = !var(2)
trigger3 = AnimElem = 60
trigger4 = AnimElem = 61
x = 20

[State 810, Bind 1]
type = PlaySND
trigger1 = AnimElem = 65
value = 3200,1
Channel = 1

[State 810, Bind 1]
type = PlaySND
trigger1 = AnimElem = 67
value = 3200,2
Channel = 3

[State 1000, 3]
type = Projectile
trigger1 = AnimElem = 67
attr = S, HP
damage    = 150, 15
animtype = Up
fall.animtype = Up
getpower = 0,0
givepower = 30,15
guardflag = M
hitflag = MAF
pausetime = 3,12
sparkno = S8002
guard.sparkno = S8202
sparkxy = -15,-85
hitsound = S5,6
guardsound = S6,0
ground.type = High
air.type = low
ground.slidetime = 17
ground.hittime  = 17
guard.slidetime = 17
guard.hittime = 17
guard.ctrltime = 17
ground.velocity = -4, -7.5
air.velocity = -4,-7
projanim = 3250
projhitanim = 3250
projremanim = 3251
projcancelanim = 3251
ProjRemove = 0
ProjRemovetime = 36
ProjPriority = 9999
velocity = 0
offset = Floor(p2Dist x)+30,0
ID = 3200
projid = 3200
Fall = 1
Fall.Recover = 0
Envshake.Time = 15
yAccel = .5
p2StateNo = 3150
EnvShake.Time = 25

[State 3000,  Dream Cancel]
type = ChangeState
TriggerAll = power >= 3000
TriggerAll = AnimElem = 44, >= 0
TriggerAll = AnimElem = 47, < 0
TriggerAll = Life <= Const(Data.Life)/4
TriggerAll = !var(2)
Trigger1 = Command = "Armageddon"
Trigger2 = helper(2000), var(10)
Trigger3 = var(9)
Trigger3 = AnimElem = 46, = 2
Trigger3 = p2life > 250
Value = 4100

[State 820, State End]
type = ChangeState
trigger1 = !AnimTime
trigger1 = var(9)
value = 195

[State 820, State End]
type = ChangeState
trigger1 = !AnimTime
value = 0
Ctrl = 1

;-----------------------------------
;Ankoku Jigoku Gokuraku Otoshi P2(1)
;-----------------------------------
[Statedef 3210]
Type = A
MoveType = H
Physics = N
VelSet = 0
Ctrl = 0
PowerAdd = 0

[State -1, Anim]
Type = HitBy
Trigger1 = 1
Value = S, HT
IgnoreHitPause = 1

[State -1, Anim]
Type = ChangeAnim2
Trigger1 = !time
Value = 3210

[State -1, Posadd]
Type = PosAdd
Trigger1 = AnimElem = 3
y = -const(size.head.pos.y)

[State -1, Posadd]
Type = Velset
Trigger1 = AnimElem = 3
y = 4

[State 1200, End]
type = SelfState
Trigger1 = AnimElem = 3, > 0
Trigger1 = Pos y >= 0
Trigger1 = Vel y > 0
value = 5100

;-----------------------------------
;Ankoku Jigoku Gokuraku Otoshi P2(2)
;-----------------------------------
[Statedef 3211]
Type = A
MoveType = H
Physics = N
VelSet = 0
Ctrl = 0
PowerAdd = 0

[State -1, Anim]
Type = ChangeAnim2
Trigger1 = !time
Value = 3211

[State 1200, End]
type = SelfState
Trigger1 = !AnimTime
value = 5070

;-----------------------------------
;Ankoku Jigoku Gokuraku Otoshi P2(3)
;-----------------------------------
[Statedef 3212]
Type = A
MoveType = H
Physics = N
VelSet = 0
Ctrl = 0
PowerAdd = 0

[State -1, Anim]
Type = ChangeAnim2
Trigger1 = !time
Value = 3212

[State 1031, 4]
type = Velset
trigger1 = !Time
x = -2.5
y = -18

[State 1031, 4]
type = VelAdd
trigger1 = Time
y = .6

[State 200, Over]
Type = SelfState
Trigger1 = vel y > 0
Trigger1 = Pos y >= 0
Value = 5100

;-----------------------------------
;Ankoku Jigoku Gokuraku Otoshi alt
;-----------------------------------
[Statedef 3220]
Type = S
MoveType = A
Physics = N
Anim = 3201
VelSet = 0
Ctrl = 0
PowerAdd = 0

[State -1, Turn]
Type = Turn
Trigger1 = !time
Trigger1 = p2Dist x < 0
IgnoreHitPause = 1

[State -1, Cancel Combo]
Type = TargetState
Trigger1 = !time
IgnoreHitPause = 1
value = 3210

[State 3000, SDM Set]
Type = Varset
Trigger1 = !Time
var(2) = 0

[State -1, Cancel Combo]
Type = Poweradd
Trigger1 = !time
IgnoreHitPause = 1
value = -1000

[State 3000, SDM Set]
Type = Varset
TriggerAll = !Time
TriggerAll = var(15) || var(51)
TriggerAll = Power >= 1000+1000*var(51)+1000*(!var(15))
Trigger1 = !var(9)
Trigger1 = Command = "2punches"
Trigger2 = helper(2000),var(7)
Trigger2 = !var(9)
Trigger3 = var(9)
Trigger3 = p2Life > 250
trigger3 = !(life <= const(data.life)/4 && power >= 3000+1000*(!var(15)))
var(2) = 1

[State 3000, PALFX]
type = PalFX
Trigger1 = timemod = 2,0
Trigger1 = time <= 15
time = 1
add = 255,255,255
sinadd = -100,-100,-100, 2
ignorehitpause = 1

[State 3000,SCancel1]
type = Explod
trigger1 = time =10
anim = 11110
pos = 65,75
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -1
bindtime = -1
ownpal = 1
removeongethit = 1

[State 3000,SCancel2]
type = Explod
trigger1 = time = 1
anim = 11101
pos = 0,75
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -2
bindtime = -1
ownpal = 1
removeongethit = 1

[State 3000, SDM Set]
Type = AssertSpecial
Trigger1 = AnimElem = 1, = 1
Flag = NoBG
Flag2 = NoFG
time = 42

[State 3000, SDM Set]
Type = EnvColor
Trigger1 = AnimElem = 3
Value = 255,0,0
Under = 1
time = 42

[State 3000, SDM Set]
Type = BgPalFx
Trigger1 = var(2)
InvertAll = 1
Time = 3
Color = 6
IgnoreHitPause = 1

[State 3000, SDM Set]
Type = PowerAdd
Trigger1 = !Time
Trigger1 = !var(15)
value = -1000

[State 3000, SDM Set]
Type = VarSet
Trigger1 = !Time
Trigger1 = var(15)
var(15) = 1

[State 3000, DM FX Sound]
type = PlaySnd
Trigger1 = AnimElem = 3
Value = 8000, var(2)
Channel = 5
IgnoreHitPause = 1

[State 3000, Yashiro's voice]
type = PlaySnd
Trigger1 = AnimElem = 3
Value = 3200, 0
Channel = 1
IgnoreHitPause = 1

[State 3000, DM Pause]
type = superpause
trigger1 = animelem = 3
time = 42
anim = -1
darken = 1
poweradd = -1000*var(2)
movetime = 26
persistent = 0
ontop = 1
p2defmul = 1

[State 3000, DM FX Sound]
type = PlaySnd
Trigger1 = AnimElem = 1, = 1
Value = 8000, var(2)
Channel = 5
IgnoreHitPause = 1

[State 3000, DM FX1]
Type = Explod
trigger1 = animelem = 3
anim = 8100+10*var(2)
PosType = p1
Ownpal = 1
SprPriority = -2
BindTime = -1
IgnoreHitPause = 1
Pos = 30,-140
RemoveOnGetHit = 1
PauseMoveTime = 99
SuperMoveTime = 99

[State 3000, DM FX 2]
Type = Explod
trigger1 = animelem = 3
anim = 8101+10*var(2)
PosType = p1
Ownpal = 1
SprPriority = 2
BindTime = -1
IgnoreHitPause = 1
Pos = 30,-140
RemoveOnGetHit = 1
PauseMoveTime = 99
SuperMoveTime = 99

[State 820, Bind 1]
type = TargetBind
trigger1 = AnimElem = 1, >= 0
trigger1 = AnimElem = 2, < 0
pos = 55, 0

[State 820, Bind 2]
type = TargetBind
trigger1 = AnimElem = 2, >= 0
trigger1 = AnimElem = 3, < 0
pos = 35, -125

[State 820, Bind 3]
type = TargetBind
trigger1 = AnimElem = 3, >= 0
trigger1 = AnimElem = 4, < 0
pos = 25, -150

[State 3000, kick FX SND]
type = PlaySnd
Trigger1 = AnimElem = 6
Value = 1, 2
Channel = 3
IgnoreHitPause = 1

[State 3029, 2]
type = HitDef
trigger1 = animelem = 8
attr = S, HT
damage = 40,4
animtype = Heavy
getpower = 0
givepower = 30,15
guardflag =
hitflag = MAFD+
pausetime = 10,12
guard.pausetime = 10,12
sparkno = S8002
guard.sparkno = S8012
sparkxy = -15,-45
hitsound = S5,6
guardsound = S6,0
ground.type = low
ground.slidetime = 10
ground.hittime = 17
ground.velocity = 0,0
air.velocity = 0,0
fall = 1
fall.recover = 0
EnvShake.time = 18
EnvShake.freq =  45
EnvShake.ampl = -6
P2StateNo = 3250
Maxdist = 0, 0
ID = 3200
kill = 0

[State 800, 1]
type = EnvColor
Trigger1 = MoveHit
Value = 255,255,255
Under = 1
Time = 3
IgnoreHitpause = 1
Persistent = 0

[State 800, 1]
type = MoveHitReset
Trigger1 = MoveContact

[State 800, 1]
type = HitDef
Trigger1 = AnimElem = 17
attr = C, HT
hitflag = FD+
priority = 5, Miss
sparkno = -1
sparkxy = -15,-15
HitSound = S800,1
sprpriority = -1
p1facing = 1
p2facing = 1
p1stateno = 3202
p2stateno = 3211
Fall = 1
Fall.Recover = 0
fall.EnvShake.time = 10
fall.EnvShake.freq =  45
fall.EnvShake.ampl = -8
Fall.damage = 57
ID = 3200
kill = 0

[State 1000, 9]
type = ChangeState
Trigger1 = !AnimTime
value = 0
Ctrl = 1

;-----------------------------------
;------- Hit by AJGO's Kick --------
;-----------------------------------
[Statedef 3250]
type = A
movetype= H
physics = N
velset = 0,0

[State 3250, PlayerPush]
type = HitBy
trigger1 = 1
Value = SC, HP,HT
IgnoreHitPause = 1

[State 3250, PlayerPush]
type = PlayerPush
trigger1 = 1
Value = 0
IgnoreHitPause = 1

[State 6000, Change by HitType1]
type = ChangeAnim
trigger1 = !Time
trigger1 = GetHitVar(animtype) != [3,5]
value = ifelse((GetHitVar(airtype) = 1),5000,5010) + GetHitVar(animtype)

[State 6000, Change by HitType2]
type = ChangeAnim
trigger1 = !Time
trigger1 = GetHitVar(animtype) = [3,5]
value = 5012

[State 6000, Change by HitType3]
type = ChangeAnim
trigger1 = !Time
trigger1 = (GetHitVar(animtype) = [4,5]) && (SelfAnimExist(5047 + GetHitVar(animtype)))
value = 5047 + GetHitVar(animtype) ;5051 - 4 + type

[State 6000, Change by HitType4]
type = ChangeAnim
trigger1 = Time > 0
value = anim

[State 6000, Invencible]
type = NotHitBy
trigger1 = 1
value = SCA

[State 6000, end]
type = ChangeState
trigger1 = HitShakeOver
value = 3251

[State 6000, FFB Light]
type = ForceFeedback
trigger1 = anim = 5000
trigger2 = anim = 5010
persistent = 0
time = 6
waveform = square

[State 6000, FFB Medium]
type = ForceFeedback
trigger1 = anim = 5001
trigger2 = anim = 5011
persistent = 0
time = 8
waveform = sinesquare
ampl = 110,-1,-.3

[State 6000, FFB Hard]
type = ForceFeedback
trigger1 = anim = 5012
trigger2 = anim = 5002
trigger3 = anim = 5030
trigger4 = anim = [5051,5059]
persistent = 0
time = 15
waveform = sinesquare
ampl = 140

;---------------------------------------------------------------------------
[Statedef 3251]
type = A
movetype= H
physics = N
ctrl = 0

[State 3250, PlayerPush]
type = HitBy
trigger1 = 1
Value = SC, HP,HT
IgnoreHitPause = 1

[State 3250, PlayerPush]
type = PlayerPush
trigger1 = 1
Value = 0
IgnoreHitPause = 1

[State 6001, Change by HitType1]
type = Changeanim
trigger1 = !Time
trigger1 = anim = 5012
value = 5030

[State 6001, HitVelAdd]
type = VelAdd
trigger1 = 1
y = GetHitVar(yaccel)

[State 6001, HitVelSet]
type = HitVelSet
trigger1 = !Time
x = 1
y = 1

[State 6001, end1]
type = ChangeState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
value = 3260

[State 6001, end2]
type = ChangeState
trigger1 = AnimTime = 0
value = 3252

;---------------------------------------------------------------------------
[Statedef 3252]
type = A
movetype= H
physics = N

[State 3250, PlayerPush]
type = HitBy
trigger1 = 1
Value = SC, HP,HT
IgnoreHitPause = 1

[State 3250, PlayerPush]
type = PlayerPush
trigger1 = 1
Value = 0
IgnoreHitPause = 1

[State 6000, Change by HitType1]
type = ChangeAnim
trigger1 = !Time
trigger1 = SelfAnimExist(5035)
trigger1 = Anim != [5051,5059]
trigger1 = Anim != 5090
value = 5035

[State 6002, HitVelAdd]
type = VelAdd
trigger1 = 1
y = GetHitVar(yaccel)

[State 6000, Falling]
type = hitfallset
trigger1 = Vel Y > 0
trigger1 = Pos Y >= -20
value = 1
ignorehitpause = 1

[State 6003, End1]
type = ChangeState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
value = 3260

[State 6003, End2]
type = ChangeState
trigger1 = HitOver
trigger2 = AnimTime = 0
trigger3 = Time = 0
trigger3 = Anim != 5035
value = 3253

;---------------------------------------------------------------------------
[Statedef 3253]
type = A
movetype= H
physics = N

[State 3250, PlayerPush]
type = HitBy
trigger1 = 1
Value = SC, HP,HT
IgnoreHitPause = 1

[State 3250, PlayerPush]
type = PlayerPush
trigger1 = 1
Value = 0
IgnoreHitPause = 1

[State 6000, Change by HitType1]
type = ChangeAnim
trigger1 = AnimTime = 0
trigger1 = Anim = 5035
trigger2 = Time = 0
trigger2 = Anim != 5035
trigger2 = (Anim != [5051, 5059]) && (Anim != [5061, 5069])
trigger2 = Anim != 5090
value = 5050

[State 6000, Change by HitType2]
type = ChangeAnim
trigger1 = anim = [5050,5059]
trigger1 = Vel Y >= ifelse(anim = 5050, 1, -2)
trigger1 = SelfAnimExist(anim+10)
value = anim+10
persistent = 0

[State 6003, HitVelAdd]
type = VelAdd
trigger1 = 1
y = GetHitVar(yaccel)

[State 6000, Invencible]
type = NotHitBy
trigger1 = 1
value = SCA

[State 6000, End]
type = ChangeState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
value = 3260

;---------------------------------------------------------------------------
[Statedef 3260]
type = L
movetype= H
physics = N

[State 3250, PlayerPush]
type = HitBy
trigger1 = 1
Value = SC, HP,HT
IgnoreHitPause = 1

[State 3250, PlayerPush]
type = PlayerPush
trigger1 = 1
Value = 0
IgnoreHitPause = 1

[State 5100, 1]
type = VelSet
trigger1 = Time = 0
trigger1 = GetHitVar(fall.yvel) = 0
trigger1 = vel x > 1
x = 1

[State 5100, EnvShake]
type = FallEnvShake
trigger1 = Time = 0

[State 5100, Var] ;Save fall velocity
type = VarSet
trigger1 = Time = 0
sysvar(1) = floor(vel y)

[State 5100, 2] ;Hit ground anim (normal)
type = ChangeAnim
triggerall = time = 0
trigger1 = (anim != [5051,5059]) && (anim != [5061,5069])
trigger2 = !SelfAnimExist(5100 + (anim % 10))
value = 5100

[State 5100, 3] ;Hit ground anim (for hit up)
type = ChangeAnim
trigger1 = time = 0
trigger1 = (anim = [5051,5059]) || (anim = [5061,5069])
trigger1 = SelfAnimExist(5100 + (anim % 10))
value = 5100 + (anim % 10)

[State 5100, 4]
type = PosSet
trigger1 = Time = 0
y = 0

[State 5100, 5]
type = VelSet
trigger1 = Time = 0
y = 0

[State 5100, 6] ;Reduce speed
type = VelMul
trigger1 = Time = 0
x = 0.75

[State 5100, 7]
type = ChangeState
trigger1 = Time = 0
trigger1 = GetHitVar(fall.yvel) = 0
value = 5110 ;HIT_LIEDOWN

[State 5100, 8]
type = GameMakeAnim
trigger1 = Time = 1
value = 60 + (sysvar(1) > 5) + (sysvar(1) > 14)
pos = 0, 0
under = sysvar(1) <= 14

[State 5100, 9]
type = HitFallDamage
trigger1 = Time = 3

[State 5100, 10]
type = PlaySnd
trigger1 = Time = 1
value = F7, (sysvar(1) > 5) + (sysvar(1) > 14)

[State 5100, 11]
type = PosFreeze
trigger1 = 1

[State 5100, 12]
type = ChangeState
trigger1 = AnimTime = 0
value = 3261

[State 5100, 13]
type = ForceFeedback
trigger1 = Time = 0
waveform = sinesquare
ampl = 128,-3,-.2,.005
time = 20

;---------------------------------------------------------------------------
[Statedef 3261]
type = L
movetype= H
physics = N

[State 3250, PlayerPush]
type = HitBy
trigger1 = 1
Value = SC, HP,HT
IgnoreHitPause = 1

[State 3250, PlayerPush]
type = PlayerPush
trigger1 = 1
Value = 0
IgnoreHitPause = 1

[State 5101, 1] ;Coming hit ground anim (normal)
type = ChangeAnim
triggerall = time = 0
trigger1 = anim != [5101,5109]
trigger2 = !SelfAnimExist(5160 + (anim % 10))
value = 5160

[State 5101, 2] ;Coming hit ground anim (for hit up)
type = ChangeAnim
triggerall = time = 0
trigger1 = anim = [5101,5109]
trigger1 = SelfAnimExist(5160 + (anim % 10))
value = 5160 + (anim % 10)

[State 5101, 3]
type = HitFallVel
trigger1 = Time = 0

[State 5101, 4]
type = PosSet
trigger1 = Time = 0
y = 20

[State 5101, 5] ;Acceleration
type = VelAdd
trigger1 = 1
y = .4

[State 5101, 6] ;Hit ground
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 12
type = ChangeState
value = 3262

[Statedef 3262]
type    = L
movetype= H
physics = N

[State 3250, PlayerPush]
type = HitBy
trigger1 = 1
Value = SC, HP,HT
IgnoreHitPause = 1

[State 3250, PlayerPush]
type = PlayerPush
trigger1 = 1
Value = 0
IgnoreHitPause = 1

[State 5110, EnvShake]
type = FallEnvShake
trigger1 = Time = 0

[State 5110, 1] ;For hit up/up-diag type (from state 5081)
type = ChangeAnim
persistent = 0
trigger1 = SelfAnimExist(5110 + (anim % 10))
trigger1 = anim = [5081,5089]
value = 5110 + (anim % 10)

[State 5110, 2] ;Hit ground anim (normal)
type = ChangeAnim
triggerall = time = 0
triggerall = anim != [5110,5119] ;Not already changed anim
trigger1 = anim != [5161,5169]
trigger2 = !SelfAnimExist(5170 + (anim % 10))
value = 5170

[State 5110, 3] ;Hit ground anim (for hit up)
type = ChangeAnim
triggerall = time = 0
triggerall = anim != [5110,5119] ;Not already changed anim
trigger1 = anim = [5161,5169]
trigger1 = SelfAnimExist(5170 + (anim % 10))
value = 5170 + (anim % 10)

[State 5110, 4]
type = HitFallDamage
trigger1 = Time = 0

[State 5110, 5]
type = PosSet
trigger1 = Time = 0
y = 0

[State 5110, Var] ;Get fall velocity
type = VarSet
trigger1 = Time = 0
trigger1 = GetHitVar(fall.yvel) != 0
sysvar(1) = floor(vel y)

[State 5110, 6]
type = PlaySnd
trigger1 = Time = 0
trigger1 = !SysVar(0)
value = F7, (sysvar(1) > 5) + (sysvar(1) > 14)

[State 5110, 7]
type = GameMakeAnim
trigger1 = Time = 0
trigger1 = !SysVar(0)
value = 60 + (sysvar(1) > 5) + (sysvar(1) > 14)
pos = 0, 0
under = sysvar(1) <= 14

[State 5110, 8]
type = VelSet
trigger1 = Time = 0
y = 0

[State 5110, 9] ;For hit up type
type = ChangeAnim
persistent = 0
triggerall = anim = [5171,5179]
triggerall = SelfAnimExist(5110 + (anim % 10))
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground anim
value = 5110 + (anim % 10)

[State 5110, 10] ;For normal
type = ChangeAnim
persistent = 0
triggerall = Anim != [5111,5119]
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
value = 5110

[State 5110, 12]
type = VarSet
trigger1 = SysVar(0)
trigger1 = Time = 0
sysvar(0) = 0

[State 5110, 13] ;Friction
type = VelMul
trigger1 = 1
x = 0.85

[State 5110, 14]
type = ForceFeedback
trigger1 = alive
trigger1 = Time = 0
time = 8
ampl = 240
waveform = sine

[State 5110, 15]
type = ForceFeedback
trigger1 = !alive
trigger1 = Time = 0
ampl = 200, 7, -.467
time = 30
waveform = sine

[State 5110, 11]
type = SelfState
trigger1 = Time >= 45
value = ifelse(Alive, 5120,  5150)

;-----------------------------------
;--------- Araburu Daichi ----------
;-----------------------------------
[Statedef 3300]
Type = A
MoveType = A
Physics = N
Anim = 3300
VelSet = 0,0
Ctrl = 0
PowerAdd = 0
Juggle = 8

[State -1, Cancel Combo]
Type = Poweradd
Trigger1 = !time
Trigger1 = prevstateno = [1000, 1900]
IgnoreHitPause = 1
value = -1000

[State 3000, PALFX]
type = PalFX
Trigger1 = timemod = 2,0
Trigger1 = time <= 15
ignorehitpause = 1
Trigger1 = prevstateno = [1000, 1900]
time = 1
add = 255,255,255
sinadd = -100,-100,-100, 2
ignorehitpause = 1

[State 3000,SCancel1]
type = Explod
trigger1 = time = 10 && prevstateno = [1000,2000]
anim = 11100+10*(prevstateno = 1000)
pos = 65,75
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -1
bindtime = -1
ownpal = 1
removeongethit = 1

[State 3000,SCancel2]
type = Explod
trigger1 = !time && prevstateno = [1000,2000]
anim = 11101
pos = 0,75
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -2
bindtime = -1
ownpal = 1
removeongethit = 1

[State 3000,SCancel3]
type = Explod
trigger1 = !time && (prevstateno = [1010,2000])
anim = 11102
pos = 0,75
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -3
bindtime = -1
ownpal = 1
removeongethit = 1

[State 3000, SDM Set]
Type = AssertSpecial
Trigger1 = AnimElem = 1, = 1
Flag = NoBG
Flag2 = NoFG
time = 26+16*(PrevStateNo = [1000, 2000])

[State 3000, SDM Set]
Type = EnvColor
Trigger1 = AnimElem = 1, = 1
Value = 255*(prevstateno = 1000),0,0
Under = 1
time = 26+16*(PrevStateNo = [1000, 2000])

[State 1000, Inv1ncible]
type = NotHitBy
Trigger1 = 1
value = SCA
IgnoreHitPause = 1

[State 1000, Yashiro Voice]
type = PlaySnd
Trigger1 = AnimElem = 2
value = 3300,0
Channel = 1

[State 3000, SDM Set]
Type = PowerAdd
Trigger1 = !Time
Trigger1 = !var(15)
value = -1000

[State 3000, SDM Set]
Type = VarSet
Trigger1 = !Time
Trigger1 = var(15)
var(15) = 1

[State 3000, DM Pause]
type = superpause
trigger1 = animelem = 1, = 1
time = 26+16*(PrevStateNo = [1000, 2000])
anim = -1
darken = 1
poweradd = 0
movetime = 26
persistent = 0
ontop = 1
p2defmul = 1

[State 3000, SDM Set]
Type = varSet
Trigger1 = !Time
var(2) = 0

[State 3000, SDM Set]
Type = varSet
TriggerAll = !Time
TriggerAll = Power >= 1000+1000*var(51)
TriggerAll = var(15) || var(51)
Trigger1 = Command = "2kicks"
Trigger2 = helper(2000), var(8)
Trigger3 = var(9)
Trigger3 = p2Life > 300
var(2) = 1

[State 3000, After]
type = AfterImage
trigger1 = time = 27
time = 2
palmul = .65,.65,.75
palbright = 30,30,30
palcontrast = 120,120,220
timegap = 1
framegap = 5
Trans = add1
color = 0

[State 3020, After Set]
type = AfterImagetime
trigger1 = time > 27
time = 2
ignorehitpause = 1

[State 3000, SDM Set]
Type = BgPalFx
Trigger1 = var(2)
InvertAll = 1
Color = 6
Time = 3
IgnoreHitPause = 1

[State 3000, SDM Set]
Type = VarSet
Trigger1 = !Time
Trigger1 = var(15)
var(15) = 1

[State 3000, DM Pause]
type = superpause
trigger1 = animelem = 1, = 1
time = 26+16*(PrevStateNo = [1000, 2000])
anim = -1
darken = 1
poweradd = -1000*var(2)
movetime = 26
persistent = 0
ontop = 1
p2defmul = 1

[State 3000, DM FX Sound]
type = PlaySnd
Trigger1 = AnimElem = 1, = 1
Value = 8000, var(2)
Channel = 5
IgnoreHitPause = 1

[State 3000, DM FX1]
Type = Explod
trigger1 = animelem = 1, = 1
anim = 8100+10*var(2)
PosType = p1
Ownpal = 1
SprPriority = -2
BindTime = -1
IgnoreHitPause = 1
Pos = 40,-115
RemoveOnGetHit = 1
PauseMoveTime = 99
SuperMoveTime = 99

[State 3000, DM FX 2]
Type = Explod
trigger1 = animelem = 1, = 1
anim = 8101+10*var(2)
PosType = p1
Ownpal = 1
SprPriority = 2
BindTime = -1
IgnoreHitPause = 1
Pos = 40,-115
RemoveOnGetHit = 1
PauseMoveTime = 99
SuperMoveTime = 99

[State 1000, Yashiro Voice]
type = PlaySnd
Trigger1 = AnimElem = 3
value = 50,1
Channel = 2

[State 1300, Vel]
Type = VelSet
Trigger1 = AnimElem = 3
x = 5
y = -8.5

[State 1300, Gravity]
Type = Veladd
Trigger1 = AnimElem = 3, > 0
y = .45

[State 1300, Gravity]
Type = Width
Trigger1 = AnimElem = 3, > 0
Edge = 10,0

[State 1000, 9]
type = ChangeState
trigger1 = AnimElem = 3, > 0
trigger1 = vel y >= -2
value = 3301

;-----------------------------------
;---- Araburu Daichi descending ----
;-----------------------------------
[Statedef 3301]
Type = A
MoveType = A
Physics = N
Anim = 1601
Ctrl = 0
Juggle  = 8
Sprpriority = 1

[State 3000, SDM Set]
Type = BgPalFx
Trigger1 = var(2)
InvertAll = 1
Color = 6
Time = 3
IgnoreHitPause = 1

[State 3020, After Set]
type = AfterImagetime
trigger1 = 1
time = 2
ignorehitpause = 1

[State 1300, Gravity]
Type = Width
Trigger1 = 1
Edge = 10,0

[State 1300, Gravity]
Type = Veladd
Trigger1 = 1
y = .45

[State 800, 1]
type = HitDef
Trigger1 = !var(6)
attr = A, HT
hitflag = M-
priority = 1, Miss
sparkno = -1
sparkxy = -15,-35
HitSound = S800,1
sprpriority = 1
p1facing = 1
p2facing = 1
p1stateno = 3310
p2stateno = 3315+var(2)
Fall = 1
Fall.Recover = 0
Fall.Envshake.Time = 20
Fall.Envshake.Ampl = -8
ID = 3200

[State 200, Over]
Type = ChangeState
Trigger1 = Pos y >= 0
Trigger1 = Vel y >= 0
Value = 1602

;-----------------------------------
;- Araburu Daichi success 1st part -
;-----------------------------------
[Statedef 3310]
Type = S
MoveType = A
Physics = N
Anim = 3310+var(2)
Ctrl = 0
PowerAdd = 0
SprPriority = 1
Velset = 0,0

[State 3000, SDM Set]
Type = BgPalFx
Trigger1 = var(2)
InvertAll = 1
Color = 6
Time = 3
IgnoreHitPause = 1

[State 800, 1]
type = EnvColor
Trigger1 = AnimElem = 1
Value = 255,255,255
Under = 1
IgnoreHitpause = 1
Time = 3

[State 3020, After Set]
type = AfterImagetime
trigger1 = 1
time = 2
ignorehitpause = 1

[State -3, FX]
type = Explod
Trigger1 = AnimElem = 1, = 1
anim = 8220
pos = 0,0
bindtime = 1
ownpal = 1
Ontop = 1
PauseMoveTime = 99
SuperMoveTime = 99

[State 1031, 4]
type = Width
trigger1 = AnimElem = 1
edge = 50,0

[State 810, Out of corners]
type = Width
TriggerAll = var(2)
trigger1 = AnimElem = 15
trigger2 = AnimElem = 29
Edge = 60,0

[State 810, Out of corners]
type = Width
TriggerAll = var(2)
trigger1 = AnimElem = 22
trigger2 = AnimElem = 36
Edge = 0,120

[State 810, grab FX]
type = PlaySnd
TriggerAll = var(2)
trigger1 = AnimElem = 13
trigger2 = AnimElem = 21
trigger3 = AnimElem = 27
trigger4 = AnimElem = 35
Value = 820, 0
Channel = 3

[State 1400, bindtoTarget]
type = bindtoTarget
trigger1 = AnimElem = 1, >= 0
trigger1 = AnimElem = 8, < 0
pos = 0,5, head

[State 1400, Landing]
type = PosSet
trigger1 = AnimElem = 8
y = 0

[State 1400, PosAdd]
type = PosAdd
trigger1 = AnimElem = 8
x = 60

[State 1400, Targetbind]
type = TargetBind
trigger1 = AnimElem = 8, >= 0
Trigger1 = AnimElem = 12, < 0
Pos = -60,0

[State 1400, Targetbind]
type = TargetBind
trigger1 = AnimElem = 12, >= 0
Trigger1 = AnimElem = 13, < 0
Pos = -80,0

[State -3, Landing Sound]
type = PlaySnd
trigger1 = AnimElem = 9
Value = 52,0
Channel = 3

[State -3, OTG FX]
type = Explod
trigger1 = AnimElem = 9
anim = 8300
pos = 0,0
bindtime = 1
ownpal = 1
sprpriority = -3
PauseMoveTime = 99
SuperMoveTime = 99

[State -3, Yashiro's Voice]
type = PlaySnd
trigger1 = AnimElem = 11
Value = 3300,1
Channel = 1

[State -3, PosAdd]
type = PosAdd
Trigger1 = var(2)
trigger1 = AnimElem = 13
x = 55

[State 820, Bind 5]
type = TargetBind
TriggerAll = var(2)
trigger1 = AnimElem = 13, >= 0
trigger1 = AnimElem = 14, < 0
trigger2 = AnimElem = 27, >= 0
trigger2 = AnimElem = 28, < 0
pos = -75, -85

[State 820, Bind 5]
type = TargetBind
TriggerAll = var(2)
trigger1 = AnimElem = 14, >= 0
trigger1 = AnimElem = 15, < 0
trigger2 = AnimElem = 28, >= 0
trigger2 = AnimElem = 29, < 0
pos = -10, -115

[State 820, Bind 5]
type = TargetBind
TriggerAll = var(2)
trigger1 = AnimElem = 15, >= 0
trigger1 = AnimElem = 20, < 0
trigger2 = AnimElem = 29, >= 0
trigger2 = AnimElem = 34, < 0
pos = 20, 0

[State 820, Bind 5]
type = TargetBind
trigger1 = AnimElem = 20, >= 0
trigger1 = AnimElem = 21, < 0
trigger2 = AnimElem = 34, >= 0
trigger2 = AnimElem = 35, < 0
pos = 30, -65

[State 820, Bind 10]
type = TargetBind
trigger1 = AnimElem = 21, >= 0
trigger1 = AnimElem = 22, < 0
trigger2 = AnimElem = 35, >= 0
trigger2 = AnimElem = 36, < 0
pos = -10, -110

[State 820, Bind 10]
type = TargetBind
trigger1 = AnimElem = 22, >= 0
trigger1 = AnimElem = 23, < 0
trigger2 = AnimElem = 36, >= 0
trigger2 = AnimElem = 37, < 0
pos = -85, -100

[State 820, Bind 10]
type = TargetBind
trigger1 = AnimElem = 23, >= 0
trigger1 = AnimElem = 25, < 0
trigger2 = AnimElem = 37, >= 0
trigger2 = AnimElem = 39, < 0
pos = -100, 0

[State 820, Bind 5]
type = TargetBind
trigger1 = AnimElem = 25, >= 0
trigger1 = AnimElem = 26, < 0
trigger2 = AnimElem = 39, >= 0
trigger2 = AnimElem = 40, < 0
pos = -80, 0

[State 820, Bind 5]
type = TargetBind
trigger1 = AnimElem = 26, >= 0
trigger1 = AnimElem = 27, < 0
trigger2 = AnimElem = 40, >= 0
trigger2 = AnimElem = 41, < 0
pos = -75, -40

[State 820, Bind 5]
type = Sprpriority
trigger1 = AnimElem = 17
trigger2 = AnimElem = 31
value = -2

[State 820, Bind 5]
type = Sprpriority
trigger1 = AnimElem = 20
trigger2 = AnimElem = 34
value = 1

[State -3, OTG back FX]
type = Explod
Trigger1 = AnimElem = 23
Trigger2 = AnimElem = 37
anim = 7910
pos = -100,10
bindtime = 1
ownpal = 1
sprpriority = 4
PauseMoveTime = 99
SuperMoveTime = 99

[State -3, OTG front FX]
type = Explod
Trigger1 = var(2)
Trigger1 = AnimElem = 15
trigger2 = AnimElem = 29
anim = 7910
pos = 25,10
bindtime = 1
ownpal = 1
sprpriority = 4
PauseMoveTime = 99
SuperMoveTime = 99

[State -3, OTG back dust]
type = Explod
Trigger1 = AnimElem = 23
Trigger2 = AnimElem = 37
anim = 7920
pos = -100,10
bindtime = 1
ownpal = 1
sprpriority = 3
PauseMoveTime = 99
SuperMoveTime = 99

[State -3, OTG front dust]
type = Explod
Trigger1 = var(2)
Trigger1 = AnimElem = 15
trigger2 = AnimElem = 29
anim = 7920
pos = 25,10
bindtime = 1
ownpal = 1
sprpriority = 3
PauseMoveTime = 99
SuperMoveTime = 99

[State -3, OTG FX]
type = EnvShake
Trigger1 = var(2)
Trigger1 = AnimElem = 15
trigger2 = AnimElem = 23
Trigger3 = AnimElem = 29
Trigger4 = AnimElem = 37
Time = 18
Ampl = -8

[State 800, 1]
type = EnvColor
Trigger1 = var(2)
Trigger1 = AnimElem = 15
trigger2 = AnimElem = 23
Trigger3 = AnimElem = 29
Trigger4 = AnimElem = 37
Value = 255,255,255
Under = 1
IgnoreHitpause = 1
Time = 3

[State 820, Hurt]
type = TargetLifeAdd
Trigger1 = var(2)
Trigger1 = AnimElem = 15
trigger2 = AnimElem = 23
Trigger3 = AnimElem = 29
Trigger4 = AnimElem = 37
value = floor(-50*((10-var(5))*.1))
kill = 0

[State 810, Bind 1]
type = PlaySnd
Trigger1 = var(2)
Trigger1 = AnimElem = 15
trigger2 = AnimElem = 23
Trigger3 = AnimElem = 29
Trigger4 = AnimElem = 37
Value = 850, 0
Channel = 2

[State 1031, 4]
type = PlaySnd
trigger1 = AnimElem = 13
trigger1 = !var(2)
trigger2 = AnimElem = 41
trigger2 = var(2)
value = 50,1
channel = 2

[State 810, Bind 1]
type = Velset
trigger1 = AnimElem = 13
trigger1 = !var(2)
trigger2 = AnimElem = 41
trigger2 = var(2)
x = 2
y = -11

[State 810, Bind 1]
type = Gravity
trigger1 = AnimElem = 13, > 0
trigger1 = !var(2)
trigger2 = AnimElem = 41, > 0
trigger2 = var(2)

[State 820, Bind 5]
type = TargetBind
trigger1 = AnimElem = 13, >= 0
trigger1 = AnimElem = 14, < 0
trigger1 = !var(2)
trigger2 = AnimElem = 41, >= 0
trigger2 = AnimElem = 42, < 0
trigger2 = var(2)
pos = -35, -75

[State 820, Bind 5]
type = TargetBind
trigger1 = AnimElem = 14, >= 0
trigger1 = AnimElem = 15, < 0
trigger1 = !var(2)
trigger2 = AnimElem = 42, >= 0
trigger2 = AnimElem = 43, < 0
trigger2 = var(2)
pos = -25, -105

[State 820, Bind 5]
type = TargetBind
trigger1 = AnimElem = 15, >= 0
trigger1 = !var(2)
trigger2 = AnimElem = 43, >= 0
trigger2 = var(2)
pos = 25, -125

[State 820, State End]
type = ChangeState
triggerAll = Pos y >= 0
triggerAll = Vel y > 0
trigger1 = AnimElem = 15, >= 0
trigger1 = !var(2)
trigger2 = AnimElem = 43, >= 0
trigger2 = var(2)
value = 3320

;-----------------------------------
;---- Araburu Daichi P2 DM - 1 -----
;-----------------------------------
[Statedef 3315]
Type = A
MoveType = H
Physics = N
VelSet = 0
Ctrl = 0
PowerAdd = 50

[State -1, Cancel Combo]
Type = ChangeAnim2
Trigger1 = !time
Value = 3315

[State 1200, End]
type = ChangeState
Trigger1 = Time > 140
value = 5070

;-----------------------------------
;---- Araburu Daichi P2 SDM - 1 ----
;-----------------------------------
[Statedef 3316]
Type = A
MoveType = H
Physics = N
VelSet = 0
Ctrl = 0
PowerAdd = 50

[State -1, Cancel Combo]
Type = ChangeAnim2
Trigger1 = !time
Value = 3316

[State 1200, End]
type = SelfState
Trigger1 = Time > 300
value = 5070

;-----------------------------------
;- Araburu Daichi success 2nd part -
;-----------------------------------
[Statedef 3320]
Type = A
MoveType = A
Physics = N
Anim = 3320
VelSet = 0,0
Ctrl = 0
PowerAdd = 0

[State 3000, SDM Set]
Type = BgPalFx
Trigger1 = var(2)
InvertAll = 1
Color = 6
Time = 3
IgnoreHitPause = 1

[State 800, 1]
type = EnvColor
Trigger1 = AnimElem = 1, = 1
Value = 255,255,255
Under = 1
IgnoreHitpause = 1
Time = 3

[State 3020, After Set]
type = AfterImagetime
trigger1 = 1
time = 2
ignorehitpause = 1

[State 1000, width]
type = width
Trigger1 = AnimElem = 1
Edge = 20,0

[State 1000, width]
type = TargetState
Trigger1 = !Time
Value = 3325

[State 1000, Posset]
type = Posset
Trigger1 = !Time
y = 0

[State 810, Bind 1]
type = PlaySnd
trigger1 = AnimElem = 1
Value = 820, 0
Channel = 3

[State -3, OTG FX]
type = Explod
Trigger1 = AnimElem = 1, = 1
anim = 7910
pos = 20,10
bindtime = 1
ownpal = 1
sprpriority = 4
PauseMoveTime = 99
SuperMoveTime = 99

[State -3, OTG FX]
type = Explod
Trigger1 = AnimElem = 1, = 1
anim = 7920
pos = 20,10
bindtime = 1
ownpal = 1
sprpriority = 3
PauseMoveTime = 99
SuperMoveTime = 99

[State -3, OTG FX]
type = EnvShake
Trigger1 = AnimElem = 1, = 1
Time = 16
Ampl = -8

[State 820, Hurt]
type = TargetLifeAdd
Trigger1 = AnimElem = 1, = 1
value = floor(-100*((10-var(5))*.1))
Kill = 0

[State 810, Bind 1]
type = PlaySnd
Trigger1 = AnimElem = 1, = 1
Value = 850, 1
Channel = 4

[State 1000, bind]
type = Targetbind
Trigger1 = AnimElem = 1, >= 0
Trigger1 = AnimElem = 2, < 0
pos = 20,0

[State 1100, Air Velocity]
Type = PosAdd
Trigger1 = AnimElem = 2
x = 14

[State 1000, bind]
type = Targetbind
Trigger1 = AnimElem = 2, >= 0
Trigger1 = AnimElem = 3, < 0
pos = -20,-20

[State 1100, Air Velocity]
Type = PosAdd
Trigger1 = AnimElem = 3
x = 26

[State 1000, bind]
type = Targetbind
Trigger1 = AnimElem = 3, >= 0
Trigger1 = AnimElem = 4, < 0
pos = -45,-5

[State 1100, Air Velocity]
Type = PosAdd
Trigger1 = AnimElem = 4
x = 77

[State 1000, bind]
type = Targetbind
Trigger1 = AnimElem = 4, >= 0
Trigger1 = AnimElem = 7, < 0
pos = -125,-5

[State 1000, bind]
type = Targetbind
Trigger1 = AnimElem = 7, >= 0
Trigger1 = AnimElem = 8, < 0
pos = -100,-65

[State 1000, bind]
type = Targetbind
Trigger1 = AnimElem = 7, >= 0
Trigger1 = AnimElem = 8, < 0
pos = -100,-65

[State 810, Bind 1]
type = PosAdd
trigger1 = AnimElem = 8
x = -45

[State 1031, 4]
type = PlaySnd
trigger1 = AnimElem = 8
value = 50,1
channel = 2

[State 810, Bind 1]
type = Velset
trigger1 = AnimElem = 8
x = 2
y = -13

[State 810, Bind 1]
type = Gravity
trigger1 = AnimElem = 8, > 0

[State 820, Bind 5]
type = TargetBind
trigger1 = AnimElem = 8, >= 0
pos = -35, -75

[State 1000, 9]
type = ChangeState
Trigger1 = Vel y > -4
Trigger1 = AnimElem = 8, > 0
value = 3330

;-----------------------------------
;---- Araburu Daichi P2 2nd part ---
;-----------------------------------
[Statedef 3325]
Type = A
MoveType = H
Physics = N
VelSet = 0
Ctrl = 0
PowerAdd = 50

[State -1, Cancel Combo]
Type = ChangeAnim2
Trigger1 = !time
Value = 3325

[State 1200, End]
type = SelfState
Trigger1 = Time > 120
value = 5070

;-----------------------------------
;- Araburu Daichi success 3rd part -
;-----------------------------------
[Statedef 3330]
Type = A
MoveType = A
Physics = N
Anim = 3330
Ctrl = 0
PowerAdd = 0
SprPriority = 1

[State 3000, SDM Set]
Type = BgPalFx
Trigger1 = var(2)
InvertAll = 1
Color = 6
Time = 3
IgnoreHitPause = 1

[State 800, 1]
type = EnvColor
Trigger1 = Target, pos y >= 0
Value = 255,255,255
Under = 1
IgnoreHitpause = 1
Persistent = 0
Time = 3

[State 800, 1]
type = TargetLifeAdd
Trigger1 = Target, pos y >= 0
value = -floor(50*((10-var(5))*.1))
IgnoreHitpause = 1
Persistent = 0

[State 800, 1]
type = EnvShake
Trigger1 = Target, pos y >= 0
Time = 25
IgnoreHitpause = 1
Persistent = 0

[State 3020, After Set]
type = AfterImagetime
trigger1 = 1
time = 2
ignorehitpause = 1

[State 1031, 4]
type = width
trigger1 = 1
edge = 50,0

[State 1031, 4]
type = PlaySnd
trigger1 = AnimElem = 1
value = 820,0
channel = 3

[State 1420, targetstate]
type = TargetState
trigger1 = !Time
value = 3335

[State 1400, Targetbind]
type = Targetbind
trigger1 = AnimElem = 1, >= 0
trigger1 = AnimElem = 2, < 0
pos = -60,-80

[State 1400, Targetbind]
type = Targetbind
trigger1 = AnimElem = 2, >= 0
trigger1 = AnimElem = 3, < 0
pos = 25,-120

[State 1400, Targetbind]
type = Targetbind
trigger1 = AnimElem = 3
pos = 30,-50

[State 1400, Targetbind]
type = Gravity
trigger1 = 1

[State 200, Over]
Type = ChangeState
trigger1 = pos y >= 0
trigger1 = vel y > 0
Value = 3340

;-----------------------------------
;---- Araburu Daichi P2 3rd part ---
;-----------------------------------
[Statedef 3335]
Type = A
MoveType = H
Physics = N
Ctrl = 0
PowerAdd = 0
SprPriority = -1
Velset = 0,0

[State 1031, 4]
type = ChangeAnim2
trigger1 = !Time
value = 3335

[State 1031, 4]
type = Velset
trigger1 = AnimElem = 3, = 1
x = -5
y = 25

[State 200, Over]
Type = ChangeState
trigger1 = AnimElem = 3, > 1
Trigger1 = vel y > 0
Trigger1 = Pos y >= 0
Value = 3260

;-----------------------------------
;----- Araburu Daichi Finisher -----
;-----------------------------------
[Statedef 3340]
Type = S
MoveType = I
Physics = N
Anim = 3340
Ctrl = 0
PowerAdd = 0
VelSet = 0,0

[State 3000, SDM Set]
Type = BgPalFx
Trigger1 = var(2)
InvertAll = 1
Color = 6
Time = 3
IgnoreHitPause = 1

[State 800, 1]
type = EnvColor
Trigger1 = projhit(3200) = 1
Value = 255,255,255
Under = 1
IgnoreHitpause = 1
Persistent = 0
Time = 3

[State 3020, After Set]
type = AfterImagetime
trigger1 = 1
time = 2
ignorehitpause = 1

[State 1100, PosSet]
Type = PosSet
Trigger1 = !time
y = 0

[State -3, Landing Sound]
type = PlaySnd
Trigger1 = !Time
Value = 850,0
Channel = 3

[State -3, OTG FX]
type = Explod
Trigger1 = !Time
anim = 8310
pos = 45,0
bindtime = 1
ownpal = 1
sprpriority = -3
PauseMoveTime = 99
SuperMoveTime = 99

[State -3, OTG FX]
type = Explod
Trigger1 = !Time
anim = 8320
pos = 45,0
bindtime = 1
ownpal = 1
sprpriority = 3
PauseMoveTime = 99
SuperMoveTime = 99

[State 200, Quake]
Type = EnvShake
Trigger1 = !Time
Time = 16
Ampl = -6
ignorehitpause = 1

[State 200, Quake]
Type = PlaySND
Trigger1 = AnimElem = 2
Value = 3200,2
channel = 2

[State 1000, 3]
type = Projectile
trigger1 = AnimElem = 2
attr = S, HP
damage = 150, 15
animtype = Up
fall.animtype = Up
getpower = 0,0
givepower = 30,15
guardflag = M
hitflag = MAFD
pausetime = 3,12
sparkno = S8002
guard.sparkno = S8202
sparkxy = -15,-85
hitsound = S5,7
guardsound = S6,0
ground.type = High
air.type = low
ground.slidetime = 17
ground.hittime  = 17
guard.slidetime = 17
guard.hittime = 17
guard.ctrltime = 17
ground.velocity = -4, -7.5
air.velocity = -4,-7
projanim = 3250
projhitanim = 3250
projremanim = 3251
projcancelanim = 3251
ProjRemove = 0
ProjRemovetime = 36
ProjPriority = 9999
velocity = 0
offset = Floor(p2Dist x)+30,0
ID = 3200
projid = 3200
Fall = 1
Fall.Recover = 0
Envshake.Time = 15
yAccel = .5
p2StateNo = 3150
EnvShake.Time = 25

[State 820, State End]
type = ChangeState
trigger1 = !AnimTime
trigger1 = var(9)
value = 195

[State 1000, 9]
type = ChangeState
Trigger1 = !AnimTime
value = 0
Ctrl = 1

;-----------------------------------
;----- Araburu Daichi Classic ------
;-----------------------------------
[Statedef 3400]
Type = S
MoveType = A
Physics = S
Anim = 3400
VelSet = 0,0
Ctrl = 0
PowerAdd = 0
Juggle = 8

[State 3000, SDM Set]
Type = Varset
Trigger1 = !Time
var(2) = 0

[State 3000, SDM Set]
Type = Varset
TriggerAll = !Time
TriggerAll = var(15) || var(51)
TriggerAll = Power >= 1000+1000*var(51)
Trigger1 = Command = "2punches"
Trigger2 = helper(2000),var(7)
Trigger3 = var(9)
Trigger3 = p2Life > 250
var(2) = 1

[State -1, Cancel Combo]
Type = Poweradd
Trigger1 = time = 1
Trigger1 = prevstateno = [1000, 2000]
IgnoreHitPause = 1
value = -1000

[State 3000, PALFX]
type = PalFX
Trigger1 = timemod = 2,1
Trigger1 = time <= 15
ignorehitpause = 1
trigger1 = prevstateno = [1000, 2000]
time = 1
add = 255,255,255
sinadd = -100,-100,-100, 2
ignorehitpause = 1

[State 3000,SCancel1]
type = Explod
trigger1 = time =10 && prevstateno = [1000,2000]
anim = 11100+10*(prevstateno = [1000,1010])
pos = 65,75
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -1
bindtime = -1
ownpal = 1
removeongethit = 1

[State 3000,SCancel2]
type = Explod
trigger1 = time = 1 && prevstateno = [1000,2000]
anim = 11101
pos = 0,75
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -2
bindtime = -1
ownpal = 1
removeongethit = 1

[State 3000,SCancel3]
type = Explod
trigger1 = time = 1 && prevstateno = [1100,2000]
anim = 11102
pos = 0,75
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -3
bindtime = -1
ownpal = 1
removeongethit = 1

[State 3000, SDM Set]
Type = AssertSpecial
Trigger1 = AnimElem = 1, = 1
Flag = NoBG
Flag2 = NoFG
time = 26+16*(PrevStateNo = [1000, 2000])

[State 3000, SDM Set]
Type = EnvColor
Trigger1 = AnimElem = 1, = 1
Value = 255*(PrevStateNo = [1000,1010]),0,0
Under = 1
time = 26+16*(PrevStateNo = [1000, 2000])

[State 3000, SDM Set]
Type = BgPalFx
Trigger1 = var(2)
InvertAll = 1
Time = 3
Color = 6
IgnoreHitPause = 1

[State 3000, SDM Set]
Type = PowerAdd
Trigger1 = Time = 1
Trigger1 = !var(15)
value = -1000

[State 3000, SDM Set]
Type = VarSet
Trigger1 = Time = 1
Trigger1 = var(15)
var(15) = 1

[State 3000, DM Pause]
type = superpause
trigger1 = animelem = 1, = 1
time = 26+16*(PrevStateNo = [1000, 2000])
anim = -1
darken = 1
poweradd = -1000*var(2)
movetime = 26
persistent = 0
ontop = 1
p2defmul = 1

[State 3000, DM FX Sound]
type = PlaySnd
Trigger1 = AnimElem = 1, = 1
Value = 8000, var(2)
Channel = 5
IgnoreHitPause = 1

[State 3000, DM FX1]
Type = Explod
trigger1 = animelem = 1, = 1
anim = 8100+10*var(2)
PosType = p1
Ownpal = 1
SprPriority = -2
BindTime = -1
IgnoreHitPause = 1
Pos = 60,-80
RemoveOnGetHit = 1
PauseMoveTime = 99
SuperMoveTime = 99

[State 3000, DM FX 2]
Type = Explod
trigger1 = animelem = 1, = 1
anim = 8101+10*var(2)
PosType = p1
Ownpal = 1
SprPriority = 2
BindTime = -1
IgnoreHitPause = 1
Pos = 60,-80
RemoveOnGetHit = 1
PauseMoveTime = 99
SuperMoveTime = 99

[State 3000, Yashiro's voice]
type = PlaySnd
Trigger1 = AnimElem = 1, = 1
Value = 3400, 0
Channel = 1
IgnoreHitPause = 1

[State 1000, Invincibility]
type = NotHitBy
Trigger1 = AnimElem = 4, < 0
value = SCA
IgnoreHitPause = 1
Persistent = 1

[State 800, 1]
type = HitDef
Triggerall = p2dist x < 75
Trigger1 = PrevStateNo != [200,2000]
Trigger1 = !var(6)
Trigger1 = AnimElem = 3
attr = S, HT
hitflag = M-
fall.animtype = heavy
ground.type = low
ground.hittime = 60
priority = 7, Miss
Sparkno = -1
sparkxy = 0,-145
HitSound = S800,1
sprpriority = 1
p1facing = 1
p2facing = 1
p1stateno = 3401
p2stateno = 3410+var(2)
Fall = 1
Fall.Recover = 0
Fall.Envshake.Time = 20
Fall.Envshake.Ampl = -8
NumHits = 0
ID = 3200

[State 800, 1]
type = HitDef
Triggerall = p2dist x < 55
Trigger1 = PrevStateNo = [200,2000]
Trigger1 = !var(19)
Trigger1 = AnimElem = 3
attr = S, HT
hitflag = M
fall.animtype = heavy
priority = 1, Miss
ground.type = low
ground.hittime = 60
Sparkno = -1
sparkxy = 0,-145
HitSound = S800,1
sprpriority = 1
p1facing = 1
p2facing = 1
p1stateno = 3401
p2stateno = 3410+var(2)
Fall = 1
Fall.Recover = 0
Fall.Envshake.Time = 20
Fall.Envshake.Ampl = -8
NumHits = 0
ID = 3200

[State 1000, 9]
type = ChangeState
Trigger1 = !AnimTime
value = 0
Ctrl = 1

;-----------------------------------
;-- Araburu Daichi Classic P1 - 1 --
;-----------------------------------
[Statedef 3401]
Type = S
MoveType = A
Physics = N
Anim = 3401+var(2)
VelSet = 0,0
Ctrl = 0
PowerAdd = 0

[State -3, OTG FX]
type = Explod
Trigger1 = AnimElem = 3
anim = 8220
pos = 27,-135
bindtime = 1
ownpal = 1
Ontop = 1
PauseMoveTime = 99
SuperMoveTime = 99

[State 3000, After]
type = AfterImage
trigger1 = !time
time = 2
palmul = .65,.65,.75
palbright = 30,30,30
palcontrast = 120,120,220
timegap = 1
framegap = 5
Trans = add1
color = 0

[State 3020, After Set]
type = AfterImagetime
trigger1 = 1
time = 2
ignorehitpause = 1

[State 3000, SDM Set]
Type = BgPalFx
Trigger1 = var(2)
InvertAll = 1
Color = 6
Time = 3
IgnoreHitPause = 1

[State 810, Out of corners]
type = Width
trigger1 = AnimElem = 1
trigger2 = AnimElem = 13
trigger3 = AnimElem = 26, >= 0
Edge = 50,0

[State 810, Out of corners]
type = Width
trigger1 = AnimElem = 7
trigger2 = AnimElem = 21
Edge = 0,120

[State 810, Bind 1]
type = PlaySnd
trigger1 = AnimElem = 9
Value = 3400, 1
Channel = 1

[State 810, Bind 1]
type = PlaySnd
trigger1 = AnimElem = 5
trigger2 = AnimElem = 12
trigger3 = AnimElem = 19
Value = 820, 0
Channel = 3

[State 820, Bind 1]
type = TargetBind
trigger1 = AnimElem = 1, >= 0
trigger1 = AnimElem = 2, < 0
pos = 55, 0

[State 820, Bind 2]
type = TargetBind
trigger1 = AnimElem = 2, >= 0
trigger1 = AnimElem = 3, < 0
pos = 35, -125

[State 820, Bind 3]
type = TargetBind
trigger1 = AnimElem = 3, >= 0
trigger1 = AnimElem = 4, < 0
pos = 25, -150

[State 820, Bind 4]
type = TargetBind
trigger1 = AnimElem = 4, >= 0
trigger1 = AnimElem = 5, < 0
pos = 25, -148

[State 820, Bind 5]
type = TargetBind
trigger1 = AnimElem = 5, >= 0
trigger1 = AnimElem = 6, < 0
pos = 0, -125


[State 820, Bind 10]
type = TargetBind
trigger1 = AnimElem = 6, >= 0
trigger1 = AnimElem = 7, < 0
trigger2 = AnimElem = 20, >= 0
trigger2 = AnimElem = 21, < 0
pos = -10, -110

[State 820, Bind 10]
type = TargetBind
trigger1 = AnimElem = 7, >= 0
trigger1 = AnimElem = 8, < 0
trigger2 = AnimElem = 21, >= 0
trigger2 = AnimElem = 22, < 0
pos = -85, -100

[State 820, Bind 10]
type = TargetBind
trigger1 = AnimElem = 8, >= 0
trigger1 = AnimElem = 10, < 0
trigger2 = AnimElem = 22, >= 0
trigger2 = AnimElem = 24, < 0
pos = -100, 0

[State 820, Bind 5]
type = TargetBind
trigger1 = AnimElem = 10, >= 0
trigger1 = AnimElem = 11, < 0
trigger2 = AnimElem = 24, >= 0
trigger2 = AnimElem = 25, < 0
pos = -80, 0

[State 820, Bind 5]
type = TargetBind
trigger1 = AnimElem = 11, >= 0
trigger1 = AnimElem = 12, < 0
trigger2 = AnimElem = 25, >= 0
trigger2 = AnimElem = 26, < 0
pos = -75, -40

[State 820, Bind 5]
type = TargetBind
trigger1 = AnimElem = 12, >= 0
trigger1 = AnimElem = 13, < 0
trigger1 = var(2)
pos = -75, -85

[State 820, Bind 5]
type = TargetBind
trigger1 = AnimElem = 13, >= 0
trigger1 = AnimElem = 14, < 0
trigger1 = var(2)
pos = -10, -115

[State 820, Bind 5]
type = TargetBind
trigger1 = AnimElem = 14, >= 0
trigger1 = var(2)
trigger1 = AnimElem = 19, < 0
pos = 20, 0

[State 820, Bind 5]
type = TargetBind
trigger1 = AnimElem = 19, >= 0
trigger1 = AnimElem = 20, < 0
pos = 30, -65

[State 820, Bind 5]
type = Sprpriority
trigger1 = AnimElem = 16
value = -2

[State 820, Bind 5]
type = Sprpriority
trigger1 = AnimElem = 19
value = 1

[State -3, OTG FX]
type = Explod
Trigger1 = AnimElem = 8
trigger2 = AnimElem = 14
trigger2 = var(2)
trigger3 = AnimElem = 22
trigger3 = var(2)
anim = 7910
pos = 125*(Animelem = 14)-100,10
bindtime = 1
ownpal = 1
sprpriority = 4
PauseMoveTime = 99
SuperMoveTime = 99

[State -3, OTG FX]
type = Explod
Trigger1 = AnimElem = 8
trigger2 = AnimElem = 14
trigger2 = var(2)
trigger3 = AnimElem = 22
trigger3 = var(2)
anim = 7920
pos = 125*(Animelem = 14)-100,10
bindtime = 1
ownpal = 1
sprpriority = 3
PauseMoveTime = 99
SuperMoveTime = 99

[State -3, OTG FX]
type = EnvShake
Trigger1 = AnimElem = 8
trigger2 = AnimElem = 14
trigger2 = var(2)
trigger3 = AnimElem = 22
trigger3 = var(2)
Time = 12+2*var(2)
Ampl = -6-var(2)

[State 820, Hurt]
type = TargetLifeAdd
trigger1 = AnimElem = 8
trigger2 = AnimElem = 14
trigger2 = var(2)
trigger3 = AnimElem = 22
trigger3 = var(2)
value = floor(-50*((10-var(5))*.1))
kill = 0

[State 810, Bind 1]
type = PlaySnd
trigger1 = AnimElem = 8
trigger2 = AnimElem = 14
trigger2 = var(2)
trigger3 = AnimElem = 22
Value = 850, 0
Channel = 2

[State 810, Bind 1]
type = PosAdd
trigger1 = AnimElem = 12
trigger1 = !var(2)
trigger2 = AnimElem = 26
x = -45

[State 1031, 4]
type = PlaySnd
trigger1 = AnimElem = 12
trigger1 = !var(2)
trigger2 = AnimElem = 26
value = 50,1
channel = 2

[State 810, Bind 1]
type = Velset
trigger1 = AnimElem = 12
trigger1 = !var(2)
trigger2 = AnimElem = 26
x = 2
y = -11

[State 810, Bind 1]
type = Gravity
trigger1 = AnimElem = 12, > 0
trigger1 = !var(2)
trigger2 = AnimElem = 26, > 0

[State 820, Bind 5]
type = TargetBind
trigger1 = AnimElem = 12, >= 0
trigger1 = AnimElem = 13, < 0
trigger1 = !var(2)
trigger2 = AnimElem = 26, >= 0
trigger2 = AnimElem = 27, < 0
pos = -35, -75

[State 820, Bind 5]
type = TargetBind
trigger1 = AnimElem = 13, >= 0
trigger1 = AnimElem = 14, < 0
trigger1 = !var(2)
trigger2 = AnimElem = 27, >= 0
trigger2 = AnimElem = 28, < 0
pos = -25, -105

[State 820, Bind 5]
type = TargetBind
trigger1 = AnimElem = 14, >= 0
trigger1 = !var(2)
trigger2 = AnimElem = 28, >= 0
pos = 25, -125

[State 820, State End]
type = ChangeState
triggerAll = Pos y >= 0
triggerAll = Vel y > 0
trigger1 = AnimElem = 14, >= 0
trigger1 = !var(2)
trigger2 = AnimElem = 28, >= 0
value = 3320

;-----------------------------------
;-- Araburu Daichi Classic Cancel --
;-----------------------------------
[Statedef 3405]
Type = S
MoveType = A
Physics = S
Anim = 3405
VelSet = 0,0
Ctrl = 0
PowerAdd = 0
Juggle = 0

[State 3000, SDM Set]
Type = Varset
Trigger1 = !Time
var(2) = 0

[State 3000, SDM Set]
Type = Varset
TriggerAll = !Time
TriggerAll = var(15) || var(51)
TriggerAll = Power >= 1000+1000*var(51)
Trigger1 = Command = "2punches"
Trigger2 = helper(2000),var(7)
Trigger3 = var(9)
Trigger3 = p2Life > 250
var(2) = 1

[State -1, Cancel Combo]
Type = Poweradd
Trigger1 = time = 1
IgnoreHitPause = 1
value = -1000

[State 3000, PALFX]
type = PalFX
Trigger1 = timemod = 2,1
Trigger1 = time <= 15
ignorehitpause = 1
time = 1
add = 255,255,255
sinadd = -100,-100,-100, 2
ignorehitpause = 1

[State 3000,SCancel1]
type = Explod
trigger1 = time = 10
anim = 11110
pos = 65,75
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -1
bindtime = -1
ownpal = 1
removeongethit = 1

[State 3000,SCancel2]
type = Explod
trigger1 = time = 1
anim = 11101
pos = 0,75
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -2
bindtime = -1
ownpal = 1
removeongethit = 1

[State 3000, SDM Set]
Type = AssertSpecial
Trigger1 = AnimElem = 1, = 1
Flag = NoBG
Flag2 = NoFG
time = 42

[State 3000, SDM Set]
Type = EnvColor
Trigger1 = AnimElem = 1, = 1
Value = 255,0,0
Under = 1
time = 42

[State 3000, SDM Set]
Type = BgPalFx
Trigger1 = var(2)
InvertAll = 1
Time = 3
Color = 6
IgnoreHitPause = 1

[State 3000, SDM Set]
Type = PowerAdd
Trigger1 = Time = 1
Trigger1 = !var(15)
value = -1000

[State 3000, SDM Set]
Type = VarSet
Trigger1 = Time = 1
Trigger1 = var(15)
var(15) = 1

[State 3000, DM Pause]
type = superpause
trigger1 = animelem = 1, = 1
time = 42
anim = -1
darken = 1
poweradd = -1000*var(2)
movetime = 26
persistent = 0
ontop = 1
p2defmul = 1

[State 3000, DM FX Sound]
type = PlaySnd
Trigger1 = AnimElem = 1, = 1
Value = 8000, var(2)
Channel = 5
IgnoreHitPause = 1

[State 3000, DM FX1]
Type = Explod
trigger1 = animelem = 1, = 1
anim = 8100+10*var(2)
PosType = p1
Ownpal = 1
SprPriority = -2
BindTime = -1
IgnoreHitPause = 1
Pos = 60,-80
RemoveOnGetHit = 1
PauseMoveTime = 99
SuperMoveTime = 99

[State 3000, DM FX 2]
Type = Explod
trigger1 = animelem = 1, = 1
anim = 8101+10*var(2)
PosType = p1
Ownpal = 1
SprPriority = 2
BindTime = -1
IgnoreHitPause = 1
Pos = 60,-80
RemoveOnGetHit = 1
PauseMoveTime = 99
SuperMoveTime = 99

[State 3000, Yashiro's voice]
type = PlaySnd
Trigger1 = AnimElem = 1, = 1
Value = 3400, 0
Channel = 1
IgnoreHitPause = 1

[State 1000, Power set]
Type = PosAdd
Trigger1 = AnimElem = 3
x = 12

[State 1000, Power set]
Type = PosAdd
Trigger1 = !AnimTime
x = -12

[State 800, 1]
type = HitDef
Trigger1 = p2dist x < 75
Trigger1 = AnimElem = 2
attr = S, HT
hitflag = MAFD
fall.animtype = heavy
priority = 1, Miss
ground.type = low
ground.hittime = 60
Sparkno = -1
HitSound = S800,1
sprpriority = 1
p1facing = 1
p2facing = 1
p1stateno = 3401
p2stateno = 3410+var(2)
Fall = 1
Fall.Recover = 0
Fall.Envshake.Time = 20
Fall.Envshake.Ampl = -8
NumHits = 0
ID = 3200

[State 1000, 9]
type = ChangeState
Trigger1 = !AnimTime
value = 0
Ctrl = 1

;-----------------------------------
; Araburu Daichi Classic DM P2 - 1 -
;-----------------------------------
[Statedef 3410]
Type = A
MoveType = H
Physics = N
VelSet = 0
Ctrl = 0
PowerAdd = 50

[State -1, Cancel Combo]
Type = ChangeAnim2
Trigger1 = !time
Value = 3410

[State 1200, End]
type = ChangeState
Trigger1 = Time > 120
value = 5070

;-----------------------------------
; Araburu Daichi Classic SDM P2 - 1
;-----------------------------------
[Statedef 3411]
Type = A
MoveType = H
Physics = N
VelSet = 0
Ctrl = 0
PowerAdd = 50

[State -1, Cancel Combo]
Type = ChangeAnim2
Trigger1 = !time
Value = 3411

[State 1200, End]
type = ChangeState
Trigger1 = Time > 300
value = 5070

;============================================================================
; Hidden Super Danger Moves
;============================================================================
;-----------------------------------
;-------- [ERROR] CODE 2002 --------
;-----------------------------------
[Statedef 4000]
Type = S
MoveType = A
Physics = N
Anim = 4000
VelSet = 0
Ctrl = 0
PowerAdd = 0
Juggle = 8

[State 3000,SCancel1]
type = Explod
trigger1 = time = 10 && prevstateno = [1000,2000]
anim = 11100+10*(prevstateno = 1000)
pos = 65,75
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -1
bindtime = -1
ownpal = 1
removeongethit = 1

[State 3000,SCancel2]
type = Explod
trigger1 = !time && prevstateno = [1000,2000]
anim = 11101
pos = 0,75
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -2
bindtime = -1
ownpal = 1
removeongethit = 1

[State 3000,SCancel3]
type = Explod
trigger1 = !time && prevstateno = [1100,2000]
anim = 11102
pos = 0,75
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -3
bindtime = -1
ownpal = 1
removeongethit = 1

[State 3000,Dcancel1]
type = Explod
trigger1 = !time && prevstateno = [3000,4000]
anim = 11200
pos = 0,85
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -1
bindtime = -1
ownpal = 1
removeongethit = 1

[State 3000,Dcancel2]
type = Explod
trigger1 = !time && prevstateno = [3000,4000]
anim = 11201
pos = 0,85
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -2
bindtime = -1
ownpal = 1
removeongethit = 1

[State 3000,Dcancel3]
type = Explod
trigger1 = !time && prevstateno = [3000,4000]
anim = 11202
pos = 0,85
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -3
bindtime = -1
ownpal = 1
removeongethit = 1

[State -1, Cancel Combo]
Type = Poweradd
Trigger1 = !time
Trigger1 = prevstateno = [1000, 3999]
IgnoreHitPause = 1
value = -1000

[State 3000, PALFX]
type = PalFX
Trigger1 = timemod = 2,0
Trigger1 = time <= 15
ignorehitpause = 1
Trigger1 = prevstateno = [1000, 3999]
time = 1
add = 255,255,255
sinadd = -100,-100,-100, 2
ignorehitpause = 1

[State 3000, SDM Set]
Type = AssertSpecial
Trigger1 = AnimElem = 4
Flag = NoBG
Flag2 = NoFG
time = 26+16*(PrevStateNo = [1000, 3999])

[State 3000, SDM Set]
Type = EnvColor
Trigger1 = AnimElem = 4
Value = 255*(PrevStateNo = 1000),0,0
Under = 1
time = 26+16*(PrevStateNo = [1000, 3999])

[State 3000, After]
type = AfterImage
trigger1 = AnimElem = 4
time = 2
palmul = .65,.65,.75
palbright = 30,30,30
palcontrast = 120,120,220
timegap = 1
framegap = 5
Trans = add1
color = 0

[State 3020, After Set]
type = AfterImagetime
trigger1 = AnimElem = 4, > 0
time = 2
ignorehitpause = 1

[State 3000, SDM Set]
Type = PowerAdd
Trigger1 = !Time
Trigger1 = !var(15)
value = -1000

[State 3000, SDM Set]
Type = VarSet
Trigger1 = !Time
var(15) = 1

[State 3000,HSDM BG]
type = Explod
trigger1 = AnimElem = 5
anim = 11000
ID = 11000
pos = 0,0
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -5
bindtime = -1
ownpal = 1
removetime = -1
removeongethit = 1

[State 3000, DM Pause]
type = superpause
trigger1 = animelem = 4
time = 26+16*(PrevStateNo = [1000, 3999])
anim = -1
darken = 1
poweradd = -1000
movetime = 26
persistent = 0
ontop = 1
p2defmul = 1

[State 3000, DM FX Sound]
type = PlaySnd
Trigger1 = AnimElem = 4
Value = 8000, 2
Channel = 5
IgnoreHitPause = 1

[State 3000, DM FX Sound]
type = PlaySnd
Trigger1 = AnimElem = 6
Value = 105, 0
Channel = 1
IgnoreHitPause = 1

[State 3000, DM FX1]
Type = Explod
trigger1 = animelem = 4
anim = 8120
PosType = p1
Ownpal = 1
SprPriority = -2
BindTime = -1
IgnoreHitPause = 1
Pos = 25,-15
RemoveOnGetHit = 1
PauseMoveTime = 99
SuperMoveTime = 99

[State 3000, DM FX 2]
Type = Explod
trigger1 = animelem = 4
anim = 8121
PosType = p1
Ownpal = 1
SprPriority = 2
BindTime = -1
IgnoreHitPause = 1
Pos = 25,-15
RemoveOnGetHit = 1
PauseMoveTime = 99
SuperMoveTime = 99

[State 3000, DM FX Sound]
type = StateTypeSet
Trigger1 = AnimElem = 6
StateType = A
IgnoreHitPause = 1

[State 3100, First Hits]
Type = HitDef
Trigger1 = AnimElem = 6
attr = A, HA
damage = 0, 15
animtype = Heavy
Fall.animtype = Heavy
getpower = 0,0
givepower = 30,15
guardflag = M
hitflag = MAF
pausetime = 6,6
guard.pausetime = 6,6
sparkno = S8002
guard.sparkno = S8012
sparkxy = -15,-75
hitsound = S5,4
guardsound = S6,0
ground.type = low
ground.slidetime = 20
ground.hittime  = 20
guard.slidetime = 17
guard.hittime = 17
guard.ctrltime = 17
guard.velocity = -9.3
ground.velocity = -4, -5.5
ground.cornerpush.veloff = 0;0
guard.cornerpush.veloff = 0;0
air.velocity = -4,-4.5
yAccel = .5
Fall = 1
Fall.Recover = !var(55)
Fall.RecoverTime = 35
EnvShake.Time = 5
Kill = 0

[State 1100, Dash Velocity]
Type = VelSet
Trigger1 = AnimElem = 6
x = 10

[State 1000, 9]
type = ChangeState
Trigger1 = MoveHit
Trigger1 = Target, alive
value = 4002

[State 1000, 9]
type = ChangeState
Trigger1 = !Animtime
Trigger2 = MoveGuarded
value = 4001

;-----------------------------------
;---- [ERROR] CODE 2002 missed ----
;-----------------------------------
[Statedef 4001]
Type = S
MoveType = I
Physics = N
Anim = 4001
Ctrl = 0
PowerAdd = 0

[State -3, VelMul]
type = VelMul
trigger1 = 1
x = .9

[State -3, Landing Sound]
type = PlaySnd
trigger1 = AnimElem = 1
Value = 52,0
Channel = 3

[State -3, OTG FX]
type = Explod
trigger1 = AnimElem = 1
anim = 8300
pos = 0,0
bindtime = 1
ownpal = 1
sprpriority = -3
PauseMoveTime = 99
SuperMoveTime = 99

[State 3020, After Set]
type = AfterImagetime
trigger1 = 1
time = 2
ignorehitpause = 1

[State 1000, 9]
type = ChangeState
Trigger1 = !AnimTime
value = 0
Ctrl = 1

;-----------------------------------
;---- [ERROR] CODE 2002 Success ----
;-----------------------------------
[Statedef 4002]
Type = S
MoveType = A
Physics = S
Anim = 4002
VelSet = 0, 0
Ctrl = 0
PowerAdd = 0

[State 810, Bind 1]
type = NotHitBy
trigger1 = 1
Value = SCA
Ignorehitpause = 1

[State 810, Bind 1]
type = TargetState
trigger1 = !Time
Value = 6200

[State 810, Bind 1]
type = Width
trigger1 = !Time
Edge = 65,0

[State 810, Bind 1]
type = TargetBind
trigger1 = AnimElem = 1
pos = 65, 0

[State 1100, Yashiro's Voice]
Type = PlaySnd
Trigger1 = AnimElem = 10
Value = 4000, 0
Channel = 1

[State 200, light high]
Type = HitDef
Trigger1 = AnimElem = 2
Trigger2 = AnimElem = 52
attr = S, HA
damage = 20, 2
AnimType = Light
getpower = 0,0
givepower = 3,1
Guardflag = M
Hitflag = MAF
pauseTime = 0,0
SparkNo = S8000
Guard.SparkNo = S8010
sparkxy = -15,-70
HitSound = S5,0
GuardSound = S6,0
ground.Type = High
ground.SlideTime = 20
ground.HitTime  = 20
ground.Velocity = 0
Air.Velocity = 0
Ground.cornerpush.veloff = 0;0
Air.cornerpush.veloff = 0;0
Kill = 0

[State 200, light low]
Type = HitDef
Trigger1 = AnimElem = 8
attr = S, HA
damage = 20, 2
AnimType = Light
getpower = 0,0
givepower = 3,1
Guardflag = M
Hitflag = MAF
pauseTime = 0,0
SparkNo = S8000
Guard.SparkNo = S8010
sparkxy = -15,-25
HitSound = S5,1
GuardSound = S6,0
ground.Type = Low
ground.SlideTime = 20
ground.HitTime  = 20
ground.Velocity = 0
Air.Velocity = 0
Ground.cornerpush.veloff = 0;0
Air.cornerpush.veloff = 0;0
Kill = 0

[State 210,PosAdd]
type = PosAdd
trigger1 = AnimElem = 25
trigger2 = AnimElem = 26
trigger3 = AnimElem = 27
x = 5

[State 200, medium high]
Type = HitDef
Trigger1 = AnimElem = 20
Trigger2 = AnimElem = 29
attr = S, HA
damage = 20, 2
AnimType = Medium
getpower = 0,0
givepower = 3,1
Guardflag = M
Hitflag = MAF
pauseTime = 0,0
SparkNo = S8001
Guard.SparkNo = S8011
sparkxy = -15,-80-10*(animElem = 29)
HitSound = S5,2+(animElem = 29)
GuardSound = S6,0
ground.Type = High
ground.SlideTime = 20
ground.HitTime  = 20
ground.Velocity = 0
Air.Velocity = 0
Ground.cornerpush.veloff = 0;0
Air.cornerpush.veloff = 0;0
Kill = 0

[State 200, Strong high]
Type = HitDef
Trigger1 = AnimElem = 13
Trigger2 = AnimElem = 39
attr = S, HA
damage = 20, 2
AnimType = Heavy
getpower = 0,0
givepower = 3,1
Guardflag = M
Hitflag = MAF
pauseTime = 0,0
SparkNo = S8001
Guard.SparkNo = S8011
sparkxy = -15,-90+20*(animElem = 39)
HitSound = S5,4
GuardSound = S6,0
ground.Type = High
ground.SlideTime = 20
ground.HitTime  = 20
ground.Velocity = 0
Air.Velocity = 0
Ground.cornerpush.veloff = 0;0
Air.cornerpush.veloff = 0;0
Kill = 0

[State 200, Strong low]
Type = HitDef
Trigger1 = AnimElem = 45
attr = S, HA
damage = 20, 2
AnimType = Heavy
getpower = 0,0
givepower = 3,1
Guardflag = M
Hitflag = MAF
pauseTime = 3,3
SparkNo = S8001
Guard.SparkNo = S8011
sparkxy = -15,-25
HitSound = S5,5
GuardSound = S6,0
ground.Type = Low
ground.SlideTime = 20
ground.HitTime  = 20
ground.Velocity = 0
Air.Velocity = 0
Ground.cornerpush.veloff = 0;0
Air.cornerpush.veloff = 0;0
Kill = 0

[State 210,Velset]
type = Velset
trigger1 = AnimElem = 55
trigger2 = AnimElem = 72
x = 4

[State 200, Jet High]
Type = HitDef
Trigger1 = AnimElem = 62
Trigger2 = AnimElem = 89
attr = S, HA
damage = 50, 5
AnimType = Heavy
getpower = 0,0
givepower = 3,1
Guardflag = M
Hitflag = MAF
pauseTime = 6,6
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,-90
HitSound = S5,6
GuardSound = S6,0
ground.Type = High
ground.SlideTime = 30
ground.HitTime  = 30
ground.Velocity = -4
Air.Velocity = 0
Ground.cornerpush.veloff = 0
Air.cornerpush.veloff = 0
Kill = 0

[State 210,PosAdd]
type = PosAdd
trigger1 = AnimElem = 77
trigger2 = AnimElem = 78
trigger3 = AnimElem = 79
trigger4 = AnimElem = 80
trigger5 = AnimElem = 104
trigger6 = AnimElem = 105
trigger7 = AnimElem = 106
trigger8 = AnimElem = 107
x = 15

[State 200, Jet Low]
Type = HitDef
Trigger1 = AnimElem = 76
Trigger2 = AnimElem = 103
attr = S, HA
damage = 60, 6
AnimType = Heavy
getpower = 0,0
givepower = 3,1
Guardflag = M
Hitflag = MAF
pauseTime = 6,13
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,-45
HitSound = S5,6
GuardSound = S6,0
ground.Type = Low
ground.SlideTime = 30
ground.HitTime  = 30
ground.Velocity = -9.5
Air.Velocity = 0
Ground.cornerpush.veloff = 0;0
Air.cornerpush.veloff = 0;0
Kill = 0

[State 3000, After]
type = AfterImage
trigger1 = AnimElem = 109
time = 2
palmul = .65,.65,.75
palbright = 30,30,30
palcontrast = 120,120,220
timegap = 1
framegap = 5
Trans = add1
color = 0

[State 3020, After Set]
type = AfterImagetime
trigger1 = AnimElem = 109, > 0
time = 2
ignorehitpause = 1

[State 200, Finisher]
Type = HitDef
Trigger1 = AnimElem = 113
attr = S, HA
damage = 50, 5
AnimType = Heavy
getpower = 0,0
givepower = 3,1
Guardflag = M
Hitflag = MAF
pauseTime = 25,27
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,-65
HitSound = S5,6
GuardSound = S6,0
ground.Type = Low
ground.SlideTime = 30
ground.HitTime  = 30
ground.Velocity = 0
Air.Velocity = 0
Ground.cornerpush.veloff = 0;0
Air.cornerpush.veloff = 0;0
Envshake.time = 25

[State 3020, 2]
Type = TargetState
Trigger1 = MoveHit
Trigger1 = AnimElem = 113, < 0
Value = 6200
ignoreHitpause = 1

[State 3020, After Set]
type = varset
trigger1 = AnimElem = 113, >= 0
var(7) = 1
ignorehitpause = 1

[State 3020, 2]
Type = MovehitReset
Trigger1 = Movecontact
ignoreHitpause = (AnimElem = 114, < 0)

[State 1000, 9]
type = ChangeState
Trigger1 = !AnimTime
value = 3103

;-----------------------------------
;----------- Armageddon ------------
;-----------------------------------
[Statedef 4100]
Type = S
MoveType = A
Physics = N
Anim = 4100+(prevstateno = 3001)
VelSet = 0
Ctrl = 0
PowerAdd = 0
Juggle = 8*(prevstateno != [1000,4000])

[State 3000,SCancel1]
type = Explod
trigger1 = time = 10 && prevstateno = [1000,2000]
anim = 11100+10*(prevstateno = 1000)
pos = 65,75
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -1
bindtime = -1
ownpal = 1
removeongethit = 1

[State 3000,SCancel2]
type = Explod
trigger1 = !time && prevstateno = [1000,2000]
anim = 11101
pos = 0,75
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -2
bindtime = -1
ownpal = 1
removeongethit = 1

[State 3000,SCancel3]
type = Explod
trigger1 = !time && prevstateno = [1100,2000]
anim = 11102
pos = 0,75
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -3
bindtime = -1
ownpal = 1
removeongethit = 1

[State 3000,Dcancel1]
type = Explod
trigger1 = !time && prevstateno = [3000,4000]
anim = 11200
pos = 0,85
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -1
bindtime = -1
ownpal = 1
removeongethit = 1

[State 3000,Dcancel2]
type = Explod
trigger1 = !time && prevstateno = [3000,4000]
anim = 11201
pos = 0,85
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -2
bindtime = -1
ownpal = 1
removeongethit = 1

[State 3000,Dcancel3]
type = Explod
trigger1 = !time && prevstateno = [3000,4000]
anim = 11202
pos = 0,85
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -3
bindtime = -1
ownpal = 1
removeongethit = 1

[State -1, Cancel Combo]
Type = Poweradd
Trigger1 = !time
Trigger1 = prevstateno = [1000, 3999]
IgnoreHitPause = 1
value = -1000

[State 3000, PALFX]
type = PalFX
Trigger1 = timemod = 2,0
Trigger1 = time <= 15
ignorehitpause = 1
Trigger1 = prevstateno = [1000, 3999]
time = 1
add = 255,255,255
sinadd = -100,-100,-100, 2
ignorehitpause = 1

[State 3000, SDM Set]
Type = AssertSpecial
trigger1 = animelem = 1, = 1
Flag = NoBG
Flag2 = NoFG
time = 26+16*(PrevStateNo = [1000, 3999])

[State 3000, SDM Set]
Type = EnvColor
trigger1 = animelem = 1, = 1
Value = 255*(PrevStateNo = 1000),0,0
Under = 1
time = 26+16*(PrevStateNo = [1000, 3999])

[State 3000, SDM Set]
Type = PowerAdd
Trigger1 = !Time
Trigger1 = !var(15)
value = -1000

[State 3000, SDM Set]
Type = VarSet
Trigger1 = !Time
var(15) = 1

[State 3000,HSDM BG]
type = Explod
trigger1 = AnimElem = 2
anim = 7930
ID = 11000
pos = 0,0
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -5
bindtime = -1
ownpal = 1
removetime = -1
removeongethit = 1

[State 3000, DM Pause]
type = superpause
trigger1 = animelem = 1, = 1
time = 26+16*(PrevStateNo = [1000, 3999])
anim = -1
darken = 1
poweradd = -1000
movetime = 26
persistent = 0
ontop = 1
p2defmul = 1

[State 3000, DM FX Sound]
type = PlaySnd
trigger1 = animelem = 1, = 1
Value = 8000, 2
Channel = 5
IgnoreHitPause = 1

[State 3000, DM FX Sound]
type = PlaySnd
Trigger1 = AnimElem = 6
Value = 105, 0
Channel = 3
IgnoreHitPause = 1

[State 3000, DM FX Sound]
type = PlaySnd
Trigger1 = AnimElem = 1, = 1
Value = 191, 0
Channel = 2
IgnoreHitPause = 1

[State 3000, Yashiro's Voice]
type = PlaySnd
Trigger1 = AnimElem = 1, = 1
Value = 5000, 3
Channel = 1
IgnoreHitPause = 1

[State 3000, Yashiro's Voice]
type = PlaySnd
Trigger1 = AnimElem = 6
Value = 4100, 0
Channel = 1
IgnoreHitPause = 1

[State 3000, DM FX1]
Type = Explod
trigger1 = animelem = 1, = 1
anim = 8120
PosType = p1
Ownpal = 1
SprPriority = -2
BindTime = -1
IgnoreHitPause = 1
Pos = -25,-60
RemoveOnGetHit = 1
PauseMoveTime = 99
SuperMoveTime = 99

[State 3000, DM FX 2]
Type = Explod
trigger1 = animelem = 1, = 1
anim = 8121
PosType = p1
Ownpal = 1
SprPriority = 2
BindTime = -1
IgnoreHitPause = 1
Pos = -25,-60
RemoveOnGetHit = 1
PauseMoveTime = 99
SuperMoveTime = 99

[State 3000, Posadd]
type = PosAdd
Trigger1 = AnimElem = 2
Trigger2 = AnimElem = 3
Trigger3 = AnimElem = 4
Trigger4 = AnimElem = 6
Trigger5 = AnimElem = 7
Trigger6 = AnimElem = 8
Trigger7 = AnimElem = 9
x = 15

[State 191, 1]
Type = EnvShake
Trigger1 = time > 27
Trigger1 = Timemod = 5,0
Trigger1 = AnimElem = 10, < 0
Time = 5
Ampl = 3

[State 310, armor]
type = reversaldef
trigger1 = animelem = 9, < 0
reversal.attr = SCA, AA, AP
attr = S, HP
pausetime = 10,12
sparkno = S8002
sparkxy = 10,0
hitsound = S6,0
numhits = 0
hitflag = MAP
Persistent = 1

[State 3020, 2]
type = movehitreset
trigger1 = animelem = 9, < 0
ignorehitpause = 1

[State 3020, 2]
type = NotHitBy
trigger1 = animelem = 9, < 3
Value = SCA, AA, AP
ignorehitpause = 1

[State 3100, DA PUNCH!!!]
Type = HitDef
Trigger1 = AnimElem = 9
attr = S, HA
damage = 500-100*(prevStateNo = [3000,3999]),500-100*(prevStateNo = [3000,3999])
animtype = DiagUp
getpower = 0,0
givepower = 300,150
guardflag =
hitflag = MAF
pausetime = 8,12
guard.pausetime = 8,12
sparkno = S8002
guard.sparkno = S8012
sparkxy = -15,-60
hitsound = S5,7
guardsound = S6,0
ground.type = low
ground.slidetime = 20
ground.hittime  = 20
guard.slidetime = 17
guard.hittime = 17
guard.ctrltime = 17
guard.velocity = -9.3
ground.velocity = -6.5, -7.5
ground.cornerpush.veloff = 0;0
guard.cornerpush.veloff = 0;0
air.velocity = -6.5,-6.5
yAccel = .5
Fall = 1
Fall.Recover = 0
EnvShake.Time = 20

[State 3000, Posadd]
type = PosAdd
Trigger1 = AnimElem = 14
x = 11

[State 1100, Dash Velocity]
Type = VelSet
Trigger1 = AnimElem = 6
x = 14-12*(prevStateNo = 1420 || prevStateNo = 3202)

[State 1100, STOP!]
Type = VelSet
Trigger1 = AnimElem = 14
x = 0

[State 1100, Dash Velocity]
Type = VelMul
Trigger1 = AnimElem = 9, > 0
x = .9

[State 1000, 9]
type = ChangeState
Trigger1 = !Animtime
value = 0
Ctrl = 1
;============================================================================
; Custom Gethit States
;============================================================================
;-----------------------------------
;----------- Guard Kill ------------
;-----------------------------------
[Statedef 5950]
type = U
movetype = H
physics = S
ctrl = 0
velset = 0, 0

[State 5950,Invincible]
type = NotHitBy
trigger1 = 1
value = SCA

[State 5950, GUARDING]
type = ChangeAnim
trigger1 = !HitOver
value = 150+var(27)

[State 5950, collapse]
type = ChangeAnim
Trigger1 = HitOver
Trigger1 = anim != 5950
value = 5950

[State 5950, Ouch]
type = PalFX
trigger1 = anim = 5950
trigger1 = AnimElem = 1
time = 1

[State 5950, Ouch]
type = PlaySnd
trigger1 = anim = 5950
trigger1 = AnimElem = 1
value = 5000+(var(1) > 1), 3

[State 5950, dead]
type = ChangeState
Trigger1 = AnimElem = 9
trigger1 = anim = 5950
value = 5150
ctrl = 0

;-----------------------------------
;-------- Juggle Type Fall ---------
;-----------------------------------
[Statedef 6000]
type    = A
movetype= H
physics = N
velset = 0,0

[State 6000, Change by HitType1]
type = ChangeAnim
trigger1 = !Time
trigger1 = GetHitVar(animtype) != [3,5]
value = ifelse((GetHitVar(airtype) = 1),5000,5010) + GetHitVar(animtype)

[State 6000, Change by HitType2]
type = ChangeAnim
trigger1 = !Time
trigger1 = GetHitVar(animtype) = [3,5]
value = 5012

[State 6000, Change by HitType3]
type = ChangeAnim
trigger1 = !Time
trigger1 = (GetHitVar(animtype) = [4,5]) && (SelfAnimExist(5047 + GetHitVar(animtype)))
value = 5047 + GetHitVar(animtype) ;5051 - 4 + type

[State 6000, Change by HitType4]
type = ChangeAnim
trigger1 = Time > 0
value = anim

[State 6000, NOT Falling]
type = hitfallset
trigger1 = Time > 0
value = 0
ignorehitpause = 1

[State 6000, end]
type = ChangeState
trigger1 = HitShakeOver
value = 6001

[State 6000, FFB Light]
type = ForceFeedback
trigger1 = anim = 5000
trigger2 = anim = 5010
persistent = 0
time = 6
waveform = square

[State 6000, FFB Medium]
type = ForceFeedback
trigger1 = anim = 5001
trigger2 = anim = 5011
persistent = 0
time = 8
waveform = sinesquare
ampl = 110,-1,-.3

[State 6000, FFB Hard]
type = ForceFeedback
trigger1 = anim = 5012
trigger2 = anim = 5002
trigger3 = anim = 5030
trigger4 = anim = [5051,5059]
persistent = 0
time = 15
waveform = sinesquare
ampl = 140

;---------------------------------------------------------------------------
[Statedef 6001]
type    = A
movetype= H
physics = N
ctrl = 0

[State 6001, NOT Falling]
type = hitfallset
trigger1 = !Time
value = 0
ignorehitpause = 1

[State 6001, Change by HitType1]
type = Changeanim
trigger1 = !Time
trigger1 = anim = 5012
value = 5030

[State 6001, HitVelAdd]
type = VelAdd
trigger1 = 1
y = GetHitVar(yaccel)

[State 6001, HitVelSet]
type = HitVelSet
trigger1 = !Time
x = 1
y = 1

[State 6000, Falling]
type = hitfallset
trigger1 = Vel Y > 0
trigger1 = Pos Y >= -20
value = 1
ignorehitpause = 1
[State 6001, end1]
type = SelfState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= -20
value = 5050

[State 6001, end2]
type = ChangeState
trigger1 = AnimTime = 0
value = 6002

;---------------------------------------------------------------------------
[Statedef 6002]
type    = A
movetype= H
physics = N

[State 6002, NOT Falling]
type = hitfallset
trigger1 = !Time
value = 0
ignorehitpause = 1


[State 6000, Change by HitType1]
type = ChangeAnim
trigger1 = !Time
trigger1 = SelfAnimExist(5035)
trigger1 = Anim != [5051,5059]
trigger1 = Anim != 5090
value = 5035

[State 6002, HitVelAdd]
type = VelAdd
trigger1 = 1
y = GetHitVar(yaccel)

[State 6000, Falling]
type = hitfallset
trigger1 = Vel Y > 0
trigger1 = Pos Y >= -20
value = 1
ignorehitpause = 1

[State 6003, End1]
type = SelfState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= -20
value = 5050

[State 6003, End2]
type = ChangeState
trigger1 = HitOver
trigger2 = AnimTime = 0
trigger3 = Time = 0
trigger3 = Anim != 5035
value = 6003

;---------------------------------------------------------------------------

[Statedef 6003]
type    = A
movetype= H
physics = N

[State 6000, Change by HitType1]
type = ChangeAnim
trigger1 = AnimTime = 0
trigger1 = Anim = 5035
trigger2 = Time = 0
trigger2 = Anim != 5035
trigger2 = (Anim != [5051, 5059]) && (Anim != [5061, 5069])
trigger2 = Anim != 5090
value = 5050

[State 6000, Change by HitType2]
type = ChangeAnim
trigger1 = anim = [5050,5059]
trigger1 = Vel Y >= ifelse(anim = 5050, 1, -2)
trigger1 = SelfAnimExist(anim+10)
value = anim+10
persistent = 0

[State 6003, HitVelAdd]
type = VelAdd
trigger1 = 1
y = GetHitVar(yaccel)

[State 6003, NOT Falling]
type = HitFallSet
trigger1 = !Time
value = 0

[State 6000, Falling]
type = hitfallset
trigger1 = Vel Y > 0
trigger1 = Pos Y >= -25
value = 1
ignorehitpause = 1

[State 6000, End]
type = SelfState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= -25
value = 5050

;-----------------------------------
;---- Don't Juggle Type Air Hit ----
;-----------------------------------
; HITA_SHAKE
[Statedef 6010]
type    = A
movetype= H
physics = N
velset = 0,0

[State 5040, 3]
type = nothitby
trigger1 = 1
value = sca
ignorehitpause = 1

[State 5020, 1] ;Anim for HIT_LIGHT to HIT_HARD
type = ChangeAnim
trigger1 = Time = 0
trigger1 = GetHitVar(animtype) != [3,5]
value = ifelse((GetHitVar(airtype) = 1),5000,5010) + GetHitVar(animtype)

[State 5020, 2] ;Anim for HIT_BACK
type = ChangeAnim
trigger1 = Time = 0
trigger1 = GetHitVar(animtype) = [3,5]
value = 5030

[State 5020, 3] ;Anim for HIT_UP/HIT_DIAGUP (only if it exists)
type = ChangeAnim
trigger1 = Time = 0
trigger1 = (GetHitVar(animtype) = [4,5]) && (SelfAnimExist(5047 + GetHitVar(animtype)))
value = 5047 + GetHitVar(animtype) ;5051 - 4 + type

[State 5020, 4] ;Freeze anim
type = ChangeAnim
trigger1 = Time > 0
value = anim

[State 5020, 5]
type = ChangeState
trigger1 = HitShakeOver
value = 6011

[State 5020, FFB Light]
type = ForceFeedback
trigger1 = anim = 5000
trigger2 = anim = 5010
persistent = 0
time = 6
waveform = square

[State 5020, FFB Medium]
type = ForceFeedback
trigger1 = anim = 5001
trigger2 = anim = 5011
persistent = 0
time = 8
waveform = sinesquare
ampl = 110,-1,-.3

[State 5020, FFB Hard]
type = ForceFeedback
trigger1 = anim = 5012
trigger2 = anim = 5002
trigger3 = anim = 5030
trigger4 = anim = [5051,5059]
persistent = 0
time = 15
waveform = sinesquare
ampl = 140

;---------------------------------------------------------------------------
; HITA_UP
[Statedef 6011]
type    = A
movetype= H
physics = N
ctrl = 0

[State 5040, 3]
type = nothitby
trigger1 = 1
value = sca

[State 5030, 1]
type = VelAdd
trigger1 = 1
y = GetHitVar(yaccel)

[State 5030, 2]
type = HitVelSet
trigger1 = Time = 0
x = 1
y = 1

[State 5030, 3]
type = ChangeState
trigger1 = HitOver
trigger2 = Vel Y > 0    ;Hit ground
trigger2 = Pos Y >= 10  ;.
value = 6013 ;HITA_RECOV

[State 5030, 5]
type = ChangeState
trigger1 = AnimTime = 0
value = 6012 ;HITA_UP (transition)

;---------------------------------------------------------------------------
; HITA_UP_T (transition)
[Statedef 6012]
type    = A
movetype= H
physics = N

[State 5040, 3]
type = nothitby
trigger1 = 1
value = sca

[State 5035, 1]
type = ChangeAnim
trigger1 = Time = 0
trigger1 = SelfAnimExist(5035)
trigger1 = Anim != [5051,5059] ;Not if in hit up anim
trigger1 = Anim != 5090 ;Not if hit off ground anim
value = 5035

[State 5635, 2]
type = VelAdd
trigger1 = 1
y = GetHitVar(yaccel)

[State 5635, 3]
type = ChangeState
trigger1 = HitOver  ;Hit is over
trigger2 = AnimTime = 0 ;Animation over
trigger3 = Vel Y > 0    ;Hit ground
trigger3 = Pos Y >= 10  ;.
trigger4 = Time = 0     ;No transition anim
trigger4 = Anim != 5035 ;.
value = 6013

;---------------------------------------------------------------------------
; HITA_RECOV (recovering in air, not falling)
[Statedef 6013]
type    = A
movetype= H
physics = N

[State 5040, 1]
type = selfState
trigger1 = !Alive
value = 5050

[State 5040, 2]
type = ChangeAnim
trigger1 = AnimTime = 0
trigger1 = Anim != 5040
trigger2 = Time = 0
trigger2 = Anim != 5035
value = 5040

[State 5040, 3]
type = nothitby
trigger1 = 1
value = sca


[State 5040, 5]
type = VelAdd
trigger1 = 1
y = GetHitVar(yaccel)

[State 5040, 6]
type = ChangeState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
value = 6014

;---------------------------------------------------------------------------
; End State
[Statedef 6014]
type    = S
movetype= H
physics = S
ctrl = 0
anim = 47
facep2 = 1

[State 6013, Invencibility]
type = nothitby
trigger1 = 1
value = sca

[State 52, 1]
type = VelSet
trigger1 = Time = 0
y = 0

[State 52, 2]
type = PosSet
trigger1 = Time = 0
y = 0

[State 52, 4]
type = SelfState
trigger1 = Time = 3
value = 0
ctrl = 1

;-----------------------------------
;--------- Dizzy Type Fall ---------
;-----------------------------------
[Statedef 6100]
type    = A
movetype= H
physics = N
velset = 0,0

[State 3318, 6]
type = varset
trigger1 = 1
var(13) = 0
IgnoreHitPause = 1

[State 3318, 6]
type = pause
trigger1 = timemod = 2, 0
time = 1
IgnoreHitPause = 1

[State 6000, Change by HitType1]
type = ChangeAnim
trigger1 = !Time
trigger1 = GetHitVar(animtype) != [3,5]
value = ifelse((GetHitVar(airtype) = 1),5000,5010) + GetHitVar(animtype)

[State 6000, Change by HitType2]
type = ChangeAnim
trigger1 = !Time
trigger1 = GetHitVar(animtype) = [3,5]
value = 5012

[State 6000, Change by HitType3]
type = ChangeAnim
trigger1 = !Time
trigger1 = (GetHitVar(animtype) = [4,5]) && (SelfAnimExist(5047 + GetHitVar(animtype)))
value = 5047 + GetHitVar(animtype) ;5051 - 4 + type

[State 6000, Change by HitType4]
type = ChangeAnim
trigger1 = Time > 0
value = anim

[State 6000, Invincible]
type = NotHitBy
trigger1 = 1
value = SCA

[State 6000, end]
type = ChangeState
trigger1 = HitShakeOver
value = 6101

[State 6000, FFB Light]
type = ForceFeedback
trigger1 = anim = 5000
trigger2 = anim = 5010
persistent = 0
time = 6
waveform = square

[State 6000, FFB Medium]
type = ForceFeedback
trigger1 = anim = 5001
trigger2 = anim = 5011
persistent = 0
time = 8
waveform = sinesquare
ampl = 110,-1,-.3

[State 6000, FFB Hard]
type = ForceFeedback
trigger1 = anim = 5012
trigger2 = anim = 5002
trigger3 = anim = 5030
trigger4 = anim = [5051,5059]
persistent = 0
time = 15
waveform = sinesquare
ampl = 140

;---------------------------------------------------------------------------
[Statedef 6101]
type    = A
movetype= H
physics = N
ctrl = 0

[State 3318, 6]
type = pause
trigger1 = timemod = 2, 0
time = 1
IgnoreHitPause = 1

[State 6000, Invincible]
type = NotHitBy
trigger1 = 1
value = SCA

[State 6001, Change by HitType1]
type = Changeanim
trigger1 = !Time
trigger1 = anim = 5012
value = 5030

[State 6001, HitVelAdd]
type = VelAdd
trigger1 = 1
y = GetHitVar(yaccel)

[State 6001, HitVelSet]
type = HitVelSet
trigger1 = !Time
x = 1
y = 1

[State 6001, HitVelSet]
type = VelSet
trigger1 = !Time
trigger1 = Vel x < -4
x = -4

[State 6001, HitVelSet]
type = VelSet
triggerAll = !Time
trigger1 = Vel x > 4
x = 4

[State 6001, HitVelSet]
type = VelSet
trigger1 = !Time
trigger1 = Vel y > -5
y = -5

[State 6001, end1]
type = ChangeState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
value = 6110

[State 6001, end2]
type = ChangeState
trigger1 = AnimTime = 0
value = 6102

;---------------------------------------------------------------------------
[Statedef 6102]
type    = A
movetype= H
physics = N

[State 3318, 6]
type = pause
trigger1 = timemod = 2, 0
time = 1
IgnoreHitPause = 1

[State 6000, Invincible]
type = NotHitBy
trigger1 = 1
value = SCA

[State 6000, Change by HitType1]
type = ChangeAnim
trigger1 = !Time
trigger1 = SelfAnimExist(5035)
trigger1 = Anim != [5051,5059]
trigger1 = Anim != 5090
value = 5035

[State 6002, HitVelAdd]
type = VelAdd
trigger1 = 1
y = GetHitVar(yaccel)

[State 6000, Falling]
type = hitfallset
trigger1 = Vel Y > 0
trigger1 = Pos Y >= -20
value = 1
ignorehitpause = 1

[State 6003, End1]
type = ChangeState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
value = 6110

[State 6003, End2]
type = ChangeState
trigger1 = HitOver
trigger2 = AnimTime = 0
trigger3 = Time = 0
trigger3 = Anim != 5035
value = 6103

;---------------------------------------------------------------------------
[Statedef 6103]
type    = A
movetype= H
physics = N

[State 3318, 6]
type = pause
trigger1 = timemod = 2, 0
time = 1
IgnoreHitPause = 1

[State 6000, Change by HitType1]
type = ChangeAnim
trigger1 = AnimTime = 0
trigger1 = Anim = 5035
trigger2 = Time = 0
trigger2 = Anim != 5035
trigger2 = (Anim != [5051, 5059]) && (Anim != [5061, 5069])
trigger2 = Anim != 5090
value = 5050

[State 6000, Change by HitType2]
type = ChangeAnim
trigger1 = anim = [5050,5059]
trigger1 = Vel Y >= ifelse(anim = 5050, 1, -2)
trigger1 = SelfAnimExist(anim+10)
value = anim+10
persistent = 0

[State 6003, HitVelAdd]
type = VelAdd
trigger1 = 1
y = GetHitVar(yaccel)

[State 6000, Invincible]
type = NotHitBy
trigger1 = 1
value = SCA

[State 6000, End]
type = ChangeState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
value = 6110

[Statedef 6110]
type    = L
movetype= H
physics = N

[State 1004, 1]
type = nothitby
trigger1 = 1
value = SCA
ignorehitpause = 1

[State 5302, 1.1]
type = Velset
trigger1 = time = 0
y = -5.5

[State 5302, 1.2]
type = Velmul
trigger1 = timemod = 2,3
trigger1 = time > 3
x = .98

[State 5302, 2.1]
type = Changeanim
trigger1 = time < 3
value = 5160

[State 5302, 3.1]
type = posset
trigger1 = time = 0
y = 20

[State 5302, 4]
type = PlaySnd
trigger1 = Time = 0
value = F7,0

[State 5302, 5]
type = GameMakeAnim
trigger1 = Time = 0
value = 60
pos = 0, -20
under = 1

[State 5302, 6]
type = posfreeze
trigger1 = time < 3

[State 5302, 7]
type = Gravity
trigger1 = time > 3

[State 5302, 8]
type = ChangeState
trigger1 = time > 3
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
value = 6111

[Statedef 6111]
type    = L
movetype= H
physics = N
velset = 0,0
anim = 5110

[State 5302, 4]
type = PlaySnd
trigger1 = !Time
value = 5000,3
ignorehitpause = 1

[State 5303, 2]
type = posset
trigger1 = time = 0
y = 0

[State 5303, 6]
type = PlaySnd
trigger1 = Time = 0
value = F7,0

[State 5303, 7]
type = GameMakeAnim
trigger1 = Time = 0
value = 60
pos = 0, 0
under = 1

[State 5303, 3.1] ;If just died
type = ChangeState
trigger1 = !alive
trigger1 = !Time
value = 5150

[State 5303, 3.2] ;If alive
type = ChangeState
triggerall = alive
trigger1 = Time = 45
value = 6120

[State 5303, 16]
type = Nothitby
trigger1 = 1
value = SCA

[Statedef 6120]
type    = L
movetype= I
physics = N
anim = 5120
velset = 0,0

[State 5302, 4]
type = PlaySnd
trigger1 = !Time
value = 5300,0
ignorehitpause = 1

[State 3318, 6]
type = varset
trigger1 = !Time
var(13) = 0
IgnoreHitPause = 1

[State 5304, 1]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

[State 5304, 2]
type = ChangeState
trigger1 = AnimTime = 0
value = 5300
ctrl = 0


[Statedef 5300]
type    = S
movetype= I
physics = S
anim = 5300
ctrl = 0

[State 3318, 6]
type = varset
trigger1 = !time
var(14) = 250

[State 3318, 6]
type = varadd
trigger1 = command ="x"
trigger2 = command ="y"
trigger3 = command ="x"
trigger4 = command ="a"
trigger5 = command ="b"
trigger6 = command ="c"
var(14) = -10

[State 3318, 6]
type = varset
trigger1 = var(14) <= 0
var(14) = 0

[State 5305, 1];back to normal
type = ChangeState
trigger1 = time >= 30+var(14)
value = 0
ctrl = 1

;-----------------------------------
;--------- Forced to Stand ---------
;-----------------------------------
[Statedef 6200]
type    = S
movetype= H
physics = N
velset = 0,0

[State 6000, 1]
type = hitfallset
trigger1 = 1
value = 0
ignorehitpause = 1

[State 6000, 1]
type = Playerpush
trigger1 = 1
value = 0

[State 6000, 1]
type = PosSet
trigger1 = Time = 0
y = 0

[State 6000, 1]
type = VelSet
trigger1 = Time = 0
y = 0

[State 6000, 1]
type = ChangeAnim
trigger1 = Time = 0
trigger1 = GetHitVar(animtype) != [3,5]
value = ifelse((GetHitVar(groundtype) = 1),5000,5010) + GetHitVar(animtype)

[State 6000, 1]
type = ChangeAnim
trigger1 = Time = 0
trigger1 = GetHitVar(animtype) = [3,5]
value = 5030

[State 6000, 1]
type = ChangeAnim
trigger1 = Time = 0
trigger1 = (GetHitVar(animtype) = [4,5]) && (SelfAnimExist(5047 + GetHitVar(animtype)))
value = 5047 + GetHitVar(animtype) ;5051 - 4 + type

[State 6000, 1]
type = ChangeAnim
trigger1 = Time > 0
value = anim

[State 6000, 1]
type = ChangeState
trigger1 = HitShakeOver
value = 6201

[State 6000, 1]
type = ForceFeedback
trigger1 = anim = 5000
trigger2 = anim = 5010
persistent = 0
time = 6
waveform = square

[State 6000, 1]
type = ForceFeedback
trigger1 = anim = 5001
trigger2 = anim = 5011
persistent = 0
time = 8
waveform = sinesquare
ampl = 110,-1,-.3

[State 6000, 1]
type = ForceFeedback
trigger1 = anim = 5012
trigger2 = anim = 5002
trigger3 = anim = 5030
persistent = 0
time = 15
waveform = sinesquare
ampl = 140

;---------------------------------------------------------------------------
; HITG_SLIDE
[Statedef 6201]
type    = S
movetype= H
physics = S

[State 6000, 1]
type = hitfallset
trigger1 = 1
value = 0
ignorehitpause = 1

[State 6000, 1]
type = Playerpush
trigger1 = 1
value = 0

[State 6000, 1]
type = HitVelSet
trigger1 = Time = 0
x = 1
ignorehitpause = 1

[State 6000, 1]
type = ChangeAnim
trigger1 = AnimTime = 0
value = 5005 + GetHitVar(animtype) + (GetHitVar(groundtype)=2)*10

[State 6000, 1]
type = VelMul
trigger1 = Time >= GetHitVar(slidetime)
x = .6

[State 6000, 1]
type = VelSet
trigger1 = HitOver
x = 0

[State 6000, 1]
type = ChangeState
trigger1 = HitOver
value = 6202


;---------------------------------------------------------------------------
; DIZZYED
[Statedef 6202]
type = S
ctrl = 0
movetype = H
velset = 0,0,0

[State 6000, 1]
type=changeanim
trigger1 = time = 0
trigger1 = selfanimexist(5300)
value = 5300

[State 6000, 1]
type = changeanim2
trigger1 = time = 0 && !selfanimexist(5300)
value = 5301

[State 6000, 1]
type = defencemulset
trigger1 = time = 100
value = 1

[State 6000, 1]
type = Selfstate
trigger1 = time = 100
value = 0
ctrl = 1

;-----------------------------------
;-------- Gethit Wire Type ---------
;-----------------------------------
[Statedef 6400]
type = A
movetype= H
physics = N
velset = 0,0

[State 1027, Anim]
type = ChangeAnim2
trigger1 = !Time
value = 6400

[State 6000, end]
type = ChangeState
trigger1 = HitShakeOver
value = 6401

;---------------------------------------------------------------------------
[Statedef 6401]
type = A
movetype= H
physics = N

[State 200, 1]
type = HitDef
trigger1 = !Time = 0
attr = A, NA
damage = 100,10
getpower = 0
givepower = 100
guardflag = MA
hitflag = MAFD
pausetime = 15,15
sparkno = 3
guard.sparkno = 42
sparkxy = -15,-75
hitsound = F5,4
guardsound = F6,0
ground.type = High
ground.slidetime = 10
ground.hittime = 17
ground.velocity = 6,-9.5
air.velocity = 6,-8
affectteam = f
fall = 1
fall.recover = 0
fall.envshaketime = 15

[STate 3044, no push]
type = playerpush
trigger1 = 1
value = 0

[State 1026, Velocity]
type = VelSet
trigger1 = !Time
x = -13
y = -5

[State 1026, Velocity]
type = Veladd
trigger1 = 1
y = .5

[State 1026, Hit ground]
type = SelfState
trigger1 = pos y >= 0
trigger1 = vel y > 0
value = 5100

[State 1026, Hit wall]
type = ChangeState
trigger1 = movecontact
trigger2 = BackEdgeBodyDist <= 20
trigger3 = FrontEdgeBodyDist <= 20
value = 6402

;---------------------------------------------------------------------------
[Statedef 6402]
type = A
movetype= H
physics = N

[State 1028, 1]
type = NotHitBy
trigger1 = 1
value = sca

[State 1027, Turn]
type = Turn
trigger1 = !Time = 0
Trigger1 = FrontEdgeBodyDist <= 30

[State 1027, Pos]
type = PosAdd
trigger1 = !Time
x = 15 - BackEdgeBodyDist

[State 1027, Stop moving]
type = PosFreeze
trigger1 = 1

[State 1027, No scroll]
type = ScreenBound
trigger1 = 1
value = 1
movecamera = 0,1

[State 1027, Anim]
type = ChangeAnim2
trigger1 = !Time
value = 6410

[State 1027, Sound]
type = PlaySnd
trigger1 = Time = 0
value = F7,2

[State 1027, Sound]
type = EnvShake
trigger1 = !Time
Ampl = -6
Time = 7

[State 1027, Sound]
type = Explod
trigger1 = !Time
anim = F72
Ontop = 1
IgnoreHitpause = 1
Pos = -15, -65

[State 1028, Vel Y]
type = VelSet
trigger1 = Time = 4
x = 2.5
y = -8.5


[State 1027, State]
type = ChangeState
trigger1 = Time = 5
value = 6002

;============================================================================
; Helpers
;============================================================================
;>>>>>>>>>>>>>>>>>>>>>>>=====================<<<<<<<<<<<<<<<<<<<<<<<|
;|||||||||||||||||||||||Command Buffer Helper||||||||||||||||||||||||
;>>>>>>>>>>>>>>>>>>>>>>>=====================<<<<<<<<<<<<<<<<<<<<<<<|
;===================================================================|
;                             var List                              |
;===================================================================|
;var(1) = weak punch buffer                                         |
;var(2) = medium punch buffer                                       |
;var(3) = strong punch buffer                                       |
;var(4) = weak kick buffer                                          |
;var(5) = medium kick buffer                                        |
;var(6) = strong kick buffer                                        |
;var(7) = 2 punches buffer                                          |
;var(8) = 2 kicks buffer                                            |
;var(10)~var(19) = (H)SDM buffer                                    |
;var(20)~var(29) = (S)DM buffer                                     |
;var(30)~var(39) = (maybe) Special moves buffer                     |
;===================================================================|
[Statedef 2000]
anim = 9999
ctrl = 0

[State 2100, Safety]
type = SelfState
trigger1 = !IsHelper
value = 0

;-----------------------------------------------------------------
;Main buffers
;-----------------------------------------------------------------
[State 2100, buffer]
type = VarSet
trigger1 = Parent,command = "x"
var(1) = 10

[State 2100, buffer]
type = VarSet
trigger1 = Parent,command = "y"
var(2) = 10

[State 2100, buffer]
type = VarSet
trigger1 = Parent,command = "z"
var(3) = 10

[State 2100, buffer]
type = VarSet
trigger1 = Parent,command = "a"
var(4) = 10

[State 2100, buffer]
type = VarSet
trigger1 = Parent,command = "b"
var(5) = 10

[State 2100, buffer]
type = VarSet
trigger1 = Parent,command = "c"
var(6) = 10

[State 2100, buffer]
type = VarSet
trigger1 = Parent,command = "2punches"
var(7) = 10

[State 2100, buffer]
type = VarSet
trigger1 = Parent,command = "2kicks"
var(8) = 10

[State 2100, buffer]
type = VarSet
trigger1 = Parent,command = "SFRecover"
trigger1 = Parent,p2dist x >= 0
trigger2 = Parent,command = "SFRecover Reverse"
trigger2 = Parent,p2dist x < 0
var(9) = 10

;-----------------------------------------------------------------
;(H)SDM buffers
;-----------------------------------------------------------------
[State 2100, buffer]
type = VarSet
trigger1 = Parent,command = "[ERROR] CODE 2002"
trigger1 = Parent,p2dist x >= 0
trigger2 = Parent,command = "[ERROR] CODE 2002 Reverse"
trigger2 = Parent,p2dist x < 0
var(10) = 15

[State 2100, buffer]
type = VarSet
trigger1 = Parent,command = "Armageddon"
var(11) = 15

;-----------------------------------------------------------------
;(S)DM buffers
;-----------------------------------------------------------------
[State 2100, buffer]
type = VarSet
trigger1 = Parent,command = "Final Impact"
trigger1 = Parent,p2dist x >= 0
trigger2 = Parent,command = "Final Impact Reverse"
trigger2 = Parent,p2dist x < 0
var(20) = 10

[State 2100, buffer]
type = VarSet
trigger1 = Parent,command = "Million Bash Stream"
trigger1 = Parent,p2dist x >= 0
trigger2 = Parent,command = "Million Bash Stream Reverse"
trigger2 = Parent,p2dist x < 0
var(21) = 10

[State 2100, buffer]
type = VarSet
trigger1 = Parent,command = "Ankoku Jigoku Gokuraku Otoshi"
trigger1 = Parent,p2dist x >= 0
trigger2 = Parent,command = "Ankoku Jigoku Gokuraku Otoshi Reverse"
trigger2 = Parent,p2dist x < 0
var(22) = 15

[State 2100, buffer]
type = VarSet
trigger1 = Parent,command = "Araburu Daichi"
trigger1 = Parent,p2dist x >= 0
trigger2 = Parent,command = "Araburu Daichi Reverse"
trigger2 = Parent,p2dist x < 0
var(23) = 10

[State 2100, buffer]
type = VarSet
trigger1 = Parent,command = "Araburu Daichi 97"
trigger1 = Parent,p2dist x >= 0
trigger2 = Parent,command = "Araburu Daichi 97 Reverse"
trigger2 = Parent,p2dist x < 0
var(24) = 15

;-----------------------------------------------------------------
;Special Moves' buffers
;-----------------------------------------------------------------
[State 2100, buffer]
type = VarSet
trigger1 = Parent,command = "Musebu Daichi"
trigger1 = Parent,p2dist x >= 0
trigger2 = Parent,command = "Musebu Daichi Reverse"
trigger2 = Parent,p2dist x < 0
var(30) = 10

[State 2100, buffer]
type = VarSet
trigger1 = Parent,command = "Odoru Daichi"
trigger1 = Parent,p2dist x >= 0
trigger2 = Parent,command = "Odoru Daichi Reverse"
trigger2 = Parent,p2dist x < 0
var(31) = 10

[State 2100, buffer]
type = VarSet
trigger1 = Parent,command = "Upper Duel"
trigger1 = Parent,p2dist x >= 0
trigger2 = Parent,command = "Upper Duel Reverse"
trigger2 = Parent,p2dist x < 0
var(32) = 10

[State 2100, buffer]
type = VarSet
trigger1 = Parent,command = "Jet Counter"
trigger1 = Parent,p2dist x >= 0
trigger2 = Parent,command = "Jet Counter Reverse"
trigger2 = Parent,p2dist x < 0
var(33) = 10

[State 2100, buffer]
type = VarSet
trigger1 = Parent,command = "Sledgehammer"
trigger1 = Parent,p2dist x >= 0
trigger2 = Parent,command = "Sledgehammer Reverse"
trigger2 = Parent,p2dist x < 0
var(34) = 10

[State 2100, buffer]
type = VarSet
trigger1 = Parent,command = "Missile Might Bash"
trigger1 = Parent,p2dist x >= 0
trigger2 = Parent,command = "Missile Might Bash Reverse"
trigger2 = Parent,p2dist x < 0
var(35) = 10

;-----------------------------------------------------------------
;buffer countdown
;-----------------------------------------------------------------
[State 2100, buffercountdown]
type = VarAdd
trigger1 = var(1)
var(1) = -1

[State 2100, buffercountdown]
type = VarAdd
trigger1 = var(2)
var(2) = -1

[State 2100, buffercountdown]
type = VarAdd
trigger1 = var(3)
var(3) = -1

[State 2100, buffercountdown]
type = VarAdd
trigger1 = var(4)
var(4) = -1

[State 2100, buffercountdown]
type = VarAdd
trigger1 = var(5)
var(5) = -1

[State 2100, buffercountdown]
type = VarAdd
trigger1 = var(6)
var(6) = -1

[State 2100, buffercountdown]
type = VarAdd
trigger1 = var(7)
var(7) = -1

[State 2100, buffercountdown]
type = VarAdd
trigger1 = var(8)
var(8) = -1

[State 2100, buffercountdown]
type = VarAdd
trigger1 = var(9)
var(9) = -1

[State 2100, buffercountdown]
type = VarAdd
trigger1 = var(10)
var(10) = -1

[State 2100, buffercountdown]
type = VarAdd
trigger1 = var(11)
var(11) = -1

[State 2100, buffercountdown]
type = VarAdd
trigger1 = var(20)
var(20) = -1

[State 2100, buffercountdown]
type = VarAdd
trigger1 = var(21)
var(21) = -1

[State 2100, buffercountdown]
type = VarAdd
trigger1 = var(22)
var(22) = -1

[State 2100, buffercountdown]
type = VarAdd
trigger1 = var(23)
var(23) = -1

[State 2100, buffercountdown]
type = VarAdd
trigger1 = var(24)
var(24) = -1

[State 2100, buffercountdown]
type = VarAdd
trigger1 = var(30)
var(30) = -1

[State 2100, buffercountdown]
type = VarAdd
trigger1 = var(31)
var(31) = -1

[State 2100, buffercountdown]
type = VarAdd
trigger1 = var(32)
var(32) = -1

[State 2100, buffercountdown]
type = VarAdd
trigger1 = var(33)
var(33) = -1

[State 2100, buffercountdown]
type = VarAdd
trigger1 = var(34)
var(34) = -1

[State 2100, buffercountdown]
type = VarAdd
trigger1 = var(35)
var(35) = -1

;-----------------------------------
;------- Super Finish Helper -------
;-----------------------------------
[Statedef 9995]
ctrl = 0
anim = 9999
movetype = A

[State 191, 1]
Type = Pause
Trigger1 = !time
Time = 15
MoveTime = 15

[State 191, 1]
Type = PlaySnd
Trigger1 = !time
Value = 9995, 0
Channel = 5

[State 9996, BgPalFX]
type = BGPalFX
trigger1 = !Time
time = 60
add = 0,0,0
mul = 255,255,255
sinadd = 100,100,100,120
invertall = 0
color = 6

;-----------------------------------
;------- Hyper Finish Helper -------
;-----------------------------------
[Statedef 9996]
ctrl = 0
anim = 9999
movetype = A

[State 191, 1]
Type = Pause
Trigger1 = time = 1
Time = 15
MoveTime = 15

[State 9996, AllPalFX]
type = AssertSpecial
trigger1 = Time < 110
flag = NoBG
flag2 = NoFG

[State 9996, AllPalFX]
type = AssertSpecial
trigger1 = Time < 110
flag = NoBarDisplay
flag2 = GlobalNoShadow

[State 3000, DM FX 2]
Type = Explod
trigger1 = !Time
anim = 7950
PosType = Left
Ownpal = 1
SprPriority = -8
BindTime = -1
IgnoreHitPause = 1
Pos = 0,-10
PauseMoveTime = 99
SuperMoveTime = 99
Scale = 1, 3
Removetime = 110

[State -2, 3]
type = Explod
trigger1 = !Time
anim = 10000
postype = left
pos = 160,120
bindtime = -1
ownpal = 1
Sprpriority = -6
ignorehitpause = 1
pausemovetime = 300
supermovetime = 300

[State -2, 3]
type = Explod
trigger1 = Time = 2
anim = 10500
postype = left
pos = 160,115
bindtime = -1
ownpal = 1
Sprpriority = -5
ignorehitpause = 1
pausemovetime = 300
supermovetime = 300
Scale = 1, 1.1

[State 191, 1]
Type = PlaySnd
Trigger1 = !time
Value = 9995, 1
Channel = 5

[State 191, 1]
Type = PlaySnd
Trigger1 = !time
Value = 9995, 2
Channel = 6

;-----------------------------------
;--------- Counter Helper ----------
;-----------------------------------
[Statedef 9997]
ctrl = 0
anim = 9999
movetype = A

[State 9000, Assert]
type = NotHitBy
trigger1 = 1
Value = SCA
ignorehitpause = 1
under = 1

[State 9000, Assert]
type = bindtotarget
trigger1 = 1
pos = 0,-50
ignorehitpause = 1
under = 1

[State -2, 3]
type = Explod
triggerAll = Parent, var(10) = 1
triggerAll = p2movetype = H
trigger1 = Parent, movehit
Trigger2 = projhit = 1
anim = 8200
ID = 8200
postype = left
bindtime = -1
ownpal = 1
ontop = 1
persistent = 0
ignorehitpause = 1
pos = 60,60

[State -2, 3]
type = Explod
triggerAll = Parent, var(10) = 2
triggerAll = p2movetype = H
trigger1 = Parent, movehit
Trigger2 = projhit = 1
anim = 8200
ID = 8200
postype = right
bindtime = -1
ownpal = 1
ontop = 1
persistent = 0
ignorehitpause = 1
pos = -60,60

[State 9000, Assert]
type = envshake
triggerAll = p2movetype = H
trigger1 = Parent, movehit
Trigger2 = projhit = 1
time = 5
ampl = -6
ignorehitpause = 1
persistent = 0

[State 9000, Assert]
type = envcolor
triggerAll = p2movetype = H
trigger1 = Parent, movehit
Trigger2 = projhit = 1
time = 2
value = 255,255,255
under = 1
ignorehitpause = 1
persistent = 0

[State 9000, Effect]
type = destroyself
trigger1 = p2movetype != A && p2movetype != H
trigger2 = p2StateNo = [6000, 6005]
trigger2 = p2movetype = H
trigger3 = p2movetype = H
trigger3 = p2Statetype != A
trigger4 = RoundState != 2
trigger5 = Parent, movetype = H
ignorehitpause = 1

;--------------------------------
; Win the Match
;--------------------------------
[Statedef 9998]
type = S
movetype = I
anim = 9999

[State 2000, Time for win screen]
type = AssertSpecial
trigger1 = time = [0,500]
flag = RoundNotOver

[State 2000, Silence]
type = AssertSpecial
trigger1 = time = [110,520]
flag = NoMusic

[State 2000, Music]
type = PlaySnd
trigger1 = Time = 145
value = 8500,0

[State 9990, Bg]
type = AssertSpecial
trigger1 = Time >= 100
flag = NoBarDisplay

[State 9000, BG]
type = BGPalFx
trigger1 = Time >= 100
time = 1
Add = -40,-40,120
Color = 0
ignorehitpause = 1

[State 9990, BG]
trigger1 = time = 100
type = Explod
ownpal = 1
anim = 8500
postype = left
pos = 160,240
bindtime = -1
ID = 2020
ontop = 1

[State 9990, portrait]
trigger1 = time = 130
type = Explod
ownpal = 1
anim = 7800+parent,var(1)
postype = left
pos = 160,240
bindtime = -1
ID = 7800
ontop = 1

[State 9990, TEXT]
type = Explod
trigger1 = time = 160
ownpal = 1
anim = 8510+(Parent, StateNo = 181)+2*(Parent, StateNo = 182)+10*parent,var(26)
postype = left
pos = 160,240
bindtime = -1
ID = 8510
ontop = 1

;-------------------------------------
; AI Helper
;-------------------------------------

[Statedef 9999]
anim = 9999
ctrl = 0

[State 9741, Safety]; Just in case your opponent is very poorly coded.
type = SelfState
trigger1 = !IsHelper
value = 0

[State 9741, PauseCheck]
type = VarSet
trigger1 = (GameTime>(Parent,var(57)))
trigger2 = !(Parent,Alive)
trigger3 = (RoundState != 2)
trigger4 = Parent,var(58)
trigger5 = (var(3):=0)
var(2) = (var(3):=1)+(var(4):=0)

[State 9741, Facing]
type = Turn
trigger1 = (var(9):=(Facing != Parent,Facing))

[State 9741, DirTurnOnAI]
type = ParentVarSet
triggerall = !var(3)
triggerall = !var(9)
trigger1 = (Parent,command = "holdfwd")
trigger2 = (Parent,command = "holdback")
trigger3 = (Parent,command = "holdup")
trigger4 = (Parent,command = "holddown")
trigger5 = !(var(4):=1)
var(58) = var(4)

[State 9741, DirTurnOffAI]
type = ParentVarSet
triggerall = !var(3)
triggerall = Parent,var(58)
trigger1 = (command = "holdfwd")
trigger1 = (Parent,command = "holdfwd")
trigger2 = (command = "holdback")
trigger2 = (Parent,command = "holdback")
trigger3 = (command = "holdup")
trigger3 = (Parent,command = "holdup")
trigger4 = (command = "holddown")
trigger4 = (Parent,command = "holddown")
var(58) = (var(4):=0)

[State 9741, ButtonTurnOnAI]
type = ParentVarSet
triggerall = var(1)
triggerall = !var(2)
trigger1 = (Parent,command = "a")
trigger2 = (Parent,command = "b")
trigger3 = (Parent,command = "c")
trigger4 = (Parent,command = "x")
trigger5 = (Parent,command = "y")
trigger6 = (Parent,command = "z")
trigger7 = (Parent,command = "start")
var(58) = 1

[State 9741, ButtonTurnOffAI]
type = ParentVarSet
triggerall = !var(2)
trigger1 = (command = "a")
trigger1 = (Parent,command = "a")
trigger2 = (command = "b")
trigger2 = (Parent,command = "b")
trigger3 = (command = "c")
trigger3 = (Parent,command = "c")
trigger4 = (command = "x")
trigger4 = (Parent,command = "x")
trigger5 = (command = "y")
trigger5 = (Parent,command = "y")
trigger6 = (command = "z")
trigger6 = (Parent,command = "z")
trigger7 = (command = "start")
trigger7 = (Parent,command = "start")
var(58) = -1

[State 9741, UnPauseCheck]
type = VarSet
triggerall = var(2)
trigger1 = (Parent,command = "a")
trigger2 = (Parent,command = "b")
trigger3 = (Parent,command = "c")
trigger4 = (Parent,command = "x")
trigger5 = (Parent,command = "y")
trigger6 = (Parent,command = "z")
trigger7 = (Parent,command = "start")
trigger8 = (var(2) = 2)
trigger8 = (var(2):=0)
var(2) = 2



[State 9741, ButtonTurnOffAI]
type = ParentVarSet
trigger1 = Parent,var(58) = 1
var(9) = var(21)

[State 9741, ButtonTurnOffAI]
type = ParentVarSet
trigger1 = Parent,var(58) != 1
var(9) = 0

[State 9741, Goodbye]
type = DestroySelf
triggerall = (var(1):=1)
trigger1 = Parent,var(58)
trigger2 = !(Parent,Alive)
trigger3 = (RoundState != 2)

;============================================================================
; Override Common States
;============================================================================
;-----------------------------------
;-------------- Stand --------------
;-----------------------------------
[Statedef 0]
Type = S
Physics = S
SprPriority = 0

[State 180, 1]
Type = varset
Trigger1 = Time = 1
Trigger1 = PalNo = [1,6]
var(1) = ifelse(var(0) > 1 || var(0) < 0, 0, var(0))

[State 180, 1]
Type = varset
Trigger1 = Time = 1
Trigger1 = PalNo = [7,12]
var(1) = ifelse(var(0) > 1 || var(0) < 0, 1, var(0))

[State 0, 1]
Type = ChangeAnim
Trigger1 = Anim != 5 && Anim != var(1)
Trigger2 = Anim = 5 && !AnimTime
Value = var(1)

[State 0, 2]
Type = VelSet
Trigger1 = Time = 0
y = 0

[State 0, 3]
Type = VelSet
Trigger1 = abs(Vel x) < 2
Trigger2 = Time = 4
x = 0

;-----------------------------------
;-------------- Walk ---------------
;-----------------------------------
[Statedef 20]
Type    = S
Physics = S
SprPriority = 0

[State 20, 1]
Type = VelSet
Trigger1 = Command = "holdfwd"
x = Const(Velocity.Walk.Fwd.x)+.1*(var(1) != 0)

[State 20, 2]
Type = VelSet
Trigger1 = Command = "holdback"
x = Const(Velocity.Walk.Back.x)-.1*(var(1) != 0)

[State 20, 3]
Type = ChangeAnim
TriggerAll = Vel x > 0
Trigger1 = Anim != 20 && Anim != 5
Trigger2 = Anim = 5 && !AnimTime
Value = 20

[State 20, 4]
Type = ChangeAnim
TriggerAll = Vel x < 0
Trigger1 = Anim != 21 && Anim != 5
Trigger2 = Anim = 5 && !AnimTime
Value = 21

;-----------------------------------
;----------- jump Start ------------
;-----------------------------------
[Statedef 40]
Type    = S
Physics = S
Anim = 40
Ctrl = 0
SprPriority = 0

[State 40, 1]
Type = ChangeState
TriggerAll = !Time
TriggerAll = var(9) = [1,4]
Trigger1 = p2MoveType = H
Trigger1 = p2bodydist x < 160
Trigger2 = P2StateType = A
Trigger3 = p2StateType = L
Trigger4 = p2StateNo = [5120,5210]
Trigger5 = p2bodydist x < 80
Value = 100
Ctrl = !var(25)

[State 40, 1]
Type = ChangeState
TriggerAll = !Time
TriggerAll = var(9) = [5,8]
Trigger1 = p2MoveType = H
Trigger1 = p2bodydist x < 160
Trigger2 = P2StateType = A
Trigger3 = p2StateType = L
Trigger4 = p2StateNo = [5120,5210]
Trigger5 = p2bodydist x < 80
Value = ifelse(var(25), 100,0)
Ctrl = !var(25)

[State 40, 1]
Type = varSet
Trigger1 = Time = 0
Sysvar(1) = 0

[State 40, 1]
Type = varset
Trigger1 = Time = 0
var(2) = 0

[State 40, 1]
Type = varset
Trigger1 = Time = 0
var(4) = 0

[State 40, 3]
Type = varSet
Trigger1 = Command = "holdback"
Sysvar(1) = -1

[State 40, 2]
Type = varSet
Trigger1 = Command = "holdfwd"
Trigger2 = var(9)
Sysvar(1) = 1

[State 40, 4]
Type = varset
Trigger1 = !var(9)
Trigger1 = Command != "holdup"
Trigger2 = var(9)
Trigger2 = P2Bodydist x < 150
var(4) = 1

[State 40, 3]
Type = varSet
Trigger1 = !var(9)
Trigger1 = Command = "longjump"
Trigger2 = prevStateNo = 100 && Command = "holdfwd"
Trigger3 = var(9)
Trigger3 = P2Bodydist x > 120
var(2) = 1

[State 40, 4]
Type = VelSet
Trigger1 = !AnimTime
x = ifelse(Sysvar(1)=0, Const(Velocity.jump.Neu.x), ifelse(Sysvar(1)=1, Const(Velocity.jump.Fwd.x), Const(Velocity.jump.Back.x)))
y = Const(Velocity.jump.y)


[State 40, 5]
Type = VelSet
Trigger1 = !AnimTime
Trigger1 = var(2)
Trigger1 = Sysvar(1) = 1
x = Const(Velocity.Runjump.Fwd.x)

[State 40, 5]
Type = VelSet
Trigger1 = !AnimTime
Trigger1 = var(2)
Trigger1 = Sysvar(1) = -1
x = Const(Velocity.Runjump.Back.x)

[State 260, 3]
type = Afterimage
Trigger1 = var(2)
Time = 8
length = 10
FrameGap = 3
paladd = 80,60,160


[State 40, 4]
Type = Velmul
Trigger1 = var(4) && !AnimTime
y = .7

[State 40, 6]
Type = ChangeState
Trigger1 = !AnimTime
Value = 50
Ctrl = 1

;-----------------------------------
;-------- AI high jump fwd ---------
;-----------------------------------
[Statedef 41]
Type    = S
Physics = S
Anim = 40
Ctrl = 0
SprPriority = 0
facep2 = 1

[State 40, 1]
Type = varSet
Trigger1 = Time = 0
Sysvar(1) = 1

[State 40, 1]
Type = varset
Trigger1 = Time = 0
var(2) = 0

[State 40, 1]
Type = varset
Trigger1 = Time = 0
var(4) = 0

[State 40, 3]
Type = varSet
Trigger1 = !Time
var(2) = 1

[State 40, 4]
Type = VelSet
Trigger1 = !AnimTime
x = Const(Velocity.Runjump.Fwd.x)
y = Const(Velocity.jump.y)

[State 260, 3]
type = Afterimage
Trigger1 = 1
Time = 8
length = 10
FrameGap = 3
paladd = 80,60,160

[State 40, 6]
Type = ChangeState
Trigger1 = !AnimTime
Value = 50
Ctrl = 1

;-----------------------------------
;----- AI high short jump Start ----
;-----------------------------------
[Statedef 42]
Type    = S
Physics = S
Anim = 40
Ctrl = 0
SprPriority = 0
facep2 = 1

[State 40, 1]
Type = varset
Trigger1 = Time = 0
var(2) = 1

[State 40, 1]
Type = varset
Trigger1 = Time = 0
var(4) = 1

[State 40, 2]
Type = varSet
Trigger1 = !Time
Trigger2 = var(9)
Sysvar(1) = 1

[State 40, 4]
Type = VelSet
Trigger1 = !AnimTime
x = ifelse(Sysvar(1)=0, Const(Velocity.jump.Neu.x), ifelse(Sysvar(1)=1, Const(Velocity.jump.Fwd.x), Const(Velocity.jump.Back.x)))
y = Const(Velocity.jump.y)


[State 40, 5]
Type = VelSet
Trigger1 = !AnimTime
x = Const(Velocity.Runjump.Fwd.x)

[State 260, 3]
type = Afterimage
Trigger1 = var(2)
Time = 8
length = 10
FrameGap = 3
paladd = 80,60,160

[State 40, 4]
Type = Velmul
Trigger1 = !AnimTime
y = .7

[State 40, 6]
Type = ChangeState
Trigger1 = !AnimTime
Value = 50
Ctrl = 1

;-----------------------------------
; AI high short jump neutral Start -
;-----------------------------------
[Statedef 43]
Type    = S
Physics = S
Anim = 40
Ctrl = 0
SprPriority = 0
facep2 = 1

[State 40, 1]
Type = varset
Trigger1 = Time = 0
var(2) = 1

[State 40, 1]
Type = varset
Trigger1 = Time = 0
var(4) = 1

[State 40, 2]
Type = varSet
Trigger1 = !Time
Trigger2 = var(9)
Sysvar(1) = 0

[State 40, 4]
Type = VelSet
Trigger1 = !AnimTime
x = ifelse(Sysvar(1)=0, Const(Velocity.jump.Neu.x), ifelse(Sysvar(1)=1, Const(Velocity.jump.Fwd.x), Const(Velocity.jump.Back.x)))
y = Const(Velocity.jump.y)


[State 260, 3]
type = Afterimage
Trigger1 = var(2)
Time = 8
length = 10
FrameGap = 3
paladd = 80,60,160

[State 40, 4]
Type = Velmul
Trigger1 = !AnimTime
y = .7

[State 40, 6]
Type = ChangeState
Trigger1 = !AnimTime
Value = 50
Ctrl = 1

;-----------------------------------
;---- AI short jump back Start -----
;-----------------------------------
[Statedef 44]
Type    = S
Physics = S
Anim = 40
Ctrl = 0
SprPriority = 0
facep2 = 1

[State 40, 1]
Type = varset
Trigger1 = Time = 0
var(4) = 1

[State 40, 2]
Type = varSet
Trigger1 = !Time
Trigger2 = var(9)
Sysvar(1) = -1

[State 40, 4]
Type = VelSet
Trigger1 = !AnimTime
x = ifelse(Sysvar(1)=0, Const(Velocity.jump.Neu.x), ifelse(Sysvar(1)=1, Const(Velocity.jump.Fwd.x), Const(Velocity.jump.Back.x)))
y = Const(Velocity.jump.y)


[State 40, 4]
Type = Velmul
Trigger1 = !AnimTime
y = .7

[State 40, 6]
Type = ChangeState
Trigger1 = !AnimTime
Value = 50
Ctrl = 1

;-----------------------------------
;------------- Run Fwd -------------
;-----------------------------------
[Statedef 100]
Type    = S
MoveType = I
Physics = S
Anim = 100
SprPriority = 2
Velset = 0,0
Ctrl = 0

[State 100, Velocity]
Type = VelSet
Trigger1 = AnimElemTime(2) >= 0
x = Const(Velocity.Run.Fwd.x)

[State 100, jump]
Type = ChangeState
trigger1 = !var(9)
Trigger1 = Command = "holdup"
Value = 40

[State 100, Sound]
Type = PlaySnd
Trigger1 = AnimElem = 3  || AnimElem = 7
Value = 100,0
Channel = 3

[State 100, AI End]
type = ChangeState
triggerall = var(9)
triggerall = Time > 12
trigger1 = !var(25)
trigger1 = P2bodydist X <= 70-30*(var(53) = 3)
trigger1 = p2movetype != A && p2movetype != H
trigger2 = !var(25)
trigger2 = p2movetype = A
trigger3 = p2bodydist x < 5
trigger4 = p2StateType = A
value = 103

[State 100, 9]
Type = ChangeState
triggerall = Time > 12
trigger1 = !var(9)
Trigger1 = Command != "holdfwd"
Value = 103

;-----------------------------------
;------------- GC Dash -------------
;-----------------------------------
[Statedef 101]
Type    = S
MoveType = I
Physics = S
Anim = 101
SprPriority = -2
Velset = 0,0
Ctrl = 0
Poweradd = -500

[State 700, Cancel0]
type = VarAdd
Trigger1 = !Time
var(16) = -500

[State 260, 3]
type = Afterimage
Trigger1 = !Time
Time = 2
length = 8
FrameGap = 3
paladd = 128,128,164

[State 260, 3]
type = AfterImageTime
Trigger1 = Time
Time = 2

[State 3000, PALFX]
type = PalFX
Trigger1 = timemod = 2,0
Trigger1 = time <= 7
ignorehitpause = 1
time = 1
add = 255,255,255
sinadd = -100,-100,-100, 2
ignorehitpause = 1

[State 100, Velocity]
Type = VelSet
Trigger1 = AnimElem = 2, > 0
Trigger1 = AnimElem = 3, < 0
x = 9

[State 100, Velocity]
Type = NotHitBy
Trigger1 = !Time
value = SCA
Time = 12

[State 100, Sound]
Type = PlaySnd
Trigger1 = AnimElem = 2
Value = 105,0
Channel = 3

[State 100, 9]
Type = ChangeState
Trigger1 = !AnimTime
Value = 103

;-----------------------------------
;---------- Run/Dash end -----------
;-----------------------------------
[Statedef 103]
Type    = S
MoveType = I
Physics = S
Anim = 103
SprPriority = -2
Velset = 0
Ctrl = 0

[State 260, 3]
type = AfterimageTime
Trigger1 = !Time
Time = 0

[State 100, 9]
Type = ChangeState
Trigger1 = !AnimTime
Value = 0
Ctrl = 1

;-----------------------------------
;------------ Back Hop -------------
;-----------------------------------
[Statedef 105]
Type = A
Movetype = I
Physics = N
Anim = 105
Velset = 0
Ctrl = 0


[State 105, Invincible]
Type = NotHitBy
Trigger1 = AnimElem = 2, < 0
Value = sca

[State 105, Sound Set]
Type = PlaySnd
Trigger1 = AnimElem = 2
Value = 105, 0
Channel = 3

[State 105, VelSet]
type = velset
trigger1 = AnimElem = 2
x = const(velocity.run.back.x)
y = const(velocity.run.back.y)

[State 106, 3]
Type = velmul
Trigger1 = animelem = 2, > 0
x = .85

[State 106, 3]
Type = Gravity
Trigger1 = animelem = 2, > 0

[State 105, 4]
type = ChangeState
trigger1 = Pos Y >= 0 && Vel Y > 0
value = 106

;-----------------------------------
;-------- Back Hop Landing ---------
;-----------------------------------
[Statedef 106]
type = S
movetype = I
physics = S
anim = 106


[State 106, 1]
type = VelSet
trigger1 = !Time
y = 0

[State 106, 1]
type = PosSet
trigger1 = !Time
y = 0

[State 106, 1]
type = MakeDust
trigger1 = Vel x != 0
pos = -8, 0
spacing = 5

[State 106, 9]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;-----------------------------------
;--- Guard State Modifyed for AI ---
;-----------------------------------
;GUARD (start)
[Statedef 120]
type = U    ;Leave state type unchanged
physics = U ;Leave physics unchanged


[State 120, 1]
type = VarSet
trigger1 = !Time
var(27) = 0
ignorehitpause = 1

[State 120, 1]
type = Ctrlset
trigger1 = !Time
Trigger1 = var(9)
Trigger1 = enemy, numproj > 0
Trigger1 = statetype != A
value = 0
ignorehitpause = 1

[State 120, 1]
type = ChangeAnim
trigger1 = Time = 0
value = 120 + (statetype = C) + (statetype = A)*2

[State 120, 2]
type = StateTypeSet
triggerall = Time = 0
trigger1 = statetype = S && !var(9)
trigger2 = statetype != A && p2statetype != C && var(9)
physics = S

[State 120, 3]
type = StateTypeSet
triggerall = !Time
trigger1 = statetype = C && !var(9)
trigger2 = statetype != A && p2statetype = C && var(9)
physics = C

[State 120, 4]
type = StateTypeSet
trigger1 = !Time && statetype = A
physics = A

[State 120, Hi to Lo]
type = StateTypeSet
triggerall = statetype = S
trigger1 = command = "holddown" && !var(9)
trigger2 = p2statetype = C && var(9)
statetype = C
physics = C

[State 120, Lo to Hi]
type = StateTypeSet
triggerall = statetype = C
trigger1 = command != "holddown" && !var(9)
trigger2 = p2statetype != C && var(9)
statetype = S
physics = S

[State 120, 1]
type = VarSet
trigger1 = Time
var(27) = StateType = C
ignorehitpause = 1

[State 120, 5]
type = ChangeState
trigger1 = AnimTime = 0
value = 130 + (statetype = C) + (statetype = A)*2

[State 120, Stop Guarding]
type = ChangeState
trigger1 = command != "holdback" && var(9) = 0
trigger2 = !inguarddist
trigger3 = var(9) && enemy, moveguarded
value = 140

;---------------------------------------------------------------------------
; STAND GUARD (guarding)
[Statedef 130]
type    = S
physics = S

[State 120, 1]
type = VarSet
trigger1 = !Time
var(27) = 0
ignorehitpause = 1

[State 120, 1]
type = Ctrlset
trigger1 = Time = 0 && var(9) && enemy, numproj > 0
value = 0
ignorehitpause = 1

[State 130, 1]
type = ChangeAnim
trigger1 = Anim != 130
value = 130

[State 130, Hi to Lo]
type = ChangeState
trigger1 = command = "holddown" && !var(9)
trigger2 = p2statetype = C && var(9)
value = 131

[State 130, Stop Guarding]
type = ChangeState
trigger1 = command != "holdback" && var(9) = 0
trigger2 = !inguarddist
trigger3 = var(9) && enemy, moveguarded
value = 140

;---------------------------------------------------------------------------
; CROUCH GUARD (guarding)
[Statedef 131]
type    = C
physics = C

[State 120, 1]
type = VarSet
trigger1 = !Time
var(27) = 1
ignorehitpause = 1

[State 120, 1]
type = Ctrlset
trigger1 = Time = 0 && var(9) && enemy, numproj > 0
value = 0
ignorehitpause = 1

[State 131, 1]
type = ChangeAnim
trigger1 = Anim != 131
value = 131

[State 131, Lo to Hi]
type = ChangeState
trigger1 = command != "holddown" && !var(9)
trigger2 = p2statetype != C && var(9)
value = 130

[State 131, Stop Guarding]
type = ChangeState
trigger1 = command != "holdback" && var(9) = 0
trigger2 = !inguarddist
trigger3 = var(9) && enemy, moveguarded
value = 140

;---------------------------------------------------------------------------
; AIR GUARD (guarding)
[Statedef 132]
type    = A
physics = N

[State 132, 1]
type = ChangeAnim
trigger1 = Anim != 132
value = 132

[State 132, 2]
type = VelAdd
trigger1 = 1
y = Const(movement.yaccel)

[State 132, 3]
type = VarSet
trigger1 = 1
sysvar(0) = (pos y >= 0) && (vel y > 0)

[State 132, 4]
type = VelSet
trigger1 = sysvar(0)
y = 0

[State 132, 5]
type = PosSet
trigger1 = sysvar(0)
y = 0

[State 132, 6]
type = ChangeState
trigger1 = sysvar(0)
trigger1 = command = "holdback" || var(9)
trigger1 = inguarddist
value = 130

[State 132, 7]
type = ChangeState
trigger1 = sysvar(0)
value = 52

[State 132, Stop Guarding]
type = ChangeState
trigger1 = command != "holdback" && var(9) = 0
trigger2 = !inguarddist
value = 140

;---------------------------------------------------------------------------
;---------------------------------------------------------------------------
; SGUARDHIT (shaking)
[Statedef 150]
type    = S
movetype= H
physics = N
velset = 0,0

[State 150, 1]
type = ChangeAnim
trigger1 = 1
value = 150

[State 150, 2]
type = ChangeState
trigger1 = HitShakeOver
value = 151 + 2*(command = "holddown"|| (var(9) && p2statetype = C))

[State 150, Hi to Lo]
type = StateTypeSet
triggerall = statetype = S
trigger1 = command = "holddown" && var(9) = 0
trigger2 = var(9) && p2statetype = C
statetype = C
physics = C

[State 150, Lo to Hi]
type = StateTypeSet
trigger1 = statetype = C && command != "holddown" && var(9) = 0
trigger2 = var(9) && p2statetype != C
statetype = S
physics = S

[State 120, 1]
type = VarSet
trigger1 = 1
var(27) = StateType = C
ignorehitpause = 1

[State 150, 3]
type = ForceFeedback
trigger1 = time = 0
waveform = square
time = 3

;---------------------------------------------------------------------------
; SGUARDHIT2 (knocked back)
[Statedef 151]
type    = S
movetype= H
physics = S
anim = 150

[State 151, 1]
type = HitVelSet
trigger1 = Time = 0
x = 1

[State 151, 2]
type = VelSet
trigger1 = Time = GetHitVar(slidetime)
trigger2 = HitOver
x = 0

[State 151, 3]
type = CtrlSet
trigger1 = Time = GetHitVar(ctrltime)
value = 1

[State 150, Hi to Lo]
type = StateTypeSet
triggerall = statetype = S
trigger1 = command = "holddown" && var(9) = 0
trigger2 = var(9) && p2statetype = C
statetype = C
physics = C

[State 150, Lo to Hi]
type = StateTypeSet
trigger1 = statetype = C && command != "holddown" && var(9) = 0
trigger2 = var(9) && p2statetype != C
statetype = S
physics = S

[State 120, 1]
type = VarSet
trigger1 = 1
var(27) = StateType = C
ignorehitpause = 1

[State 151, 4]
type = ChangeState
trigger1 = HitOver
value = 130+(statetype = C)
ctrl = 1

;---------------------------------------------------------------------------
; CGUARDHIT (shaking)
[Statedef 152]
type    = C
movetype= H
physics = N
velset = 0,0

[State 152, 1]
type = ChangeAnim
trigger1 = 1
value = 151

[State 150, 2]
type = ChangeState
trigger1 = HitShakeOver
value = 151 + 2*(command = "holddown"|| (var(9) && p2statetype = C))

[State 150, Hi to Lo]
type = StateTypeSet
triggerall = statetype = S
trigger1 = command = "holddown" && var(9) = 0
trigger2 = var(9) && p2statetype = C
statetype = C
physics = C

[State 150, Lo to Hi]
type = StateTypeSet
trigger1 = statetype = C && command != "holddown" && var(9) = 0
trigger2 = var(9) && p2statetype != C
statetype = S
physics = S

[State 120, 1]
type = VarSet
trigger1 = 1
var(27) = StateType = C
ignorehitpause = 1

[State 152, 4]
type = ForceFeedback
trigger1 = time = 0
waveform = square
time = 4

;---------------------------------------------------------------------------
; CGUARDHIT2 (knocked back)
[Statedef 153]
type    = C
movetype= H
physics = C
anim = 151

[State 120, 1]
type = VarSet
trigger1 = !Time
var(27) = 1
ignorehitpause = 1

[State 153, 1]
type = HitVelSet
trigger1 = Time = 0
x = 1

[State 153, 2]
type = VelSet
trigger1 = Time = GetHitVar(slidetime)
trigger2 = HitOver
x = 0

[State 153, 3]
type = CtrlSet
trigger1 = Time = GetHitVar(ctrltime)
value = 1

[State 150, Hi to Lo]
type = StateTypeSet
triggerall = statetype = S
trigger1 = command = "holddown" && var(9) = 0
trigger2 = var(9) && p2statetype = C
statetype = C
physics = C

[State 150, Lo to Hi]
type = StateTypeSet
trigger1 = statetype = C && command != "holddown" && var(9) = 0
trigger2 = var(9) && p2statetype != C
statetype = S
physics = S

[State 120, 1]
type = VarSet
trigger1 = 1
var(27) = StateType = C
ignorehitpause = 1

[State 153, 4]
type = ChangeState
trigger1 = HitOver
value = 130+(statetype = C)
ctrl = 1

;---------------------------------------------------------------------------
; AGUARDHIT2 (knocked away)
[Statedef 155]
type    = A
movetype= H
physics = N
anim = 152

[State 155, 1]
type = HitVelSet
trigger1 = Time = 0
x = 1
y = 1

[State 155, 2]
type = VelAdd
trigger1 = 1
y = Const(movement.yaccel)

[State 155, 3]
type = CtrlSet
trigger1 = Time = GetHitVar(ctrltime)
value = 1

[State 155, 4]
type = VarSet
trigger1 = 1
sysvar(0) = (pos y >= 0) && (vel y > 0)

[State 155, 5]
type = VelSet
trigger1 = sysvar(0)
y = 0

[State 155, 6]
type = PosSet
trigger1 = sysvar(0)
y = 0

[State 155, 6]
type = ChangeState
trigger1 = sysvar(0)
trigger1 = command = "holdback" || var(9)
trigger1 = inguarddist
value = 130

[State 155, 7]
type = ChangeState
trigger1 = sysvar(0)
value = 52

;-----------------------------------
;----- Lose for Time over pose -----
;-----------------------------------
[Statedef 170]
Type = S
Ctrl = 0
Anim = 170
Velset = 0,0

[State 170, 1]
Type = NotHitBy
Trigger1 = Time = 0
Value = SCA
Time = 1

;-----------------------------------
;----------- Pre - Intro -----------
;-----------------------------------
[Statedef 190]
Type = S
Ctrl = 0
Velset = 0,0

[State 190, 1]
Type = ChangeAnim
Trigger1 = SelfAnimExist(190)
Value = 190

[State 180, 1]
Type = varset
Trigger1 = Time = 1
Trigger1 = PalNo = [1,6]
var(1) = ifelse(var(0) > 1 || var(0) < 0, 0, var(0))

[State 180, 1]
Type = varset
Trigger1 = Time = 1
Trigger1 = PalNo = [7,12]
var(1) = ifelse(var(0) > 1 || var(0) < 0, 1, var(0))

[State 190, 2] ;Go straight to intro.
Type = ChangeState
Trigger1 = Time = 1
Value = 191

;-----------------------------------
;-------- KOF Recovery Roll --------
;-----------------------------------
[Statedef 5201]
type    = L
movetype= H
physics = N
anim = 5200
ctrl = 0

[State 5100, EnvShake]
type = FallEnvShake
trigger1 = !Time

[State 5100, 8]
type = GameMakeAnim
trigger1 = !Time
value = 60 + (sysvar(1) > 5) + (sysvar(1) > 14)
pos = 0, 0
under = sysvar(1) <= 10

[State 5100, 10]
type = PlaySnd
trigger1 = !Time
value = F7, (sysvar(1) > 5) + (sysvar(1) > 14)

[State 5100, 13]
type = ForceFeedback
trigger1 = Time = 0
waveform = sinesquare
ampl = 128,-3,-.2,.005
time = 2

[State 5201, 1] ;Turn if not facing opponent
type = Turn
trigger1 = Time = 0
trigger1 = P2Dist X < -5

[State 5201, 2]
type = VelSet
trigger1 = !Time
y = 0

[State 5201, 2.1]
type = VelSet
trigger1 = Time >= 0
trigger1 = Time <= 12
x = -4

[State 5201, 3]
type = PosSet
trigger1 = !Time
y = 0

[State 5201, 4]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

[State 5201, 3]
type = statetypeset
trigger1 = Time = 1
statetype = S
movetype= I
physics = S

[State 701, 1]
type = PlaySnd
trigger1 = Time = 1
value = 0,3
Channel = 2

[State 5201, 6]
type = ChangeState
trigger1 = !AnimTime
value = 0
ctrl = 1

;-----------------------------------
;------ CAPCOM Recovery Roll -------
;-----------------------------------
[Statedef 5202]
type    = L
movetype= H
physics = N
anim = 5201
ctrl = 0

[State 1000, Power set]
Type = varSet
Trigger1 = !Time
var(50) = 1
IgnoreHitPause = 1

[State 1000, buffer setting1]
Type = varSet
Trigger1 = !Time
Trigger1 = helper(2000),var(1) > helper(2000), var(2)
Trigger1 = helper(2000),var(1) > helper(2000), var(3)
var(2) = 0

[State 1000, buffer setting2]
Type = varSet
Trigger1 = !Time
Trigger1 = helper(2000),var(2) > helper(2000), var(1)
Trigger1 = helper(2000),var(2) > helper(2000), var(3)
var(2) = 1

[State 1000, buffer setting3]
Type = varSet
Trigger1 = !Time
Trigger1 = helper(2000),var(3) > helper(2000), var(1)
Trigger1 = helper(2000),var(3) > helper(2000), var(2)
var(2) = 2

[State 1000, Power Set]
Type = varSet
TriggerAll = !Time
Trigger1 = command="x"
Trigger2 = command="y"
Trigger3 = command="z"
var(2) = IfElse(command = "y",1,IfElse(Command = "z",2,0))

[State 1000, Power set]
Type = varSet
Trigger1 = !Time
Trigger1 = var(9)
var(2) = 0

[State 1000, Power set]
Type = varSet
Trigger1 = !Time
Trigger1 = var(9)
var(2) = (p2bodydist x > 30)+(p2bodydist x > 100)

[State 5100, EnvShake]
type = FallEnvShake
trigger1 = !Time

[State 5100, 8]
type = GameMakeAnim
trigger1 = !Time
value = 60 + (sysvar(1) > 5) + (sysvar(1) > 14)
pos = 0, 0
under = sysvar(1) <= 10

[State 5100, 10]
type = PlaySnd
trigger1 = !Time
value = F7, (sysvar(1) > 5) + (sysvar(1) > 14)

[State 5100, 13]
type = ForceFeedback
trigger1 = !Time
waveform = sinesquare
ampl = 128,-3,-.2,.005
time = 2

[State 5201, 1]
type = changestate
trigger1 = !Time && !alive
value = 5101

[State 5201, 1]
type = Turn
trigger1 = !Time
trigger1 = P2Dist X < -5

[State 5201, 3]
type = PosSet
trigger1 = !Time
y = 0

[State 5201, 2]
type = VelSet
trigger1 = !Time
x = 0
y = 0

[State 5201, 3]
type = statetypeset
trigger1 = animelem = 2
statetype = S
movetype= I
physics = N

[State 5201, 2]
type = VelSet
trigger1 = time = 10
trigger1 = var(2) >= 1
x = 4+var(2)*3

[State 5100, 8]
type = Playerpush
trigger1 = 1
value = 0

[State 5201, 6]
type = ChangeState
trigger1 = Time >= 20+var(2)*5
value = 0
ctrl = 1

;-----------------------------------
;----------- Hit Liedead -----------
;-----------------------------------
; HIT_LIEDEAD
[Statedef 5150]
type    = L
movetype= H
physics = N
sprpriority = -3

[State 5150, 1] ;Normal anim
type = ChangeAnim
triggerall = Time = 0
triggerall = SelfAnimExist(5140)
trigger1 = (anim != [5111,5119]) && (anim != [5171,5179])
trigger2 = !SelfAnimExist(5140 + (anim % 10))
value = 5140

[State 5150, 3] ;Hit up type anim
type = ChangeAnim
trigger1 = Time = 0
trigger1 = (anim = [5111,5119]) || (anim = [5171,5179])
trigger1 = SelfAnimExist(5140 + (anim % 10))
value = 5140 + (anim % 10)

[State 5150, 4] ;Match over anim
type = ChangeAnim
persistent = 0
trigger1 = MatchOver = 1
trigger1 = Anim = [5140,5149]
trigger1 = SelfAnimExist(anim+10)
value = anim+10

[State 5150, 5] ;Switch to 5110 if liedead anim does not exist
type = ChangeAnim
trigger1 = Time = 0
trigger1 = Anim != [5140,5159]
trigger1 = Anim != [5110,5119]
value = 5110

[State 5150, 6] ;Friction
type = VelMul
trigger1 = 1
x = 0.85

[State 5150, 7] ;Friction
type = VelSet
trigger1 = Vel x < .05
persistent = 0
x = 0

[State 5950, Changeanim]
type = ChangeAnim
trigger1 = !Time
trigger1 = PrevStateno = 5950
value = 5171

[State 5950, Changeanim]
type = PosAdd
trigger1 = !Time
trigger1 = PrevStateno = 5950
x = 50

[State 5150, 8]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

;-----------------------------------
;--------- Initializing... ---------
;-----------------------------------
[Statedef 5900]
Type = S
Anim = var(1)

[State 5900, 1] ;Clear All int variables
Type = varRangeSet
Trigger1 = RoundNo = 1
Trigger2 = TeamMode = turns
Trigger2 = RoundNo > 1
Trigger2 = Roundsexisted <= 0
Trigger2 = RoundState = 0
Value = 0

[State 5900, 2] ;Clear All float variables
Type = varRangeSet
Trigger1 = RoundNo = 1
Trigger2 = TeamMode = turns
Trigger2 = RoundNo > 1
Trigger2 = Roundsexisted <= 0
Trigger2 = RoundState = 0
fValue = 0

[State 5900, LR start]
type = VarSet
trigger1 = var(2)
var(2) = 0

[State 5900, LR start]
type = VarSet
trigger1 = !var(10)
var(10) = teamside

[State 5900, Guard Crush Reset]
type = VarSet
trigger1 = var(11)
var(11) = 0

[State 5900, Dizzy Reset]
type = VarSet
trigger1 = var(13)
var(13) = 0

[State 5900, MAX Reset]
type = VarSet
trigger1 = var(15)
var(15) = 0

[State 5900, MAX bar Reset]
type = VarSet
trigger1 = var(17)
var(17) = 0

[State 191, 1]
Type = Changestate
TriggerAll = Time = 2
TriggerAll = RoundNo > 1
TriggerAll = Enemy, Teammode = Turns
TriggerAll = Enemy, Roundsexisted <= 0
TriggerAll = !Numpartner
TriggerAll = NumEnemy < 2
Trigger1 = p2Name = "Chris"
Trigger2 = p2Name = "Shermie"
Trigger3 = p2Name = "Iori"
Trigger4 = p2Name = "Yagami"
Trigger5 = p2Name = "Iori Yagami"
Trigger6 = p2Name = "Goenitz"
Trigger7 = p2Name = "Leopold Goenitz"
value = 192

[State 5900, 3] ;Intro
Type = ChangeState
Trigger1 = RoundNo = 1
Trigger2 = TeamMode = turns
Trigger2 = RoundNo > 1
Trigger2 = Roundsexisted <= 0
Trigger2 = RoundState = 0
Value = 190


;============================================================================
; States that are always executed (use Statedef -2)
;============================================================================
[Statedef -2]

[State -2, Display]
type = DisplayToClipboard
trigger1 = 1
ignorehitpause = 1
text = "              DIST x= %d     DIST Y = %d"
params = floor(p2dist x), floor(p2dist y)

; Command buffering ----------------------------------------------------------------

[State -2, CMDbuffer]
type = Helper
trigger1 = !ishelper
trigger1 = !NumHelper(2000)
ID = 2000
name = "cmdbuffer"
stateno = 2000
postype = left
pos = 0,0
ignorehitpause = 1
keyctrl = 0

; Special finish effect --------------------------------------------------------------
[State -2, Special Finish]
type = Helper
triggerall = WinKo && !NumHelper(9995)
trigger1 = movecontact && hitdefattr = SCA,SA,SP,ST
trigger2 = NumTarget(1400)
ID = 9995
stateno = 9995
postype = left
pos = 0,0
pausemovetime = 9999
ignorehitpause = 1

; DM/SDM finish effect --------------------------------------------------------------

[State -2, DM/SDM Finish]
type = Helper
triggerall = WinKo && !NumHelper(9996)
trigger1 = movecontact && hitdefattr = SCA,HA,HP,HT
trigger2 = NumTarget(3200)
ID = 9996
stateno = 9996
postype = left
pos = 0,0
pausemovetime = 9999
ignorehitpause = 1

[State 9996, Remove BG for Hyper finish]
type = RemoveExplod
trigger1 = numexplod(11000)
trigger1 = numhelper(9996)
ID = 11000
ignorehitpause = 1

; KOF Juggle State Optimization ----------------------------------------------
[State 9000, Assert]
type = AssertSpecial
trigger1 = p2MoveType = H
trigger1 = p2StateNo = [6000,6003]
trigger2 = p2StateNo = [5080, 5150]
Flag = NoJuggleCheck
ignorehitpause = 1
persistent = 0

; AI De-activate coding ------------------------------------------------------

[State -2, AI Desactivate]
type = VarSet
trigger1 = var(9) > 0 && RoundState = 3
var(9) = 0

; KOF MAX timer coding --------------------------------------------------------------

[State -2, set powerbar]
type = powerset
trigger1 = RoundState = 2
trigger1 = var(15) && !NumPartner
trigger1 = !NumPartner
trigger1 = stateno != [3000,4999]
trigger1 = stateno != 750
value = var(16)
ignorehitpause = 1

[State -2, 8]
type = VarAdd
trigger1 = Var(15)
trigger1 = StateNo != 750
var(15) = -1
ignorehitpause = 1

[State -2, 8]
type = VarSet
trigger1 = Var(15) < 0
trigger1 = StateNo != 750
var(15) = 0
ignorehitpause = 1

[State -2, powerbar]
type = ModifyExplod
trigger1 = Var(15)
ID = 8231
scale = (Var(15)) / 1000.0,1
ignorehitpause = 1

[State -2, powerbar]
type = removeExplod
trigger1 = NumExplod(8231)
trigger1 = !Var(15)
ID = 8230
ignorehitpause = 1

[State -2, powerbar]
type = removeExplod
trigger1 = !Var(15)
ID = 8231
ignorehitpause = 1

[State -2, 9]
type = varadd
trigger1 = Var(17) > 0 && !Var(15)
var(17) = -1
ignorehitpause = 1

[State 714, 5]
type = Explod
trigger1 = var(10) = 1
trigger1 = !var(15) && var(17) && var(17) != 20
scale =1,(1-(0.05*(20-var(17))))
anim = 8230
postype = left
pos = 25,210
bindtime = -1
removetime = 1
ontop = 1
ignorehitpause = 1

[State 714, 5]
type = Explod
trigger1 = var(10) = 2
trigger1 = !var(15) && var(17) && var(17) != 20
scale =1,(1-(0.05*(20-var(17))))
anim = 8231
postype = Right
pos = -25,210
bindtime = -1
removetime = 1
ontop = 1
ignorehitpause = 1

[State -2, 11]
type = PalFX
trigger1 = MoveType != H
trigger1 = (GameTime%2)=0
trigger1 = var(15)
time = 1
add = 70,70,70
ignorehitpause = 1

; Projectile Effects --------------------------------------------------------

[State -2, KOF Projectile & Burn pause]
Type = Pause
TriggerAll = RoundState = 2
TriggerAll = (GameTime%4) = 1
Trigger1 = ProjHitTime(0) = [1,15]
Trigger2 = var(8) > 15
Time = 1
MoveTime = 0
IgnoreHitPause = 1

[State -2, KOF Projectile & Burn pause]
Type = Varset
Trigger1 = ProjHitTime(1010) = 1
Trigger2 = ProjHitTime(3010) = 1
var(8) = Ifelse(Enemy, GetHitvar(fall) = 1, 40, 55)
IgnoreHitPause = 1

[State -2, SDM Proj envcolor]
type = EnvColor
Trigger1 = ProjHitTime(3000) = 1
Value = 255, 255, 255
Time = 2
Under = 1
IgnoreHitPause = 1

[State -1]
type = Helper
trigger1 = NumHelper(9997) = 0
trigger1 = roundstate = 2 && p2movetype = A
name = "counter hit"
id = 9997
helpertype = normal
pos = 0,0
postype = p1
stateno = 9997
keyctrl = 0
ownpal = 1
pausemovetime = 9999999
supermovetime = 9999999

;   Throw limitter   ------------------------------------------------------

[State -2, single]
type = VarSet
trigger1 = MoveContact||projcontact = 1
trigger2 = p2stateno = [5020,5120]
trigger3 = p2stateno = [5620,5690]
trigger4 = p2stateno = 1036 && p2movetype = H
trigger5 = p2stateno = 843 && p2movetype = H
var(6) = 10
ignorehitpause = 1

[State -2, single]
type = VarAdd
trigger1 = var(6) >= 1
trigger1 = p2movetype != H
var(6) = -1
ignorehitpause = 1

[State -2, single]
type = VarSet
trigger1 = p2movetype = A
var(6) = 0
ignorehitpause = 1

[State -2, super]
type = VarSet
trigger1 = MoveGuarded
trigger2 = projguarded = 1
trigger3 = p2stateno = [5020,5120]
Trigger4 = P2MoveType = H
trigger4 = p2stateno = [6000,6200]
Trigger5 = P2MoveType = H
Trigger5 = EnemyNear, Hitover
var(19) = 10
ignorehitpause = 1

[State -2, super]
type = VarSet
trigger1 = p2movetype = A
trigger2 = MoveHit
trigger2 = EnemyNear, HitShakeover = 0
var(19) = 0
ignorehitpause = 1

[State -2, super]
type = VarAdd
trigger1 = var(19) >= 1
trigger1 = p2movetype != H
var(19) = -1
ignorehitpause = 1

; Burn Explod -------------------------------------------------------------

[State 3020, 2]
Type = Explod
Trigger1 = var(8) > 20
Trigger1 = NumExplod(7003) < 3
Anim = 7003
PosType = p2
Ownpal = 1
SprPriority = 5
BindTime = 1
Pos = -10, -80
Random = 20, 40
Id = 7003
IgnoreHitPause = 1

[State 3020, 2]
Type = Explod
Trigger1 = var(8) > 15
Trigger1 = NumExplod(7002) < 5
Anim = 7002
PosType = p2
Ownpal = 1
SprPriority = 5
BindTime = 1
Pos = -10, -80
Random = 30, 50
Id = 7002
IgnoreHitPause = 1

[State 3020, 2]
Type = Explod
Trigger1 = var(8) > 5
Trigger1 = NumExplod(7001) < 7
Anim = 7001
PosType = p2
Ownpal = 1
SprPriority = 5
BindTime = 1
Pos = -10, -80
Random = 40, 70
Id = 7001
IgnoreHitPause = 1

[State 3020, 2]
Type = Explod
Trigger1 = var(8) > 0
Trigger1 = NumExplod(7000) < 7
Anim = 7000
PosType = p2
Ownpal = 1
SprPriority = 5
BindTime = 1
Pos = -10, -80
Random = 40, 70
Id = 7000
IgnoreHitPause = 1

[State 3020, 2]
Type = varAdd
Trigger1 = var(8) > 0
var(8) = -1

; Dizzy countdown -------------------------------------------------------------
[State -2, Dizzy count ]
type = Varadd
trigger1 = var(13) > 0
trigger1 = movetype != H
var(13) = -1
Ignorehitpause = 1

; Guard Crush Countdown -------------------------------------------------------------
[State -2, GCrushCount ]
type = Varadd
trigger1 = var(11) > 0
trigger1 = movetype != H
var(11) = -1
ignorehitpause = 1

; Guard Crush Countdown Adjust 1 ----------------------------------------------------
[State -3, GCrushAdjust1 ]
type = Varset
trigger1 = var(11) < 0
var(11) = 0
ignorehitpause = 1

; Dizzy increasing value coding -----------------------------------------------
[State -2, DizzyIncreasing ]
type = Varadd
triggerall = gethitvar(damage) > 0 && gethitvar(hitcount) > 0
triggerall = UniqHitCount <= 1
trigger1 = enemy,movehit
trigger2 = enemy,projhit = 1
var(13) = floor((ifelse(GetHitVar(damage) <= 100,GetHitVar(damage),100))/gethitvar(hitcount))*2
ignorehitpause = 1
persistent = 0

; Stop sound when getting hit -------------------------------------------------
[State -3, Stop Sound]
type = StopSnd
trigger1 = Movetype = H
Channel = 1

; Remove HSDM BG --------------------------------------------------------------
[State -2, RemoveBG]
type = removeExplod
trigger1 = NumExplod(11000)
trigger1 = StateNo != [4000, 4999]
trigger1 = StateNo != [1102, 1103]
trigger1 = StateNo != 3103
ID = 11000
ignorehitpause = 1


; FIX zzzasd throw bug --------------------------------------------------------
[State -2, zzzasd bugfix]
type = ChangeAnim
trigger1 = StateNo = 812
trigger1 = Anim = 200
value = 306
ignorehitpause = 1


; Remove Power Charging Effects -----------------------------------------------
[State -2, RemoveBG]
type = removeExplod
trigger1 = NumExplod(8400)
trigger1 = StateNo != 770
ID = 8400
ignorehitpause = 1

[State -2, StopchargeSnd1]
type = stopsnd
trigger1 = StateNo != 770
Channel = 6

[State -2, StopchargeSnd2]
type = stopsnd
trigger1 = StateNo != 770
channel = 7

; Increase Defensive Power when life < 50% ----------------------------------------------

[State -3,def up]
type = DefenceMulSet
trigger1 = !var(9)
trigger1 = Life > const(data.life)/2
value = 1+.1*var(1)
ignorehitpause = 1

[State -3,def up]
type = DefenceMulSet
trigger1 = var(9)
trigger1 = Life > const(data.life)/2
value = 1-.1*var(1)-.3*(var(9) > 9)-.3*(var(9) > 20)
ignorehitpause = 1

[State -3,def up]
type = DefenceMulSet
trigger1 = !var(9)
trigger1 = Life <= const(data.life)/2
value = ifelse(life <= const(data.life)/4,.7,.8)+.1*var(1)
ignorehitpause = 1

[State -3,def up]
type = DefenceMulSet
trigger1 = var(9)
trigger1 = Life <= const(data.life)/2
value = ifelse(life <= const(data.life)/4,.7,.8)-.1*var(1)-.3*(var(9) > 9)-.3*(var(9) > 20)
ignorehitpause = 1

;-------------------------------------------------------------------------------
;------------------------- KOF Cornerpush by YongMing --------------------------
;------------------------------ Modifyed by Elix -------------------------------
;---------------------- Revised and Upgraded by Don Drago ----------------------
;-------------------------------------------------------------------------------
; Main Changes:
; 1 - Added Custom States Support
; 2 - All possible var(x) = 0 changed to !var(x) (faster to process)
; 3 - Removed the needing of Explod(3000) to control SuperPause
; 4 - Fixed the Movetype = H landing bug (in the original code, when the opponent
;     lands in a custom state, being "MoveType = H", you could get a little corner
;     push. Fixed in this new version
; 5 - Elix used "!hitpausetime" in his version of the code. The old "Target,
;     Gethitvar(HitShakeTime)" proved to be far more useful (unless you use the
;     same amount of pausetime in your hitdefs, like 11,11 or 13,13.

[State -2, HitShakeOver VelSet]
type = VarSet
triggerall = NumTarget
triggerall = (target, BackEdgeBodyDist <= 5) || (target, FrontEdgeBodyDist <= 5)
triggerall = target, MoveType = H
triggerall = target, Vel y = 0
triggerall = !Numtarget(3200)
triggerall = StateType != A
triggerAll = target,StateNo != [6000, 6099]; DGroove Custom States
trigger1 = target, StateType = S
trigger2 = target, StateType = C
fvar(0) = ifelse(target, BackEdgeBodyDist <= 5,target, Vel X,-target, Vel X)

[State -2, HitShake VelSet]
type = VarSet
triggerall = NumTarget
triggerall = !fvar(0)
triggerall = (target, BackEdgeBodyDist <= 5) || (target, FrontEdgeBodyDist <= 5)
triggerall = target, GetHitVar(HitShakeTime) = 0
triggerall = target, GetHitVar(yvel) = 0
triggerall = !Numtarget(3200)
triggerAll = target,StateNo != [6000, 6099]; DGroove Custom States
trigger1 = target, StateNo = 5000
trigger2 = target, StateNo = 5010
trigger3 = target, StateNo = 150
trigger4 = target, StateNo = 152
IgnoreHitPause = 1
fvar(0) = ifelse(facing = -1 && target, BackEdgeBodyDist <= 5,target, GetHitVar(xvel),-target, GetHitVar(xvel))

[State -2, Corner Push]
type = PosAdd
trigger1 = NumTarget
trigger1 = HitShakeOver
trigger1 = target,StateNo != [5200, 5299]; Recovery rolls
trigger1 = fvar(0)
trigger1 = !(Time <= 28 && StateNo = [3000, 4999]); This avoids the creation of explods.
x = fvar(0)

[State -2, Velocity Reset]
type = VarSet
triggerall = fvar(0)
trigger1 = !NumTarget
trigger2 = target,HitShakeOver
trigger3 = target,StateNo = [6000, 6099]
fvar(0) = 0


