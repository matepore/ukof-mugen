;================================================================================
;その他ステート
;================================================================================

; 1st Throw
;----------

; Attempt
;--------
[StateDef 800]
Type = S
MoveType = A
Physics = S
anim = 800
sprpriority = 2
ctrl = 0

[State 200, 2]
type = HitDef
trigger1 = AnimElem = 1
attr = S, NT
damage = 0
animtype = hard
hitflag = M, miss
guardflag = P
sparkno = -1
sparkxy = -20,-60
pausetime = 0,0
p1facing = 1
p2facing = 1
P1StateNo = 801
P2StateNo = 805

[State 800, end state]
type = ChangeState
trigger1 = Animtime = 0
value = 225

; Attack
;--------
[StateDef 801]
Type = S
MoveType = A
Physics = S
anim = 801
sprpriority = 2
velset = 0,0
ctrl = 0

[State 801, grab spark]
type = Explod
trigger1 = AnimElem = 1
anim = 7013
ID = 800
postype = p1
pos = 50,-94
bindtime = 1
sprpriority = 1
ownpal = 1

[State 801, hit spark]
type = Explod
trigger1 = AnimElem = 5
anim = 7002
ID = 800
postype = p1
pos = 56,-76
bindtime = 1
ontop = 1
ownpal = 1

[State 801, voice]
type = PlaySnd
trigger1 = AnimElem = 1
value = 800,0

[State 801, voice]
type = PlaySnd
trigger1 = AnimElem = 4
value = 400,0

[State 801, hit sound]
type = PlaySnd
trigger1 = AnimElem = 5
value = 211,0

[State 801, target life]
type = TargetLifeAdd
trigger1 = numtarget > 0
trigger1 = AnimElem = 5
value = -30

[State 801, poweradd]
type = poweradd
trigger1 = numtarget > 0
trigger1 = AnimElem = 5
value = 30

[State 801, target position 0]
type = TargetBind
trigger1 = numtarget > 0
trigger1 = AnimElem = 1
pos = 36, 0

[State 801, target position 1]
type = TargetBind
trigger1 = numtarget > 0
trigger1 = AnimElem = 2
pos = 40, 0

[State 801, target position 2]
type = TargetBind
trigger1 = numtarget > 0
trigger1 = AnimElem = 3
pos = 36, 0

[State 801, target position 3]
type = TargetBind
trigger1 = numtarget > 0
trigger1 = AnimElem = 4
pos = 36, -12

[State 801, target position 4]
type = TargetBind
trigger1 = numtarget > 0
trigger1 = AnimElem = 5
pos = 28, -24

[State 801, target position 5]
type = TargetBind
trigger1 = numtarget > 0
trigger1 = AnimElem = 6
pos = 36, -12

[State 801, target position 6]
type = TargetBind
trigger1 = numtarget > 0
trigger1 = AnimElem = 7
pos = 36, 0


[State 810,Width]
type = Width
trigger1 = AnimElem = 1 && BackEdgeDist < 60
edge = 20,60

[State 810,Width]
type = Width
trigger1 = AnimElem = 1 && FrontEdgeDist < 60
edge = 60,20

[State 801, end state]
type = ChangeState
trigger1 = Time = 96
value = 802

; Last Hit
;----------
[StateDef 802]
Type = S
MoveType = A
Physics = N
anim = 802
sprpriority = 2
ctrl = 0

[State 807, invincibility]
type = NotHitBy
trigger1 = 1
value = SCA

[State 807, ghost]
type = PlayerPush
trigger1 = 1
value = 1

[State 802, hit spark]
type = Explod
trigger1 = AnimElem = 5
anim = 7002
ID = 800
postype = p1
pos = 56,-72
bindtime = 1
ontop = 1
ownpal = 1

[State 802, hit sound]
type = PlaySnd
trigger1 = AnimElem = 5
value = 215,0

[State 802, add position]
type = PosAdd
trigger1 = AnimElem = 6
x = 32

[State 802, upward velocity]
type = VelSet
trigger1 = time = 17
x = 2
y = -8.5

[State 802, gravity]
type = VelAdd
trigger1 = time >= 17
y = 0.5

[State 802, target life]
type = TargetLifeAdd
trigger1 = numtarget > 0
trigger1 = AnimElem = 5
value = -30

[State 802, poweradd]
type = poweradd
trigger1 = numtarget > 0
trigger1 = AnimElem = 5
value = 30

[State 802, target state]
type = TargetState
trigger1 = numtarget > 0
trigger1 = time = 0
value = 806

[State 802, target position 1]
type = TargetBind
trigger1 = numtarget > 0
trigger1 = AnimElem = 1
pos = 40, 0

[State 802, target position 2]
type = TargetBind
trigger1 = numtarget > 0
trigger1 = AnimElem = 2
pos = 36, 0

[State 802, target position 3]
type = TargetBind
trigger1 = numtarget > 0
trigger1 = AnimElem = 3
pos = 36, -12

[State 802, target position 4]
type = TargetBind
trigger1 = numtarget > 0
trigger1 = AnimElem = 4
pos = 28, -24

[State 801, target position 5]
type = TargetBind
trigger1 = numtarget > 0
trigger1 = AnimElem = 5
pos = 28, -36

[State 801, target position 6]
type = TargetBind
trigger1 = numtarget > 0
trigger1 = AnimElem = 6
pos = 52, -39

[State 802, end state]
type = ChangeState
trigger1 = AnimTime = 0
value = 803

; Land
;------
[StateDef 803]
Type = S
MoveType = I
Physics = N
anim = 803
sprpriority = 2
ctrl = 0

[State 803, stop velocity]
type = VelSet
trigger1 = time = 0
x = 0
y = 0

[State 803, position]
type = PosSet
trigger1 = time = 0
y = 0

[State 803, end state]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

; Ennemy Hit
;------------
[StateDef 805]
Type = S
MoveType = H
Physics = N
sprpriority = -1
velset = 0,0
ctrl = 0

[State 805, grabbed animation]
type = ChangeAnim2
trigger1 = time < 20
value = 805
elem = 2

[State 805, hit animation]
type = ChangeAnim2
trigger1 = time = 20
value = 805

[State 805, fall state]
type = SelfState
trigger1 = time = 100
value = 5070

; Ennemy Last Hit
;-----------------
[StateDef 806]
Type = S
MoveType = H
Physics = N
sprpriority = -1
velset = 0,0
ctrl = 0

[State 807, invincibility]
type = NotHitBy
trigger1 = 1
value = SCA

[State 807, ghost]
type = PlayerPush
trigger1 = 1
value = 1

[State 806, hit animation]
type = ChangeAnim2
trigger1 = time = 0
value = 806

[State 806, fall state]
type = ChangeState
trigger1 = AnimTime = 0
value = 807

; Ennemy Falling
;----------------
[StateDef 807]
Type = A
MoveType = H
Physics = N
sprpriority = -1
ctrl = 0

[State 807, invincibility]
type = NotHitBy
trigger1 = 1
value = SCA

[State 807, ghost]
type = PlayerPush
trigger1 = 1
value = 1

[State 807, falling animation]
type = ChangeAnim
trigger1 = time = 0
value = 5050

[State 807, velocity]
type = VelSet
trigger1 = time = 0
x = -4
y = -6

[State 807, gravity 1]
type = VelAdd
trigger1 = time <= 16
y = 0.4

[State 807, gravity 2]
type = VelAdd
trigger1 = time > 16
y = 0.7

[State 807, fall state]
type = SelfState
trigger1 = Time = 32
value = 5100



; 2nd Throw
;----------

; Attempt
;--------
[StateDef 810]
Type = S
MoveType = A
Physics = S
anim = 800
sprpriority = 2
ctrl = 0

[State 200, 2]
type = HitDef
trigger1 = AnimElem = 1
attr = S, NT
damage = 0
animtype = hard
hitflag = M, miss
guardflag = P
sparkno = -1
sparkxy = -20,-60
pausetime = 0,0
p1facing = 1
p2facing = 1
P1StateNo = 811
P2StateNo = 815

[State 800, end state]
type = ChangeState
trigger1 = Animtime = 0
value = 235

; Attack
;--------
[StateDef 811]
Type = S
MoveType = A
Physics = N
anim = 811
sprpriority = 2
velset = 0,0
ctrl = 0

[State 805, screen]
type = null;screenbound
trigger1 = 1
value = 0

[State 811, position 1]
type = PosAdd
trigger1 = AnimElem = 2
x = 8
y = -12

[State 811, position 2]
type = PosAdd
trigger1 = AnimElem = 3
x = -56
y = 12

[State 811, position 3]
type = PosAdd
trigger1 = AnimElem = 4
x = -16

[State 811, position 4]
type = PosAdd
trigger1 = AnimElem = 5
x = -16

[State 811, position 5]
type = PosAdd
trigger1 = AnimElem = 6
x = -16

[State 811, turn]
type = turn
trigger1 = AnimElem = 12

[State 811, grab spark]
type = Explod
trigger1 = AnimElem = 2
anim = 7013
ID = 800
postype = p1
pos = 44,-64
bindtime = 1
sprpriority = 1
ownpal = 1

[State 811, ground shockwave]
type = Explod
trigger1 = AnimElem = 6
anim = 7036
ID = 800
postype = p1
pos = -56,0
bindtime = 1
sprpriority = -2
ownpal = 1

[State 801, voice]
type = PlaySnd
trigger1 = AnimElem = 1
value = 800,0

[State 811, ]
type = PlaySnd
trigger1 = AnimElem = 4
value = 810,0

[State 811, hit ground sound]
type = PlaySnd
trigger1 = AnimElem = 6
value = 810,1

[State 801, voice]
type = PlaySnd
trigger1 = AnimElem = 4
value = 300,0

[State 811, env shake]
type = EnvShake
trigger1 = AnimElem = 6
time = 10
ampl = -4

[State 802, target life]
type = TargetLifeAdd
trigger1 = numtarget > 0
trigger1 = AnimElem = 6
value = -150

[State 802, poweradd]
type = powerAdd
trigger1 = numtarget > 0
trigger1 = AnimElem = 5
value = 150

[State 811, target position 1]
type = TargetBind
trigger1 = numtarget > 0
trigger1 = AnimElem = 1
pos = 40, 0

[State 811, target position 2]
type = TargetBind
trigger1 = numtarget > 0
trigger1 = AnimElem = 2
pos = 32, 12

[State 811, target position 3]
type = TargetBind
trigger1 = numtarget > 0
trigger1 = AnimElem = 3
;pos = 88, -24
pos = 76, -80

[State 811, target position 4]
type = TargetBind
trigger1 = numtarget > 0
trigger1 = AnimElem = 4
;pos = 56, -48
pos = 52, -85

[State 811, target position 5]
type = TargetBind
trigger1 = numtarget > 0
trigger1 = AnimElem = 5
;pos = -12, -56
pos = -22, -98

[State 811, target position 6]
type = TargetBind
trigger1 = numtarget > 0
trigger1 = AnimElem = 6
pos = -62, 0

[State 810,Width]
type = Width
trigger1 = (AnimElem = 1 || AnimElem = 5) && BackEdgeDist < 60
edge = 20,60

[State 810,Width]
type = Width
trigger1 = (AnimElem = 1 || AnimElem = 5) && FrontEdgeDist < 60
edge = 60,20

[State 811, end state]
type = ChangeState
trigger1 = Animtime = 0
value = 0
ctrl = 1

; Ennemy Hit
;------------
[StateDef 815]
Type = S
MoveType = H
Physics = N
sprpriority = -1
velset = 0,0
ctrl = 0

[State 815, hit animation]
type = ChangeAnim2
trigger1 = time  = 0
value = 815

[State 815, velocity]
type = VelSet
trigger1 = AnimTime = 0
x = 4
y = -6.5

[State 815, fall state]
type = ChangeState
trigger1 = AnimTime = 0
value = 816

; Ennemy Falling
;----------------
[StateDef 816]
Type = A
MoveType = H
Physics = N
sprpriority = -1
ctrl = 0

[State 816, hit animation]
type = ChangeAnim2
trigger1 = time  = 0
value = 816

[State 816, velocity]
type = VelSet
trigger1 = time = 0
x = 4
y = -6

[State 816, gravity]
type = VelAdd
trigger1 = 1
y = 0.5

[State 816, end state]
type = SelfState
trigger1 = AnimTime = 0
value = 5100

; -------------------------------Power up (start)
[Statedef 310]
type = S
movetype = I
physics = S
anim = 310
velset = 0
ctrl = 0

[State 301, snd]
type = PlaySnd
trigger1 = AnimElem = 1
value = 400,0

[State 301, snd]
type = PlaySnd
trigger1 = AnimElem = 5
value = 310,0
channel = 0

[State 730, 1]
type = ChangeState
trigger1 = AnimTime = 0
value = 311

; Power up
[Statedef 311]
type = S
movetype = I
physics = S
anim = 311

[State 705, 2]
type = Explod
trigger1 = ((Time + 12) % 12) = 0
anim = 7020
ID = 310
sprpriority = 3
postype = p1
pos = 0,0
bindtime = -1
removeongethit = 1

[State 735, 1]
type = ChangeState
triggerall = !var(59)
trigger1 = command != "hold_a"
trigger2 = command != "hold_y"
value = 312

[State 704, 8]
type = ChangeState
triggerall = var(59)
triggerall = Power < 3000
trigger1 = roundstate != 2
trigger2 = P2BodyDist X <= 140
trigger2 = enemynear,statetype != L && enemynear,stateno != [5030,5120]
trigger2 = random <= 100*Var(59)
trigger3 = P2BodyDist X <= 180
trigger3 = EnemyNear,MoveType = A
trigger4 = Inguarddist
trigger4 = random <= 100*var(59)
trigger5 = enemy,numproj > 0
trigger5 = random <= 100*var(59)
trigger6 = enemy,authorname = "Nyankoro" && P2Name = "Krizalid"
trigger6 = EnemyNear,StateNo = 1040
trigger7 = P2BodyDist X <= 70
trigger7 = enemynear,stateno = 5110
trigger7 = random <= 100*var(59)
trigger8 = Enemy,Numhelper
trigger8 = P2bodyDIst X <= 160
trigger8 = enemynear,statetype != L && enemynear,stateno != [5030,5120]
value = 312

[State 735, 2]
type = PowerAdd
trigger1 = Time = [0,12]
value = 6

[State 735, 2]
type = ChangeState
trigger1 = Power >= 3000
value = 313

[State 735, 3]
type = ChangeState
trigger1 = AnimTime = 0
value = 311

; Power up (end)
[Statedef 312]
type = S
movetype = I
physics = S
anim = 312

[State 1100, 1]
type = RemoveExplod
trigger1 = AnimElem = 1
ID = 318

[State 301, snd]
type = StopSnd
trigger1 = Time = 0
channel = 0

[State 740, 1]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

; Power up (maxed out)
[Statedef 313]
type = S
movetype = I
physics = S
anim = 312

[State 1100, 1]
type = RemoveExplod
trigger1 = AnimElem = 1
ID = 310

[State 301, snd]
type = StopSnd
trigger1 = Time = 0
channel = 0

[State 741, 2]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1


[Statedef 999]
type = A
movetype = I
physics = N
velset = 0
anim = 999
ctrl = 0

[State -2]
type = playsnd
trigger1 = roundno = 1 || roundno = 3 || roundno = 5 || roundno = 7 || roundno = 9
trigger1 = animelem = 2
value = s0,0
channel = 5
volume = 150
loop = 1

[State -2]
type = playsnd
trigger1 = roundno = 2 || roundno = 4 || roundno = 6 || roundno = 8 || roundno = 10
trigger1 = animelem = 2
value = s0,1
channel = 5
volume = 150
loop = 1

[State 999,]
type = changestate
trigger1 = animtime = 0
value = 998

[Statedef 998]
type = A
movetype = I
physics = N
anim = 999
velset = 0
ctrl = 0

[State 999,]
type = changestate
trigger1 = animtime = 0
value = 998

;\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
; MAX2
[Statedef 8000]
type = A
movetype = I
physics = N
anim = 8000
velset = 0, 0
ctrl = 0
sprpriority = -99

[State 3020, 1]
type = AssertSpecial
trigger1 = 1
flag = NoBG
flag2 = NoFG
ignorehitpause = 1

[State 191, Wood 1]
type = Explod
trigger1 = time = 0
anim = 8001
id = 8000
postype = back
pos = 0, 0
bindtime = -1
removetime = -1
sprpriority = -999
supermovetime = 999

[State 191, Wood 1]
type = Explod
trigger1 = time = 0
anim = 8001
id = 8000
postype = back
pos = -320, 0
bindtime = -1
removetime = -1
sprpriority = -999
supermovetime = 999

[State 191, Wood 1]
type = Explod
trigger1 = time = 0
anim = 8002
id = 8000
postype = back
pos = 0, 0
bindtime = -1
removetime = -1
sprpriority = -999
supermovetime = 999

[State 191, Wood 1]
type = Explod
trigger1 = time = 0
anim = 8002
id = 8000
postype = back
pos = -320, 0
bindtime = -1
removetime = -1
sprpriority = -999
supermovetime = 999

[State 191, Wood 1]
type = Explod
trigger1 = time = 0
anim = 8003
id = 8000
postype = back
pos = 0, 0
bindtime = -1
removetime = -1
sprpriority = -999
supermovetime = 999

[State 191, Wood 1]
type = Explod
trigger1 = time = 0
anim = 8003
id = 8000
postype = back
pos = -320, 0
bindtime = -1
removetime = -1
sprpriority = -999
supermovetime = 999

[State 191, Wood 1]
type = Explod
trigger1 = time = 0
anim = 8004
id = 8000
postype = back
pos = 0, 0
bindtime = -1
removetime = -1
sprpriority = -999
supermovetime = 999

[State 191, Wood 1]
type = Explod
trigger1 = time = 0
anim = 8004
id = 8000
postype = back
pos = -320, 0
bindtime = -1
removetime = -1
sprpriority = -999
supermovetime = 999

[State 191, Wood 1]
type = Explod
trigger1 = time = 0
anim = 8005
id = 8000
postype = back
pos = 0, 0
bindtime = -1
removetime = -1
sprpriority = -999
supermovetime = 999

[State 191, Wood 1]
type = Explod
trigger1 = time = 0
anim = 8005
id = 8000
postype = back
pos = -320, 0
bindtime = -1
removetime = -1
sprpriority = -999
supermovetime = 999


[State 191, Wood 1]
type = Explod
trigger1 = time = 0
anim = 8006
id = 8000
postype = back
pos = 0, 0
bindtime = -1
removetime = -1
sprpriority = -999
supermovetime = 999

[State 191, Wood 1]
type = Explod
trigger1 = time = 0
anim = 8006
id = 8000
postype = back
pos = -320, 0
bindtime = -1
removetime = -1
sprpriority = -999
supermovetime = 999


[State 191, Wood 1]
type = Explod
trigger1 = time = 0
anim = 8007
id = 8000
postype = back
pos = 0, 0
bindtime = -1
removetime = -1
sprpriority = -999
supermovetime = 999

[State 191, Wood 1]
type = Explod
trigger1 = time = 0
anim = 8007
id = 8000
postype = back
pos = -320, 0
bindtime = -1
removetime = -1
sprpriority = -999
supermovetime = 999

[State 3020, 1]
type = changestate
trigger1 = root,StateNo != [3400,3899]
trigger2 = root,stateno = 3402
value = 8001

;-------------------------------
[Statedef 8001]
type = A
movetype = I
physics = N
anim = 8000
velset = 0, 0
ctrl = 0
sprpriority = -99

[State 3020, 1]
type = null;AssertSpecial
trigger1 = 1
flag = NoBG
flag2 = NoFG
ignorehitpause = 1

;---------------------[エフェクト]
[state a]
type = varset
trigger1 = time = 0
v = 1
value = 256

[state a]
type = varadd
trigger1 = time <= 32
v = 1
value = -8

[State a];暗転
type = BGPalfx
trigger1 = time <= 32
time = 1
add = var(1),var(1),var(1)
invertall = 0
color = 256

;---------------------[効果音]
[State a];
type = PlaySnd
trigger1 = time = 0
value = 8000,0

[State 191, Wood 1]
type = Explod
trigger1 = time = 0
anim = 8010
id = 8010
postype = back
pos = 0, 0
bindtime = -1
sprpriority = -999
supermovetime = 999
trans = addalpha
alpha = 245,150

[State 3020, 1]
type = RemoveExplod
trigger1 = time = 0
ID = 8000

[State 3020, 1]
type = DestroySelf
trigger1 = time = 32

[Statedef 8100]
type = S
ctrl = 0
anim = 8100
velset = 0,0
movetype = I
physics = N
sprpriority = -95

[state a]
type = posset
trigger1 = facing = 1
x = -160
y = pos y - screenpos y + 95

[state a]
type = posset
trigger1 = facing = -1
x = 160
y = pos y - screenpos y + 95

[state a]
type = varset
trigger1 = time = 0
v = 1
value = 0

[state a]
type = varadd
trigger1 = animelem = 5,>0
v = 1
value = 1

;---------------------[ヘルパー]
[state a];カットイン
type = Helper
trigger1 = time = 0
id = 8105
name = "cut"
pos = 0 , 0
postype = p1
stateno = 8105
pausemovetime = 999
supermovetime = 999
helpertype = normal
persistent = 0
ignorehitpause = 1
keyctrl = 0 
ownpal = 1

;---------------------[透過]
[state a]
type = varadd
trigger1 = animelem = 23,>0
v = 2
value = 1

[state a]
type = angledraw
trigger1 = animelem = 23,>=0
scale = 1.0,1.0 - var(2)*0.1


;---------------------[]
[state a]
type = destroyself
trigger1 = animtime = 0
trigger2 = root,movetype = H

;---------------------------------------------------------------------------
;(HELPER)MAX2・カットイン・顔
[Statedef 8105]
type = S
ctrl = 0
anim = 8105
velset = 0,0
movetype = I
physics = N
sprpriority = -85

[state a]
type = posset
trigger1 = facing = 1
x = -160
y = pos y - screenpos y + 95

[state a]
type = posset
trigger1 = facing = -1
x = 160
y = pos y - screenpos y + 95

[state a]
type = varset
trigger1 = time = 0
v = 1
value = 0

;---------------------[透過]

[state a]
type = varadd
trigger1 = Var(1) < 10
trigger1 = animelem = 5,<=0
v = 1
value = 1

[state a]
type = angledraw
trigger1 = animelem = 5,< 0
scale = (0.0 + var(1)*0.1),(0.0 + var(1)*0.1)


[state a]
type = varadd
trigger1 = animelem = 6,>0
v = 2
value = 1

[state a]
type = angledraw
trigger1 = animelem = 6,>=0
scale = 1.0,1.0 - var(2)*0.1


;---------------------[]
[state a]
type = destroyself
trigger1 = animtime = 0
trigger2 = root,movetype = H


