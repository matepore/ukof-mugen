;===============================================================================
;EN ESTA SECCION SE ENCUENTRABN TODOS LOS ESTADOS DE -2 Y -3
;DEL CHAR LA MODIFICACION SIN AUTORIZACION PUEDE SIGNIFICAR
;UNA FALLA TOTAL EN EL MISMO
;===============================================================================
;-----------------------------------------------------------------------------
[Statedef -2]

;No Pasar Atras del Oponente (KOF Style)
[State -2, Width]
type = Width
trigger1 = Movetype != H
edge = 20-(Statetype = A)*3,0
ignorehitpause =1

;-------------------------------------------------------------------------------
;Electro
[State -2,]
type = Explod
triggerall = p2movetype = H
trigger1 = Projhittime(1010) >= 0 && Projhittime(1010) <= 25
trigger1 = Random < 350
trigger2 = Projhittime(2040) >= 0 && Projhittime(2040) <= 25
trigger2 = Random < 400
anim = 4160
pos = 0,-50
postype = p2
sprpriority = 9
bindtime = 1
random = 100,100
ownpal = 1
supermove = 1
;-------------------------------------------------------------------------------
;Variables y Explods de Quemar
[State 2300, Burn]
type = Varset
trigger1 = Projhittime(2010) >= 0 && Projhittime(2010) <= 1
trigger2 = Projhittime(2035) >= 0 && Projhittime(2035) <= 1
trigger3 = Anim = 2051
trigger3 = AnimElemtime(68) >= 0
trigger4 = Anim = 2031
persistent = 0
ignorehitpause = 1
var(23) = 1
;-------------------------------------------------------------------------------
;Variables y Explods de Electro
[State 2300, Burn]
type = Varset
trigger1 = Projhittime(1010) >= 0 && Projhittime(1010) <= 1
trigger2 = Projhittime(2040) >= 0 && Projhittime(2040) <= 1
trigger3 = Anim = 2051
trigger3 = AnimElemtime(70) >= 0
trigger4 = Anim = 2031
persistent = 0
ignorehitpause = 1
var(24) = 1

;Fuego Burning
[State -2,]
type = Explod
triggerall = p2movetype = H
trigger1 = Projhittime(2010) >= 0 && Projhittime(2010) <= 25
trigger1 = Random < 70
trigger2 = Projhittime(2035) >= 0 && Projhittime(2035) <= 25
trigger2 = Random < 70
trigger3 = Anim = 2051
trigger3 = AnimElemtime(70) >= 0
trigger3 = Random < 70
anim = 4150
pos = 0,-50
postype = p2
sprpriority = 9
bindtime = 1
random = 100,100
ownpal = 1

[State -2,]
type = Explod
triggerall = p2movetype = H
trigger1 = Projhittime(2010) >= 0 && Projhittime(2010) <= 25
trigger1 = Random < 70
trigger2 = Projhittime(2035) >= 0 && Projhittime(2035) <= 25
trigger2 = Random < 70
trigger3 = Anim = 2051
trigger3 = AnimElemtime(70) >= 0
trigger3 = Random < 200
anim = 4151
pos = 0,-50
postype = p2
sprpriority = 9
bindtime = 1
random = 100,100
ownpal = 1

[State -2,]
type = Explod
triggerall = p2movetype = H
trigger1 = Projhittime(2010) >= 0 && Projhittime(2010) <= 25
trigger1 = Random < 70
trigger2 = Projhittime(2035) >= 0 && Projhittime(2035) <= 25
trigger2 = Random < 70
trigger3 = Anim = 2051
trigger3 = AnimElemtime(70) >= 0
trigger3 = Random < 200
anim = 4152
pos = 0,-50
postype = p2
sprpriority = 9
bindtime = 1
random = 100,100
ownpal = 1

[State -2,]
type = Explod
triggerall = p2movetype = H
trigger1 = Projhittime(2010) >= 0 && Projhittime(2010) <= 25
trigger1 = Random < 70
trigger2 = Projhittime(2035) >= 0 && Projhittime(2035) <= 25
trigger2 = Random < 70
trigger3 = Anim = 2051
trigger3 = AnimElemtime(70) >= 0
trigger3 = Random < 200
anim = 4153
pos = 0,-50
postype = p2
sprpriority = 9
bindtime = 1
random = 100,100
ownpal = 1

[State 1000, PlaySnd]
type = PlaySnd
triggerall = p2movetype = H
trigger1 = Projhittime(2035) >= 0 && Projhittime(2035) <= 1
trigger1 = Random < 200
value = S12,8

[State 1000, PlaySnd]
type = PlaySnd
triggerall = p2movetype = H
trigger1 = Projhittime(2035) >= 0 && Projhittime(2035) <= 1
trigger1 = Random < 200
value = S12,9

;P2 en el Suelo
[State 1000, explods]
type = Explod
triggerall = (p2stateno = [5100,5110]) && p2movetype = H
trigger1 = var(23) > 0 && Random < 70
anim = 4146
pos = 0,0
facing = -1
postype = p2
sprpriority = 999
bindtime = 1
random = 100,0
ownpal = 1
ignorehitpause = 1

[State 1000, explods]
type = Explod
triggerall = (p2stateno = [5100,5110]) && p2movetype = H
trigger1 = var(23) > 0 && Random < 70
anim = 4151
pos = 0,0
postype = p2
sprpriority = 999
bindtime = 1
random = 100,100
ownpal = 1
ignorehitpause = 1

[State 1000, VarSet]
type = VarSet
trigger1 = p2movetype != H
v = 23
value = 0
persistent = 0

;P2 en el Suelo electro
[State 1000, explods]
type = Explod
triggerall = (p2stateno = [5100,5110]) && p2movetype = H
trigger1 = var(24) > 0 && Random < 200
anim = 4160
pos = 0,0
facing = -1
postype = p2
sprpriority = 999
bindtime = 1
random = 100,100
ownpal = 1
ignorehitpause = 1

[State 1000, VarSet]
type = VarSet
trigger1 = p2movetype != H
v = 24
value = 0
persistent = 0
;-------------------------------------------------------------------------------
[State -2, EnvColor]
type = EnvColor
trigger1 = Projhittime(1010) >= 0 && Projhittime(1010) <= 1
trigger2 = Projhittime(2010) >= 0 && Projhittime(2010) <= 1
trigger3 = Projhittime(2030) >= 0 && Projhittime(2030) <= 1
trigger4 = Projhittime(2040) >= 0 && Projhittime(2040) <= 1
trigger5 = Projhittime(2035) >= 0 && Projhittime(2035) <= 1
value = 255,255,255
time = 1
under = 1

[State -2, Assertspecial]
type = Assertspecial
trigger1 = roundstate != 2
trigger2 = Ctrl = 0 && (Anim = [0,2]) && MoveType != H
flag = NoBarDisplay
ignorehitpause = 1

[State -3, noautoturn]
type = AssertSpecial
trigger1 = BackEdgeBodyDist < 23
flag = noautoturn
;-------------------------------------------------------------------------------
;Pausa de ataques
[State -3, Slow Down]
type = Pause
triggerall = RoundState = 2
trigger1 = ProjHitTime(1000) = [15,30]
trigger2 = ProjHitTime(1010) = [10,15]
trigger3 = ProjHitTime(2030) = [15,30]
trigger4 = ProjHitTime(2040) = [15,30]
trigger5 = ProjHitTime(2035) = [15,30]
trigger6 = ProjHitTime(2010) = [12,22]
time = 1
movetime = 0
ignorehitpause = 1
;-----------------------------------------------------------------------------
[State 100, StopSnd]
type = StopSnd
trigger1 = stateno != 910 && stateno != 911
channel = 8

[State 100, StopSnd]
type = StopSnd
trigger1 = stateno != 910 && stateno != 911
channel = 9

[State 100, StopSnd]
type = StopSnd
trigger1 = movetype = H
channel = 4
ignorehitpause = 1
;-----------------------------------------------------------------------------

[State -2, No sound in Guanding KO]
type = AssertSpecial
trigger1 = stateno = 5000 || stateno = 5010 || stateno = 5070
trigger1 = statetype != A
flag = Nokosnd
ignorehitpause = 1

[State -2, Guarding KO]
type = ChangeState
trigger1 = prevstateno = [120,152]
trigger1 = !alive
value = 6010
ignorehitpause = 1

[State -2, 二人目のイントロ]
type = ChangeState
value = 190
triggerall = TeamMode = Turns
trigger1 = stateno = 5900

[State -2, ライフ確認]
type = VarSet
triggerall = RoundState = [0,1]
trigger1 = RoundNo = 1
trigger2 = TeamMode = Turns
trigger2 = RoundsExisted = 0
v = 22
value = Life

[State -2, ライフ取得ミス対策]
type = VarSet
triggerall = Var(22) = [0,100]
triggerall = Time = 1
trigger1 = RoundNo = 1
trigger2 = RoundsExisted = 0
v = 22
value = const(data.life)
;----------------------------------------------------------------------------
[State -2, 残像]
type = AfterImage
trigger1 = Movetype = H
time = 1

[State -2,]
type = StopSnd
trigger1 = command != "holdfwd"
trigger2 = Anim != 100 && anim != 101
channel = 6

;-------------------------------------------------------------------------------
;KO Flash Effect
[State -2, Helper]
type = Helper
triggerall = numhelper(9910) <= 0
trigger1 = winKo = 1 && movehit && stateno = [899,4999]
trigger2 = winko = 1 && Projhittime(1000) >= 0 && Projhittime(1000) <= 1
trigger3 = winko = 1 && Projhittime(1010) >= 0 && Projhittime(1010) <= 1
trigger4 = winko = 1 && Projhittime(2010) >= 0 && Projhittime(2010) <= 1
trigger5 = winko = 1 && Projhittime(2030) >= 0 && Projhittime(2030) <= 1
trigger6 = winko = 1 && Projhittime(2040) >= 0 && Projhittime(2040) <= 1
trigger7 = winko = 1 && Projhittime(2035) >= 0 && Projhittime(2035) <= 1
trigger8 = winko = 1 && anim = 2031
helpertype = normal
name = "KO Flash"
Id = 9910
stateno = 9910
pos = 0,0
postype = p1
facing = 1
ignorehitpause = 1
supermove = 1
pausemove = 1
pausemovetime = 99999
supermovetime = 99999
ownpal = 1

[state -2, PlaySound]
type = playsnd
trigger1 = WinKO
trigger1 = RoundState = 3
trigger1 = var(12) = 0
IgnoreHitPause = 1
persistent = 0
value = s5200,0
volumescale = 255

[state -2, varset]
type = varset
trigger1 = RoundState = 3
IgnoreHitPause = 1
v = 12
value = 1

[state -2, varset]
type = varset
trigger1 = RoundState = 2
IgnoreHitPause = 1
v = 12
value = 0

;-------------------------------------------------------------------------------
[State -2, 4]
type = VarRandom
triggerall = Time = 1
trigger1 = stateno = 5000
trigger2 = stateno = 5010
trigger3 = stateno = 5020
v = 4
range = 0,30

[State -2, 5]
type = PlaySnd
triggerall = Time = 1
triggerall = Var(4) = [0,3]
triggerall = alive = 1
trigger1 = stateno = 5000
trigger2 = stateno = 5010
trigger3 = stateno = 5020
value = s5000,0
channel = 0

[State -2, 6]
type = PlaySnd
triggerall = Time = 1
triggerall = Var(4) = [4,7]
triggerall = alive = 1
trigger1 = stateno = 5000
trigger2 = stateno = 5010
trigger3 = stateno = 5020
value = s5000,1
channel = 0

[State -2, 6]
type = PlaySnd
triggerall = Time = 1
triggerall = Var(4) = [8,11]
triggerall = alive = 1
trigger1 = stateno = 5000
trigger2 = stateno = 5010
trigger3 = stateno = 5020
value = s5000,2
channel = 0

[State -2, 6]
type = PlaySnd
triggerall = Time = 1
triggerall = Var(4) = [12,15]
triggerall = alive = 1
trigger1 = stateno = 5000
trigger2 = stateno = 5010
trigger3 = stateno = 5020
value = s5000,3
channel = 0

[State -2]
type = PlaySnd
Triggerall = Alive = 1
triggerall = Time = 1
trigger1 = (stateno = 5100) && (anim = 5100 || anim = 5101 || anim = 5102)
value = S5000,7
;---------------------------------------------------------------------------------
[Statedef -3]
;---------------------------------------------------------------------------------

[State -3, コマンドを入れたらVarをON]
type = VarSet
trigger1 = command = "jump"
trigger1 = ctrl
trigger1 = statetype = S
v = 3
value = 1

[State -3, sysvarを引継ぐ]
type = VarSet
trigger1 = Var(3) = 1
trigger1 = stateno = 40
trigger1 = AnimTime = 0
var(3) = ifelse(sysvar(1)=0, 2, ifelse(sysvar(1)=1, 3, 4))

[State -3, varをOFFにするステート]
type = VarSet
triggerall = Time = 2
trigger1 = stateno = 50
trigger2 = stateno != [40,59]
v = 3
value = 0

[State -3, 前にボタンを押してたら前にも加速]
type = VelAdd
trigger1 = var(3) = 3
trigger1 = stateno = 50
x = 2

[State -3, 後ろなら後ろに加速]
type = VelAdd
trigger1 = var(3) = 4
trigger1 = stateno = 50
x = -2.1

[State -3, varをOFFにするステート]
type = VarSet
trigger1 = Var(3) != 0
trigger2 = prevstateno = 100
trigger2 = AnimTime = 0
v = 2
value = 1

[State -3, varをOFFにするステート]
type = VarSet
trigger1 = stateno = 52
trigger2 = stateno = 20
v = 2
value = 0

[State -3, varをOFFにするステート]
type = VarSet
trigger1 = Var(3) != 0
trigger2 = prevstateno = 100
trigger2 = AnimTime = 0
v = 2
value = 1

[State -3, varをOFFにするステート]
type = VarSet
trigger1 = statetype != A
trigger1 = stateno != 40
v = 2
value = 0

[State -3, Afterimage]
type = Afterimage
trigger1 = var(3) >= 1
trigger1 = stateno = 50
trigger2 = AnimTime = 0
trigger2 = prevstateno = 100 ;RUN_FWD
trigger2 = sysvar(1) = 1
time = 2
length = 7
PalBright = 0,0,0
PalContrast = 256,256,256
PalAdd = 0,0,0
PalMul = 1,1,1
FrameGap = 3

[State -3, Afterimagetime]
type = Afterimagetime
triggerall = Var(2) = 1
triggerall = Stateno != 0
trigger1 = stateno = 50
trigger1 = time%2 = 0
time = 2

