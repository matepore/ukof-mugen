;基本データ部分
[Data]
life              = 3000    ;体力ゲージの最大値を決めます
power             = 5000    ;パワーゲージ最大値（デフォルトは 3000 = Lv.3 になります・オプション）
attack            = 100     ;攻撃力パーセンテージ（デフォルトは 100% になります）
defence           = 100     ;防御力パーセンテージ（デフォルトは 100% になります）
fall.defence_up   = 50      ;一時的に上昇するダウン時の防御力パーセンテージ
liedown.time      = 20      ;倒れてから起き上がるまでの時間
airjuggle         = 15      ;ジャグルポイント限界値　★１
sparkno           = 2       ;デフォルトのヒットスパーク番号（fightfx.airか、キャラのairから呼び出す）
guard.sparkno     = 40      ;デフォルトのガードスパーク番号（fightfx.airか、キャラのairから呼び出す）
KO.echo           = 0       ;ＫＯ時の声にエコーを掛けるかどうか（0=しない・1=する）
volume            = 128     ;キャラの音量　255が最高
intpersistindex   = 20,29   ;Varを次のラウンドへ持ち越しが可能 (最小=0, 最大=59)  ★２
floatpersistindex = 40      ;FVarを次のラウンドへ持ち越しが可能 (最小=0, 最大=39) ★２

;---------------------------------------------------------------------------
;サイズ設定
[Size]
xscale           = 1        ;キャラ画像の横のスケール
yscale           = 1        ;キャラ画像の縦のスケール
ground.back      = 20       ;キャラの幅（地上後方）
ground.front     = 20      ;キャラの幅（地上前方）
air.back         = 20       ;キャラの幅（空中後方）
air.front        = 20       ;キャラの幅（空中前方）
height           = 60       ;跳び越す相手のためのキャラの高さ
attack.dist      = 160      ;攻撃を出した時に相手がガード体勢に入る最低の距離
proj.attack.dist = 90       ;相手がガード体勢に入る発射物との最低の距離
proj.doscale     = 0        ;xscaleとyscaleが発射物のスケールにも影響するかどうか（0=しない・1=する）
head.pos         = -5, -70  ;BindToTargetの時に必要な頭の座標
mid.pos          = -5, -60  ;BindToTargetの時に必要な体中心の座標
shadowoffset     = 0        ;影の垂直方向の位置
draw.offset      = 0,0      ;キャラ描画表示位置（Ｘ軸,Ｙ軸）

;---------------------------------------------------------------------------
;移動速度設定
[Velocity]
walk.fwd     = 2         ;前進歩行速度
walk.back    = -2        ;後退歩行速度
run.fwd      = 5.5, 0      ;前に走る時の速度（Ｘ軸,Ｙ軸）
run.back     = -5.9,-3.9   ;後ろに走る時の速度（Ｘ軸,Ｙ軸）
jump.neu     = 0,-11      ;垂直ジャンプ速度（Ｘ軸,Ｙ軸）
jump.back    = -2.3        ;後ジャンプ速度
jump.fwd     = 2.3        ;前ジャンプ速度
runjump.back = -3.8,-8  ;後ろに走りながらのジャンプ速度（オプション）
runjump.fwd  = 3.8,-8      ;前に走りながらのジャンプ速度（オプション）
airjump.neu  = 0,-9.6      ;空中垂直ジャンプ速度（オプション）
airjump.back = -2.5        ;空中後ジャンプ速度（オプション）
airjump.fwd  = 2.55        ;空中前ジャンプ速度（オプション）

;---------------------------------------------------------------------------
;動作設定
[Movement]
airjump.num     = 0      ;空中ジャンプが出来る回数（オプション）
airjump.height  = 35     ;空中ジャンプするために必要な最低限の高さ（オプション）
yaccel          = .61     ;重力（垂直下降加速度）
stand.friction  = .8    ;立ち状態の摩擦係数
crouch.friction = .8    ;しゃがみ状態の摩擦係数

;----------------------------------------------------------
;var使用表
; var(0)  - 大ジャンプ判定
; var(1)  - 小ジャンプ判定
; var(2)  - 
; var(3)  -
; var(4)  - 生存判定
; var(5)  - 投げぬけ判定
; var(6)  - 
; var(7)  - 
; var(8)  - 
; var(9)  - 
; var(10) - 
; var(11) - 
; var(12) - 特定技ヒット後ジャグル増大判定
; var(13) - 
; var(14) - スーパーキャンセル判定
; var(15) - ドリームキャンセル判定
; var(16) - ベイパーキャノン派生判定
; var(17) - マキシマ・スクランブル、マキシマ・リフト派生判定
; var(18) - ファイナルキャノンタイムカウント
; var(19) - 通常技ガード判定
; var(20) - 空中ガードシステム
; var(21) - ファイナルキャノンヒットタイムカウント
; var(25) - スキルゲージ
; var(26) - スキルポイント
; var(27) - ゲージ位置
; var(28) - 従来設定
; var(29) - ファイナルキャノンタイムカウント
; var(58) - ＡＩコンボ用
; var(59) - ＡＩ


; fvar(0) - 攻撃力補正（ダメージ補正）
; fvar(1) - 
; fvar(2) - 空中復帰誘導

;----------------------------------------------------------
;ヘルパーvar使用表
; var(0)  - フェードアウト処理

;---------------------------------------------------------------------------
; 基本行動のステート
;---------------------------------------------------------------------------
; タイムオーバー時
[Statedef 170]
type = S
ctrl = 0
anim = 170
velset = 0,0
sprpriority = 2

[State 170, NotHitBy]
type = NotHitBy
trigger1 = 1 
value = SCA
time = 1

[State 170, PosSet]
type = PosSet
trigger1 = Time = 0
y = 0

;---------------------------------------------------------------------------
; 勝利ポーズ分岐
[Statedef 180]
type = S
ctrl = 0
anim = 0
velset = 0,0

[State 180, PosSet]
type = PosSet
trigger1 = Time = 0
y = 0

[State 180,1]
type = ChangeState
trigger1 = time = 0
value = ifelse((random <= 600),181,182)

;---------------------------------------------------------------------------
; 勝利ポーズ
;クルクルクルクル、カチャ
[Statedef 181]
type = S
movetype = I
physics = S
ctrl = 0
velset = 0,0
sprpriority = 2

[State 1121, 1]
type = ChangeAnim
trigger1 = Time = 0
value =  181

[State 181, 1]
type = AssertSpecial
trigger1 = Time = [0,100]
flag = RoundNotOver

[State 170, PosSet]
type = PosSet
trigger1 = Time = 0
y = 0

[State 202, 0]
type = PlaySnd
trigger1 = AnimElem = 7
value = 10,11
volume = 255

[State 202, 0]
type = PlaySnd
trigger1 = AnimElem = 18
value = 10,9
volume = 255

;---------------------------------------------------------------------------
; 勝利ポーズ２
;ハンッ！
[Statedef 182]
type = S
movetype = I
physics = S
ctrl = 0
velset = 0,0
sprpriority = 2

[State 1121, 1]
type = ChangeAnim
trigger1 = Time = 0
value =  182

[State 181, 1]
type = AssertSpecial
trigger1 = Time = [0,100]
flag = RoundNotOver

[State 170, PosSet]
type = PosSet
trigger1 = Time = 0
y = 0

[State 202, 0]
type = PlaySnd
trigger1 = AnimElem = 4
value = 3,4
volume = 255

[State 202, 0]
type = PlaySnd
trigger1 = AnimElem = 4
value = 10,10
volume = 255

[State 200, ice]
type = Explod
trigger1 = AnimElem = 4,= 0
anim = 183
ID = 183
postype = p1
pos = 38,-90
bindtime = 1
sprpriority = 3
ownpal = 1
removeongethit = 0
removetime = -2
ignorehitpause = 1

;---------------------------------------------------------------------------
; イントロ分岐

;イントロ選択
[Statedef 190]
type = S
ctrl = 0
anim = 0
velset = 0,0

[State 190, 1]
type = ChangeState
triggerall = Time = 0
trigger1 = (P2Name = "K'XI" || P4Name = "K'XI" )
trigger1 = EnemyNear,AuthorName = "beppu"
value = 193

[State 190, 1]
type = ChangeState
trigger1 = Time = 0
value = 191+(random%2)

;---------------------------------------------------------------------------
; イントロ　行くぜ、相棒。
[Statedef 191]
type = S
ctrl = 0
anim = 191
velset = 0,0

[State 191, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = Intro

[State 202, 0]
type = PlaySnd
trigger1 = AnimElem = 2
value = 3,5
volume = 255
channel = 3

[State 202, 0]
type = PlaySnd
trigger1 = AnimElem = 8
value = 10,9
volume = 255

[State 193, 8]
type = ChangeState
trigger1 = AnimTime = 0
value = 0

;---------------------------------------------------------------------------
; イントロ　手を合わせる
[Statedef 192]
type = S
ctrl = 0
anim = 192
velset = 0,0

[State 1000, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = Intro

[State 1000, ChangeState]
type = ChangeState
trigger1 = AnimTime = 0
value = 0

;---------------------------------------------------------------------------
; イントロ　Ｋ’専用
[Statedef 193]
type = S
ctrl = 0
anim = 193
velset = 0,0

[State 191, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = Intro

[State 193, 8]
type = ChangeState
trigger1 = AnimTime = 0
value = 0

;---------------------------------------------------------------------------
; 挑発
[Statedef 195]
type     = S
movetype = I
physics  = S
anim     = 195
velset   = 0,0
ctrl     = 0
sprpriority = 2
facep2 = 1

[State 195, PosSet]
type = PosSet
trigger1 = Time = 0
y = 0

[State 195, 1]
type = PlaySnd
trigger1 = AnimElem = 3
value = 3,2
channel = 2
volume = 255

[State 195, 2]
type = CtrlSet
trigger1 = time = 30
value = 1

[State 195, end]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Jump Start
[Statedef 40]
type    = S
physics = S
anim = 40
ctrl = 0
sprpriority = 1

[State 40, 1]
type = VarSet
trigger1 = Time = 0
sysvar(1) = 0

[State 40, 2]
type = VarSet
triggerall = !var(59)
triggerall = Time = 0
trigger1 = command = "holdfwd"
trigger2 = PrevStateNo = 100
sysvar(1) = 1

[State 40, 3]
type = VarSet
triggerall = !var(59)
triggerall = Time = 0
trigger1 = command = "holdback"
sysvar(1) = -1

[State 40, 1]
type = VarSet
triggerall = var(59)
triggerall = PrevStateNo != 100
trigger1 = Random = [0,60]
sysvar(1) = 0

[State 40, 2]
type = VarSet
triggerall = var(59)
trigger1 = Random = [61,900]
trigger2 = PrevStateNo = 100
sysvar(1) = 1

[State 40, 3]
type = VarSet
triggerall = var(59)
triggerall = PrevStateNo != 100
trigger1 = Random = [901,999]
sysvar(1) = -1

[State 40, 4];大ジャンプ判定
type = VarSet
trigger1 = Time = 0
var(0) = 0

[State 40, 4];小,中ジャンプ判定
type = VarSet
trigger1 = Time = 0
var(1) = 0

[State 40, 7]
type = VarSet
triggerall = Time = 0
triggerall = !var(59)
;triggerall = Command = "holdfwd"
trigger1 = Command = "longjump"
trigger2 = PrevStateNo = 100 ;ダッシュ
trigger3 = Prevstateno = [10,12]
var(0) = 1

[State 40, 8]
type = VarSet
triggerall = Time = 0
triggerall = !var(59)
triggerall = Command = "holdback"
trigger1 = Command = "longjump"
trigger2 = Prevstateno = [10,12]
var(0) = -1

[State 40, 7]
type = VarSet
triggerall = Time = 0
triggerall = var(59)
trigger1 = PrevStateNo = 100
trigger2 = Random <= 450
var(0) = 1

[State 40, 8]
type = VarSet
triggerall = Time = 0
triggerall = var(59)
trigger1 = Random = [451,800]
var(0) = -1

[State 40, 10];小,中ジャンプ判定
type = VarSet
;triggerall = AnimTime = 0
trigger1 = Command != "holdup"
var(1) = 1

[State 40, 8]
type = VarSet
triggerall = Time = 0
triggerall = var(59)
trigger1 = Random = [0,200]
var(1) = 1

[State 40, normｌ];ノーマルジャンプ判定x
type = VelSet
triggerall = AnimTime = 0
trigger1 = !var(0)
trigger1 = !var(1)
x = ifelse(sysvar(1) = 0, Const(velocity.jump.neu.x), ifelse(sysvar(1)=1, const(velocity.jump.fwd.x), const(velocity.jump.back.x)))

[State 40, ];大ジャンプ判定x
type = VelSet
triggerall = AnimTime = 0
trigger1 = var(0)
trigger1 = !var(1)
x =  ifelse(sysvar(1) = 0, Const(velocity.jump.neu.x), ifelse(sysvar(1)=1, const(velocity.runjump.fwd.x), const(velocity.runjump.back.x)))

[State 40, 4];中ジャンプ判定x
type = VelSet
triggerall = AnimTime = 0 
trigger1 = var(0)
trigger1 = var(1)
x =  ifelse(sysvar(1) = 0, Const(velocity.jump.neu.x), ifelse(sysvar(1)=1, const(velocity.runjump.fwd.x)*.92, const(velocity.runjump.back.x)*.92))

[State 40, 4];小ジャンプ判定x
type = VelSet
triggerall = AnimTime = 0
trigger1 = !var(0)
trigger1 = var(1)
x = ifelse(sysvar(1) = 0, Const(velocity.jump.neu.x), ifelse(sysvar(1)=1, const(velocity.runjump.fwd.x)*.62, const(velocity.runjump.back.x)*.62))


[State 40, 4];ジャンプ判定y
type = VelSet
triggerall = AnimTime = 0
trigger1 = !var(0)
trigger1 = !var(1)    ;ノーマルジャンプ
trigger2 = var(0)
trigger2 = !var(1)   ;大ジャンプ
y = const(velocity.jump.y)

[State 40, 4];ジャンプ判定y
type = VelSet
triggerall = AnimTime = 0
trigger1 = var(0)
trigger1 = var(1)    ;中ジャンプ
trigger2 = !var(0)
trigger2 = var(1)    ;小ジャンプ
y = const(velocity.jump.y)*.75

[State 40, 6]
type = ChangeState
trigger1 = AnimTime = 0
value = 50
ctrl = 1

;---------------------------------------------------------------------------
; Jump Up
[Statedef 50]
type    = A
physics = A

[State 50, 1]
type = VarSet
trigger1 = Time = 0
sysvar(1) = 0

[State -3, 2];小ジャンプ音
type = PlaySnd
triggerall = time = 0
trigger1 = !var(0)
trigger1 = var(1)
trigger2 = vel x = 0
trigger2 = var(0)
trigger2 = var(1)
value = 40, 1

[State -3, 2];ノーマルジャンプ音
type = PlaySnd
triggerall = time = 0
trigger1 = !var(0)
trigger1 = !var(1)
value = 40, 2

[State -3, 2];中、大ジャンプ音
type = PlaySnd
triggerall = time = 0
trigger1 = var(0)
trigger1 = !var(1)
trigger2 = var(0)
trigger2 = var(1)
value = 40, 3

[State 50, 3]
type = Afterimage
triggerall = Time = 1
trigger1 = var(0)
trigger1 = !var(1)
trigger2 = var(0)
trigger2 = var(1)
time = 35
PalBright = 0,0,0
PalContrast = 130,130,130
PalAdd = 0,0,0
PalMul = 1,1,1
Length = 4
FrameGap = 1
timegap = 6
trans = add1


[State 50, 2]
type = ChangeAnim
trigger1 = Time = 0
trigger1 = !var(1)
value = ifelse((vel x)=0, 41, ifelse((vel x)>0, 42, 43))

[State 50, 2]
type = ChangeAnim
trigger1 = Time = 0
trigger1 = var(1) = 1
value = 50

[State 201, 15] ;Short
type = null;Changestate
;trigger1 = !var(1)
trigger1 = vel y > 0 && pos y >= 0
value = 52
ctrl = 0

[State 201, 15] ;Short
type = null;Changestate
trigger1 = var(1)
trigger1 = vel y > 0 && pos y >= -11
value = 52
ctrl = 0

;---------------------------------------------------------------------------
; Jump Down (empty state for compatibility)
[Statedef 51]
type    = A
physics = A

[State 51, 1]
type = Null
trigger1 = 1

;---------------------------------------------------------------------------
; Jump Land
[Statedef 52]
type    = S
physics = S
anim = 47
ctrl = 0
velset = 0,0
facep2 = 1

;[State 52, 2]
;type = Ctrlset
;trigger1 = Time = 2
;value = 1

[State 52, 1]
type = VelSet
trigger1 = Time = 0
y = 0

[State 52, 2]
type = PosSet
trigger1 = Time = 0
y = 0

[State 201, 4]
type = Afterimage
trigger1 = Time = 1
time = 0

[State 52, 4]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;------------------------------------------------------------------------------
