;=====================================================================
;  CNS File For "Refuse Hinako Shijo"                Made By OG子 OGヲ
;                                       Ver. 1.0            2007/10/01
;=====================================================================

;=====================================================================
; Stuff to do
;=====================================================================

[Statedef -2]

[State -2, Debug]
type		= Null;AppendToClipboard
triggerall	= !IsHelper
trigger1	= 1
text		= "%f  %f\n"
params		= P2BodyDist X, P2BodyDist Y
ignorehitpause	= 1

;---------------------------------------------------------------------
; Helper Init
;---------------------------------------------------------------------
[State -2, Helper]
type				= Helper
triggerall			= !IsHelper
triggerall			= TeamSide = 1
triggerall			= NumHelper(40000) <= 0
trigger1			= !NumPartner
trigger2			= ID <= Partner,ID
helpertype			= player
name				= "Hinako's P1 GamePause Helper"
ID					= 40000
pos					= 0, 0
postype				= p1
facing				= 1
stateno				= 5150
keyctrl				= 1
ownpal				= 1
supermovetime		= 9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
pausemovetime		= 9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
ignorehitpause		= 1

[State -2, Helper]
type				= Helper
triggerall			= !IsHelper
triggerall			= TeamSide = 1
triggerall			= NumHelper(20000) <= 0
trigger1			= !NumPartner
trigger2			= ID <= Partner,ID
helpertype			= player
name				= "Hinako's P1 Always Helper"
ID					= 20000
pos					= 0, 0
postype				= p1
facing				= 1
stateno				= 5150
keyctrl				= 1
ownpal				= 1
supermovetime		= 9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
pausemovetime		= 9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
ignorehitpause		= 1

[State -2, Helper]
type				= Helper
triggerall			= !IsHelper
triggerall			= TeamSide = 1
triggerall			= NumHelper(60000) <= 0
trigger1			= !NumPartner
trigger2			= ID <= Partner,ID
helpertype			= player
name				= "Hinako's P1 Attack Helper"
ID					= 60000
pos					= 0, 0
postype				= p1
facing				= 1
stateno				= 5150
keyctrl				= 1
ownpal				= 1
supermovetime		= 9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
pausemovetime		= 9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
ignorehitpause		= 1

[State -2, Helper]
type				= Helper
triggerall			= !IsHelper
triggerall			= TeamSide = 1
triggerall			= NumHelper(30000) <= 0
trigger1			= !NumPartner
trigger2			= ID <= Partner,ID
helpertype			= player
name				= "Hinako's P1 Koutai Manage Helper"
ID					= 30000
pos					= 0, 0
postype				= p1
facing				= 1
stateno				= 5150
keyctrl				= 1
ownpal				= 1
supermovetime		= 9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
pausemovetime		= 9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
ignorehitpause		= 1

[State -2, Helper]
type				= Helper
triggerall			= !IsHelper
triggerall			= TeamSide = 1
triggerall			= NumHelper(50000) <= 0
trigger1			= !NumPartner
trigger2			= ID <= Partner,ID
helpertype			= player
name				= "Hinako's P1 SuperPause Manage Helper"
ID					= 50000
pos					= 0, 0
postype				= p1
facing				= 1
stateno				= 5150
keyctrl				= 1
ownpal				= 1
supermovetime		= 9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
pausemovetime		= 9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
ignorehitpause		= 1

[State -2, Helper]
type				= Helper
triggerall			= !IsHelper
triggerall			= TeamSide != 1
triggerall			= NumHelper(40000) <= 0
trigger1			= !NumPartner
trigger2			= ID <= Partner,ID
helpertype			= player
name				= "Hinako's P2 GamePause Helper"
ID					= 40000
pos					= 0, 0
postype				= p1
facing				= 1
stateno				= 5150
keyctrl				= 1
ownpal				= 1
supermovetime		= 9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
pausemovetime		= 9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
ignorehitpause		= 1

[State -2, Helper]
type				= Helper
triggerall			= !IsHelper
triggerall			= TeamSide != 1
triggerall			= NumHelper(20000) <= 0
trigger1			= !NumPartner
trigger2			= ID <= Partner,ID
helpertype			= player
name				= "Hinako's P2 Always Helper"
ID					= 20000
pos					= 0, 0
postype				= p1
facing				= 1
stateno				= 5150
keyctrl				= 1
ownpal				= 1
supermovetime		= 9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
pausemovetime		= 9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
ignorehitpause		= 1

[State -2, Helper]
type				= Helper
triggerall			= !IsHelper
triggerall			= TeamSide != 1
triggerall			= NumHelper(60000) <= 0
trigger1			= !NumPartner
trigger2			= ID <= Partner,ID
helpertype			= player
name				= "Hinako's P2 Attack Helper"
ID					= 60000
pos					= 0, 0
postype				= p1
facing				= 1
stateno				= 5150
keyctrl				= 1
ownpal				= 1
supermovetime		= 9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
pausemovetime		= 9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
ignorehitpause		= 1

[State -2, Helper]
type				= Helper
triggerall			= !IsHelper
triggerall			= TeamSide != 1
triggerall			= NumHelper(30000) <= 0
trigger1			= !NumPartner
trigger2			= ID <= Partner,ID
helpertype			= player
name				= "Hinako's P2 Koutai Manage Helper"
ID					= 30000
pos					= 0, 0
postype				= p1
facing				= 1
stateno				= 5150
keyctrl				= 1
ownpal				= 1
supermovetime		= 9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
pausemovetime		= 9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
ignorehitpause		= 1

[State -2, Helper]
type				= Helper
triggerall			= !IsHelper
triggerall			= TeamSide != 1
triggerall			= NumHelper(50000) <= 0
trigger1			= !NumPartner
trigger2			= ID <= Partner,ID
helpertype			= player
name				= "Hinako's P2 SuperPause Manage Helper"
ID					= 50000
pos					= 0, 0
postype				= p1
facing				= 1
stateno				= 5150
keyctrl				= 1
ownpal				= 1
supermovetime		= 9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
pausemovetime		= 9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
ignorehitpause		= 1

[State -2, Helper]
type				= Helper
triggerall			= !IsHelper
triggerall			= TeamSide = 1
triggerall			= NumHelper(40000) <= 0
triggerall			= NumPartner
trigger1			= ID > Partner,ID
helpertype			= player
name				= "Hinako's P3 GamePause Helper"
ID					= 40000
pos					= 0, 0
postype				= p1
facing				= 1
stateno				= 5150
keyctrl				= 1
ownpal				= 1
supermovetime		= 9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
pausemovetime		= 9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
ignorehitpause		= 1

[State -2, Helper]
type				= Helper
triggerall			= !IsHelper
triggerall			= TeamSide = 1
triggerall			= NumHelper(20000) <= 0
triggerall			= NumPartner
trigger1			= ID > Partner,ID
helpertype			= player
name				= "Hinako's P3 Always Helper"
ID					= 20000
pos					= 0, 0
postype				= p1
facing				= 1
stateno				= 5150
keyctrl				= 1
ownpal				= 1
supermovetime		= 9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
pausemovetime		= 9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
ignorehitpause		= 1

[State -2, Helper]
type				= Helper
triggerall			= !IsHelper
triggerall			= TeamSide = 1
triggerall			= NumHelper(60000) <= 0
trigger1			= !NumPartner
trigger2			= ID > Partner,ID
helpertype			= player
name				= "Hinako's P3 Attack Helper"
ID					= 60000
pos					= 0, 0
postype				= p1
facing				= 1
stateno				= 5150
keyctrl				= 1
ownpal				= 1
supermovetime		= 9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
pausemovetime		= 9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
ignorehitpause		= 1

[State -2, Helper]
type				= Helper
triggerall			= !IsHelper
triggerall			= TeamSide = 1
triggerall			= NumHelper(30000) <= 0
triggerall			= NumPartner
trigger1			= ID > Partner,ID
helpertype			= player
name				= "Hinako's P3 Koutai Manage Helper"
ID					= 30000
pos					= 0, 0
postype				= p1
facing				= 1
stateno				= 5150
keyctrl				= 1
ownpal				= 1
supermovetime		= 9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
pausemovetime		= 9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
ignorehitpause		= 1

[State -2, Helper]
type				= Helper
triggerall			= !IsHelper
triggerall			= TeamSide = 1
triggerall			= NumHelper(50000) <= 0
triggerall			= NumPartner
trigger1			= ID > Partner,ID
helpertype			= player
name				= "Hinako's P3 SuperPause Manage Helper"
ID					= 50000
pos					= 0, 0
postype				= p1
facing				= 1
stateno				= 5150
keyctrl				= 1
ownpal				= 1
supermovetime		= 9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
pausemovetime		= 9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
ignorehitpause		= 1

[State -2, Helper]
type				= Helper
triggerall			= !IsHelper
triggerall			= TeamSide != 1
triggerall			= NumHelper(40000) <= 0
triggerall			= NumPartner
trigger1			= ID > Partner,ID
helpertype			= player
name				= "Hinako's P4 GamePause Helper"
ID					= 40000
pos					= 0, 0
postype				= p1
facing				= 1
stateno				= 5150
keyctrl				= 1
ownpal				= 1
supermovetime		= 9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
pausemovetime		= 9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
ignorehitpause		= 1

[State -2, Helper]
type				= Helper
triggerall			= !IsHelper
triggerall			= TeamSide != 1
triggerall			= NumHelper(20000) <= 0
triggerall			= NumPartner
trigger1			= ID > Partner,ID
helpertype			= player
name				= "Hinako's P4 Always Helper"
ID					= 20000
pos					= 0, 0
postype				= p1
facing				= 1
stateno				= 5150
keyctrl				= 1
ownpal				= 1
supermovetime		= 9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
pausemovetime		= 9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
ignorehitpause		= 1

[State -2, Helper]
type				= Helper
triggerall			= !IsHelper
triggerall			= TeamSide != 1
triggerall			= NumHelper(60000) <= 0
trigger1			= !NumPartner
trigger2			= ID > Partner,ID
helpertype			= player
name				= "Hinako's P1 Attack Helper"
ID					= 60000
pos					= 0, 0
postype				= p1
facing				= 1
stateno				= 5150
keyctrl				= 1
ownpal				= 1
supermovetime		= 9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
pausemovetime		= 9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
ignorehitpause		= 1

[State -2, Helper]
type				= Helper
triggerall			= !IsHelper
triggerall			= TeamSide != 1
triggerall			= NumHelper(30000) <= 0
triggerall			= NumPartner
trigger1			= ID > Partner,ID
helpertype			= player
name				= "Hinako's P4 Koutai Manage Helper"
ID					= 30000
pos					= 0, 0
postype				= p1
facing				= 1
stateno				= 5150
keyctrl				= 1
ownpal				= 1
supermovetime		= 9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
pausemovetime		= 9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
ignorehitpause		= 1

[State -2, Helper]
type				= Helper
triggerall			= !IsHelper
triggerall			= TeamSide != 1
triggerall			= NumHelper(50000) <= 0
triggerall			= NumPartner
trigger1			= ID > Partner,ID
helpertype			= player
name				= "Hinako's P4 SuperPause Manage Helper"
ID					= 50000
pos					= 0, 0
postype				= p1
facing				= 1
stateno				= 5150
keyctrl				= 1
ownpal				= 1
supermovetime		= 9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
pausemovetime		= 9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
ignorehitpause		= 1

;---------------------------------------------------------------------
; ラウンド開始時の初期化状態か
;---------------------------------------------------------------------
[State -2, Is Init]
type		= VarSet
trigger1	= !IsHelper
trigger2	= IsHelper(60000)
var(50)		= 0
ignorehitpause	= 1

[State -2, Is Init]
type		= VarSet
triggerall	= !IsHelper
triggerall	= RoundState = 0
trigger1	= (StateNo = [180, 189])
trigger2	= (StateNo = 5500)
trigger3	= (StateNo = 5900)
var(50)		= 1
ignorehitpause	= 1

[State -2, Is Init]
type		= VarSet
triggerall	= IsHelper(60000)
triggerall	= RoundState = 0
trigger1	= (Root,StateNo = [180, 189])
trigger2	= (Root,StateNo = 5500)
trigger3	= (Root,StateNo = 5900)
var(50)		= 1
ignorehitpause	= 1

;---------------------------------------------------------------------
; check
;---------------------------------------------------------------------
;------------------- キー
[State -2, Key]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) <= 0
triggerall	= !Var(50)
trigger1	= 1
var(59)		= 1
ignorehitpause	= 1

;------------------- 各種ビットフラグ
[State -2, Bit]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= (Var(1) & (Var(59) * 268435456)) != (Var(59) * 268435456)
var(59)		= 1
ignorehitpause	= 1

;------------------- 汎用ステートタイマー
[State -2, State Timer]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= Var(4) - Var(59) < 0
var(59)		= 1
ignorehitpause	= 1

;------------------- 保持HP
[State -2, Life Buf]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= (Var(6) & (Var(59) * 268435456)) != (Var(59) * 268435456)
var(59)		= 1
ignorehitpause	= 1

;------------------- 総合ヒット数カウンタ
[State -2, Combo Count]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= (Var(7) & (Var(59) * 268435456)) != (Var(59) * 268435456)
var(59)		= 1
ignorehitpause	= 1

;------------------- 最大HP
[State -2, MaxLife]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= (Var(12) & (Var(59) * 268435456)) != (Var(59) * 268435456)
var(59)		= 1
ignorehitpause	= 1

[State -2, MaxLife Buf]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= (Var(13) & (Var(59) * 268435456)) != (Var(59) * 268435456)
var(59)		= 1
ignorehitpause	= 1

;------------------- 被連続技用総ダメージ
[State -2, Enemy Total Combo Damage]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= Var(14) - Var(59) < 0
var(59)		= 1
ignorehitpause	= 1

;------------------- 盾
[State -2, Shield]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= Var(15) - Var(59) < 0
var(59)		= 1
ignorehitpause	= 1

;------------------- 各種ビットフラグ2
[State -2, Bit2]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= (Var(16) & Var(59)) != Var(59)
var(59)		= 1
ignorehitpause	= 1

;------------------- 真の保持HP
[State -2, Life Buf2]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= (Var(17) & (Var(59) * 268435456)) != (Var(59) * 268435456)
var(59)		= 1
ignorehitpause	= 1

;------------------- 各種ビットフラグ3
[State -2, Bit3]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= (Var(18) & Var(59)) != Var(59)
var(59)		= 1
ignorehitpause	= 1

;------------------- 各種ビットフラグ4
[State -2, Bit4]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= (Var(19) & (Var(59) * 268435456)) != (Var(59) * 268435456)
var(59)		= 1
ignorehitpause	= 1

;------------------- 被連続技用総ダメージ(パワーゲージ)
[State -2, Enemy Total Combo Damage Power]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= Var(21) - Var(59) < 0
var(59)		= 1
ignorehitpause	= 1

;------------------- ユーザーコンフィグ
[State -2, User Config]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= (Var(22) & Var(59)) != Var(59)
var(59)		= 1
ignorehitpause	= 1

;------------------- 保持パワーゲージ
[State -2, Power Buf]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= (Var(23) - Var(59)) < 0
var(59)		= 1
ignorehitpause	= 1

;------------------- ゲームタイマー
[State -2, GameTime]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= (Var(24) - Var(59)) < 0
var(59)		= 1
ignorehitpause	= 1

;------------------- AIコマンド入力補完用ビットフラグ
[State -2, AI Command Bit]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= (Var(25) & (Var(59) * 268435456)) != (Var(59) * 268435456)
var(59)		= 1
ignorehitpause	= 1

;------------------- キャンセル可能状態
[State -2, Cancel Enable]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= (Var(28) & Var(59)) != Var(59)
var(59)		= 1
ignorehitpause	= 1

;------------------- ターゲットのID
[State -2, TargetID]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= (Var(30) - Var(59)) < 0
var(59)		= 1
ignorehitpause	= 1

;------------------- 各種ビットフラグ5
[State -2, Bit5]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= (Var(32) & (Var(59) * 268435456)) != (Var(59) * 268435456)
var(59)		= 1
ignorehitpause	= 1

;------------------- AIコマンド入力補完用ビットフラグ2
[State -2, AI Command Bit2]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= (Var(34) & Var(59)) != Var(59)
var(59)		= 1
ignorehitpause	= 1

;---------------------------------------------------------------------
; conversion
;---------------------------------------------------------------------
;------------------- 汎用ステートタイマー
[State -2, State Timer]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= 1
var(4)		= (Var(4) - Var(59))
ignorehitpause	= 1

;------------------- 保持HP
[State -2, Life Buf]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= 1
var(6)		= (Var(6) | (Var(59) * 268435456)) - (Var(59) * 268435456)
ignorehitpause	= 1

;------------------- 最大HP
[State -2, MaxLife]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= 1
var(12)		= (Var(12) | (Var(59) * 268435456)) - (Var(59) * 268435456)
ignorehitpause	= 1

[State -2, MaxLife Buf]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= 1
var(13)		= (Var(13) | (Var(59) * 268435456)) - (Var(59) * 268435456)
ignorehitpause	= 1

;------------------- 被連続技用総ダメージ
[State -2, Enemy Total Combo Damage]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= 1
var(14)		= (Var(14) - Var(59))
ignorehitpause	= 1

;------------------- 盾
[State -2, Shield]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= 1
var(15)		= (Var(15) - Var(59))
ignorehitpause	= 1

;------------------- 真の保持HP
[State -2, Life Buf2]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= 1
var(17)		= (Var(17) | (Var(59) * 268435456)) - (Var(59) * 268435456)
ignorehitpause	= 1

;------------------- 被連続技用総ダメージ(パワーゲージ)
[State -2, Enemy Total Combo Damage Power]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= 1
var(21)		= (Var(21) - Var(59))
ignorehitpause	= 1

;------------------- 保持パワーゲージ
[State -2, Power Buf]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= 1
var(23)		= (Var(23) - Var(59))
ignorehitpause	= 1

;------------------- ゲームタイマー
[State -2, GameTime]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= 1
var(24)		= (Var(24) - Var(59))
ignorehitpause	= 1

;------------------- ターゲットのID
[State -2, TargetID]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= 1
var(30)		= (Var(30) - Var(59))
ignorehitpause	= 1

;------------------- Error
[State -2, Debug]
type		= Null;AppendToClipboard
triggerall	= !IsHelper
triggerall	= !Var(50)
trigger1	= Var(59) = 1
text		= "Error "
ignorehitpause	= 1

;---------------------------------------------------------------------
; ヘルパー初期化判定
;---------------------------------------------------------------------
[State -2, Helper Init Check]
type		= VarAdd
triggerall	= !IsHelper
triggerall	= !Var(50)
triggerall	= (Var(16) & 234881024) < 234881024
trigger1	= NumHelper(20000) <= 0
trigger2	= NumHelper(30000) <= 0
trigger3	= NumHelper(40000) <= 0
trigger4	= NumHelper(60000) <= 0
var(16)		= 234881024 / 7
ignorehitpause	= 1

[State -2, Helper Init Check]
type		= VarSet
triggerall	= !IsHelper
triggerall	= !Var(50)
trigger1	= NumHelper(20000) > 1
trigger2	= NumHelper(30000) > 1
trigger3	= NumHelper(40000) > 1
trigger4	= NumHelper(60000) > 1
var(16)		= (Var(16) | 234881024)
ignorehitpause	= 1

[State -2, Helper Init Check]
type		= VarSet
triggerall	= !IsHelper
triggerall	= !Var(50)
trigger1	= NumHelper(20000) = 1
trigger1	= NumHelper(30000) = 1
trigger1	= NumHelper(40000) = 1
trigger1	= NumHelper(60000) = 1
var(16)		= (Var(16) | 234881024) - 234881024
ignorehitpause	= 1

[State -2, Helper Init Check]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= (Var(16) & 234881024) >= (234881024 / 7 * 6)
var(59)		= 1
ignorehitpause	= 1

;---------------------------------------------------------------------
; 試合開始のCtrlフラグ
;---------------------------------------------------------------------
[State -2, Ctrl Buf]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= Ctrl
trigger2	= NumHelper(20000)
trigger2	= (Helper(20000),Var(18) & 8)
var(19)		= (Var(19) | 131072)
ignorehitpause	= 1

;---------------------------------------------------------------------
; キャラモード
;---------------------------------------------------------------------
[State -2, Char Mode Buf]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= NumHelper(20000)
triggerall	= Helper(20000),Var(0) = 20000
trigger1	= (Var(32) & 7) > Helper(20000),Var(23)
var(32)		= (Var(32) | 7) - 7 + Helper(20000),Var(23)
ignorehitpause	= 1

;---------------------------------------------------------------------
; AI専用フラグ
;---------------------------------------------------------------------
[State -2, AI Init Check Set]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= (Var(1) & 32)
var(19)		= (Var(19) | 512)
ignorehitpause	= 1

;---------------------------------------------------------------------
; ステートやアニメの履歴 保持 初期化
;---------------------------------------------------------------------
; 2F前の履歴を保存
[State -2, State Record]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
trigger1	= 1
var(35)		= Var(26)
ignorehitpause	= 1

; 1F前の履歴を保存
[State -2, State Ctrl Record]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
trigger1	= Ctrl
var(2)		= (Var(2) | 2097152)
ignorehitpause	= 1

[State -2, State Record]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
trigger1	= 1
var(26)		= Var(2)
ignorehitpause	= 1

[State -2, State Steal Record]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
trigger1	= 1
var(26)		= (Var(26) | 4194304) - 4194304 * !(Var(1) & 1024)
ignorehitpause	= 1

[State -2, State Not Steal Change Record]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
trigger1	= 1
var(26)		= (Var(26) | 33554432) - 33554432 * !(Var(18) & 1073741824)
ignorehitpause	= 1

[State -2, State Damage Record]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
trigger1	= 1
var(26)		= (Var(26) | 67108864) - 67108864
ignorehitpause	= 1

[State -2, State Damage Record]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
trigger1	= (Var(19) & 4096)
trigger2	= (Var(1) & 1024)
trigger3	= (Var(18) & 1073741824)
var(26)		= (Var(26) | 67108864)
ignorehitpause	= 1

; 
[State -2, State Change Record]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
trigger1	= 1
var(2)		= (Var(2) | 8388608) - 8388608
ignorehitpause	= 1

[State -2, Anim Record]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
trigger1	= 1
var(27)		= Var(3)
ignorehitpause	= 1

[State -2, MoveContact Record]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
trigger1	= 1
var(29)		= (Var(29) | 31) - 31 + IfElse( MoveContact < 31, MoveContact, 31 )
ignorehitpause	= 1

[State -2, MoveHit Record]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
trigger1	= 1
var(29)		= (Var(29) | 992) - 992 + (992 / 31) * IfElse( MoveHit < 31, MoveHit, 31 )
ignorehitpause	= 1

[State -2, MoveGuarded Record]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
trigger1	= 1
var(29)		= (Var(29) | 31744) - 31744 + (31744 / 31) * IfElse( MoveGuarded < 31, MoveGuarded, 31 )
ignorehitpause	= 1

[State -2, MoveReversed Record]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
trigger1	= 1
var(29)		= (Var(29) | 1015808) - 1015808 + (1015808 / 31) * IfElse( MoveReversed < 31, MoveReversed, 31 )
ignorehitpause	= 1

;---------------------------------------------------------------------
; ゲームタイマー
;---------------------------------------------------------------------
[State -2, GameTime]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= 1
var(24)		= GameTime
ignorehitpause	= 1

;---------------------------------------------------------------------
; MoveType=H で来て、そのまま過ごすか
;---------------------------------------------------------------------
[State -2, State MoveType=H]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= 1
var(19)		= (Var(19) | 4096) - 4096*!(MoveType = H)
ignorehitpause	= 1

;---------------------------------------------------------------------
; ステート奪取判定
;---------------------------------------------------------------------
;------------------- 今ステート奪取されてないか(AI用)をリセット
[State -2, State Not Steal Reset for AI]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= 1
var(1)		= (Var(1) | 134217728) - 134217728
ignorehitpause	= 1

;------------------- ステート奪取判定リセット
[State -2, State Steal Check]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= 1
var(1)		= (Var(1) | 1024) - 1024
ignorehitpause	= 1

[State -2, State Steal Check]
type		= VarSet
triggerall	= IsHelper
trigger1	= 1
var(1)		= (Var(1) | 1024) - 1024
ignorehitpause	= 1

;------------------- ステート奪取判定更新(通常ステート奪取)
[State -2, State Steal Check]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= !(Var(1) & 2048)
var(1)		= (Var(1) | 1024)
ignorehitpause	= 1

[State -2, State Steal Check]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= 1
var(1)		= (Var(1) | 2048) - 2048
ignorehitpause	= 1

[State -2, State Steal Check]
type		= VarSet
triggerall	= IsHelper
trigger1	= !(Var(1) & 2048)
var(1)		= (Var(1) | 1024)
ignorehitpause	= 1

[State -2, State Steal Check]
type		= VarSet
triggerall	= IsHelper
trigger1	= 1
var(1)		= (Var(1) | 2048) - 2048
ignorehitpause	= 1

;------------------- ステート奪取状態を保持
[State -2, State Steal Record]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= 1
var(2)		= (Var(2) | 4194304) - 4194304 * !(Var(1) & 1024)
ignorehitpause	= 1

;------------------- ステート奪取カウンタ
[State -2, State Steal Count Reset]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= !(Var(1) & 1024)
var(18)		= (Var(18) | 8387584) - 8387584
ignorehitpause	= 1

[State -2, State Steal Count]
type		= VarAdd
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= (Var(1) & 1024)
trigger1	= (Var(18) & 8387584) <= (8387584 / 8191 * 8190)
var(18)		= (8387584 / 8191)
ignorehitpause	= 1

;---------------------------------------------------------------------
; ステート奪取されないステート変更判定
;---------------------------------------------------------------------
[State -2, State Not Steal Reset]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= 1
var(18)		= (Var(18) | 1073741824) - 1073741824
ignorehitpause	= 1

[State -2, State Not Steal Check]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= StateNo != (Var(2) & 131071)
triggerall	= !(Var(1) & 1024) && MoveType != H
triggerall	= !(StateNo = 120 && (Var(1) & 33554432))
triggerall	= !(RoundState = 4 && (StateNo = 170 || StateNo = 175 || StateNo = 180))
triggerall	= !((Var(2) & 131071) = 611 && StateNo = 614)
triggerall	= !((Var(2) & 131071) = 1401 && StateNo = 1402)
triggerall	= !((Var(2) & 131071) = 1411 && StateNo = 1412)
triggerall	= !((Var(2) & 131071) = 1701 && StateNo = 1703)
trigger1	= MoveReversed
trigger2	= !NumHelper(20000)
trigger3	= !Ctrl && !(RoundState = 2 && !Ctrl && StateNo = 0 && (Helper(20000),Var(18) & 7) < 2)
trigger4	= !(StateNo = 0 || StateNo = 10 || StateNo = 12 || StateNo = 20 || StateNo = 40 || StateNo = 120)
var(18)		= (Var(18) | 1073741824)
ignorehitpause	= 1

[State -2, Debug]
type		= AppendToClipboard
triggerall	= !IsHelper
trigger1	= (Var(18) & 1073741824)
text		= "%d %d %d %d %d"
params		= GameTime, Ctrl, MoveReversed, StateNo, (Var(2) & 131071)
ignorehitpause	= 1

[State -2, Debug]
type		= AppendToClipboard
triggerall	= !IsHelper
triggerall	= NumHelper(20000)
trigger1	= (Var(18) & 1073741824)
text		= " %d %d"
params		= RoundState, (Helper(20000),Var(18) & 7)
ignorehitpause	= 1

[State -2, Debug]
type		= AppendToClipboard
triggerall	= !IsHelper
trigger1	= (Var(18) & 1073741824)
text		= "\n"
ignorehitpause	= 1

;------------------- ステート奪取しないステート変更状態を保持
[State -2, State Not Steal Change Record]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= 1
var(2)		= (Var(2) | 33554432) - 33554432 * !(Var(18) & 1073741824)
ignorehitpause	= 1

;---------------------------------------------------------------------
; 攻撃が相手に触れたか
;---------------------------------------------------------------------
[State -2, Hit Reset]
type		= VarSet
triggerall	= !IsHelper
trigger1	= 1
var(1)		= (Var(1) | 512) - 512
ignorehitpause	= 1

[State -2, Guard Reset]
type		= VarSet
triggerall	= !IsHelper
trigger1	= 1
var(1)		= (Var(1) | 2097152) - 2097152
ignorehitpause	= 1

;------------------- ヒット判定
[State -2, Hit Check]
type		= VarSet
triggerall	= !IsHelper
triggerall	= !Var(50)
triggerall	= MoveHit = 1
trigger1	= !(!(Var(1) & 1024) && (Var(2) & 131071) = 611)
trigger1	= !(!(Var(1) & 1024) && (Var(2) & 131071) = 701)
trigger1	= !(!(Var(1) & 1024) && (Var(2) & 131071) = 1102)
trigger1	= !(!(Var(1) & 1024) && (Var(2) & 131071) = 1152)
trigger1	= !(!(Var(1) & 1024) && (Var(2) & 131071) = 1401 && (0 <= AnimElemTime(2) && AnimElemTime(7) <= 0))
trigger1	= !(!(Var(1) & 1024) && (Var(2) & 131071) = 1411 && (0 <= AnimElemTime(2) && AnimElemTime(8) <= 0))
trigger1	= !(!(Var(1) & 1024) && (Var(2) & 131071) = 1411 && (0 <= AnimElemTime(18) && AnimElemTime(21) <= 0))
trigger1	= !(!(Var(1) & 1024) && (Var(2) & 131071) = 1701 && !(1 <= AnimElemTime(16) && AnimElemTime(21) <= 0))
trigger1	= !(!(Var(1) & 1024) && (Var(2) & 131071) = 1901)
trigger1	= !(!(Var(1) & 1024) && (Var(2) & 131071) = 1906)
trigger1	= !(!(Var(1) & 1024) && (Var(2) & 131071) = [4600, 4629])
var(1)		= (Var(1) | 512)
ignorehitpause	= 1

;------------------- ガード判定
[State -2, Guard Check]
type		= VarSet
triggerall	= !IsHelper
triggerall	= !Var(50)
triggerall	= MoveGuarded = 1
trigger1	= !(!(Var(1) & 1024) && (Var(2) & 131071) = 611)
trigger1	= !(!(Var(1) & 1024) && (Var(2) & 131071) = 701)
trigger1	= !(!(Var(1) & 1024) && (Var(2) & 131071) = 1102)
trigger1	= !(!(Var(1) & 1024) && (Var(2) & 131071) = 1152)
trigger1	= !(!(Var(1) & 1024) && (Var(2) & 131071) = 1401 && (0 <= AnimElemTime(2) && AnimElemTime(7) <= 0))
trigger1	= !(!(Var(1) & 1024) && (Var(2) & 131071) = 1411 && (0 <= AnimElemTime(2) && AnimElemTime(8) <= 0))
trigger1	= !(!(Var(1) & 1024) && (Var(2) & 131071) = 1411 && (0 <= AnimElemTime(18) && AnimElemTime(21) <= 0))
trigger1	= !(!(Var(1) & 1024) && (Var(2) & 131071) = 1701 && !(1 <= AnimElemTime(16) && AnimElemTime(21) <= 0))
trigger1	= !(!(Var(1) & 1024) && (Var(2) & 131071) = 1901)
trigger1	= !(!(Var(1) & 1024) && (Var(2) & 131071) = 1906)
trigger1	= !(!(Var(1) & 1024) && (Var(2) & 131071) = [4600, 4629])
var(1)		= (Var(1) | 2097152)
ignorehitpause	= 1

;------------------- ヒットストップ時間
; ヒットストップ時間に+1してるのは、後で減算カウンタが同フレーム内で実行されるため
[State -2, Hit Stop Time Set]
type		= VarSet
triggerall	= !IsHelper
triggerall	= !Var(50)
triggerall	= MoveContact = 1
triggerall	= !(Var(18) & 528482304)
trigger1	= ((Var(2) & 131071) = 201)
trigger2	= ((Var(2) & 131071) = 211)
trigger3	= ((Var(2) & 131071) = 221) && (0 < AnimElemTime(3))
trigger4	= ((Var(2) & 131071) = 226)
trigger5	= ((Var(2) & 131071) = 301)
trigger6	= ((Var(2) & 131071) = 311)
trigger7	= ((Var(2) & 131071) = 321)
trigger8	= ((Var(2) & 131071) = 331)
trigger9	= ((Var(2) & 131071) = 501)
trigger10	= ((Var(2) & 131071) = 511)
trigger11	= ((Var(2) & 131071) = 521) && (0 < AnimElemTime(3))
trigger12	= ((Var(2) & 131071) = 531) && (0 < AnimElemTime(3))
trigger13	= ((Var(2) & 131071) = 601)
trigger14	= ((Var(2) & 131071) = 606)
trigger15	= ((Var(2) & 131071) = 613)
trigger16	= ((Var(2) & 131071) = 621)
trigger17	= ((Var(2) & 131071) = 711)
trigger18	= ((Var(2) & 131071) = 741)
trigger19	= ((Var(2) & 131071) = 1001)
trigger20	= ((Var(2) & 131071) = 1104)
trigger21	= ((Var(2) & 131071) = 1401) && (0 <= AnimElemTime(21))
trigger22	= ((Var(2) & 131071) = 1406)
trigger23	= ((Var(2) & 131071) = 1411) && (0 <= AnimElemTime(35))
trigger24	= ((Var(2) & 131071) = 1416)
trigger25	= ((Var(2) & 131071) = 1651)
trigger26	= ((Var(2) & 131071) = 3011)
trigger27	= ((Var(2) & 131071) = 3111)
trigger28	= ((Var(2) & 131071) = 3401) && MoveGuarded
trigger29	= ((Var(2) & 131071) = 3411) && MoveGuarded
trigger30	= ((Var(2) & 131071) = 3416) && MoveGuarded
trigger31	= ((Var(2) & 131071) = 4302)
trigger32	= ((Var(2) & 131071) = 4352)
var(18)		= (Var(18) | 528482304) - 528482304 + 528482304 / 63 * (7 + 1)
ignorehitpause	= 1

[State -2, Hit Stop Time Set]
type		= VarSet
triggerall	= !IsHelper
triggerall	= !Var(50)
triggerall	= MoveContact = 1
triggerall	= !(Var(18) & 528482304)
trigger1	= ((Var(2) & 131071) = 221) && (AnimElemTime(3) <= 0)
trigger2	= ((Var(2) & 131071) = 231) && (AnimElemTime(3) <= 0)
trigger3	= ((Var(2) & 131071) = 1206)
trigger4	= ((Var(2) & 131071) = 1302)
trigger5	= ((Var(2) & 131071) = 1701) && (1 <= AnimElemTime(16) && AnimElemTime(21) <= 0)
trigger6	= ((Var(2) & 131071) = 3201)
trigger7	= ((Var(2) & 131071) = 3301)
trigger8	= ((Var(2) & 131071) = 3501) && MoveGuarded
trigger9	= ((Var(2) & 131071) = 3511) && MoveGuarded
trigger10	= ((Var(2) & 131071) = 3516) && MoveGuarded
var(18)		= (Var(18) | 528482304) - 528482304 + 528482304 / 63 * (1 + 1)
ignorehitpause	= 1

[State -2, Hit Stop Time Set]
type		= VarSet
triggerall	= !IsHelper
triggerall	= !Var(50)
triggerall	= MoveContact = 1
triggerall	= !(Var(18) & 528482304)
trigger1	= ((Var(2) & 131071) = 1631)
trigger2	= ((Var(2) & 131071) = 1641)
var(18)		= (Var(18) | 528482304) - 528482304 + 528482304 / 63 * (2 + 1)
ignorehitpause	= 1

[State -2, Hit Stop Time Set]
type		= VarSet
triggerall	= !IsHelper
triggerall	= !Var(50)
triggerall	= MoveContact = 1
triggerall	= !(Var(18) & 528482304)
trigger1	= ((Var(2) & 131071) = 231) && (0 < AnimElemTime(3))
trigger2	= ((Var(2) & 131071) = 703)
trigger3	= ((Var(2) & 131071) = 705)
trigger4	= ((Var(2) & 131071) = 707)
trigger5	= ((Var(2) & 131071) = 709)
trigger6	= ((Var(2) & 131071) = 721)
trigger7	= ((Var(2) & 131071) = 731)
trigger8	= ((Var(2) & 131071) = 781)
trigger9	= ((Var(2) & 131071) = 1401) && (1 <= AnimElemTime(7) && AnimElemTime(12) <= 0)
trigger10	= ((Var(2) & 131071) = 1411) && ((1 <= AnimElemTime(8) && AnimElemTime(11) <= 0) || (1 <= AnimElemTime(21) && AnimElemTime(26) <= 0))
trigger11	= ((Var(2) & 131071) = 1511)
trigger12	= ((Var(2) & 131071) = 1516)
trigger13	= ((Var(2) & 131071) = 1521)
var(18)		= (Var(18) | 528482304) - 528482304 + 528482304 / 63 * (4 + 1)
ignorehitpause	= 1

[State -2, Hit Stop Time Set]
type		= VarSet
triggerall	= !IsHelper
triggerall	= !Var(50)
triggerall	= MoveContact = 1
triggerall	= !(Var(18) & 528482304)
trigger1	= ((Var(2) & 131071) = 611)
trigger2	= ((Var(2) & 131071) = 701)
trigger3	= ((Var(2) & 131071) = 1401) && (AnimElemTime(7) <= 0)
trigger4	= ((Var(2) & 131071) = 1411) && ((1 <= AnimElemTime(2) && AnimElemTime(8) <= 0) || (1 <= AnimElemTime(18) && AnimElemTime(21) <= 0))
trigger5	= ((Var(2) & 131071) = 1701) && !(1 <= AnimElemTime(16) && AnimElemTime(21) <= 0)
var(18)		= (Var(18) | 528482304) - 528482304 + 528482304 / 63 * (4 + 1)
ignorehitpause	= 1

[State -2, Hit Stop Time Set]
type		= VarSet
triggerall	= !IsHelper
triggerall	= !Var(50)
triggerall	= MoveContact = 1
triggerall	= !(Var(18) & 528482304)
trigger1	= ((Var(2) & 131071) = 1102)
trigger2	= ((Var(2) & 131071) = 1152)
var(18)		= (Var(18) | 528482304) - 528482304 + 528482304 / 63 * (11 + 1)
ignorehitpause	= 1

[State -2, Hit Stop Time Reset]
type		= VarSet
triggerall	= !IsHelper
triggerall	= !Var(50)
trigger1	= HitPauseTime
trigger2	= MoveReversed = 1
var(18)		= (Var(18) | 528482304) - 528482304
ignorehitpause	= 1

[State -2, Hit Stop Time Buffer]
type		= VarSet
triggerall	= !IsHelper
triggerall	= !Var(50)
trigger1	= 1
var(0)		= (Var(18) & 528482304)
ignorehitpause	= 1

[State -2, Hit Stop Time Decrease Counter]
type		= VarAdd
triggerall	= !IsHelper
triggerall	= !Var(50)
trigger1	= (Var(18) & 528482304)
var(18)		= -528482304 / 63
ignorehitpause	= 1

[State -2, Hit Stop Time End Flag Reset]
type		= VarSet
triggerall	= !IsHelper
triggerall	= !Var(50)
trigger1	= 1
var(18)		= (Var(18) | -2147483648) - -2147483648
ignorehitpause	= 1

[State -2, Hit Stop Time End Flag Set]
type		= VarSet
triggerall	= !IsHelper
triggerall	= !Var(50)
triggerall	= !(Var(18) & 528482304)
trigger1	= Var(0)
trigger2	= MoveContact = 1
trigger3	= MoveReversed = 1
var(18)		= (Var(18) | -2147483648)
ignorehitpause	= 0

;------------------- 当身されたときはhitDefを消す
[State -2, HitDef Reset]
type		= HitDef
triggerall	= !IsHelper
trigger1	= MoveReversed
attr		=
hitflag		=
guardflag	=
guard.dist	= 0
ignorehitpause	= 1

;---------------------------------------------------------------------
; ターゲット番号生成
;---------------------------------------------------------------------
[State -2, VarSet]
type		= VarSet
triggerall	= !IsHelper
trigger1	= 1
var(31)		= -1
ignorehitpause	= 1

[State -2, VarSet]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(31) < 0
trigger1	= NumTarget((10 + ((Var(16) & 240)/16-0+16)%16))
var(31)		= (10 + ((Var(16) & 240)/16-0+16)%16)
ignorehitpause	= 1

[State -2, VarSet]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(31) < 0
trigger1	= NumTarget((10 + ((Var(16) & 240)/16-1+16)%16))
var(31)		= (10 + ((Var(16) & 240)/16-1+16)%16)
ignorehitpause	= 1

[State -2, VarSet]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(31) < 0
trigger1	= NumTarget((1 + ((Var(19) & 3)/1-0+4)%4))
var(31)		= (1 + ((Var(19) & 3)/1-0+4)%4)
ignorehitpause	= 1

[State -2, VarSet]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(31) < 0
trigger1	= NumTarget((1 + ((Var(19) & 3)/1-1+4)%4))
var(31)		= (1 + ((Var(19) & 3)/1-1+4)%4)
ignorehitpause	= 1

;---------------------------------------------------------------------
;  ダメージ状態か
;---------------------------------------------------------------------
[State -2, IsDamage Reset]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= 1
var(1)		= (Var(1) | 16384) - 16384
ignorehitpause	= 1

[State -2, IsDamage]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= (Var(1) & 1024)
trigger2	= (Var(18) & 1073741824)
trigger3	= MoveType = H	; 以下はHitOverrideでダメージ状態だと検出しない用
trigger3	= !((Var(2) & 131071) = 0 && StateNo = 1)
trigger3	= !((Var(2) & 131071) = 601 && StateNo = 602)
trigger3	= !((Var(2) & 131071) = 611 && StateNo = 614)
trigger3	= !((Var(2) & 131071) = 613 && StateNo = 615)
trigger3	= !((Var(2) & 131071) = 1511 && StateNo = 1512)
trigger3	= !((Var(2) & 131071) = 1516 && StateNo = 1517)
trigger3	= !((Var(2) & 131071) = 1521 && StateNo = 1522)
trigger3	= !((Var(2) & 131071) = 4601 && StateNo = 4604)
trigger3	= !((Var(2) & 131071) = 4611 && StateNo = 4614)
trigger3	= !((Var(2) & 131071) = 4621 && StateNo = 4624)
var(1)		= (Var(1) | 16384)
ignorehitpause	= 1

[State -2, Not IsDamage Set Activate]
type		= CtrlSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= !(Var(1) & 16384)
triggerall	= MoveType = H
trigger1	= ((Var(2) & 131071) = 0 && StateNo = 1)
value		= 1
ignorehitpause	= 1

[State -2, Not IsDamage Set Activate]
type		= StateTypeSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= !(Var(1) & 16384)
triggerall	= MoveType = H
trigger1	= ((Var(2) & 131071) = 0 && StateNo = 1)
movetype	= I
ignorehitpause	= 1

[State -2, Is First Direct Damage Reset]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= 1
var(1)		= (Var(1) | 8) - 8
ignorehitpause	= 1

[State -2, Is First Direct Damage Set]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= (MoveType = H && (Var(1) & 16384))
; 打撃やられ
trigger1	= !(Var(1) & 1024)
trigger1	= StateNo = 5000 || StateNo = 5010 || StateNo = 5020 || StateNo = 5070
trigger1	= Time = 0
; ガード
trigger2	= !(Var(1) & 1024)
trigger2	= StateNo = 150 || StateNo = 152 || StateNo = 154
trigger2	= Time = 0
; ステ奪取され中にダメージ有り
trigger3	= (Var(1) & 1024)
trigger3	= GetHitVar(damage)
; ステ奪取しないステ変更中にダメージ有り
trigger4	= (Var(18) & 1073741824)
trigger4	= GetHitVar(damage)
var(1)		= (Var(1) | 8)
ignorehitpause	= 1

;---------------------------------------------------------------------
; パレット
;---------------------------------------------------------------------
[State -2, PalFX Counter]
type		= VarAdd
triggerall	= !IsHelper
trigger1	= (Var(32) & 8126464)
var(32)		= -1 * 262144
ignorehitpause	= 1

[State -2, PalFX Counter]
type		= VarAdd
triggerall	= !IsHelper
trigger1	= (Var(32) & 260046848)
var(32)		= -1 * 8388608
ignorehitpause	= 1

;=====================================================================
; Input Command ずらし押し専用
;=====================================================================
[State -2 Input Command]	; C+D(ずらし押し)
type		= VarSet
triggerall	= !IsHelper
triggerall	= !(Var(1) & 32)
triggerall	= NumHelper(20000)
; /C + D
trigger1	= ((Var(8) & 48) = 48) && (Helper(20000),Command = "hold_b") && !(Var(25) & 32768)
; C + /D
trigger2	= (Helper(20000),Command = "hold_y") && !(Var(25) & 4096) && ((Var(8) & 192) = 192)
var(8)		= (Var(8) | 768)
ignorehitpause	= 1

[State -2 Input Command]	; A+B(ずらし押し)
type		= VarSet
triggerall	= !IsHelper
triggerall	= !(Var(1) & 32)
triggerall	= NumHelper(20000)
; /A + B
trigger1	= ((Var(8) & 3) = 3) && (Helper(20000),Command = "hold_a") && !(Var(25) & 16384)
; A + /B
trigger2	= (Helper(20000),Command = "hold_x") && !(Var(25) & 2048) && ((Var(8) & 12) = 12)
var(8)		= (Var(8) | 7168) - 7168 + 5*1024
ignorehitpause	= 1

[State -2 Input Command]	; MAX合掌ひねり(ずらし押し)
type		= VarSet
triggerall	= !IsHelper
triggerall	= !(Var(1) & 32)
triggerall	= NumHelper(20000)
; /B + D
trigger1	= ((Var(11) & 7) = 5*1) && (Helper(20000),Command = "hold_b") && (Helper(20000),Command = "hold_b") && !(Var(25) & 32768)
; B + /D
trigger2	= (Helper(20000),Command = "hold_a") && !(Var(25) & 16384) && ((Var(11) & 56) = 5*8)
var(11)		= (Var(11) | 448) - 448 + 5*64
ignorehitpause	= 1

[State -2 Input Command]	; MAX大一番(ずらし押し)
type		= VarSet
triggerall	= !IsHelper
triggerall	= !(Var(1) & 32)
triggerall	= NumHelper(20000)
; /A + C
trigger1	= ((Var(11) & 3584) = 5*512) && (Helper(20000),Command = "hold_y") && !(Var(25) & 4096)
; A + /C
trigger2	= (Helper(20000),Command = "hold_x") && !(Var(25) & 2048) && ((Var(11) & 28672) = 5*4096)
var(11)		= (Var(11) | 229376) - 229376 + 5*32768
ignorehitpause	= 1

[State -2 Input Command]	; MAX諸手突き(ずらし押し)
type		= VarSet
triggerall	= !IsHelper
triggerall	= !(Var(1) & 32)
triggerall	= NumHelper(20000)
; /A + C
trigger1	= ((Var(11) & 1835008) = 5*262144) && (Helper(20000),Command = "hold_y") && !(Var(25) & 4096)
; A + /C
trigger2	= (Helper(20000),Command = "hold_x") && !(Var(25) & 2048) && ((Var(11) & 14680064) = 5*2097152)
var(11)		= (Var(11) | 117440512) - 117440512 + 5*16777216
ignorehitpause	= 1

[State -2 Input Command]	; MAX我慢(ずらし押し)
type		= VarSet
triggerall	= !IsHelper
triggerall	= !(Var(1) & 32)
triggerall	= NumHelper(20000)
; /A + C
trigger1	= ((Var(10) & 28672) = 5*4096) && (Helper(20000),Command = "hold_y") && !(Var(25) & 4096)
; A + /C
trigger2	= (Helper(20000),Command = "hold_x") && !(Var(25) & 2048) && ((Var(10) & 229376) = 5*32768)
var(10)		= (Var(10) | 1835008) - 1835008 + 5*262144
ignorehitpause	= 1

;=====================================================================
; Command Record Decrease
;=====================================================================
[State -2, Command Record Decrease]	; A
type		= VarAdd
triggerall	= !IsHelper
triggerall	= (Var(8) & 3)
trigger1	= (Var(8) & 3) > 2*1
trigger2	= !HitPauseTime && !(Var(18) & 528482304)
var(8)		= -1
ignorehitpause	= 1

[State -2, Command Record Decrease]	; B
type		= VarAdd
triggerall	= !IsHelper
triggerall	= (Var(8) & 12)
trigger1	= (Var(8) & 12) > 2*4
trigger2	= !HitPauseTime && !(Var(18) & 528482304)
var(8)		= -4
ignorehitpause	= 1

[State -2, Command Record Decrease]	; C
type		= VarAdd
triggerall	= !IsHelper
triggerall	= (Var(8) & 48)
trigger1	= (Var(8) & 48) > 2*16
trigger2	= !HitPauseTime && !(Var(18) & 528482304)
var(8)		= -16
ignorehitpause	= 1

[State -2, Command Record Decrease]	; D
type		= VarAdd
triggerall	= !IsHelper
triggerall	= (Var(8) & 192)
trigger1	= (Var(8) & 192) > 2*64
trigger2	= !HitPauseTime && !(Var(18) & 528482304)
var(8)		= -64
ignorehitpause	= 1

[State -2, Command Record Decrease]	; C+D
type		= VarAdd
triggerall	= !IsHelper
triggerall	= (Var(8) & 768)
trigger1	= (Var(8) & 768) > 2*256
trigger2	= !HitPauseTime && !(Var(18) & 528482304)
var(8)		= -256
ignorehitpause	= 1

[State -2, Command Record Decrease]	; A+B
type		= VarAdd
triggerall	= !IsHelper
triggerall	= (Var(8) & 7168)
trigger1	= (Var(8) & 7168) > 2*1024
trigger2	= !HitPauseTime && !(Var(18) & 528482304)
var(8)		= -1024
ignorehitpause	= 1

[State -2, Command Record Decrease]	; シールド
type		= VarAdd
triggerall	= !IsHelper
triggerall	= (Var(8) & 24576)
trigger1	= (Var(8) & 24576) > 2*8192
trigger2	= !HitPauseTime && !(Var(18) & 528482304)
var(8)		= -8192
ignorehitpause	= 1

[State -2, Command Record Decrease]	; 挑発
type		= VarAdd
triggerall	= !IsHelper
triggerall	= (Var(8) & 786432)
trigger1	= (Var(8) & 786432) > 2*262144
trigger2	= !HitPauseTime && !(Var(18) & 528482304)
var(8)		= -262144
ignorehitpause	= 1

[State -2, Command Record Decrease]	; バースト
type		= VarAdd
triggerall	= !IsHelper
triggerall	= (Var(8) & 3145728)
trigger1	= (Var(8) & 3145728) > 2*1048576
trigger2	= !HitPauseTime && !(Var(18) & 528482304)
var(8)		= -1048576
ignorehitpause	= 1

[State -2, Command Record Decrease]	; ダッシュ
type		= VarAdd
triggerall	= !IsHelper
triggerall	= (Var(8) & 29360128)
trigger1	= (Var(8) & 29360128) > 2*4194304
trigger2	= !HitPauseTime && !(Var(18) & 528482304)
var(8)		= -4194304
ignorehitpause	= 1

[State -2, Command Record Decrease]	; バクステ
type		= VarAdd
triggerall	= !IsHelper
triggerall	= (Var(8) & 234881024)
trigger1	= (Var(8) & 234881024) > 2*33554432
trigger2	= !HitPauseTime && !(Var(18) & 528482304)
var(8)		= -33554432
ignorehitpause	= 1

[State -2, Command Record Decrease]	; high_jump_flag
type		= VarAdd
triggerall	= !IsHelper
triggerall	= (Var(8) & -268435456)
trigger1	= (Var(8) & -268435456) != 2*268435456 && (Var(8) & -268435456) != 1*268435456
trigger2	= !HitPauseTime && !(Var(18) & 528482304)
var(8)		= -268435456
ignorehitpause	= 1

[State -2, Command Record Decrease]	; 寄り切り
type		= VarAdd
triggerall	= !IsHelper
triggerall	= (Var(9) & 7)
trigger1	= (Var(9) & 7) > 2*1
trigger2	= !HitPauseTime && !(Var(18) & 528482304)
var(9)		= -1
ignorehitpause	= 1

[State -2, Command Record Decrease]	; がぶり寄り
type		= VarAdd
triggerall	= !IsHelper
triggerall	= (Var(9) & 56)
trigger1	= (Var(9) & 56) > 2*8
trigger2	= !HitPauseTime && !(Var(18) & 528482304)
var(9)		= -8
ignorehitpause	= 1

[State -2, Command Record Decrease]	; 掛け投げ(弱)
type		= VarAdd
triggerall	= !IsHelper
triggerall	= (Var(9) & 448)
trigger1	= (Var(9) & 448) > 2*64
trigger2	= !HitPauseTime && !(Var(18) & 528482304)
var(9)		= -64
ignorehitpause	= 1

[State -2, Command Record Decrease]	; 掛け投げ(強)
type		= VarAdd
triggerall	= !IsHelper
triggerall	= (Var(9) & 3584)
trigger1	= (Var(9) & 3584) > 2*512
trigger2	= !HitPauseTime && !(Var(18) & 528482304)
var(9)		= -512
ignorehitpause	= 1

[State -2, Command Record Decrease]	; 超頭突き(弱)
type		= VarAdd
triggerall	= !IsHelper
triggerall	= (Var(9) & 28672)
trigger1	= (Var(9) & 28672) > 2*4096
trigger2	= !HitPauseTime && !(Var(18) & 528482304)
var(9)		= -4096
ignorehitpause	= 1

[State -2, Command Record Decrease]	; 超頭突き(強)
type		= VarAdd
triggerall	= !IsHelper
triggerall	= (Var(9) & 229376)
trigger1	= (Var(9) & 229376) > 2*32768
trigger2	= !HitPauseTime && !(Var(18) & 528482304)
var(9)		= -32768
ignorehitpause	= 1

[State -2, Command Record Decrease]	; 小手投げ(弱)
type		= VarAdd
triggerall	= !IsHelper
triggerall	= (Var(9) & 1835008)
trigger1	= (Var(9) & 1835008) > 2*262144
trigger2	= !HitPauseTime && !(Var(18) & 528482304)
var(9)		= -262144
ignorehitpause	= 1

[State -2, Command Record Decrease]	; 小手投げ(強)
type		= VarAdd
triggerall	= !IsHelper
triggerall	= (Var(9) & 14680064)
trigger1	= (Var(9) & 14680064) > 2*2097152
trigger2	= !HitPauseTime && !(Var(18) & 528482304)
var(9)		= -2097152
ignorehitpause	= 1

[State -2, Command Record Decrease]	; 五輪突き(弱)
type		= VarAdd
triggerall	= !IsHelper
triggerall	= (Var(9) & 117440512)
trigger1	= (Var(9) & 117440512) > 2*16777216
trigger2	= !HitPauseTime && !(Var(18) & 528482304)
var(9)		= -16777216
ignorehitpause	= 1

[State -2, Command Record Decrease]	; 五輪突き(強)
type		= VarAdd
triggerall	= !IsHelper
triggerall	= (Var(9) & 939524096)
trigger1	= (Var(9) & 939524096) > 2*134217728
trigger2	= !HitPauseTime && !(Var(18) & 528482304)
var(9)		= -134217728
ignorehitpause	= 1

[State -2, Command Record Decrease]	; 突き上げ(弱)
type		= VarAdd
triggerall	= !IsHelper
triggerall	= (Var(10) & 7)
trigger1	= (Var(10) & 7) > 2*1
trigger2	= !HitPauseTime && !(Var(18) & 528482304)
var(10)		= -1
ignorehitpause	= 1

[State -2, Command Record Decrease]	; 突き上げ(強)
type		= VarAdd
triggerall	= !IsHelper
triggerall	= (Var(10) & 56)
trigger1	= (Var(10) & 56) > 2*8
trigger2	= !HitPauseTime && !(Var(18) & 528482304)
var(10)		= -8
ignorehitpause	= 1

[State -2, Command Record Decrease]	; 四股踏み(弱)
type		= VarAdd
triggerall	= !IsHelper
triggerall	= (Var(10) & 448)
trigger1	= (Var(10) & 448) > 2*64
trigger2	= !HitPauseTime && !(Var(18) & 528482304)
var(10)		= -64
ignorehitpause	= 1

[State -2, Command Record Decrease]	; 四股踏み(強)
type		= VarAdd
triggerall	= !IsHelper
triggerall	= (Var(10) & 3584)
trigger1	= (Var(10) & 3584) > 2*512
trigger2	= !HitPauseTime && !(Var(18) & 528482304)
var(10)		= -512
ignorehitpause	= 1

[State -2, Command Record Decrease]	; 合掌ひねり(弱)
type		= VarAdd
triggerall	= !IsHelper
triggerall	= (Var(11) & 7)
trigger1	= (Var(11) & 7) > 2*1
trigger2	= !HitPauseTime && !(Var(18) & 528482304)
var(11)		= -1
ignorehitpause	= 1

[State -2, Command Record Decrease]	; 合掌ひねり(強)
type		= VarAdd
triggerall	= !IsHelper
triggerall	= (Var(11) & 56)
trigger1	= (Var(11) & 56) > 2*8
trigger2	= !HitPauseTime && !(Var(18) & 528482304)
var(11)		= -8
ignorehitpause	= 1

[State -2, Command Record Decrease]	; MAX合掌ひねり
type		= VarAdd
triggerall	= !IsHelper
triggerall	= (Var(11) & 448)
trigger1	= (Var(11) & 448) > 2*64
trigger2	= !HitPauseTime && !(Var(18) & 528482304)
var(11)		= -64
ignorehitpause	= 1

[State -2, Command Record Decrease]	; 大一番(弱)
type		= VarAdd
triggerall	= !IsHelper
triggerall	= (Var(11) & 3584)
trigger1	= (Var(11) & 3584) > 2*512
trigger2	= !HitPauseTime && !(Var(18) & 528482304)
var(11)		= -512
ignorehitpause	= 1

[State -2, Command Record Decrease]	; 大一番(強)
type		= VarAdd
triggerall	= !IsHelper
triggerall	= (Var(11) & 28672)
trigger1	= (Var(11) & 28672) > 2*4096
trigger2	= !HitPauseTime && !(Var(18) & 528482304)
var(11)		= -4096
ignorehitpause	= 1

[State -2, Command Record Decrease]	; MAX大一番
type		= VarAdd
triggerall	= !IsHelper
triggerall	= (Var(11) & 229376)
trigger1	= (Var(11) & 229376) > 2*32768
trigger2	= !HitPauseTime && !(Var(18) & 528482304)
var(11)		= -32768
ignorehitpause	= 1

[State -2, Command Record Decrease]	; 諸手突き(弱)
type		= VarAdd
triggerall	= !IsHelper
triggerall	= (Var(11) & 1835008)
trigger1	= (Var(11) & 1835008) > 2*262144
trigger2	= !HitPauseTime && !(Var(18) & 528482304)
var(11)		= -262144
ignorehitpause	= 1

[State -2, Command Record Decrease]	; 諸手突き(強)
type		= VarAdd
triggerall	= !IsHelper
triggerall	= (Var(11) & 14680064)
trigger1	= (Var(11) & 14680064) > 2*2097152
trigger2	= !HitPauseTime && !(Var(18) & 528482304)
var(11)		= -2097152
ignorehitpause	= 1

[State -2, Command Record Decrease]	; MAX諸手突き
type		= VarAdd
triggerall	= !IsHelper
triggerall	= (Var(11) & 117440512)
trigger1	= (Var(11) & 117440512) > 2*16777216
trigger2	= !HitPauseTime && !(Var(18) & 528482304)
var(11)		= -16777216
ignorehitpause	= 1

[State -2, Command Record Decrease]	; 我慢(弱)
type		= VarAdd
triggerall	= !IsHelper
triggerall	= (Var(10) & 28672)
trigger1	= (Var(10) & 28672) > 2*4096
trigger2	= !HitPauseTime && !(Var(18) & 528482304)
var(10)		= -4096
ignorehitpause	= 1

[State -2, Command Record Decrease]	; 我慢(強)
type		= VarAdd
triggerall	= !IsHelper
triggerall	= (Var(10) & 229376)
trigger1	= (Var(10) & 229376) > 2*32768
trigger2	= !HitPauseTime && !(Var(18) & 528482304)
var(10)		= -32768
ignorehitpause	= 1

[State -2, Command Record Decrease]	; MAX我慢
type		= VarAdd
triggerall	= !IsHelper
triggerall	= (Var(10) & 1835008)
trigger1	= (Var(10) & 1835008) > 2*262144
trigger2	= !HitPauseTime && !(Var(18) & 528482304)
var(10)		= -262144
ignorehitpause	= 1

;---------------------------------------------------------------------
; 盾
;---------------------------------------------------------------------
;------------------- 初期化
[State -2, Shield Reset]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= Var(15) < 0
var(15)		= 0
ignorehitpause	= 1

;------------------- 限界値付き増加1
[State -2, Shield Set]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= (Var(32) & 7) < 4
triggerall	= (Var(2) & 131071) = 3601
triggerall	= AnimElemTime(1) - 1 = 0
trigger1	= (Var(15) < 100*1/1)
var(15)		= IfElse( Var(15) + 30*1/1 >= 100*1/1, 100*1/1, Var(15) + 30*1/1 )
ignorehitpause	= 1

;------------------- 限界値付き増加2
[State -2, Shield Set]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= (Var(32) & 7) < 4
triggerall	= (Var(2) & 131071) = 3701
triggerall	= AnimElemTime(1) - 1 = 0
trigger1	= (Var(15) < 100*1/1)
var(15)		= IfElse( Var(15) + 70*1/1 >= 100*1/1, 100*1/1, Var(15) + 70*1/1 )
ignorehitpause	= 1

;------------------- 盾の瀕死用処理
[State -2, Shield Dying]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= 1
var(0)		= (Life = 1) && Var(15)
ignorehitpause	= 1

[State -2, Shield Dying]
type		= LifeAdd
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= Var(0)
value		= 1
absolute	= 1
ignorehitpause	= 1

[State -2, Shield Dying]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= Var(0)
var(15)		= IfElse( Var(15) - 1*1/1 > 1*1/1, 2*1/1, Var(15) - 1*1/1 )
ignorehitpause	= 1

;---------------------------------------------------------------------
;  強制復帰リセット
;---------------------------------------------------------------------
;------------------- フラグを寝かす
[State -2, VarSet]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
trigger1	= 1
var(1)		= (Var(1) | 4) - 4
ignorehitpause	= 1

;---------------------------------------------------------------------
;  鋼体
;---------------------------------------------------------------------
;------------------- 直接攻撃によるダメージ計算
[State -2, Koutai Damage Reset]
type		= VarSet
triggerall	= !IsHelper
trigger1	= 1
var(57)		= 0
ignorehitpause	= 1

[State -2, Koutai Damage Reset]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= 1
var(57)		= GetHitVar(damage)
ignorehitpause	= 1

[State -2, Koutai Damage Set]
type		= VarSet
triggerall	= !IsHelper
trigger1	= Var(57) > 0
var(57)		= IfElse( Var(57)*1/1 <= Var(12), Var(57)*1/1, 0 )
ignorehitpause	= 1

[State -2, Koutai Damage Set]
type		= VarSet
triggerall	= !IsHelper
trigger1	= 1
fvar(0)		= Var(57)
ignorehitpause	= 1

;------------------- 当身は「食らった」ようにしたい、用フラグ判定
;------------------- ただしどんな攻撃でも鋼体回数が減る状態で、ペナルティ鋼体の場合は、回数を減らさない
[State -2, Atemi?]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= (MoveReversed = [1, 2]) && ((Var(1) & 1024) || (Var(18) & 1073741824))
var(1)		= (Var(1) | 65536)
ignorehitpause	= 1

[State -2, Atemi? Reset]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= !((Var(1) & 1024) || (Var(18) & 1073741824))
trigger2	= (Var(22) & 32)
trigger2	= NumHelper(30000)
trigger2	= !Helper(30000),Var(3)
trigger2	= Helper(30000),Var(7)
trigger3	= (Var(32) & 7) = 0
var(1)		= (Var(1) | 65536) - 65536
ignorehitpause	= 1

;------------------- 鋼体中か
[State -2, Koutai? Reset]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= 1
var(1)		= (Var(1) | 1048576) - 1048576
ignorehitpause	= 1

; 特定の鋼体中は当身は食らえるように、フラグを立てない
[State -2, Koutai?]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= !(Var(1) & 65536)
trigger1	= (Var(18) & 1008)
trigger2	= NumHelper(30000)
trigger2	= Helper(30000),Var(3)
trigger3	= NumHelper(30000)
trigger3	= Helper(30000),Var(7)
var(1)		= (Var(1) | 1048576)
ignorehitpause	= 1

;------------------- すごいダメージでやられになる鋼体か
[State -2, Koutai Knock Out Damage Reset]
type		= VarSet
triggerall	= !IsHelper
trigger1	= 1
var(57)		= Floor( FVar(0) )
ignorehitpause	= 1

[State -2, Koutai Knock Out Damage Reset]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= Var(57) > 0
; 対モード以上は「すごいダメやられ鋼体」は発動しない
trigger1	= (Var(32) & 7) < 4
var(57)		= 0
ignorehitpause	= 1

[State -2, Koutai Knock Out Bug Reset]
type		= VarSet
triggerall	= !IsHelper
; いきなり即死対策
trigger1	= Life >= LifeMax && FVar(0) >= LifeMax*1/1
; ダメ喰らったとみなさない場合
trigger2	= (Var(57) > 0) && !(Var(1) & 8)
; 閾ダメージを満たさない場合
trigger3	= (Var(57) > 0) && (Var(57) < 125*1/1)
var(57)		= 0
ignorehitpause	= 1

[State -2, Koutai Knock Out Set]
type		= VarSet
triggerall	= !IsHelper
trigger1	= (Var(57) > 0)
var(57)		= 1
ignorehitpause	= 1

;------------------- ステート奪取され用鋼体
[State -2, Koutai Steal Reset]
type		= VarSet
triggerall	= !IsHelper
trigger1	= 1
var(0)		= 0
ignorehitpause	= 1

[State -2, Koutai Steal State Decree Koutai Flag Reset]
type		= VarSet
triggerall	= !IsHelper
trigger1	= 1
var(58)		= 0
ignorehitpause	= 1

[State -2, Koutai Steal State Decree Koutai Flag Set]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= (Var(19) & 8192) && !(Var(19) & 2048) && (Var(5) >= 30*1/1)
triggerall	= (Var(1) & 1048576)
trigger1	= (Var(32) & 7) < 4
; 行動可能になったら
trigger2	= (Ctrl || RoundState != 2) && !(Var(1) & 16384) && StateType != L
; 最大HP以上のダメージを受けたら
trigger3	= Life >= LifeMax && FVar(0) >= LifeMax*1/1
var(58)		= 1
ignorehitpause	= 1

[State -2, Koutai Steal State Reset]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= (Var(32) & 7) < 4
trigger2	= (Ctrl || RoundState != 2) && !(Var(1) & 16384) && StateType != L
trigger3	= !(Var(1) & 1048576)
trigger4	= Life >= LifeMax && FVar(0) >= LifeMax*1/1
var(19)		= (Var(19) | 8192) - 8192
ignorehitpause	= 1

[State -2, Koutai Steal Check]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= (Var(32) & 7) >= 4
triggerall	= !(Life >= LifeMax && FVar(0) >= LifeMax*1/1)
trigger1	= ((Var(1) & 1024) || (Var(18) & 1073741824))
var(0)		= (Var(1) & 1048576) && ((Var(1) & 1024) || (Var(18) & 1073741824))
ignorehitpause	= 1

[State -2, Koutai?]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= (Var(19) & 8192)
trigger2	= (Var(57) > 0)
var(0)		= 1
ignorehitpause	= 1

;------------------- 鋼体強制復帰
[State -2, Koutai Force Recovery]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= (Var(1) & 1048576)
triggerall	= !(Var(18) & 1073741824) || (Var(32) & 7) < 2
; ステート奪取され用
trigger1	= !Var(0)
var(1)		= (Var(1) | 4)
ignorehitpause	= 1

[State -2, Koutai Force Recovery]
type		= PosSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= NumHelper(20000)
triggerall	= (Helper(20000),Var(0) = 20000)
triggerall	= (Var(1) & 1048576)
triggerall	= (Var(1) & 16384)
trigger1	= !Var(0)
x			= Helper(20000),Pos X
y			= Helper(20000),Pos Y
ignorehitpause	= 1

[State -2, Koutai Force Recovery]
type		= Turn
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= !Ctrl || !( Ctrl && ((Var(2) & 131071) = 0 || ((Var(2) & 131071) = [10, 12]) || (Var(2) & 131071) = 20) )
triggerall	= IfElse( Facing = 1, (Var(2) & 16777216), !(Var(2) & 16777216) )
triggerall	= (Var(1) & 1048576)
trigger1	= !Var(0)
ignorehitpause	= 1

[State -2, Koutai Force Recovery]
type		= VelSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= (Var(1) & 1048576)
trigger1	= !Var(0)
x			= FVar(7)
y			= FVar(8)
ignorehitpause	= 1

;------------------- 時間鋼体用タイマーリセット
; 当身は食らうように
; ただしステート奪取復帰時の鋼体解除は無し
[State -2, Koutai Timer Reset]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= !(Var(1) & 1048576)
trigger1	= (Var(1) & 65536)
var(18)		= (Var(18) | 1008) - 1008
ignorehitpause	= 1

;------------------- 鋼体用当身を出すか
[State -2, Koutai No Decrease Reset]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= 1
var(16)		= (Var(16) | 268435456) - 268435456
ignorehitpause	= 1

[State -2, Koutai No Decrease]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= (Var(1) & 1048576)
triggerall	= !(Var(1) & 65536) && (Var(18) & 1008)
trigger1	= !(Var(1) & 16384)
; 打撃やられ
trigger2	= (Var(1) & 16384) && !Var(0) && (Var(1) & 8)
trigger2	= FVar(0) >= 0
; ガード
trigger3	= (Var(1) & 16384) && !Var(0) && (Var(1) & 8)
trigger3	= FVar(0) >= 0
trigger3	= !(Var(1) & 1024)
trigger3	= StateNo = 150 || StateNo = 152 || StateNo = 154
trigger3	= Time = 0
; ステ取られ(ステ奪われるだけの鋼体中は処理しない)
trigger4	= (Var(1) & 16384) && !Var(0)
trigger4	= (Var(1) & 1024) || (Var(18) & 1073741824)
; 鋼体付き攻撃
trigger5	= (Var(2) & 131071) = 601 || (Var(2) & 131071) = 611 || (Var(2) & 131071) = 613 || (Var(2) & 131071) = 1701
; 各種緊急回避(ステ奪取される鋼体・・・ではない場合のみ)
trigger6	= !(Var(1) & 1024)
trigger6	= (Var(32) & 7) < 4
trigger6	= (Var(2) & 131071) = 4051 && AnimElemTime(3) >= 0 && AnimElemTime(8) < 0
; 各種緊急回避(ステ奪取される鋼体・・・ではない場合のみ)
trigger7	= !(Var(1) & 1024)
trigger7	= (Var(32) & 7) < 4
trigger7	= (Var(2) & 131071) = 4081 && AnimElemTime(4) >= 0 && AnimElemTime(9) < 0
; 各種緊急回避(ステ奪取される鋼体・・・ではない場合のみ)
trigger8	= !(Var(1) & 1024)
trigger8	= (Var(32) & 7) < 4
trigger8	= (Var(2) & 131071) = 4097 && AnimElemTime(4) >= 0
var(16)		= (Var(16) | 268435456)
ignorehitpause	= 1

[State -2, Koutai Decrease Reset]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= 1
var(1)		= (Var(1) | 262144) - 262144
ignorehitpause	= 1

[State -2, Koutai Decrease Chance]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= (Var(1) & 1048576)
triggerall	= !(Var(16) & 268435456)
triggerall	= (Var(1) & 65536) || !(Var(18) & 1008)
trigger1	= 0
; 打撃やられ
trigger2	= (Var(1) & 16384) && !Var(0) && (Var(1) & 8)
trigger2	= FVar(0) >= 0
; ガード
trigger3	= (Var(1) & 16384) && !Var(0) && (Var(1) & 8)
trigger3	= FVar(0) >= 0
trigger3	= !(Var(1) & 1024)
trigger3	= StateNo = 150 || StateNo = 152 || StateNo = 154
trigger3	= Time = 0
; ステ取られ(ステ奪われるだけの鋼体中は処理しない)
trigger4	= (Var(1) & 16384) && !Var(0)
trigger4	= (Var(1) & 1024) || (Var(18) & 1073741824)
; 鋼体付き攻撃
trigger5	= (Var(2) & 131071) = 601 || (Var(2) & 131071) = 611 || (Var(2) & 131071) = 613 || (Var(2) & 131071) = 1701
; 各種緊急回避(ステ奪取される鋼体・・・ではない場合のみ)
trigger6	= !(Var(1) & 1024)
trigger6	= (Var(32) & 7) < 4
trigger6	= (Var(2) & 131071) = 4051 && AnimElemTime(3) >= 0 && AnimElemTime(8) < 0
; 各種緊急回避(ステ奪取される鋼体・・・ではない場合のみ)
trigger7	= !(Var(1) & 1024)
trigger7	= (Var(32) & 7) < 4
trigger7	= (Var(2) & 131071) = 4081 && AnimElemTime(4) >= 0 && AnimElemTime(9) < 0
; 各種緊急回避(ステ奪取される鋼体・・・ではない場合のみ)
trigger8	= !(Var(1) & 1024)
trigger8	= (Var(32) & 7) < 4
trigger8	= (Var(2) & 131071) = 4097 && AnimElemTime(4) >= 0
var(1)		= (Var(1) | 262144)
ignorehitpause	= 1

;------------------- ステート奪取される用鋼体減少命令
[State -2, Koutai Force Decrease Reset]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= 1
var(19)		= (Var(19) | 1024) - 1024
ignorehitpause	= 1

; 強制鋼体当身を寝かす
[State -2, Koutai No Decrease Reset]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= (Var(1) & 1048576) && !Var(0)
trigger1	= Var(58)
var(16)		= (Var(16) | 268435456) - 268435456
ignorehitpause	= 1

; 鋼体当身を寝かす
[State -2, Koutai Decrease Reset]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= (Var(1) & 1048576) && !Var(0)
trigger1	= Var(58)
var(1)		= (Var(1) | 262144) - 262144
ignorehitpause	= 1

; 強制鋼体中で無いなら、強制的に鋼体を1個減らす
[State -2, Koutai Decrease Chance]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= (Var(1) & 1048576) && !Var(0)
triggerall	= !(Var(18) & 1008)
trigger1	= Var(58)
var(19)		= (Var(19) | 1024)
ignorehitpause	= 1

; 強制鋼体があるならそれを無くす
[State -2, Timer Decrease Chance]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= (Var(1) & 1048576) && !Var(0)
triggerall	= (Var(18) & 1008)
triggerall	= NumHelper(30000)
triggerall	= Helper(30000),Var(3) || Helper(30000),Var(7)
trigger1	= Var(58)
var(18)		= (Var(18) | 1008) - 1008
ignorehitpause	= 1

[State -2, Koutai Decrease Reset]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= !(Var(19) & 8192) && !(Var(1) & 16384)
var(19)		= (Var(19) | 2048) - 2048
ignorehitpause	= 1

;------------------- 時間鋼体用タイマー減少
[State -2, Koutai Timer Decrease]
type		= VarAdd
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= !(Var(18) & 528482304)
triggerall	= !(Var(2) & 4194304) && !(Var(2) & 33554432) && !Var(0)
trigger1	= (Var(18) & 1008)
var(18)		= -1008 / 63
ignorehitpause	= 0

;------------------- キャラモードSUMOU時の時間鋼体用タイマー設定
[State -2, Koutai Timer Set By Mode]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= (Var(32) & 7) = 0
trigger1	= (Var(18) & 1008) < 1008 / 63
var(18)		= (Var(18) | 1008) - 1008 + 1008 / 63
ignorehitpause	= 1

;------------------- ステート奪取されるだけ用鋼体の蓄積ダメージ初期化
[State -2, Koutai Damage Reset]
type		= VarSet
triggerall	= !IsHelper
trigger1	= Var(0)
trigger1	= !(Var(19) & 8192)
var(5)		= 0
ignorehitpause	= 1

;------------------- ステート奪取だけされる鋼体かのバッファ
[State -2, Koutai Steal State Set]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
trigger1	= Var(0)
var(19)		= (Var(19) | 8192)
ignorehitpause	= 1

;---------------------------------------------------------------------
;  自分以外のスーパーポーズが長過ぎる
;---------------------------------------------------------------------
;------------------- 色々ペナルティ
[State -2, SuperPause NotHit]
type		= NotHitBy
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= Alive
trigger1	= (Var(1) & 131072)
value2		= SCA
time		= 60
ignorehitpause	= 1

[State -2, SuperPause NotHit]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= Alive
triggerall	= (Var(32) & 7) < 3
trigger1	= (Var(1) & 131072)
var(13)		= Var(12)
ignorehitpause	= 1

[State -2, SuperPause NotHit]
type		= LifeSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= Alive
triggerall	= (Var(32) & 7) < 3
trigger1	= (Var(1) & 131072)
value		= LifeMax
ignorehitpause	= 1

[State -2, Debug]
type		= AppendToClipboard
triggerall	= !IsHelper
triggerall	= !Var(50)
triggerall	= Alive
trigger1	= (Var(1) & 131072)
text		= "Error SuperPause "
ignorehitpause	= 1

[State -2, VarSet]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= Alive
trigger1	= (Var(1) & 131072)
var(1)		= (Var(1) | 4)
ignorehitpause	= 1

[State -2, VarSet]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= Alive
triggerall	= (Var(18) & 1008) < 1008 / 63 * 60
trigger1	= (Var(1) & 131072)
var(18)		= (Var(18) | 1008) - 1008 + 1008 / 63 * 60
ignorehitpause	= 1

[State -2, VarSet]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= 1
var(1)		= (Var(1) | 131072) - 131072
ignorehitpause	= 1

;---------------------------------------------------------------------
; パワーゲージダメージ
;---------------------------------------------------------------------
[State -2, Power Damage Init]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= 1
var(0)		= 0
ignorehitpause	= 1

[State -2, Power Damage]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= 1
var(0)		= Var(23) - Power
ignorehitpause	= 1

[State -2, Power Damage]
type		= VarAdd
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= Var(0) > 0
var(21)		= Var(0)
ignorehitpause	= 1

;------------------- ダメージ無視
[State -2, Damage NotHit Init]
type		= VarSet
triggerall	= !IsHelper
trigger1	= 1
var(0)		= 0
ignorehitpause	= 1

[State -2, Damage NotHit Init]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= Alive
triggerall	= (Var(32) & 7) < 4 && (Var(20) & 535822336)
triggerall	= Const(data.power) > 0
trigger1	= Floor( (Var(20) & 535822336) / 1048576 * 10 * IfElse(PowerMax<Const(data.power),PowerMax,Const(data.power))/(1.0*Const(data.power)) ) <= Var(21)
var(0)		= 1
ignorehitpause	= 1

[State -2, Damage NotHit]
type		= NotHitBy
triggerall	= !IsHelper
trigger1	= Var(0)
value2		= SCA
time		= 60
ignorehitpause	= 1

[State -2, Damage NotHit]
type		= PowerSet
triggerall	= !IsHelper
trigger1	= Var(0)
value		= PowerMax
ignorehitpause	= 1

[State -2, VarSet]
type		= VarSet
triggerall	= !IsHelper
trigger1	= Var(0)
var(1)		= (Var(1) | 4)
ignorehitpause	= 1

[State -2, VarSet]
type		= VarSet
triggerall	= !IsHelper
triggerall	= (Var(18) & 1008) < 1008 / 63 * 60
trigger1	= Var(0)
var(18)		= (Var(18) | 1008) - 1008 + 1008 / 63 * 60
ignorehitpause	= 1

[State -2, Debug]
type		= Null;AppendToClipboard
triggerall	= !IsHelper
trigger1	= Var(0)
text		= "Error %d "
params		= Var(21)
ignorehitpause	= 1

;------------------- ステートを奪われているときは、パワーゲージ保持
[State -2, Power Damage Init]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= (Var(1) & 1024)
var(23)		= Power
ignorehitpause	= 1

;---------------------------------------------------------------------
;  防御力補正
;---------------------------------------------------------------------
;------------------- 前フレの落下ダメージ要請処理
[State -2, HitFallDamage Damage]
type		= HitFallDamage
triggerall	= !IsHelper
trigger1	= (Var(19) & 65536)
ignorehitpause	= 1

[State -2, HitFallDamage Reset]
type		= VarSet
triggerall	= !IsHelper
trigger1	= 1
var(19)		= (Var(19) | 65536) - 65536
ignorehitpause	= 1

;------------------- 1フレの総ダメージ量を算出
[State -2, 1 Frame Damage Init]
type		= VarSet
triggerall	= !IsHelper
trigger1	= 1
var(0)		= 0
ignorehitpause	= 1

[State -2, 1 Frame Damage]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= 1
var(0)		= Var(6) - Life + (Var(6) > LifeMax) * (LifeMax - Var(6))
ignorehitpause	= 1

;------------------- 通常打撃を鋼体で耐えた時の被ダメージ計算
[State -2, Normal Attack Damege in Normal Mode Koutai]
type		= VarSet
triggerall	= !IsHelper
trigger1	= 1
fvar(39)	= 0
ignorehitpause	= 1

[State -2, Normal Attack Damege in Normal Mode Koutai]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= 1
fvar(39)	= GetHitVar(damage)
ignorehitpause	= 1

[State -2, Normal Attack Damege in Normal Mode Koutai]
type		= VarSet
triggerall	= !IsHelper
trigger1	= FVar(39) > 0
fvar(39)	= FVar(39) / 4.0
ignorehitpause	= 1

;------------------- ダメージ量n倍
; 総ダメージ側
[State -2, 1 Frame Damage]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= 1
var(0)		= IfElse( -Var(12) <= Var(0)*1/1 && Var(0)*1/1 <= Var(12), Var(0)*1/1, IfElse( Var(0) >= 0, Var(12), -Var(12) ) )
ignorehitpause	= 1

; 鋼体堪え被ダメ側
[State -2, 1 Frame Damage]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= 1
fvar(39)	= IfElse( -Var(12) <= FVar(39)*1/1 && FVar(39)*1/1 <= Var(12), FVar(39)*1/1, IfElse( FVar(39) >= 0, Var(12), -Var(12) ) )
ignorehitpause	= 1

;------------------- 被連続技用総ダメージ、カウンタ設定
[State -2, Enemy Total Combo Damage]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
; 何かしら被ダメージがある時
trigger1	= Var(0) > 0
; 物理被ダメージの予約がある時
trigger2	= FVar(39) > 0
; 回復じゃない物理攻撃を喰らった時
trigger3	= (Var(1) & 8) && (FVar(39) = 0)
; ステ奪取されてるとき
trigger4	= (Var(1) & 1024)
; ステ奪取されないステ変更がある時
trigger5	= (Var(18) & 1073741824)
var(16)		= (Var(16) | 28672)
ignorehitpause	= 1

;------------------- 鋼体堪え被ダメを受けないケースを考慮
[State -2, Koutai Damage Reset Check]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
; 被ダメを受けないモードの時
trigger1	= (Var(32) & 7) < 2
; 鋼体状態じゃない時
trigger2	= !(Var(1) & 1048576)
; 強制復帰しない時
trigger3	= !(Var(1) & 4)
; 回復の時
trigger4	= FVar(39) < 0
; ガード時
trigger5	= !(Var(1) & 1024)
trigger5	= StateNo = 150 || StateNo = 152 || StateNo = 154
trigger5	= Time = 0
fvar(39)	= 0
ignorehitpause	= 1

;------------------- 防御倍率
; 防御力補正が入る前の値を保存
[State -2, Damage Buf]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= 1
var(58)		= Var(0)
ignorehitpause	= 1

[State -2, Damage Buf]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= 1
fvar(0)		= Var(0) + FVar(39)
ignorehitpause	= 1

; 総ダメージ側
[State -2, Damage]
type		= VarSet
triggerall	= !IsHelper
trigger1	= 1
var(57)		= 0
ignorehitpause	= 1

[State -2, Damage]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= NumHelper(20000)
trigger1	= Var(0) > 0
var(57)		= Floor(Var(0)/Helper(20000),FVar(1)) + ((Floor(Var(0)/Helper(20000),FVar(1)*1000))%1000 > Random)
ignorehitpause	= 1

[State -2, Damage]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= NumHelper(20000)
trigger1	= Var(0) > 0
var(0)		= IfElse( 0 <= Var(57) && Var(57) < Var(12), Var(57), Var(12) )
ignorehitpause	= 1

; 鋼体耐え被ダメ側
[State -2, Damage]
type		= VarSet
triggerall	= !IsHelper
trigger1	= 1
var(57)		= 0
ignorehitpause	= 1

[State -2, Damage]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= NumHelper(20000)
trigger1	= FVar(39) > 0
var(57)		= Floor(FVar(39)/Helper(20000),FVar(1)) + ((Floor(FVar(39)/Helper(20000),FVar(1)*1000))%1000 > Random)
ignorehitpause	= 1

[State -2, Damage]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= NumHelper(20000)
trigger1	= FVar(39) > 0
fvar(39)	= IfElse( 0 <= Var(57) && Var(57) < Var(12), Var(57), Var(12) )
ignorehitpause	= 1

;------------------- 防御力が低い用のダメージ丸め処理
; 特に前Fからの打撃でノーバウンドで死なないように
; 「F1やF2や即死打撃or即死投げで死ぬ用」でも丸め込まれるが、ここでも一応 Life > 0 の判定をする
[State -2, VarSet]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= Var(0) > 0
triggerall	= Life > 0
triggerall	= NumHelper(20000)
triggerall	= Helper(20000),FVar(1) < 1.0
trigger1	= Var(13) - Var(0) <= 0
var(0)		= Var(13) - 1
ignorehitpause	= 1

;------------------- Life<=0用、その分のダメージを食らう
; 通常打撃用にLife <= 0のチェックを外す
[State -2, VarSet]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= Var(17) <= Var(58) / (1.0*1/1)
triggerall	= NumHelper(20000)
trigger1	= Var(0) > 0
fvar(0)		= Ceil( Var(13) * Helper(20000),FVar(1) )
ignorehitpause	= 1

[State -2, VarSet]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= Var(17) <= Var(58) / (1.0*1/1)
trigger1	= Var(0) > 0
var(0)		= Var(13)
ignorehitpause	= 1

;------------------- このフレームでのダメージ量を記録
[State -2, Damage Buf]
type		= VarSet
triggerall	= !IsHelper
trigger1	= 1
var(53)		= Var(0) + Floor(FVar(39))
ignorehitpause	= 1

;------------------- 被連続技用、総ダメージ計算
[State -2, Enemy Total Combo Damage]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= 1
var(57)		= Var(14)
ignorehitpause	= 1

[State -2, Enemy 1Frame Total Damage]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= 1
var(58)		= IfElse( FVar(0) >= Var(53), Ceil(FVar(0)), Var(53) )
ignorehitpause	= 1

[State -2, Enemy Total Combo Damage]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= Var(58) > 0
var(14)		= IfElse( Var(14) + Var(58) > Var(12), Var(12), Var(14) + Var(58) )
ignorehitpause	= 1

;------------------- 総ダメージ、ダメージ無視
[State -2, Total Damage NotHit]
type		= NotHitBy
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= Alive
triggerall	= (Var(22) & 1024) || (Var(1) & 16384)
triggerall	= (Var(32) & 7) < 4 && (Var(20) & 1047552)
trigger1	= (Var(20) & 1047552) / 1024*1/1 <= Var(14)
value2		= SCA
time		= 60
ignorehitpause	= 1

[State -2, Total Damage NotHit]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= Alive
triggerall	= (Var(22) & 1024) || (Var(1) & 16384)
triggerall	= (Var(32) & 7) < 4 && (Var(20) & 1047552)
triggerall	= NumHelper(20000)
trigger1	= (Var(20) & 1047552) / 1024*1/1 <= Var(14)
var(57)		= Floor( IfElse( FVar(0) >= Var(53), Var(57) / Helper(20000),FVar(1), Var(57) ) )
ignorehitpause	= 1

[State -2, Total Damage NotHit]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= Alive
triggerall	= (Var(22) & 1024) || (Var(1) & 16384)
triggerall	= (Var(32) & 7) < 4 && (Var(20) & 1047552)
trigger1	= (Var(20) & 1047552) / 1024*1/1 <= Var(14)
var(13)		= IfElse( (Var(22) & 128), Var(12), Var(13) + Var(57) )
ignorehitpause	= 1

[State -2, Total Damage NotHit]
type		= LifeSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= Alive
triggerall	= (Var(22) & 1024) || (Var(1) & 16384)
triggerall	= (Var(32) & 7) < 4 && (Var(20) & 1047552)
trigger1	= (Var(20) & 1047552) / 1024*1/1 <= Var(14)
value		= LifeMax
ignorehitpause	= 1

[State -2, Debug]
type		= Null;AppendToClipboard
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= Alive
triggerall	= (Var(22) & 1024) || (Var(1) & 16384)
triggerall	= (Var(32) & 7) < 4 && (Var(20) & 1047552)
trigger1	= (Var(20) & 1047552) / 1024*1/1 <= Var(14)
text		= "Error %d %d "
params		= Var(58), Var(14)
ignorehitpause	= 1

[State -2, VarSet]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= Alive
triggerall	= (Var(22) & 1024) || (Var(1) & 16384)
triggerall	= (Var(32) & 7) < 4 && (Var(20) & 1047552)
trigger1	= (Var(20) & 1047552) / 1024*1/1 <= Var(14)
var(1)		= (Var(1) | 4)
ignorehitpause	= 1

[State -2, VarSet]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= Alive
triggerall	= (Var(22) & 1024) || (Var(1) & 16384)
triggerall	= (Var(18) & 1008) < 1008 / 63 * 60
triggerall	= (Var(32) & 7) < 4 && (Var(20) & 1047552)
trigger1	= (Var(20) & 1047552) / 1024*1/1 <= Var(14)
var(18)		= (Var(18) | 1008) - 1008 + 1008 / 63 * 60
ignorehitpause	= 1

[State -2, Total Damage NotHit]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= Alive
triggerall	= (Var(22) & 1024) || (Var(1) & 16384)
triggerall	= (Var(32) & 7) < 4 && (Var(20) & 1047552)
trigger1	= (Var(20) & 1047552) / 1024*1/1 <= Var(14)
var(0)		= 0
ignorehitpause	= 1

[State -2, Total Damage NotHit]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= Alive
triggerall	= (Var(22) & 1024) || (Var(1) & 16384)
triggerall	= (Var(32) & 7) < 4 && (Var(20) & 1047552)
trigger1	= (Var(20) & 1047552) / 1024*1/1 <= Var(14)
fvar(39)	= 0
ignorehitpause	= 1

[State -2, Total Damage NotHit]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= Alive
triggerall	= (Var(22) & 1024) || (Var(1) & 16384)
triggerall	= (Var(32) & 7) < 4 && (Var(20) & 1047552)
trigger1	= (Var(20) & 1047552) / 1024*1/1 <= Var(14)
var(14)		= 0
ignorehitpause	= 1

;------------------- ダメージを喰らわないか
; 総ダメージ側
[State -2, Damage Value]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= Var(0) > 0 && Alive
triggerall	= (Var(32) & 7) < 4
trigger1	= RoundState >= 3
trigger2	= !(Var(1) & 16384)
var(0)		= 0
ignorehitpause	= 1

[State -2, Damage Value]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= Var(0) > 0 && Alive
triggerall	= ((Var(1) & 4) || (Var(1) & 1048576))
trigger1	= (Var(32) & 7) < 4
trigger2	= !GetHitVar(damage) && !(Var(19) & 8192)
var(0)		= 0
ignorehitpause	= 1

; 鋼体耐え被ダメ側
[State -2, Damage Value]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= FVar(39) > 0 && Alive
trigger1	= RoundState != 2
trigger2	= Var(0) != 0
trigger3	= FVar(0) <= 0
trigger4	= (Var(32) & 7) <= 1
trigger5	= !(Var(1) & 16384)
fvar(39)	= 0
ignorehitpause	= 1

;------------------- 盾処理
[State -2, Shield Value]
type		= VarSet
triggerall	= !IsHelper
trigger1	= 1
var(58)		= 0
ignorehitpause	= 1

[State -2, Shield Value]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= Alive
trigger1	= 1
var(58)		= Var(15) * (Var(0) > 0 || FVar(39) > 0) * (Var(15) > 0)
ignorehitpause	= 1

; 盾処理をするが、残Life以上のダメを受けたときは、強制的に盾を壊す、ダメは持ち越さない
[State -2, Reduce Damage Dying]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(58)
trigger1	= Var(17) <= FVar(0) / (1.0*1/1)
var(58)		= Var(0) + Floor(FVar(39))
ignorehitpause	= 1

[State -2, Reduce Damage]
type		= VarAdd
triggerall	= !IsHelper
triggerall	= Var(58)
trigger1	= Var(0) > 0
var(0)		= -Var(58)
ignorehitpause	= 1

[State -2, Reduce Damage]
type		= VarAdd
triggerall	= !IsHelper
triggerall	= Var(58)
trigger1	= FVar(39) > 0
fvar(39)	= -Var(58)
ignorehitpause	= 1

[State -2, Shield Reset]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(58)
trigger1	= 1
var(15)		= 0
ignorehitpause	= 1

[State -2, Shield Life]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(58)
trigger1	= Var(0) < 0
var(15)		= -Var(0)
ignorehitpause	= 1

[State -2, Shield Life]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(58)
trigger1	= FVar(39) < 0
var(15)		= Floor(-FVar(39))
ignorehitpause	= 1

[State -2, Shield Damage Reset]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(58)
trigger1	= Var(0) < 0
var(0)		= 0
ignorehitpause	= 1

[State -2, Shield Damage Reset]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(58)
trigger1	= FVar(39) < 0
fvar(39)	= 0
ignorehitpause	= 1

;------------------- ダメージ処理
[State -2, True Life Buf]
type		= VarSet
triggerall	= !IsHelper
trigger1	= 1
var(57)		= Var(13)
ignorehitpause	= 1

; 総ダメージ側
; 残り体力に、今回のダメージを足す
; やられ状態じゃなければダメージは受けない
; 永続Targetの毒効果とかも不能になりますね
; ただmugenの仕様上、相手のステートに引き込まれてLifeSet 0されたら即死するのは無理ゲーな上に、死んだ後Lifeが回復して見える
[State -2, Damage Add]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= !(Var(1) & 1048576) ; 鋼体中はダメージを受けない
trigger1	= Var(0) > 0
var(13)		= IfElse( Var(13) - Var(0) < 0, 0, Var(13) - Var(0) )
ignorehitpause	= 1

; 鋼体耐え被ダメ側
[State -2, Damage Correct]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= FVar(39) > 0
var(58)		= Floor(FVar(39))
ignorehitpause	= 1

[State -2, Damage Correct]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= FVar(39) > 0
trigger1	= (Var(32) & 7) = 3
var(58)		= Floor(FVar(39)/2.0) + (Floor(FVar(39)/2.0*1000)%1000 > Random)
ignorehitpause	= 1

[State -2, Damage Correct]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= FVar(39) > 0
trigger1	= (Var(32) & 7) < 3
var(58)		= Floor(FVar(39)/2.5) + (Floor(FVar(39)/2.5*1000)%1000 > Random)
ignorehitpause	= 1

[State -2, Damage Add]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= Var(13) > 0
trigger1	= FVar(39) > 0
var(13)		= IfElse( Var(13) - Var(58) <= 0, 1, Var(13) - Var(58) )
ignorehitpause	= 1

;------------------- 投げだけ喰らう用、鋼体蓄積ダメージ処理
[State -2, Koutai Damage Add]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= (Var(19) & 8192)
triggerall	= Var(0) > 0
trigger1	= 1
var(5)		= Var(5) + Var(0)
ignorehitpause	= 1

; FVar(0) という鋼体耐え被ダメを判定に加えてるが大丈夫か？
[State -2, Koutai Damage Add Exception]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= (Var(19) & 8192)
triggerall	= Var(0) > 0
trigger1	= (Var(13) < 2*1/1) || (Var(13) - Var(0) <= 0) || (Var(13) - FVar(0) <= 0) || (Life <= 1)
var(5)		= 82*1/1
ignorehitpause	= 1

[State -2, Koutai Damage Limit Decrease Helper]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= (Var(19) & 8192)
triggerall	= Var(0) > 0
triggerall	= Var(5) >= 82*1/1
triggerall	= !(Var(18) & 1008)
triggerall	= NumHelper(30000)
trigger1	= Helper(30000),Var(3)
trigger2	= Helper(30000),Var(7)
var(19)		= (Var(19) | 1024)
ignorehitpause	= 1

[State -2, Koutai Damage Limit Decrease Timer]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= (Var(19) & 8192)
triggerall	= Var(0) > 0
triggerall	= Var(5) >= 82*1/1
triggerall	= !(Var(19) & 1024)
trigger1	= (Var(18) & 1008)
var(18)		= (Var(18) | 1008) - 1008
ignorehitpause	= 1

[State -2, Koutai Damage Decrease Buffer]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= (Var(19) & 8192)
triggerall	= Var(0) > 0
trigger1	= Var(5) >= 82*1/1
var(19)		= (Var(19) | 2048)
ignorehitpause	= 1

[State -2, Koutai Damage Decrease]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= (Var(19) & 8192)
triggerall	= Var(0) > 0
trigger1	= Var(5) >= 82*1/1
var(5)		= 0
ignorehitpause	= 1

;------------------- 鋼体演出

;---------------------- やられ時に強く光る用 --------------------------
[State -2, PlaySnd]
type		= PlaySnd
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= RoundState <= 2
triggerall	= Alive
triggerall	= !(Var(32) & 8126464)
triggerall	= StateNo != 120
; 強制鋼体当身を出す、かつ、やられ状態
trigger1	= (Var(16) & 268435456) && (Var(1) & 16384)
; 鋼体当身を出す、かつ、やられ状態
trigger2	= (Var(1) & 262144) && (Var(1) & 16384)
; 鋼体中に強制復帰した瞬間
trigger3	= (MoveType = H || MoveReversed) && (Var(1) & 16384) && (Var(1) & 1048576) && (Var(1) & 4)
; 強制的に鋼体を減らす命令が出た瞬間
trigger4	= (Var(19) & 1024)
value		= 2080, 2
volume		= 125
ignorehitpause	= 1

[State -2, PalFX]
type		= PalFX
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= RoundState <= 3
triggerall	= Alive
triggerall	= !(Var(32) & 8126464)
triggerall	= StateNo != 120
; 強制鋼体当身を出す、かつ、やられ状態
trigger1	= (Var(16) & 268435456) && (Var(1) & 16384)
; 鋼体当身を出す、かつ、やられ状態
trigger2	= (Var(1) & 262144) && (Var(1) & 16384)
; 鋼体中に強制復帰した瞬間
trigger3	= (MoveType = H || MoveReversed) && (Var(1) & 16384) && (Var(1) & 1048576) && (Var(1) & 4)
; 強制的に鋼体を減らす命令が出た瞬間
trigger4	= (Var(19) & 1024)
add			= 192, 0, 0
sinadd		= -128, 0, 0, 80
time		= 20
ignorehitpause	= 1

[State -2, PalFX Counter Set]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= RoundState <= 3
triggerall	= Alive
triggerall	= !(Var(32) & 8126464)
triggerall	= StateNo != 120
; 強制鋼体当身を出す、かつ、やられ状態
trigger1	= (Var(16) & 268435456) && (Var(1) & 16384)
; 鋼体当身を出す、かつ、やられ状態
trigger2	= (Var(1) & 262144) && (Var(1) & 16384)
; 鋼体中に強制復帰した瞬間
trigger3	= (MoveType = H || MoveReversed) && (Var(1) & 16384) && (Var(1) & 1048576) && (Var(1) & 4)
; 強制的に鋼体を減らす命令が出た瞬間
trigger4	= (Var(19) & 1024)
var(32)		= (Var(32) | 8126464) - 8126464 + 20*262144
ignorehitpause	= 1
;---------------------- やられ時に強く光る用 --------------------------

;---------------------- うっすら光る用 --------------------------------
[State -2, PalFX]
type		= PalFX
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= RoundState <= 3
triggerall	= Alive
triggerall	= !(Var(32) & 8126464)
triggerall	= !(Var(32) & 260046848)
trigger1	= (Var(1) & 1048576)
add			= 64, 64, 0
sinadd		= -64, -64, 0, 8
time		= 4
ignorehitpause	= 1

[State -2, PalFX Counter Set]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= RoundState <= 3
triggerall	= Alive
triggerall	= !(Var(32) & 8126464)
triggerall	= !(Var(32) & 260046848)
trigger1	= (Var(1) & 1048576)
var(32)		= (Var(32) | 260046848) - 260046848 + 4*8388608
ignorehitpause	= 1
;---------------------- うっすら光る用 --------------------------------

;------------------- やられSE
[State -2, Damage End SE Flag Set]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= !(Var(1) & 1048576) ; 鋼体中はダメージを受けない
triggerall	= Alive
trigger1	= !(Var(1) & 1024) && ((MoveType = H && (Var(1) & 16384)) && (Var(26) & 1572864) != 1572864 / 3 * 2) && !Ctrl && !(StateNo = [150, 155])
trigger2	= (Var(1) & 1024) && !(Var(26) & 4194304)
trigger3	= (Var(18) & 1073741824) && !(Var(26) & 33554432)
var(1)		= (Var(1) | 32768)
ignorehitpause	= 1

; ステート奪取され中用
[State -2, Damage SE Type]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= 1
var(58)		= IfElse( (FVar(39) >= 35*1/1) || (FVar(39) >= 30*1/1 && Random < 500), 5200, IfElse((FVar(39) >= 22*1/1) || (FVar(39) >= 18*1/1 && Random < 500), 5100, 5000) )
ignorehitpause	= 1

[State -2, Damage SE Play]
type		= PlaySnd
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= RoundState < 3
triggerall	= Alive
triggerall	= Var(13) > 0
trigger1	= (Var(1) & 16384) && (Var(1) & 1024)
trigger1	= FVar(0) >= 10*1/1
trigger1	= Random < 500.0 + 500.0 * (FVar(0) / (125.0*1/1))*(FVar(0) / (125.0*1/1))
value		= Var(58), Random % ( IfElse( Var(58) = 5200, 3, 4 ) )
channel		= 0
volume		= 200
ignorehitpause	= 1

; 鋼体耐え用
[State -2, Damage SE Type]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= FVar(39) > 0
var(58)		= IfElse( (FVar(39) >= 35*1/1) || (FVar(39) >= 28*1/1 && Random < 500), 5200, IfElse((FVar(39) >= 23*1/1) || (FVar(39) >= 16*1/1 && Random < 500), 5100, 5000) )
ignorehitpause	= 1

[State -2, Damage SE Play]
type		= PlaySnd
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= RoundState < 3
triggerall	= Alive
triggerall	= Var(13) > 0
trigger1	= FVar(39) >= 10*1/1
trigger1	= Random < 250.0 + 750.0 * (FVar(39) / (36.0*1/1))*(FVar(39) / (36.0*1/1))
value		= Var(58), Random % ( IfElse( Var(58) = 5200, 3, 4 ) )
channel		= 0
volume		= 200
ignorehitpause	= 1

; ダメージ状態からの復帰用
[State -2, Damage End SE Play]
type		= PlaySnd
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= (Var(1) & 32768)
triggerall	= Alive
triggerall	= (Var(14) >= 60*1/1) && (Random < Ceil(450 + 550.0 * (Var(14) - 60.0*1/1) * 1.0 / (300.0*1/1 - 60.0*1/1)))
trigger1	= StateType = L && MoveType = I && (Anim = [5120, 5129])
trigger2	= !Ctrl && MoveType = I
trigger2	= !(Var(1) & 1024) && ((Var(3) & 131071) = [5130, 5139])
value		= 5200, 3 + (Var(14) >= 250*1/1)
channel		= 0
volume		= 200
ignorehitpause	= 1

[State -2, Damage End SE Play]
type		= PlaySnd
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= (Var(1) & 32768)
triggerall	= Alive
triggerall	= (Var(14) >= 110*1/1) && (Random < Ceil(250 + 750.0 * (Var(14) - 110.0*1/1) * 1.0 / (300.0*1/1 - 110.0*1/1)))
trigger1	= StateType != L && !(Var(1) & 16384) && Ctrl
value		= 5200, 3 + (Var(14) >= 250*1/1)
channel		= 0
volume		= 200
ignorehitpause	= 1

[State -2, Damage End SE Flag Reset]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= StateType = L && MoveType = I && (Anim = [5120, 5129])
trigger2	= !Ctrl && MoveType = I
trigger2	= !(Var(1) & 1024) && ((Var(3) & 131071) = [5130, 5139])
trigger3	= StateType != L && !(Var(1) & 16384) && Ctrl
trigger4	= !Ctrl && MoveType = I
trigger4	= !(Var(1) & 1024) && ((Var(3) & 131071) = [5200, 5219])
var(1)		= (Var(1) | 32768) - 32768
ignorehitpause	= 1

;------------------- F1やF2や即死打撃or即死投げで死ぬ用
; ステート奪取鋼体用に、鋼体中は死なないようにしたいです。
; なのでちょっと不具合が残りますが、これ以下3個の記述。
[State -2, F1F2 Damage Add]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= !(Var(22) & 1024) && !(Var(1) & 16384)
triggerall	= ((Var(13) > 1*1/1) && !(Var(19) & 8192)) || !(Var(1) & 1048576)
trigger1	= Life <= 1
var(13)		= Life*1/1
ignorehitpause	= 1

; 死に用
[State -2, Damage 0 Set]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= !Alive && Life <= 0
var(13)		= 0
ignorehitpause	= 1

;------------------- 死にSE
[State -2, Dead SE]
type		= PlaySnd
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= !Alive
trigger1	= !(Var(16) & 1073741824)
value		= 5300, Random % 2
;channel		= 0
volume		= 200
ignorehitpause	= 1

[State -2, Alive]
type		= VarSet
triggerall	= !IsHelper
trigger1	= !(Var(16) & 1073741824)
var(16)		= (Var(16) | 1073741824) - 1073741824 * Alive
ignorehitpause	= 1

;------------------- lerp
[State -2, Lerp]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= Var(13) < 0
var(13)		= 0
ignorehitpause	= 1

[State -2, Lerp]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= Var(12) < Var(13)
var(13)		= Var(12)
ignorehitpause	= 1

;---------------------------------------------------------------------
; Life補正回りのデファイン
;---------------------------------------------------------------------
; LifeMax=1000とした時の、防御力補正が終了する体力の値
; 値の範囲は 0〜1000
[State -2, Correct Life End]
type		= VarSet
triggerall	= !IsHelper
trigger1	= 1
var(54)		= 250
ignorehitpause	= 1

; LifeMax=1000とした時の、防御力補正が開始する体力の値
; 値の範囲は 0〜1000
[State -2, Correct Life Start]
type		= VarSet
triggerall	= !IsHelper
trigger1	= 1
var(55)		= 750
ignorehitpause	= 1

; 防御力補正が最大に働いた時に何倍になるか？
; 値の範囲は 1.0 以上 
[State -2, Correct Life Rate Value]
type		= VarSet
triggerall	= !IsHelper
trigger1	= 1
fvar(38)	= 2.0
ignorehitpause	= 1

; 真の最大HPは、見掛け最大HPの何倍か？
[State -2, True Life Rate]
type		= VarSet
triggerall	= !IsHelper
trigger1	= 1
fvar(37)	= ( 1000-Var(55) + (Var(55)-Var(54))*0.5*(1.0 + FVar(38)) + Var(54)*FVar(38) ) / 1000.0
ignorehitpause	= 1

;------------------- 見かけの体力増減処理
[State -2, Correct Life Start]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= 1
var(58)		= Ceil( Var(12) * ( 1.0 - (1000-Var(55))/1000.0/FVar(37) ) )
ignorehitpause	= 1

[State -2, Correct Life End]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= 1
var(56)		= Ceil( Var(12) * ( Var(54)/1000.0*FVar(38)/FVar(37) ) )
ignorehitpause	= 1

[State -2, Temp]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= 1
fvar(39)	= Var(55) - Var(54)
ignorehitpause	= 1



; 式

;Var(13) = Var(58) - (2 + (DM-1)*((Var(55)-Life*1000/LifeMax)/(Var(55)-Var(54)))*0.5/FVar(37) *(Var(55)-Life*1000/LifeMax) *Var(12)/1000

;Var(58)-Var(13) - (2 + (DM-1)*((Var(55)-Life*1000/LifeMax)/(Var(55)-Var(54)))*0.5/FVar(37) *(Var(55)-Life*1000/LifeMax) *Var(12)/1000
;-(2 + (DM-1)*((Var(55)-Life*1000/LifeMax)/(Var(55)-Var(54)))*0.5/FVar(37) *(Var(55)-Life*1000/LifeMax) + (Var(58)-Var(13))*1000/Var(12)
;-(2 + (DM-1)*((Var(55)-Life*1000/LifeMax)/(Var(55)-Var(54))) *(Var(55)-Life*1000/LifeMax) + 2*FVar(37)*(Var(58)-Var(13))*1000/Var(12)
;-2*(Var(55)-Life) -(DM-1)/(Var(55)-Var(54))*(Var(55)-Life*1000/LifeMax)*(Var(55)-Life*1000/LifeMax) + 2*FVar(37)*(Var(58)-Var(13))*1000/Var(12)
;(DM-1)/(Var(55)-Var(54))*(Var(55)-Life*1000/LifeMax)*(Var(55)-Life*1000/LifeMax) + 2*(Var(55)-Life*1000/LifeMax) - 2*FVar(37)*(Var(58)-Var(13))*1000/Var(12)
;(DM-1)*(Var(55)-Life*1000/LifeMax)*(Var(55)-Life*1000/LifeMax) + 2*(Var(55)-Var(54))*(Var(55)-Life*1000/LifeMax) - 2*FVar(37)*(Var(55)-Var(54))*(Var(58)-Var(13))*1000/Var(12)

;解の公式で解くと
;(Var(55)-Life*1000/LifeMax) = (-2*(Var(55)-Var(54)) + (4*(Var(55)-Var(54))*(Var(55)-Var(54)) + 8*(DM-1)*FVar(37)*(Var(55)-Var(54))*(Var(58)-Var(13))*1000/Var(12))**(0.5)) / (2*(DM-1))
;Life = ( Var(55) - ( -2*(Var(55)-Var(54)) + ( 4*(Var(55)-Var(54))*(Var(55)-Var(54)) + 8*(DM-1)*FVar(37)*(Var(55)-Var(54))*(Var(58)-Var(13))*1000/Var(12) )**(0.5) ) / (2*(DM-1)) )*LifeMax/1000



[State -2, Total Damage Correct No]	; 実質ダメージが補正開始体力に至ってない場合
type		= LifeSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= Var(0) >= 0 && Var(13) > 0
trigger1	= Var(13) >= Var(58)
value		= Ceil( LifeMax*( (Var(13)-Var(58))/(1.0*(Var(12)-Var(58))) *(1000-Var(55)) + Var(55) )/1000.0 )
ignorehitpause	= 1

[State -2, Total Damage Correct Start]	; 実質ダメージが補正開始体力に至った場合
type		= LifeSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= Var(0) >= 0 && Var(13) > 0
trigger1	= Var(58) > Var(13) && Var(13) >= Var(56)
value		= Ceil( LifeMax*( Var(55) - ( -2.0*FVar(39) + ( 4.0*FVar(39)*FVar(39) + 8.0*(FVar(38)-1.0)*FVar(37)*FVar(39)*(Var(58)-Var(13))*1000.0/(1.0*Var(12)) )**(0.5) ) /(2.0*(FVar(38)-1.0)) )/1000.0 )
ignorehitpause	= 1

[State -2, Total Damage Correct End]	; 実質ダメージが補正終了体力に至った場合
type		= LifeSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= Var(0) >= 0 && Var(13) > 0
trigger1	= Var(56) > Var(13)
value		= Ceil( LifeMax*( Var(13)/(1.0*Var(56)) *Var(54) )/1000.0 )
ignorehitpause	= 1

[State -2, Total Damage Correct]	; 真HPに変動が無いのに、見かけのHPが減らないようにする
type		= LifeSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= Var(0) >= 0 && Var(13) = Var(57)
trigger1	= Life < Var(17)
value		= Var(17)
ignorehitpause	= 1

[State -2, Total Damage Correct]	; 一応0 or 1になるように保険
type		= LifeSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= Var(0) >= 0
trigger1	= Var(13) <= 1*1/1 || Life <= 0
value		= 0 + (Var(13) > 0)
ignorehitpause	= 1

;------------------- 回復処理
[State -2, True Life No]	; 見かけHPが補正開始体力を超えた時用
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= Var(0) < 0
triggerall	= Life >= 0
trigger1	= Life >= LifeMax*Var(55)/1000.0
var(13)		= Floor( (Life*1000/(1.0*LifeMax) - Var(55))/(1.0*(1000-Var(55))) *(Var(12)-Var(58)) + Var(58) )
ignorehitpause	= 1

[State -2, True Life Start]	; 見かけHPが補正開始〜終了体力の範囲内用
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= Var(0) < 0
triggerall	= Life >= 0
trigger1	= LifeMax*Var(55)/1000.0 > Life && Life >= LifeMax*Var(54)/1000.0
var(13)		= Floor( Var(58) - ( (2.0 + (FVar(38)-1.0) *((Var(55)-Life*1000.0/(1.0*LifeMax))/FVar(39))) *0.5/FVar(37) *(Var(55)-Life*1000.0/(1.0*LifeMax)) *Var(12)/1000.0 ) )
ignorehitpause	= 1

[State -2, True Life End]	; 見かけHPが補正終了体力の範囲内用
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= Var(0) < 0
triggerall	= Life >= 0
trigger1	= LifeMax*Var(54)/1000.0 > Life
var(13)		= Floor( Life/(LifeMax*Var(54)/1000.0) *Var(56) )
ignorehitpause	= 1

;------------------- lerp
[State -2, Lerp]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= Var(13) < 0
var(13)		= 0
ignorehitpause	= 1

[State -2, Lerp]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= Var(12) < Var(13)
var(13)		= Var(12)
ignorehitpause	= 1

;------------------- 鋼体中における瀕死時のLife補正
[State -2, Life Correct During Koutai]
type		= LifeSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= (Var(1) & 1048576)
trigger1	= Life = 1
value		= 2
ignorehitpause	= 1

;------------------- 旧体力保持
[State -2, Life Copy]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= 1
var(6)		= Life
ignorehitpause	= 1

[State -2, Life Copy]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= 1
var(17)		= Life
ignorehitpause	= 1

;---------------------------------------------------------------------
; Life補正回りのデファイン
;---------------------------------------------------------------------
; LifeMax<1000になった時用のLifeMax値
[State -2, LifeMax]
type		= VarSet
triggerall	= !IsHelper
trigger1	= 1
fvar(38)	= IfElse( LifeMax > 1000, LifeMax, 1000 )
ignorehitpause	= 1

;---------------------------------------------------------------------
; パワーゲージ上昇倍率
;---------------------------------------------------------------------
[State -2, Power Rate Init]
type		= VarSet
triggerall	= !IsHelper
trigger1	= 1
fvar(5)		= 1.0
ignorehitpause	= 1

[State -2, Power Rate Correct]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= NumHelper(20000)
fvar(5)		= FVar(5) * Helper(20000),FVar(2)
ignorehitpause	= 1

;------------------- 残Life補正による、パワーゲージ上昇倍率
[State -2, Power Rate Correct Life]
type		= VarSet
triggerall	= !IsHelper
triggerall	= !Var(50)
trigger1	= 1
fvar(5)		= FVar(5) * IfElse( Var(17) >= FVar(38)*Var(55)/1000.0, 1.0, IfElse(Var(17) > FVar(38)*Var(54)/1000.0, 1.0 + 0.125*(1.0 - 1.0*(Var(17) - FVar(38)*Var(54)/1000.0)/(FVar(38)*Var(55)/1000.0 - FVar(38)*Var(54)/1000.0)), 1.125) )
ignorehitpause	= 1

;------------------- 喰らいによるゲージ増加
[State -2, Get Power]
type		= VarSet
triggerall	= !IsHelper
trigger1	= 1
var(57)		= 0
ignorehitpause	= 1

[State -2, Get Power]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
; F1やF2用
triggerall	= !( !(Var(22) & 1024) && !(Var(1) & 16384) && Life <= (1 + !!(Var(1) & 1048576)) )
triggerall	= Var(53) > 0
trigger1	= Const(data.power) > 0
var(57)		= Ceil( Var(53) / (1.0*1/1) * FVar(5) * 0.9375 * IfElse((Var(32) & 7) < 4, 1.25, 1.0) * IfElse(PowerMax<Const(data.power),PowerMax,Const(data.power))/(1.0*Const(data.power)) )
ignorehitpause	= 1

[State -2, PowerAdd]
type		= PowerAdd
triggerall	= !IsHelper
trigger1	= Var(57)
value		= Var(57)
ignorehitpause	= 1

;---------------------------------------------------------------------
;  通常打撃用の前処理
;---------------------------------------------------------------------
;------------------- 通常打撃
[State -2, Direct Damage Value]	; ダメージを記憶
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= 1
var(0)		= GetHitVar(damage)
ignorehitpause	= 1

[State -2, Direct Damage Value Lerp]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= LifeMax <= Var(0)
trigger2	= Var(0) <= -LifeMax
var(0)		= IfElse( Var(0) < 0, -LifeMax, LifeMax )
ignorehitpause	= 1

;------------------- 防御倍率
; 防御力補正が入る前の値を保存
[State -2, Direct Damage Value Buf]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= 1
var(58)		= Var(0)
ignorehitpause	= 1

; 総ダメージ側
[State -2, Damage]
type		= VarSet
triggerall	= !IsHelper
trigger1	= 1
var(57)		= 0
ignorehitpause	= 1

[State -2, Damage]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= NumHelper(20000)
trigger1	= Var(0) > 0
var(57)		= Floor(Var(0)/Helper(20000),FVar(1)) + ((Floor(Var(0)/Helper(20000),FVar(1)*1000))%1000 > Random)
ignorehitpause	= 1

[State -2, Damage]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= NumHelper(20000)
trigger1	= Var(0) > 0
var(0)		= IfElse( 0 <= Var(57) && Var(57) < Var(12), Var(57), Var(12) )
ignorehitpause	= 1

; 大きい方のダメージを使うようにする
[State -2, Damage]
type		= VarSet
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= Var(58) > Var(0)
var(0)		= Var(58)
ignorehitpause	= 1

;------------------- ガードによるゲージ増加
[State -2, Get Power]
type		= VarSet
triggerall	= !IsHelper
trigger1	= 1
var(57)		= 0
ignorehitpause	= 1

[State -2, Get Power]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= (MoveType = H && (Var(1) & 16384))
triggerall	= StateNo = 150 || StateNo = 152 || StateNo = 154
triggerall	= Time = 0
triggerall	= GetHitVar(ctrltime) > 0
trigger1	= Const(data.power) > 0
var(57)		= Ceil( 12 * FVar(5) * 0.9375 * IfElse((Var(32) & 7) < 4, 1.25, 1.0) * IfElse(PowerMax<Const(data.power),PowerMax,Const(data.power))/(1.0*Const(data.power)) )
ignorehitpause	= 1

[State -2, PowerAdd]
type		= PowerAdd
triggerall	= !IsHelper
trigger1	= Var(57)
value		= Var(57)
ignorehitpause	= 1

;------------------- 鋼体中のガードによるゲージ増加
[State -2, Get Power]
type		= VarSet
triggerall	= !IsHelper
trigger1	= 1
var(57)		= 0
ignorehitpause	= 1

[State -2, Get Power]
type		= VarSet
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= (MoveType = H && (Var(1) & 16384))
triggerall	= StateNo = 150 || StateNo = 152 || StateNo = 154
triggerall	= (Var(1) & 1048576)
triggerall	= Time = 0
triggerall	= GetHitVar(ctrltime) > 0
trigger1	= Const(data.power) > 0
var(57)		= Ceil( 40 * FVar(5) * 0.9375 * IfElse((Var(32) & 7) < 4, 1.25, 1.0) * IfElse(PowerMax<Const(data.power),PowerMax,Const(data.power))/(1.0*Const(data.power)) )
ignorehitpause	= 1

[State -2, PowerAdd]
type		= PowerAdd
triggerall	= !IsHelper
trigger1	= Var(57)
value		= Var(57)
ignorehitpause	= 1

;------------------- 鋼体中の通常打撃によるダメージ分のゲージ増加
[State -2, Get Power]
type		= VarSet
triggerall	= !IsHelper
trigger1	= 1
var(57)		= 0
ignorehitpause	= 1

[State -2, Get Power]
type		= VarSet
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= (Var(1) & 1048576)
triggerall	= Var(0) > 0
trigger1	= Const(data.power) > 0
var(57)		= Ceil( Var(0) / (1.0*1/1) * FVar(5) * 0.9375 * IfElse((Var(32) & 7) < 4, 1.25, 1.0) * IfElse(PowerMax<Const(data.power),PowerMax,Const(data.power))/(1.0*Const(data.power)) )
ignorehitpause	= 1

[State -2, PowerAdd]
type		= PowerAdd
triggerall	= !IsHelper
trigger1	= Var(57)
value		= Var(57)
ignorehitpause	= 1

;------------------- 総ダメージ、ダメージ無視
[State -2, Damage NotHit]
type		= NotHitBy
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= Alive
triggerall	= !(Var(1) & 1048576)
triggerall	= (Var(32) & 7) < 4 && (Var(20) & 1047552)
trigger1	= (Var(20) & 1047552) / 1024*1/1 <= Var(0)
value2		= SCA
time		= 60
ignorehitpause	= 1

[State -2, Damage NotHit]
type		= LifeSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= (Var(22) & 128)
triggerall	= Alive
triggerall	= !(Var(1) & 1048576)
triggerall	= (Var(32) & 7) < 4 && (Var(20) & 1047552)
trigger1	= (Var(20) & 1047552) / 1024*1/1 <= Var(0)
value		= LifeMax
ignorehitpause	= 1

[State -2, Damage NotHit]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= (Var(22) & 128)
triggerall	= Alive
triggerall	= !(Var(1) & 1048576)
triggerall	= (Var(32) & 7) < 4 && (Var(20) & 1047552)
trigger1	= (Var(20) & 1047552) / 1024*1/1 <= Var(0)
var(6)		= LifeMax
ignorehitpause	= 1

[State -2, Damage NotHit]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= (Var(22) & 128)
triggerall	= Alive
triggerall	= !(Var(1) & 1048576)
triggerall	= (Var(32) & 7) < 4 && (Var(20) & 1047552)
trigger1	= (Var(20) & 1047552) / 1024*1/1 <= Var(0)
var(13)		= Var(12)
ignorehitpause	= 1

[State -2, VarSet]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= Alive
triggerall	= !(Var(1) & 1048576)
triggerall	= (Var(32) & 7) < 4 && (Var(20) & 1047552)
trigger1	= (Var(20) & 1047552) / 1024*1/1 <= Var(0)
var(1)		= (Var(1) | 4)
ignorehitpause	= 1

[State -2, VarSet]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= Alive
triggerall	= !(Var(1) & 1048576)
triggerall	= (Var(32) & 7) < 4 && (Var(20) & 1047552)
triggerall	= (Var(18) & 1008) < 1008 / 63 * 60
trigger1	= (Var(20) & 1047552) / 1024*1/1 <= Var(0)
var(18)		= (Var(18) | 1008) - 1008 + 1008 / 63 * 60
ignorehitpause	= 1

[State -2, Debug]
type		= Null;AppendToClipboard
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= Alive
triggerall	= !(Var(1) & 1048576)
triggerall	= (Var(32) & 7) < 4 && (Var(20) & 1047552)
trigger1	= (Var(20) & 1047552) / 1024*1/1 <= Var(0)
text		= "Error %d "
params		= GetHitVar(damage)
ignorehitpause	= 1

[State -2, Damage NotHit]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= Alive
triggerall	= !(Var(1) & 1048576)
triggerall	= (Var(32) & 7) < 4 && (Var(20) & 1047552)
trigger1	= (Var(20) & 1047552) / 1024*1/1 <= Var(0)
var(0)		= 0
ignorehitpause	= 1

;------------------- 試合決着以降はMoveType=Hでもダメージ処理を行わないらしい
[State -2, Round Conclusion No Damage]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= RoundState > 2
var(0)		= 0
ignorehitpause	= 1

[State -2, Round Conclusion No Damage]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= RoundState > 2
var(58)		= 0
ignorehitpause	= 1

;------------------- 即死打撃で死ぬ用
[State -2, Damage Add]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= RoundState < 3
triggerall	= (Var(32) & 7) >= 4
triggerall	= !(Var(1) & 1048576) && !(Var(1) & 4)
trigger1	= Life - Var(58) <= 1
var(0)		= 0
ignorehitpause	= 1

;------------------- 補正が掛かる場合このフレームで死なないように、ダメージ分を足す
[State -2, Direct Damage LifeAdd]
type		= VarAdd
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= !(Var(1) & 4)
triggerall	= Var(0) > 0
trigger1	= Life > 1
trigger2	= Life > 0 && (Var(1) & 1048576)
var(6)		= Var(58)
ignorehitpause	= 1

[State -2, Direct Damage LifeAdd]
type		= LifeAdd
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= !(Var(1) & 4)
triggerall	= Var(0) > 0
trigger1	= Life > 1
trigger2	= Life > 0 && (Var(1) & 1048576)
value		= Var(58)
absolute	= 1
ignorehitpause	= 1

;---------------------------------------------------------------------
; バグステート無限硬直リセット
;---------------------------------------------------------------------
[State -2, Bug Loop State Reset]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= NumHelper(20000)
triggerall	= (Var(32) & 7) < 4 && Helper(20000),Var(16) > 0
triggerall	= (Var(19) & 131072)
triggerall	= RoundState < 4 && Alive
trigger1	= !Ctrl && Time >= Helper(20000),Var(16)
trigger2	= MoveReversed && HitPauseTime >= Helper(20000),Var(16)
var(1)		= (Var(1) | 4)
ignorehitpause	= 1

[State -2, Debug]
type		= AppendToClipboard
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= NumHelper(20000)
triggerall	= (Var(32) & 7) < 4 && Helper(20000),Var(16) > 0
triggerall	= (Var(19) & 131072)
triggerall	= RoundState < 4 && Alive
trigger1	= !Ctrl && Time >= Helper(20000),Var(16)
trigger2	= MoveReversed && HitPauseTime >= Helper(20000),Var(16)
text		= "Bug Loop State Reset "
ignorehitpause	= 1

;---------------------------------------------------------------------
; HitOverrideペナルティ
;---------------------------------------------------------------------
;------------------- ペナルティ
[State -2, HitOverride Penalty]
type		= VarSet
triggerall	= !IsHelper
triggerall	= !Var(50)
triggerall	= (Var(22) & 512)
triggerall	= Var(30)
; 存在しない
trigger1	= !PlayerIDExist(Var(30))
; 特定のヒットストップ中は省く
trigger2	= PlayerID(Var(30)),MoveType != H
trigger2	= !(((Var(2) & 131071) = [220, 229]) && (AnimElemTime(3) <= 0))
trigger2	= !(((Var(2) & 131071) = [230, 239]) && (AnimElemTime(3) <= 0))
trigger2	= !(((Var(2) & 131071) = [520, 529]) && (AnimElemTime(3) <= 0))
trigger2	= !(((Var(2) & 131071) = [530, 539]) && (AnimElemTime(3) <= 0))
trigger2	= !((Var(2) & 131071) = [1100, 1119])
trigger2	= !((Var(2) & 131071) = [1200, 1209])
trigger2	= !((Var(2) & 131071) = [1300, 1309])
trigger2	= !((Var(2) & 131071) = [1610, 1611])
trigger2	= !((Var(2) & 131071) = [3000, 3019])
trigger2	= !((Var(2) & 131071) = [3100, 3119])
trigger2	= !((Var(2) & 131071) = [3200, 3209])
trigger2	= !((Var(2) & 131071) = [3300, 3309])
trigger2	= MoveHit
; 飛び道具中
trigger3	= PlayerID(Var(30)),MoveType != H
trigger3	= (ProjHit = 1, = 1)
var(1)		= (Var(1) | 524288)
ignorehitpause	= 1

;------------------- ターゲット検索
[State -2, VarSet]
type		= VarSet
triggerall	= !IsHelper
trigger1	= 1
var(58)		= 0
ignorehitpause	= 1

[State -2, VarSet]
type		= VarSet
triggerall	= !IsHelper
trigger1	= ProjHitTime(1800) = 0
var(58)		= 1
ignorehitpause	= 1

[State -2, Hit TargetID Reset]
type		= VarSet
triggerall	= !IsHelper
triggerall	= !Var(50)
trigger1	= 1
var(30)		= -1
ignorehitpause	= 1

[State -2, Hit TargetID Normal Hit Check]
type		= VarSet
triggerall	= !IsHelper
triggerall	= !Var(50)
triggerall	= Var(30) = -1
triggerall	= (Var(1) & 512)
trigger1	= NumTarget(10 + (Var(16) & 240)/16)
var(30)		= IfElse( !Target(10 + (Var(16) & 240)/16),IsHelper, Target(10 + (Var(16) & 240)/16),ID, -2 )
ignorehitpause	= 1

[State -2, Hit TargetID Projectile Hit Check]
type		= VarSet
triggerall	= !IsHelper
triggerall	= !Var(50)
triggerall	= Var(30) = -1
triggerall	= Var(58)
trigger1	= NumTarget(1 + (Var(19) & 3)/1)
var(30)		= IfElse( !Target(1 + (Var(19) & 3)/1),IsHelper, Target(1 + (Var(19) & 3)/1),ID, -2 )
ignorehitpause	= 1

[State -2, Hit TargetID Index]
type		= VarSet
triggerall	= !IsHelper
trigger1	= 1
var(0)		= 0
ignorehitpause	= 1

[State -2, Hit TargetID Set]
type		= VarSet
triggerall	= !IsHelper
triggerall	= !Var(50)
triggerall	= Var(30) = -1
triggerall	= NumEnemy >= Var(0) + 1
triggerall	= EnemyNear(Var(0)),Alive
triggerall	= EnemyNear(Var(0)),MoveType = H
trigger1	= (Var(1) & 512)
trigger2	= Var(58)
var(30)		= EnemyNear(Var(0)),ID
ignorehitpause	= 1

[State -2, Hit TargetID Index]
type		= VarSet
triggerall	= !IsHelper
trigger1	= 1
var(0)		= Var(0) + 1
ignorehitpause	= 1

[State -2, Hit TargetID Set]
type		= VarSet
triggerall	= !IsHelper
triggerall	= !Var(50)
triggerall	= Var(30) = -1
triggerall	= NumEnemy >= Var(0) + 1
triggerall	= EnemyNear(Var(0)),Alive
triggerall	= EnemyNear(Var(0)),MoveType = H
trigger1	= (Var(1) & 512)
trigger2	= Var(58)
var(30)		= EnemyNear(Var(0)),ID
ignorehitpause	= 1

[State -2, Hit TargetID Index]
type		= VarSet
triggerall	= !IsHelper
trigger1	= 1
var(0)		= Var(0) + 1
ignorehitpause	= 1

[State -2, Hit TargetID Set]
type		= VarSet
triggerall	= !IsHelper
triggerall	= !Var(50)
triggerall	= Var(30) = -1
triggerall	= NumEnemy >= Var(0) + 1
triggerall	= EnemyNear(Var(0)),Alive
triggerall	= EnemyNear(Var(0)),MoveType = H
trigger1	= (Var(1) & 512)
trigger2	= Var(58)
var(30)		= EnemyNear(Var(0)),ID
ignorehitpause	= 1

[State -2, Hit TargetID Index]
type		= VarSet
triggerall	= !IsHelper
trigger1	= 1
var(0)		= Var(0) + 1
ignorehitpause	= 1

[State -2, Hit TargetID Set]
type		= VarSet
triggerall	= !IsHelper
triggerall	= !Var(50)
triggerall	= Var(30) = -1
triggerall	= NumEnemy >= Var(0) + 1
triggerall	= EnemyNear(Var(0)),Alive
triggerall	= EnemyNear(Var(0)),MoveType = H
trigger1	= (Var(1) & 512)
trigger2	= Var(58)
var(30)		= EnemyNear(Var(0)),ID
ignorehitpause	= 1

[State -2, Hit TargetID Reset]
type		= VarSet
triggerall	= !IsHelper
triggerall	= !Var(50)
trigger1	= Var(30) < 0
var(30)		= 0
ignorehitpause	= 1

;---------------------------------------------------------------------
; 攻撃力補正用、ヒットカウント数制御
;---------------------------------------------------------------------
;------------------- 補正用ヒット数加算
[State -2, HitCount Add]	; 弱攻撃
type		= VarAdd
triggerall	= !IsHelper
triggerall	= !Var(50)
triggerall	= (Var(7) & 16383) <= 16383 - 1600
triggerall	= (Var(1) & 512) && MoveHit = 1
trigger1	= ((Var(2) & 131071) = [200, 219])
trigger2	= ((Var(2) & 131071) = [300, 319])
var(7)		= 1600
ignorehitpause	= 1

[State -2, HitCount Add]	; J弱攻撃とか
type		= VarAdd
triggerall	= !IsHelper
triggerall	= !Var(50)
triggerall	= (Var(7) & 16383) <= 16383 - 2800
triggerall	= (Var(1) & 512) && MoveHit = 1
trigger1	= ((Var(2) & 131071) = [500, 519])
var(7)		= 2800
ignorehitpause	= 1

[State -2, HitCount Add]	; 強攻撃とか
type		= VarAdd
triggerall	= !IsHelper
triggerall	= !Var(50)
triggerall	= (Var(7) & 16383) <= 16383 - 3600
triggerall	= (Var(1) & 512) && MoveHit = 1
trigger1	= ((Var(2) & 131071) = [220, 229]) && !(AnimElemTime(3) <= 0)
trigger2	= ((Var(2) & 131071) = [330, 339])
trigger3	= ((Var(2) & 131071) = [520, 529]) && !(AnimElemTime(3) <= 0)
trigger4	= ((Var(2) & 131071) = [708, 709])
trigger5	= ((Var(2) & 131071) = [740, 749])
trigger6	= ((Var(2) & 131071) = [780, 789])
var(7)		= 3600
ignorehitpause	= 1

[State -2, HitCount Add]	; 立D
type		= VarAdd
triggerall	= !IsHelper
triggerall	= !Var(50)
triggerall	= (Var(7) & 16383) <= 16383 - 3200
triggerall	= (Var(1) & 512) && MoveHit = 1
trigger1	= ((Var(2) & 131071) = [230, 239]) && !(AnimElemTime(3) <= 0)
var(7)		= 3200
ignorehitpause	= 1

[State -2, HitCount Add]	; 屈C
type		= VarAdd
triggerall	= !IsHelper
triggerall	= !Var(50)
triggerall	= (Var(7) & 16383) <= 16383 - 4000
triggerall	= (Var(1) & 512) && MoveHit = 1
trigger1	= ((Var(2) & 131071) = [320, 329])
var(7)		= 4000
ignorehitpause	= 1

[State -2, HitCount Add]	; JD
type		= VarAdd
triggerall	= !IsHelper
triggerall	= !Var(50)
triggerall	= (Var(7) & 16383) <= 16383 - 3600 / (2.0 ** ((HitCount>1)*(HitCount-1)))
triggerall	= (Var(1) & 512) && MoveHit = 1
trigger1	= ((Var(2) & 131071) = [530, 539]) && !(AnimElemTime(3) <= 0)
var(7)		= Floor( 3600 / (2.0 ** ((HitCount>1)*(HitCount-1))) )
ignorehitpause	= 1

[State -2, HitCount Add]	; CDとか
type		= VarAdd
triggerall	= !IsHelper
triggerall	= !Var(50)
triggerall	= (Var(7) & 16383) <= 16383 - 4000
triggerall	= (Var(1) & 512) && MoveHit = 1
trigger1	= ((Var(2) & 131071) = [605, 609])
trigger2	= ((Var(2) & 131071) = [620, 624])
var(7)		= 4000
ignorehitpause	= 1

[State -2, HitCount Add]	; 溜めCDとか
type		= VarAdd
triggerall	= !IsHelper
triggerall	= !Var(50)
triggerall	= (Var(7) & 16383) <= 16383 - 4500
triggerall	= (Var(1) & 512) && MoveHit = 1
trigger1	= ((Var(2) & 131071) = [600, 604])
trigger2	= ((Var(2) & 131071) = [610, 615])
var(7)		= 4500
ignorehitpause	= 1

[State -2, HitCount Add]	; GCCDとか
type		= VarAdd
triggerall	= !IsHelper
triggerall	= !Var(50)
triggerall	= (Var(7) & 16383) <= 16383 - 1000
triggerall	= (Var(1) & 512) && MoveHit = 1
trigger1	= ((Var(2) & 131071) = [4300, 4399])
var(7)		= 1000
ignorehitpause	= 1

[State -2, HitCount Add]	; 3A
type		= VarAdd
triggerall	= !IsHelper
triggerall	= !Var(50)
triggerall	= (Var(7) & 16383) <= 16383 - 2000 / (2.0 ** ((HitCount>1)*(HitCount-1)))
triggerall	= (Var(1) & 512) && MoveHit = 1
trigger1	= ((Var(2) & 131071) = [710, 719])
var(7)		= Floor( 2000 / (2.0 ** ((HitCount>1)*(HitCount-1))) )
ignorehitpause	= 1

[State -2, HitCount Add]	; 6Bとか
type		= VarAdd
triggerall	= !IsHelper
triggerall	= !Var(50)
triggerall	= (Var(7) & 16383) <= 16383 - 2450
triggerall	= (Var(1) & 512) && MoveHit = 1
trigger1	= ((Var(2) & 131071) = [720, 729])
trigger2	= ((Var(2) & 131071) = [730, 739])
var(7)		= 2450
ignorehitpause	= 1

[State -2, HitCount Add]	; 派生Aとか
type		= VarAdd
triggerall	= !IsHelper
triggerall	= !Var(50)
triggerall	= (Var(7) & 16383) <= 16383 - 1600
triggerall	= (Var(1) & 512) && MoveHit = 1
trigger1	= ((Var(2) & 131071) = [702, 703])
trigger2	= ((Var(2) & 131071) = [704, 705])
var(7)		= 1600
ignorehitpause	= 1

[State -2, HitCount Add]	; 派生C
type		= VarAdd
triggerall	= !IsHelper
triggerall	= !Var(50)
triggerall	= (Var(7) & 16383) <= 16383 - 2450
triggerall	= (Var(1) & 512) && MoveHit = 1
trigger1	= ((Var(2) & 131071) = [706, 707])
var(7)		= 2450
ignorehitpause	= 1

[State -2, HitCount Add]	; 弱突き上げ
type		= VarAdd
triggerall	= !IsHelper
triggerall	= !Var(50)
triggerall	= (Var(7) & 16383) <= 16383 - 2700 / (2.0 ** ((HitCount>1)*(HitCount-1)))
triggerall	= (Var(1) & 512) && MoveHit = 1
trigger1	= ((Var(2) & 131071) = [1400, 1409])
var(7)		= Floor( 2700 / (2.0 ** ((HitCount>1)*(HitCount-1))) )
ignorehitpause	= 1

[State -2, HitCount Add]	; 強突き上げ(途中)
type		= VarAdd
triggerall	= !IsHelper
triggerall	= !Var(50)
triggerall	= (Var(7) & 16383) <= 16383 - 2100
triggerall	= (Var(1) & 512) && MoveHit = 1
trigger1	= ((Var(2) & 131071) = [1410, 1414]) && (AnimElemTime(35) < 0)
var(7)		= 2100
ignorehitpause	= 1

[State -2, HitCount Add]	; 強突き上げ(フィニッシュ)
type		= VarAdd
triggerall	= !IsHelper
triggerall	= !Var(50)
triggerall	= (Var(7) & 16383) <= 16383 - 2100 / (2.0 ** (HitCount>1))
triggerall	= (Var(1) & 512) && MoveHit = 1
trigger1	= ((Var(2) & 131071) = [1410, 1414]) && (0 <= AnimElemTime(35))
trigger2	= ((Var(2) & 131071) = [1415, 1419])
var(7)		= Floor( 2100 / (2.0 ** (HitCount>1)) )
ignorehitpause	= 1

[State -2, HitCount Add]	; 超頭突き
type		= VarAdd
triggerall	= !IsHelper
triggerall	= !Var(50)
triggerall	= (Var(7) & 16383) <= 16383 - 3600 / (2.0 ** (HitCount>1))
triggerall	= (Var(1) & 512) && MoveHit = 1
trigger1	= ((Var(2) & 131071) = [1500, 1529])
var(7)		= Floor( 3600 / (2.0 ** (HitCount>1)) )
ignorehitpause	= 1

[State -2, HitCount Add]	; はたきこみとか
type		= VarAdd
triggerall	= !IsHelper
triggerall	= !Var(50)
triggerall	= (Var(7) & 16383) <= 16383 - 6000
triggerall	= (Var(1) & 512) && MoveHit = 1
trigger1	= ((Var(2) & 131071) = [1630, 1631])
trigger2	= ((Var(2) & 131071) = [1640, 1641])
var(7)		= 6000
ignorehitpause	= 1

[State -2, HitCount Add]	; 突き出し
type		= VarAdd
triggerall	= !IsHelper
triggerall	= !Var(50)
triggerall	= (Var(7) & 16383) <= 16383 - 1000
triggerall	= (Var(1) & 512) && MoveHit = 1
trigger1	= ((Var(2) & 131071) = [1650, 1659])
var(7)		= 1000
ignorehitpause	= 1

[State -2, HitCount Add]	; ぶちかまし
type		= VarAdd
triggerall	= !IsHelper
triggerall	= !Var(50)
triggerall	= (Var(7) & 16383) <= 16383 - 2800
triggerall	= (Var(1) & 512) && MoveHit = 1
trigger1	= ((Var(2) & 131071) = [1700, 1709])
var(7)		= 2800
ignorehitpause	= 1

[State -2, HitCount Add]	; 四股
type		= VarAdd
triggerall	= !IsHelper
triggerall	= !Var(50)
triggerall	= (Var(7) & 16383) <= 16383 - 2800
trigger1	= ProjHitTime(1800) = 0
var(7)		= 2800
ignorehitpause	= 1

[State -2, HitCount Add]	; 五輪突き
type		= ParentVarAdd
triggerall	= IsHelper(60000)
triggerall	= !Var(50)
triggerall	= Root,Var(59) != 1
triggerall	= (Root,Var(7) & 16383) <= 16383 - 4000
trigger1	= (Var(2) = 61901) && MoveHit = 1
var(7)		= 4000
ignorehitpause	= 1

[State -2, HitCount Add]	; 諸手突き
type		= VarAdd
triggerall	= !IsHelper
triggerall	= !Var(50)
triggerall	= (Var(7) & 16383) <= 16383 - 2800
triggerall	= (Var(1) & 512) && MoveHit = 1
trigger1	= ((Var(2) & 131071) = [3400, 3414])
var(7)		= 2800
ignorehitpause	= 1

[State -2, HitCount Add]	; MAX諸手
type		= VarAdd
triggerall	= !IsHelper
triggerall	= !Var(50)
triggerall	= (Var(7) & 16383) <= 16383 - 5500
triggerall	= (Var(1) & 512) && MoveHit = 1
trigger1	= ((Var(2) & 131071) = [3500, 3514])
var(7)		= 5500
ignorehitpause	= 1

[State -2, HitCount Lerp]
type		= VarSet
triggerall	= !IsHelper
triggerall	= !Var(50)
trigger1	= (Var(7) & 16383) > 10000
var(7)		= (Var(7) | 16383) - 16383 + 10000
ignorehitpause	= 1

[State -2, HitCount Lerp]
type		= ParentVarSet
triggerall	= IsHelper(60000)
triggerall	= !Var(50)
trigger1	= (Root,Var(7) & 16383) > 10000
var(7)		= (Root,Var(7) | 16383) - 16383 + 10000
ignorehitpause	= 1

;------------------- 補正用ヒット数リセット
[State -2, HitCount Reset]
type		= VarSet
triggerall	= !IsHelper
triggerall	= !Var(50)
triggerall	= (Var(7) & 16383)
trigger1	= !NumHelper(20000)
trigger2	= Var(31) < 0
trigger2	= (!(Helper(20000),Var(1) & 128) && P2Movetype != H) || ((P2StateNo = 120) || (P2StateNo = [130, 132]) || (P2StateNo = 140) || (P2StateNo = [150, 155]))
trigger3	= Var(31) >= 0
trigger3	= (!(Helper(20000),Var(1) & 128) && Target(Var(31)),MoveType != H) || ((Target(Var(31)),StateNo = 120) || (Target(Var(31)),StateNo = [130, 132]) || (Target(Var(31)),StateNo = 140) || (Target(Var(31)),StateNo = [150, 155]))
trigger4	= ((Var(2) & 131071) = [3700, 3799])
var(7)		= (Var(7) | 16383) - 16383
ignorehitpause	= 1

;---------------------------------------------------------------------
; シールド補正計算
;---------------------------------------------------------------------
;------------------- シールド補正、適用判定
[State -2, Shield Check]
type		= VarSet
triggerall	= !IsHelper
triggerall	= !Var(50)
trigger1	= 1
var(1)		= (Var(1) | 4096) - 4096 * ( IfElse((Var(1) & 4096), !(Var(7) & 16383) && !(Var(16) & 3840), !(Var(7) & 16383) || !(Var(16) & 3840) ) )
ignorehitpause	= 1

[State -2, Shield Check Reset]
type		= VarSet
triggerall	= !IsHelper
triggerall	= !Var(50)
trigger1	= !(Var(7) & 16383) && !(Var(16) & 3840)
trigger2	= ((Var(2) & 131071) = [3700, 3799])
var(1)		= (Var(1) | 4096) - 4096
ignorehitpause	= 1

;---------------------------------------------------------------------
; 摩擦差によるヒットバック倍率
;---------------------------------------------------------------------
[State -2, HitVelCalcInit]
type		= VarSet
triggerall	= !IsHelper
trigger1	= 1
fvar(0)		= 0
ignorehitpause	= 1

[State -2, HitVelCalcInit]
type		= VarSet
triggerall	= !IsHelper
triggerall	= !Var(50)
trigger1	= NumEnemy
fvar(0)		= IfElse( P2StateType != C, EnemyNear,Const(movement.stand.friction), EnemyNear,Const(movement.crouch.friction) )
ignorehitpause	= 1

[State -2, HitVelCalcInit]
type		= VarSet
triggerall	= !IsHelper
triggerall	= !Var(50)
;trigger1	= FVar(0) <= 0.15
trigger1	= 1
fvar(0)		= Const(movement.stand.friction)
ignorehitpause	= 1

[State -2, HitVelCalcInit]
type		= VarSet
triggerall	= !IsHelper
triggerall	= !Var(50)
trigger1	= 1
fvar(2)		= Const(movement.stand.friction) / FVar(0)
ignorehitpause	= 1

[State -2, HitVelCalcSet]
type		= VarSet
triggerall	= !IsHelper
triggerall	= !Var(50)
trigger1	= 1
fvar(2)		= IfElse( FVar(2) >= 1.0, FVar(2)**((Const(movement.stand.friction)+0.5) / (FVar(0)+0.5)), FVar(2)**(3.0 + (FVar(0) - Const(movement.stand.friction)) * 20.0) )
ignorehitpause	= 1

;---------------------------------------------------------------------
; 画面端用ヒットバック
;---------------------------------------------------------------------
;------------------- 初期ベクトル
[State -2, VarSet]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= NumHelper(20000)
triggerall	= !(Var(18) & 528482304)
triggerall	= Var(31) >= 0
trigger1	= (Var(18) & -2147483648) && MoveContact && Target(Var(31)),MoveType = H
fvar(1)		= Abs(Target(Var(31)),HitVel X * (1.0 - 0.5*!!(Helper(20000),Var(1) & 256))) * (Target(Var(31)),StateType != A)
ignorehitpause	= 0

[State -2, VarSet]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= !(Var(18) & 528482304)
trigger1	= (Var(1) & 16384)
trigger2	= Var(31) < 0
trigger3	= Target(Var(31)),MoveType != H
trigger4	= !(Target(Var(31)),StateType = S || Target(Var(31)),StateType = C)
trigger5	= Target(Var(31)),HitShakeOver && !Target(Var(31)),Vel X && (Target(Var(31)),StateNo = [7081, 7082]) && Target(Var(31)),Anim = 7500 && Target(Var(31)),MoveType = H
fvar(1)		= 0
ignorehitpause	= 0

;------------------- 初期ヒットバック時間
[State -2, VarSet]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= !(Var(18) & 528482304)
triggerall	= Var(31) >= 0
trigger1	= (Var(18) & -2147483648) && MoveContact && Target(Var(31)),MoveType = H
var(16)		= (Var(16) | 2064384) - 2064384 + 2064384 / 63 * IfElse( Target(Var(31)),GetHitVar(slidetime) < 64, Target(Var(31)),GetHitVar(slidetime), 63 )
ignorehitpause	= 0

[State -2, VarSet]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= !(Var(18) & 528482304)
trigger1	= (Var(1) & 16384)
trigger2	= Var(31) < 0
trigger3	= Target(Var(31)),MoveType != H
trigger4	= !(Target(Var(31)),StateType = S || Target(Var(31)),StateType = C)
trigger5	= Target(Var(31)),HitShakeOver && !Target(Var(31)),Vel X && (Target(Var(31)),StateNo = [7081, 7082]) && Target(Var(31)),Anim = 7500 && Target(Var(31)),MoveType = H
var(16)		= (Var(16) | 2064384) - 2064384
ignorehitpause	= 0

;------------------- ヒットバック移動
[State -2, PosAdd]
type		= PosAdd
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= !(Var(18) & 528482304)
triggerall	= NumHelper(40000)
triggerall	= (Var(24) - 1 = Helper(40000),Var(19))
triggerall	= Var(31) >= 0
triggerall	= (StateType = S || StateType = C) && (Var(16) & 2064384)
trigger1	= Target(Var(31)),HitShakeOver
trigger1	= Target(Var(31)),BackEdgeBodyDist <= 0 || Target(Var(31)),FrontEdgeBodyDist <= 0
x			= FVar(1) * -1
ignorehitpause	= 0

;------------------- 摩擦
[State -2, VarSet]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= !(Var(18) & 528482304)
triggerall	= NumHelper(40000)
triggerall	= (Var(24) - 1 = Helper(40000),Var(19))
triggerall	= Var(31) >= 0
triggerall	= Target(Var(31)),MoveType = H && FVar(1) > 0
trigger1	= Target(Var(31)),HitShakeOver
fvar(1)		= FVar(1) * (1.0 * Target(Var(31)),Const(movement.stand.friction) * (Target(Var(31)),StateType = S) + 1.0 * Target(Var(31)),Const(movement.crouch.friction) * (Target(Var(31)),StateType = C))
ignorehitpause	= 0

;------------------- ヒットバック時間減少
[State -2, VarSet]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= !(Var(18) & 528482304)
triggerall	= NumHelper(40000)
triggerall	= (Var(24) - 1 = Helper(40000),Var(19))
triggerall	= Var(31) >= 0
triggerall	= (Var(16) & 2064384)
trigger1	= Target(Var(31)),HitShakeOver
var(16)		= (Var(16) - 2064384/63)
ignorehitpause	= 0

;---------------------------------------------------------------------
; (カウンター時の)juggle制御
;---------------------------------------------------------------------
;------------------- ジャグル解放
[State -2, Juggle OFF]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= Var(31) < 0 && (P2MoveType != H || P2StateType != A)
trigger2	= Var(31) >= 0
trigger2	= Target(Var(31)),MoveType != H || Target(Var(31)),StateType != A
trigger3	= ((Var(2) & 131071) = [3700, 3799])
var(1)		= (Var(1) | 2) - 2
ignorehitpause	= 1

;------------------- ジャグル設定、通常用(カウンター中や、無条件追撃なら設定しない)
[State -2, Juggle ON]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= (Var(2) & 131071) != 613 && (Var(2) & 131071) != 731
triggerall	= Var(31) >= 0
trigger1	= MoveHit = 1 && (Var(1) & 512)
trigger2	= ((Var(2) & 131071) = 901) && (AnimElem = 8)
trigger3	= ((Var(2) & 131071) = 3221) && (AnimElem = 9)
trigger4	= ((Var(2) & 131071) = 3351) && (AnimElem = 4)
var(1)		= (Var(1) | 2) - 2 + 2 * (!(Var(1) & 1) && !(Var(1) & 64))
ignorehitpause	= 1

;------------------- ジャグル設定、特殊用(カウンター中や、無条件追撃なら設定しない)
[State -2, Juggle ON]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= ProjHitTime(1800) = 0
trigger2	= NumHelper(60000)
trigger2	= (Helper(60000),Var(2) = 61901) && !(Helper(60000),Var(22) & 2) && Helper(60000),MoveHit
var(1)		= (Var(1) | 2) - 2 + 2 * (!(Var(1) & 1) && !(Var(1) & 64))
ignorehitpause	= 1

;------------------- ジャグル設定、GC攻撃用
[State -2, Juggle ON]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= Var(31) >= 0
trigger1	= MoveHit = 1 && (Var(1) & 512)
trigger1	= (Var(2) & 131071) = 4302 || (Var(2) & 131071) = 4352
var(1)		= (Var(1) | 2)
ignorehitpause	= 1

;------------------- 3C判定リセット
[State -2, 3C Reset]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= Var(31) < 0 && (P2MoveType != H || P2StateType != A)
trigger2	= Var(31) >= 0
trigger2	= Target(Var(31)),MoveType != H || Target(Var(31)),StateType != A
var(1)		= (Var(1) | 128) - 128
ignorehitpause	= 1

;------------------- 3C判定(カウンター中は設定しない)
[State -2, 3C Set]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= Var(31) >= 0
triggerall	= MoveHit = 1 && (Var(1) & 512)
trigger1	= (Var(2) & 131071) = 731
trigger2	= (Var(2) & 131071) = 613
var(1)		= (Var(1) | 128) - 128 + 128 * (!(Var(1) & 1))
ignorehitpause	= 1

;------------------- 無条件追撃リセット
[State -2, Tsuigeki Reset]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= !(Var(18) & 528482304)
trigger1	= 1
var(1)		= (Var(1) | 64) - 64
ignorehitpause	= 0

;---------------------------------------------------------------------
; 突っ張りヒット数制御
;---------------------------------------------------------------------
; 上のほうの「摩擦差によるヒットバック倍率」をしても
; どうしようも無いキャラとか出てくると思うので、
; 通常キャラには問題無い範囲で下記の補正をします
;------------------- ヒット数が無かったり、空中だったり、コンボ状態じゃなければリセット
[State -2, Reset]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= !NumHelper(20000) || !(Var(7) & 16383) || StateType = A || (Var(1) & 16384)
trigger2	= (Var(2) & 131071) >= 1000
trigger3	= Var(31) < 0
trigger3	= (!(Helper(20000),Var(1) & 128) && P2MoveType != H) || P2StateType = A || P2StateType = L
trigger4	= Var(31) >= 0
trigger4	= (!(Helper(20000),Var(1) & 128) && Target(Var(31)),MoveType != H) || Target(Var(31)),StateType = A || Target(Var(31)),StateType = L
var(16)		= (Var(16) | 31457280) - 31457280
ignorehitpause	= 1

;------------------- 突っ張りヒット数加算
[State -2, VarAdd]
type		= VarAdd
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= (Var(2) & 131071) = 721
triggerall	= Var(31) >= 0
triggerall	= !(Var(1) & 1)
triggerall	= MoveHit = 1 && (Var(1) & 512)
trigger1	= (Var(16) & 31457280) < 31457280
var(16)		= (31457280 / 15)
ignorehitpause	= 1

;---------------------------------------------------------------------
; カウンター処理
;---------------------------------------------------------------------
;------------------- すでにカウンター表示があれば消す
[State -2, RemoveExplod]
type		= RemoveExplod
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= NumExplod(2952)
triggerall	= (Var(1) & 1)
trigger1	= (Var(1) & 512) || (ProjHit = 1)
trigger2	= NumHelper(60000)
trigger2	= (Helper(60000),Var(2) = 61901) && Helper(60000),MoveHit = 1
ID			= 2952
ignorehitpause	= 1

;------------------- カウンター表示 1P用
[State -2, Explod]
type		= Explod
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= TeamSide = 1
triggerall	= (Var(1) & 1)
trigger1	= (Var(1) & 512) || (ProjHit = 1)
trigger2	= NumHelper(60000)
trigger2	= (Helper(60000),Var(2) = 61901) && Helper(60000),MoveHit = 1
ID			= 2952
anim		= 2952
postype		= left
pos			= 0, 68
ownpal		= 1
ontop		= 1
bindtime	= 9999
supermovetime	= 9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
pausemovetime	= 9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
ignorehitpause	= 1

;------------------- カウンター表示 2P用
[State -2, Explod]
type		= Explod
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= TeamSide = 2
triggerall	= (Var(1) & 1)
trigger1	= (Var(1) & 512) || (ProjHit = 1)
trigger2	= NumHelper(60000)
trigger2	= (Helper(60000),Var(2) = 61901) && Helper(60000),MoveHit = 1
ID			= 2952
anim		= 2953
postype		= left
pos			= 312, 68
ownpal		= 1
ontop		= 1
bindtime	= 9999
supermovetime	= 9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
pausemovetime	= 9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
ignorehitpause	= 1

;------------------- 画面フラッシュ
[State -2, EnvColor]
type		= EnvColor
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= (Var(1) & 1)
trigger1	= (Var(1) & 512) || (ProjHit = 1)
trigger2	= NumHelper(60000)
trigger2	= (Helper(60000),Var(2) = 61901) && Helper(60000),MoveHit = 1
value		= 255, 255, 255
time		= 1
under		= 1
ignorehitpause	= 1

;------------------- 特定の行動中はカウンター状態を保持
[State -2, Counter Set]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= (Var(1) & 1)
triggerall	= (Var(1) & 512)
trigger1	= (((Var(2) & 131071) = [220, 229]) && (AnimElemTime(3) <= 0))
trigger2	= (((Var(2) & 131071) = [230, 239]) && (AnimElemTime(3) <= 0))
trigger3	= (((Var(2) & 131071) = [520, 529]) && (AnimElemTime(3) <= 0))
trigger4	= (((Var(2) & 131071) = [530, 539]) && (AnimElemTime(3) <= 0))
trigger5	= ((Var(2) & 131071) = [1100, 1119])
trigger6	= ((Var(2) & 131071) = [1200, 1209])
trigger7	= ((Var(2) & 131071) = [1300, 1309])
trigger8	= ((Var(2) & 131071) = [1610, 1611])
trigger9	= ((Var(2) & 131071) = [3000, 3019])
trigger10	= ((Var(2) & 131071) = [3100, 3119])
trigger11	= ((Var(2) & 131071) = [3200, 3209])
trigger12	= ((Var(2) & 131071) = [3300, 3309])
var(1)		= (Var(1) | 4194304)
ignorehitpause	= 1

;------------------- 敵が行動中ならカウンター
[State -2, Counter Set]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= P2MoveType = A
var(1)		= (Var(1) | 1)
ignorehitpause	= 1

;------------------- カウンター判定リセット
[State -2, Counter Reset]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= !(Var(18) & 528482304)
trigger1	= P2MoveType != A
var(1)		= (Var(1) | 1) - 1
ignorehitpause	= 0

;---------------------------------------------------------------------
; 攻撃力補正計算
;---------------------------------------------------------------------
[State -2, Base Attack Reset]
type		= VarSet
triggerall	= !IsHelper
trigger1	= 1
fvar(0)		= 1.0
ignorehitpause	= 1

;------------------- 基本攻撃力計算
[State -2, Base Attack Correct]
type		= VarSet
triggerall	= !IsHelper
triggerall	= !Var(50)
trigger1	= NumHelper(20000)
fvar(0)		= FVar(0) * Helper(20000),FVar(0)
ignorehitpause	= 1

;------------------- 残Life補正による、攻撃力補正
[State -2, Attack Correct Life]
type		= VarSet
triggerall	= !IsHelper
triggerall	= !Var(50)
trigger1	= 1
fvar(0)		= FVar(0) * IfElse( Var(17) >= FVar(38)*Var(55)/1000.0, 1.0, IfElse(Var(17) > FVar(38)*Var(54)/1000.0, 1.0 + 0.125*(1.0 - 1.0*(Var(17) - FVar(38)*Var(54)/1000.0)/(FVar(38)*Var(55)/1000.0 - FVar(38)*Var(54)/1000.0)), 1.125) )
ignorehitpause	= 1

;------------------- カウンター時の攻撃力補正
[State -2, Attack Correct Counter]
type		= VarSet
triggerall	= !IsHelper
triggerall	= !Var(50)
triggerall	= Alive
trigger1	= (Var(1) & 1)
trigger2	= (Var(1) & 4194304)
fvar(0)		= FVar(0) * 1.125
ignorehitpause	= 1

;------------------- シールド成功による攻撃力補正
[State -2, Attack Correct Shield]
type		= VarSet
triggerall	= !IsHelper
triggerall	= !Var(50)
triggerall	= Alive
trigger1	= (Var(16) & 3840)
trigger2	= (Var(1) & 4096)
fvar(0)		= FVar(0) * .75
ignorehitpause	= 1

;------------------- モード変更による、敵のHPと防御力比率を考慮した攻撃力補正
[State -2, Enemy Data Correct]
type		= VarSet
triggerall	= !IsHelper
triggerall	= !Var(50)
triggerall	= Alive
trigger1	= ((NumEnemy) && (Var(22) & 16))
fvar(0)		= FVar(0) * IfElse(EnemyNear,Const(data.defence) > 100, EnemyNear,Const(data.defence), 100)/100.0 * IfElse(EnemyNear,Const(data.life) > 1000, EnemyNear,Const(data.life), 1000)/1000.0
ignorehitpause	= 1

;------------------- ヒット数補正用の攻撃力補正
[State -2, Base Attack Reset]
type		= VarSet
triggerall	= !IsHelper
triggerall	= !Var(50)
trigger1	= 1
var(0)		= IfElse( (Var(7) & 16383) <= 10000, (Var(7) & 16383), 0 )
ignorehitpause	= 1

[State -2, Base Attack Reset]
type		= VarSet
triggerall	= !IsHelper
trigger1	= 1
fvar(3)		= FVar(0)
ignorehitpause	= 1

[State -2, Special Attack Reset]
type		= VarSet
triggerall	= !IsHelper
trigger1	= 1
fvar(9)		= FVar(0)
ignorehitpause	= 1

[State -2, Attack Correct Hit]
type		= VarSet
triggerall	= !IsHelper
triggerall	= !Var(50)
triggerall	= Alive
triggerall	= Var(0) > 0
trigger1	= Var(31) >= 0
fvar(3)		= FVar(3) * ( 0.700 ** (Var(0) / 10000.0) )
ignorehitpause	= 1

[State -2, Attack Correct Hit]
type		= VarSet
triggerall	= !IsHelper
triggerall	= !Var(50)
triggerall	= Alive
triggerall	= Var(0) > 0
trigger1	= Var(31) >= 0
fvar(9)		= FVar(9) * ( 0.850 ** (Var(0) / 10000.0) )
ignorehitpause	= 1

;---------------------------------------------------------------------
; シールドカウンタ
;---------------------------------------------------------------------
[State -2, VarAdd]
type		= VarAdd
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= !(Var(18) & 528482304)
trigger1	= (Var(16) & 3840)
var(16)		= -(3840 / 15)
ignorehitpause	= 0

[State -2, VarSet]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= !(Var(18) & 528482304)
trigger1	= (Var(1) & 16384)
var(16)		= (Var(16) | 3840) - 3840
ignorehitpause	= 0

;---------------------------------------------------------------------
; InGuardDist設定
;---------------------------------------------------------------------
[State -2, GuardDist Reset]
type		= VarSet
triggerall	= !IsHelper
trigger1	= 1
var(19)		= (Var(19) | 128 | 256) - (128 | 256)
ignorehitpause	= 1

[State -2, Front GuardDist]
type		= PosAdd
triggerall	= !IsHelper
trigger1	= 1
x			= 100
ignorehitpause	= 1

[State -2, Front GuardDist]
type		= VarSet
triggerall	= !IsHelper
trigger1	= InGuardDist
var(19)		= (Var(19) | 128)
ignorehitpause	= 1

[State -2, Back GuardDist]
type		= PosAdd
triggerall	= !IsHelper
trigger1	= 1
x			= -225
ignorehitpause	= 1

[State -2, Back GuardDist]
type		= VarSet
triggerall	= !IsHelper
trigger1	= InGuardDist
var(19)		= (Var(19) | 256)
ignorehitpause	= 1

[State -2, Pos Reset]
type		= PosAdd
triggerall	= !IsHelper
trigger1	= 1
x			= 125
ignorehitpause	= 1

;---------------------------------------------------------------------
; ガードキャンセルフラグ管理
;---------------------------------------------------------------------
[State -2, GCAB Decrease]
type		= VarAdd
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= (Var(19) & 124)
var(19)		= -124 / 31
ignorehitpause	= 1

[State -2, GCAB]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= !(Var(1) & 4) && !(Var(1) & 1048576)
triggerall	= (MoveType = H && (Var(1) & 16384))
triggerall	= Time <= 0
trigger1	= StateNo = 150
trigger2	= StateNo = 152
trigger3	= StateNo = 154
var(19)		= (Var(19) | 124) - 124 + 15 * 124 / 31
ignorehitpause	= 1

;---------------------------------------------------------------------
; ガードクラッシュ
;---------------------------------------------------------------------
;------------------- ガクラによるガクラ値解放
[State -2, Guard Crush Point Reset]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= 1
var(57)		= -1
ignorehitpause	= 1

[State -2, Guard Crush Point Reset]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= (Var(18) & 536870912)
triggerall	= Var(33) <= 0
triggerall	= NumEnemy
triggerall	= Var(57) < 0
trigger1	= Enemy(0),StateNo = [7081, 7082]
trigger1	= Enemy(0),Anim = 7500 && Enemy(0),AnimElemTime(1) <= 1
trigger1	= Enemy(0),StateType = S || Enemy(0),StateType = A
trigger1	= Enemy(0),MoveType = H
trigger1	= !Enemy(0),Ctrl
var(57)		= 0
ignorehitpause	= 1

[State -2, Guard Crush Point Reset]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= (Var(18) & 536870912)
triggerall	= Var(33) <= 0
triggerall	= NumEnemy >= 2
triggerall	= Var(57) < 0
trigger1	= Enemy(1),StateNo = [7081, 7082]
trigger1	= Enemy(1),Anim = 7500 && Enemy(1),AnimElemTime(1) <= 1
trigger1	= Enemy(1),StateType = S || Enemy(1),StateType = A
trigger1	= Enemy(1),MoveType = H
trigger1	= !Enemy(1),Ctrl
var(57)		= 1
ignorehitpause	= 1

[State -2, Guard Crush Point Reset]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= Var(57) >= 0
var(33)		= 1000 * 1000
ignorehitpause	= 1

[State -2, Guard Crush Flag Reset]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= Var(57) >= 0
var(18)		= (Var(18) | 536870912) - 536870912
ignorehitpause	= 1

;------------------- すでにガードクラッシュエフェクトがあれば消す
[State -2, RemoveExplod]
type		= RemoveExplod
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= Var(57) >= 0
trigger1	= NumExplod(2080)
ID			= 2080
ignorehitpause	= 1

;------------------- ガードクラッシュエフェクト表示
[State -2, Explod]
type		= Explod
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= Var(57) >= 0
ID			= 2080
anim		= 2080
postype		= left
pos			= Floor( Enemy(Var(57)),ScreenPos X + Enemy(Var(57)),Facing*Enemy(Var(57)),Const(size.mid.pos.x) ), Floor( Enemy(Var(57)),ScreenPos Y + Enemy(Var(57)),Const(size.mid.pos.y) )
facing		= IfElse( Enemy(Var(57)),Facing = 1, 1, -1 )
ownpal		= 1
sprpriority	= 5
bindtime	= 1
supermovetime	= 9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
pausemovetime	= 9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
ignorehitpause	= 1

;------------------- すでにガードクラッシュ表示があれば消す
[State -2, RemoveExplod]
type		= RemoveExplod
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= Var(57) >= 0
trigger1	= NumExplod(2965)
ID			= 2965
ignorehitpause	= 1

;------------------- ガードクラッシュ表示 1P用
[State -2, Explod]
type		= Explod
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= Var(57) >= 0
trigger1	= TeamSide = 1
ID			= 2965
anim		= 2965
postype		= left
pos			= 0, 71
ownpal		= 1
ontop		= 1
bindtime	= 9999
supermovetime	= 9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
pausemovetime	= 9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
ignorehitpause	= 1

;------------------- ガードクラッシュ表示 2P用
[State -2, Explod]
type		= Explod
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= Var(57) >= 0
trigger1	= TeamSide != 1
ID			= 2965
anim		= 2966
postype		= left
pos			= 318, 71
ownpal		= 1
ontop		= 1
bindtime	= 9999
supermovetime	= 9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
pausemovetime	= 9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
ignorehitpause	= 1

;------------------- 不正値によるガクラ値
[State -2, Guard Crush Point Reset]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= Var(33) > 1000 * 1000
var(33)		= -1000 * 1000
ignorehitpause	= 1

;------------------- ガクラ値加算
[State -2, Guard Crush Point Add]
type		= VarSet
triggerall	= !IsHelper || IsHelper(60000)
trigger1	= 1
var(57)		= 0
ignorehitpause	= 1

[State -2, Guard Crush Point Add]
type		= VarAdd
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= ProjGuardedTime(1800) = 0
var(57)		= 57 * 1000
ignorehitpause	= 1

[State -2, Guard Crush Point Add]
type		= VarAdd
triggerall	= IsHelper(60000)
triggerall	= Root,Var(59) != 1
triggerall	= !Var(50)
trigger1	= (Var(2) = 61901) && MoveGuarded = 1
var(57)		= 170 * 1000
ignorehitpause	= 1

[State -2, Guard Crush Point Add]
type		= VarAdd
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= (Var(1) & 2097152)
trigger1	= ((Var(26) & 131071) = [1410, 1414]) && ((Var(27) & 66977792)/131072 = [8, 11])
trigger2	= ((Var(26) & 131071) = [1410, 1414]) && ((Var(27) & 66977792)/131072 = [21, 26])
var(57)		= 38 * 1000
ignorehitpause	= 1

[State -2, Guard Crush Point Add]
type		= VarAdd
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= (Var(1) & 2097152)
trigger1	= ((Var(26) & 131071) = [200, 209])
trigger2	= ((Var(26) & 131071) = [210, 219])
trigger3	= ((Var(26) & 131071) = [300, 309])
trigger4	= ((Var(26) & 131071) = [310, 319])
trigger5	= ((Var(26) & 131071) = [700, 705])
trigger6	= ((Var(26) & 131071) = [1650, 1659])
var(57)		= 47 * 1000
ignorehitpause	= 1

[State -2, Guard Crush Point Add]
type		= VarAdd
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= (Var(1) & 2097152)
trigger1	= ((Var(26) & 131071) = [1400, 1404]) && ((Var(27) & 66977792)/131072 = [7, 12])
trigger2	= ((Var(26) & 131071) = [1700, 1799])
var(57)		= 57 * 1000
ignorehitpause	= 1

[State -2, Guard Crush Point Add]
type		= VarAdd
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= (Var(1) & 2097152)
trigger1	= ((Var(26) & 131071) = [500, 509])
trigger2	= ((Var(26) & 131071) = [510, 519])
trigger3	= ((Var(26) & 131071) = [706, 707])
trigger4	= ((Var(26) & 131071) = [710, 719])
trigger5	= ((Var(26) & 131071) = [720, 729])
trigger6	= ((Var(26) & 131071) = [730, 739])
trigger7	= ((Var(26) & 131071) = [780, 789])
trigger8	= ((Var(26) & 131071) = [1500, 1599])
var(57)		= 85 * 1000
ignorehitpause	= 1

[State -2, Guard Crush Point Add]
type		= VarAdd
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= (Var(1) & 2097152)
trigger1	= ((Var(26) & 131071) = [220, 229])
trigger2	= ((Var(26) & 131071) = [230, 239])
trigger3	= ((Var(26) & 131071) = [520, 529])
trigger4	= ((Var(26) & 131071) = [530, 539])
trigger5	= ((Var(26) & 131071) = [708, 709])
trigger6	= ((Var(26) & 131071) = [740, 749])
trigger7	= ((Var(26) & 131071) = [1400, 1404]) && ((Var(27) & 66977792)/131072 = [21, 24])
trigger8	= ((Var(26) & 131071) = [1405, 1409])
trigger9	= ((Var(26) & 131071) = [1410, 1414]) && ((Var(27) & 66977792)/131072 = [35, 38])
trigger10	= ((Var(26) & 131071) = [1415, 1419])
var(57)		= 113 * 1000
ignorehitpause	= 1

[State -2, Guard Crush Point Add]
type		= VarAdd
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= (Var(1) & 2097152)
trigger1	= ((Var(26) & 131071) = [620, 624])
var(57)		= 141 * 1000
ignorehitpause	= 1

[State -2, Guard Crush Point Add]
type		= VarAdd
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= (Var(1) & 2097152)
trigger1	= ((Var(26) & 131071) = [320, 329])
trigger2	= ((Var(26) & 131071) = [330, 339])
trigger3	= ((Var(26) & 131071) = [3400, 3414])
var(57)		= 160 * 1000
ignorehitpause	= 1

[State -2, Guard Crush Point Add]
type		= VarAdd
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= (Var(1) & 2097152)
trigger1	= ((Var(26) & 131071) = [605, 609])
trigger2	= ((Var(26) & 131071) = [610, 615])
var(57)		= 170 * 1000
ignorehitpause	= 1

[State -2, Guard Crush Point Add]
type		= VarAdd
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= (Var(1) & 2097152)
trigger1	= ((Var(26) & 131071) = [600, 604])
var(57)		= 226 * 1000
ignorehitpause	= 1

[State -2, Guard Crush Point Add]
type		= VarAdd
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= (Var(1) & 2097152)
trigger1	= ((Var(26) & 131071) = [3500, 3514])
var(57)		= 260 * 1000
ignorehitpause	= 1

;------------------- ガードクラッシュ値倍率
[State -2, Base Guard Clash Reset]
type		= VarSet
triggerall	= !IsHelper
triggerall	= !Var(50)
trigger1	= 1
fvar(6)		= 1.0
ignorehitpause	= 1

; 残Life補正による、ガードクラッシュ値倍率
[State -2, VarSet]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= 1
fvar(6)		= IfElse( Var(17) >= FVar(38)*Var(55)/1000.0, 1.0, IfElse(Var(17) > FVar(38)*Var(54)/1000.0, 1.000 + 0.200*(1.0 - 1.0*(Var(17) - FVar(38)*Var(54)/1000.0)/(FVar(38)*Var(55)/1000.0 - FVar(38)*Var(54)/1000.0)), 1.200) )
ignorehitpause	= 1

; 本体のガクラ率取得
; Root,FVar(6) って微塵も保護されてないんだけど
[State -2, VarSet]
type		= VarSet
triggerall	= IsHelper(60000)
triggerall	= !Var(50)
trigger1	= 1
fvar(6)		= Root,FVar(6)
ignorehitpause	= 1

[State -2, VarSet]
type		= VarSet
triggerall	= IsHelper(60000)
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= FVar(6) < 1.0
fvar(6)		= 1.25
ignorehitpause	= 1

; 今回の総ガクラ値に倍率を掛ける
[State -2, VarSet]
type		= VarSet
triggerall	= !IsHelper || IsHelper(60000)
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= NumHelper(20000)
trigger1	= Helper(20000),FVar(6) = 0
var(57)		= 0
ignorehitpause	= 1

[State -2, VarSet]
type		= VarSet
triggerall	= !IsHelper || IsHelper(60000)
triggerall	= NumHelper(20000)
trigger1	= Var(57)
var(57)		= IfElse( Floor( Var(57) * FVar(6) * Helper(20000),FVar(6) ) != 0, Floor( Var(57) * FVar(6) * Helper(20000),FVar(6) ), 1 )
ignorehitpause	= 1

[State -2, VarSet]
type		= VarSet
triggerall	= !IsHelper || IsHelper(60000)
trigger1	= Var(57) < 0
var(57)		= 1000 * 1000
ignorehitpause	= 1

; 累積ガクラ値へ加算
[State -2, Guard Crush Point Add]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= Var(57)
var(33)		= IfElse( Var(33) - Var(57) < -1000 * 1000, -1000 * 1000, Var(33) - Var(57) )
ignorehitpause	= 1

; Root,Var(33) 微塵も保護されてないんだけど
[State -2, Guard Crush Point Add]
type		= ParentVarSet
triggerall	= IsHelper(60000)
triggerall	= Root,Var(59) != 1
triggerall	= !Var(50)
trigger1	= Var(57)
var(33)		= IfElse( Root,Var(33) - Var(57) < -1000 * 1000, -1000 * 1000, Root,Var(33) - Var(57) )
ignorehitpause	= 1

; ガクラ値記憶
[State -2, Guard Crush Point Buf]
type		= VarSet
triggerall	= !IsHelper
triggerall	= !Var(50)
trigger1	= 1
var(53)		= Var(33)
ignorehitpause	= 1

; Root,Var(33) 微塵も保護されてないんだけど
[State -2, Guard Crush Point Buf]
type		= VarSet
triggerall	= IsHelper(60000)
triggerall	= !Var(50)
trigger1	= 1
var(53)		= Root,Var(33)
ignorehitpause	= 1

;------------------- ガードクラッシュターゲットID生成
[State -2, VarSet]
type		= VarSet
triggerall	= !IsHelper || IsHelper(60000)
triggerall	= Var(59) != 1
trigger1	= 1
var(58)		= -1
ignorehitpause	= 1

[State -2, VarSet]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= Var(58) < 0
triggerall	= (Var(1) & 2097152)
trigger1	= NumTarget(10 + (Var(16) & 240)/16)
trigger1	= Target(10 + (Var(16) & 240)/16),ID != ID
var(58)		= 10 + (Var(16) & 240)/16
ignorehitpause	= 1

[State -2, VarSet]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= Var(58) < 0
triggerall	= ProjGuardedTime(1800) = 0
trigger1	= NumTarget(1 + (Var(19) & 3)/1)
trigger1	= Target(1 + (Var(19) & 3)/1),ID != ID
var(58)		= 1 + (Var(19) & 3)/1
ignorehitpause	= 1

[State -2, VarSet]
type		= VarSet
triggerall	= IsHelper(60000)
triggerall	= Var(58) < 0
triggerall	= NumTarget
trigger1	= (Var(2) = 61901) && MoveGuarded
var(58)		= 0
ignorehitpause	= 1

;------------------- すでにガードクラッシュしそうなエフェクトがあれば消す
[State -2, RemoveExplod]
type		= RemoveExplod
triggerall	= !IsHelper || IsHelper(60000)
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= Var(57)
triggerall	= Var(53) <= 250 * 1000
triggerall	= NumExplod(2080)
trigger1	= Var(58) >= 0
ID			= 2080
ignorehitpause	= 1

;------------------- ガードクラッシュしそうなエフェクト表示
[State -2, Explod]
type		= Explod
triggerall	= !IsHelper || IsHelper(60000)
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= Var(57)
triggerall	= Var(53) <= 250 * 1000
trigger1	= Var(58) >= 0
ID			= 2080
anim		= 2041
postype		= left
pos			= Floor( Target(Var(58)),ScreenPos X + Target(Var(58)),Facing*(Target(Var(58)),Const(size.mid.pos.x)-0) ), Floor( Target(Var(58)),ScreenPos Y + Target(Var(58)),Const(size.mid.pos.y) ) + 41
facing		= IfElse( Target(Var(58)),Facing = 1, 1, -1 )
ownpal		= 1
sprpriority	= 5
bindtime	= 1
supermovetime	= 9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
pausemovetime	= 9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
ignorehitpause	= 1

;------------------- ガードクラッシュステート
[State -2, TargetState]
type		= TargetState
triggerall	= !IsHelper || IsHelper(60000)
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= Var(57)
triggerall	= Var(53) <= 0
trigger1	= Var(58) >= 0
value		= 7080
ID			= Var(58)
ignorehitpause	= 1

[State -2, VarSet]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= Var(57)
triggerall	= Var(53) <= 0
trigger1	= Var(58) >= 0
var(18)		= (Var(18) | 536870912)
ignorehitpause	= 1

[State -2, VarSet]
type		= ParentVarSet
triggerall	= IsHelper(60000)
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= Var(57)
triggerall	= Var(53) <= 0
trigger1	= Var(58) >= 0
var(18)		= (Root,Var(18) | 536870912)
ignorehitpause	= 1

;------------------- ガクラ値回復
[State -2, Guard Crush Point Add]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= !(Var(18) & 528482304)
trigger1	= 1
var(57)		= 0
ignorehitpause	= 0

[State -2, Guard Crush Point Add]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= !(Var(18) & 528482304)
triggerall	= NumEnemy = 1
trigger1	= ( Enemy(0),Alive && Enemy(0),StateType != L && Enemy(0),MoveType != H )
var(57)		= Floor( 24/100.0 * 1000 + 0.01 )
ignorehitpause	= 0

[State -2, Guard Crush Point Add]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= !(Var(18) & 528482304)
triggerall	= NumEnemy >= 2
triggerall	= !Enemy(1),Alive
trigger1	= ( Enemy(0),Alive && Enemy(0),StateType != L && Enemy(0),MoveType != H )
var(57)		= Floor( 24/100.0 * 1000 + 0.01 )
ignorehitpause	= 0

[State -2, Guard Crush Point Add]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= !(Var(18) & 528482304)
triggerall	= NumEnemy >= 2
triggerall	= !Enemy(0),Alive
trigger1	= ( Enemy(1),Alive && Enemy(1),StateType != L && Enemy(1),MoveType != H )
var(57)		= Floor( 24/100.0 * 1000 + 0.01 )
ignorehitpause	= 0

[State -2, Guard Crush Point Add]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= !(Var(18) & 528482304)
triggerall	= NumEnemy >= 2
triggerall	= Enemy(0),Alive && Enemy(1),Alive
trigger1	= ( Enemy(0),StateType != L && Enemy(0),MoveType != H )
trigger2	= ( Enemy(1),StateType != L && Enemy(1),MoveType != H )
var(57)		= Floor( IfElse( ( Enemy(0),StateType != L && Enemy(0),MoveType != H && Enemy(1),StateType != L && Enemy(1),MoveType != H ), 0.24, 0.24 / 4.0 ) * 1000 + 0.01 )
ignorehitpause	= 0

[State -2, Guard Crush Point Recover]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= !(Var(18) & 528482304)
triggerall	= NumHelper(40000)
triggerall	= (Var(24) - 1 = Helper(40000),Var(19))
triggerall	= Var(33) > 0
trigger1	= Var(57)
var(33)		= IfElse( Var(33) + Var(57) > 1000 * 1000, 1000 * 1000, Var(33) + Var(57) )
ignorehitpause	= 0

;---------------------------------------------------------------------
; HitIDずらし
;---------------------------------------------------------------------
[State -2, Hit ID Init]
type		= VarSet
triggerall	= !IsHelper
triggerall	= !Var(50)
triggerall	= !(Var(18) & 528482304)
trigger1	= (Var(18) & -2147483648) && MoveContact
trigger1	= !(!(Var(1) & 1024) && (Var(2) & 131071) = 613)
trigger1	= !(!(Var(1) & 1024) && (Var(2) & 131071) = 701)
trigger1	= !(!(Var(1) & 1024) && (Var(2) & 131071) = 1102)
trigger1	= !(!(Var(1) & 1024) && (Var(2) & 131071) = 1152)
trigger1	= !(!(Var(1) & 1024) && (Var(2) & 131071) = 1401 && (0 <= AnimElemTime(2) && AnimElemTime(7) <= 0))
trigger1	= !(!(Var(1) & 1024) && (Var(2) & 131071) = 1411 && (0 <= AnimElemTime(2) && AnimElemTime(8) <= 0))
trigger1	= !(!(Var(1) & 1024) && (Var(2) & 131071) = 1411 && (0 <= AnimElemTime(18) && AnimElemTime(21) <= 0))
trigger1	= !(!(Var(1) & 1024) && (Var(2) & 131071) = 1701 && !(1 <= AnimElemTime(16) && AnimElemTime(21) <= 0))
trigger1	= !(!(Var(1) & 1024) && (Var(2) & 131071) = 1901)
trigger1	= !(!(Var(1) & 1024) && (Var(2) & 131071) = 1906)
trigger1	= !(!(Var(1) & 1024) && (Var(2) & 131071) = [4600, 4629])
trigger2	= (Var(18) & -2147483648) && MoveHit
trigger2	= (!(Var(1) & 1024) && ((Var(2) & 131071) = 1102 || (Var(2) & 131071) = 1152))
var(16)		= IfElse( (Var(16) & 240) >= 240, (Var(16) | 240) - 240, Var(16) + 16 )
ignorehitpause	= 0

[State -2, Hit ID Init]
type		= VarSet
triggerall	= !IsHelper
triggerall	= !Var(50)
trigger1	= ProjHitTime(1800) = 0 || ProjGuardedTime(1800) = 0
var(19)		= IfElse( (Var(19) & 3) >= 3, (Var(19) | 3) - 3, Var(19) + 1 )
ignorehitpause	= 1

;---------------------------------------------------------------------
; resume conversion
;---------------------------------------------------------------------
;------------------- 汎用ステートタイマー
[State -2, State Timer]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= 1
var(4)		= Var(4) + Var(59)
ignorehitpause	= 1

;------------------- 保持HP
[State -2, Life Buf]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= 1
var(6)		= Var(6) | (Var(59) * 268435456)
ignorehitpause	= 1

;------------------- 最大HP
[State -2, MaxLife]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= 1
var(12)		= Var(12) | (Var(59) * 268435456)
ignorehitpause	= 1

[State -2, MaxLife Buf]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= 1
var(13)		= Var(13) | (Var(59) * 268435456)
ignorehitpause	= 1

;------------------- 被連続技用総ダメージ
[State -2, Enemy Total Combo Damage]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= 1
var(14)		= Var(14) + Var(59)
ignorehitpause	= 1

;------------------- 盾
[State -2, Shield]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= 1
var(15)		= Var(15) + Var(59)
ignorehitpause	= 1

;------------------- 真の保持HP
[State -2, Life Buf2]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= 1
var(17)		= Var(17) | (Var(59) * 268435456)
ignorehitpause	= 1

;------------------- 被連続技用総ダメージ(パワーゲージ)
[State -2, Enemy Total Combo Damage Power]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= 1
var(21)		= Var(21) + Var(59)
ignorehitpause	= 1

;------------------- 保持パワーゲージ
[State -2, Power Buf]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= 1
var(23)		= Var(23) + Var(59)
ignorehitpause	= 1

;------------------- ゲームタイマー
[State -2, GameTime]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= 1
var(24)		= Var(24) + Var(59)
ignorehitpause	= 1

;------------------- ターゲットのID
[State -2, TargetID]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= 1
var(30)		= Var(30) + Var(59)
ignorehitpause	= 1

;------------------------------------------------------------------------------------------------------------------------------------------
; 常時
;------------------------------------------------------------------------------------------------------------------------------------------

;---------------------------------------------------------------------
; 要請によるスーパーポーズ
;---------------------------------------------------------------------
[State -2, SuperPause]
type		= SuperPause
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= RoundState < 3
triggerall	= GetHitVar(hitshaketime) < 600
triggerall	= Alive
trigger1	= (Var(1) & 67108864)
time		= 600
movetime	= 600
anim		= -1
sound		= -1, 0
darken		= 0
unhittable	= 0
p2defmul	= 1.0
ignorehitpause	= 1

[State -2, Pause]
type		= Pause
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= RoundState < 3
triggerall	= GetHitVar(hitshaketime) < 600
triggerall	= Alive
trigger1	= (Var(1) & 67108864)
time		= 600
movetime	= 600
ignorehitpause	= 1

[State -2, VarSet]
type		= VarSet
triggerall	= !IsHelper
trigger1	= 1
var(1)		= (Var(1) | 67108864) - 67108864
ignorehitpause	= 1

;---------------------------------------------------------------------
; 試合終了後
;---------------------------------------------------------------------
;------------------- 試合終了後のスーパーポーズ
[State -2, SuperPause]
type		= SuperPause
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= RoundState >= 3
triggerall	= Alive
trigger1	= !(Var(16) & 536870912)
time		= 9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
movetime	= 9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
anim		= -1
sound		= -1, 0
darken		= 0
unhittable	= 0
p2defmul	= 1.0
ignorehitpause	= 1

[State -2, Pause]
type		= Pause
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= RoundState >= 3
triggerall	= Alive
trigger1	= !(Var(16) & 536870912)
time		= 9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
movetime	= 9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
ignorehitpause	= 1

;------------------- 試合終了後のKO禁止
[State -2, NoKO]
type		= AssertSpecial
triggerall	= !IsHelper
triggerall	= RoundState = 3
triggerall	= (Var(32) & 7) < 4
trigger1	= Alive
flag		= NoKO
ignorehitpause	= 1

;------------------- 試合終了後のコントロール不能
[State -2, CtrlSet]
type		= CtrlSet
triggerall	= !IsHelper
triggerall	= RoundState >= 4
trigger1	= Alive
value		= 0
ignorehitpause	= 1

;---------------------------------------------------------------------
; 試合前のスーパーポーズ
;---------------------------------------------------------------------
;------------------- 試合初期化時
[State -2, SuperPause]
type		= SuperPause
triggerall	= !IsHelper
triggerall	= Alive
trigger1	= (RoundState = 0 && StateNo = 5900)
time		= 9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
movetime	= 9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
anim		= -1
sound		= -1, 0
darken		= 0
unhittable	= 0
p2defmul	= 1.0
ignorehitpause	= 1

[State -2, Pause]
type		= Pause
triggerall	= !IsHelper
triggerall	= Alive
trigger1	= (RoundState = 0 && StateNo = 5900)
time		= 9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
movetime	= 9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
ignorehitpause	= 1

;------------------- 戦闘開始時
[State -2, SuperPause]
type		= SuperPause
triggerall	= !IsHelper
triggerall	= RoundState = 2
triggerall	= Ctrl
triggerall	= NumHelper(20000)
trigger1	= !(Helper(20000),Var(18) & 8)
time		= 0
movetime	= 0
anim		= -1
sound		= -1, 0
darken		= 0
unhittable	= 0
p2defmul	= 1.0
ignorehitpause	= 1

[State -2, Pause]
type		= Pause
triggerall	= !IsHelper
triggerall	= RoundState = 2
triggerall	= Ctrl
triggerall	= NumHelper(20000)
trigger1	= !(Helper(20000),Var(18) & 8)
time		= 0
movetime	= 0
ignorehitpause	= 1

;---------------------------------------------------------------------
; カットイン
;---------------------------------------------------------------------
[State -2, ModifyExplod]
type		= ModifyExplod
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= NumHelper(20000)
triggerall	= (Helper(20000),Var(6) - 24) > 0
trigger1	= NumExplod(6200)
ID			= 6200
scale		= FVar(4) + FVar(4) * (Helper(20000),Var(6) - 24) * 1.0 / 26.0, FVar(4) + FVar(4) * (Helper(20000),Var(6) - 24) * 1.0 / 26.0
ignorehitpause	= 1

;---------------------------------------------------------------------
; バトル中以外無敵
;---------------------------------------------------------------------
[State -2, Force Round NotHit]
type		= NotHitBy
triggerall	= !IsHelper
trigger1	= RoundState != 2 && !(RoundState = 3 && (MoveType = H && (Var(1) & 16384)) && !(Var(1) & 4))
trigger2	= !NumHelper(20000)
trigger3	= !(Var(19) & 131072)
value2		= SCA
ignorehitpause	= 1

;---------------------------------------------------------------------
; 初期化フラグとか
;---------------------------------------------------------------------
[State -2, Round Decide Init]
type		= VarSet
triggerall	= !IsHelper
triggerall	= RoundState >= 3
trigger1	= Alive
var(16)		= (Var(16) | 536870912)
ignorehitpause	= 1

[State -2, Round Decide Intro Reset]
type		= VarSet
triggerall	= !IsHelper
triggerall	= RoundState < 4
trigger1	= Alive
var(19)		= (Var(19) | 32768) - 32768
ignorehitpause	= 1

;---------------------------------------------------------------------
; 試合終了後の永続Target外し初期化
;---------------------------------------------------------------------
[State -2, Match End State Reset]
type		= VarSet
triggerall	= !IsHelper
trigger1	= 1
var(1)		= (Var(1) | 16777216) - 16777216
ignorehitpause	= 1

[State -2, Match End State]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
trigger1	= RoundState >= 3
var(1)		= (Var(1) | 16777216)
ignorehitpause	= 1

;---------------------------------------------------------------------
; バグ
;---------------------------------------------------------------------
;------------------- 再初期化対策
[State -2, Reinit Counter]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= RoundState >= 2
triggerall	= !(Var(2) & 8388608)
trigger1	= !(Var(1) & 1024) && StateNo = 5900
var(59)		= 1
ignorehitpause	= 1

[State -2, Bug]
type		= AssertSpecial
triggerall	= !IsHelper
triggerall	= Alive
trigger1	= Var(59) = 1
flag		= timerfreeze
ignorehitpause	= 1

[State -2, Bug]
type		= NotHitBy
triggerall	= !IsHelper
triggerall	= Alive
trigger1	= Var(59) = 1
value		= SCA
ignorehitpause	= 1

[State -2, Bug]
type		= LifeSet
triggerall	= !IsHelper
triggerall	= Alive
trigger1	= Var(59) = 1
value		= LifeMax
ignorehitpause	= 1

[State -2, Bug]
type		= PowerSet
triggerall	= !IsHelper
triggerall	= Alive
trigger1	= Var(59) = 1
value		= PowerMax
ignorehitpause	= 1

[State -2, Bug]
type		= SuperPause
triggerall	= !IsHelper
triggerall	= RoundState = 2
triggerall	= Alive
trigger1	= Var(59) = 1
time		= 9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
movetime	= 9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
anim		= -1
sound		= -1
darken		= 0
unhittable	= 0
p2defmul	= 1.0
ignorehitpause	= 1

[State -2, Bug]
type		= Pause
triggerall	= !IsHelper
triggerall	= RoundState = 2
triggerall	= Alive
trigger1	= Var(59) = 1
time		= 9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
movetime	= 9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
ignorehitpause	= 1

[State -2, Bug]
type		= StateTypeSet
triggerall	= !IsHelper
triggerall	= 0 < RoundState && RoundState < 4
triggerall	= Alive
trigger1	= Var(59) = 1
type		= S
movetype	= I
physics		= N
ignorehitpause	= 1

[State -2, Bug]
type		= CtrlSet
triggerall	= !IsHelper
triggerall	= 0 < RoundState && RoundState < 4
triggerall	= Alive
trigger1	= Var(59) = 1
value		= 0
ignorehitpause	= 1

[State -2, Bug]
type		= VarSet
triggerall	= !IsHelper
triggerall	= 0 < RoundState && RoundState < 4
triggerall	= Alive
trigger1	= Var(59) = 1
var(2)		= (Var(2) | 131071) - 131071 + IfElse( !(Var(16) & 234881024), 5900, 6100 )
ignorehitpause	= 1

[State -2, Bug]
type		= VarSet
triggerall	= !IsHelper
triggerall	= 0 < RoundState && RoundState < 4
triggerall	= Alive
trigger1	= Var(59) = 1
var(2)		= (Var(2) | 8388608)
ignorehitpause	= 1

;---------------------------------------------------------------------
; ヒットポーズ解除待ち
;---------------------------------------------------------------------
;------------------- 復帰用判定リセット
[State -2, HitPause Force Recovery]
type		= VarSet
triggerall	= !IsHelper
trigger1	= 1
var(58)		= 0
ignorehitpause	= 1

;------------------- 復帰判定
[State -2, HitPause Force Recovery]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= Alive
triggerall	= (Var(1) & 4)
triggerall	= !(Var(2) & 8388608)
triggerall	= NumHelper(20000)
triggerall	= (Var(32) & 7) < 4 && Helper(20000),Var(16) > 0
triggerall	= (Var(19) & 131072)
trigger1	= 0
trigger2	= MoveReversed && HitPauseTime >= Helper(20000),Var(16)
var(58)		= 1
ignorehitpause	= 1

;------------------- 復帰用処理
[State -2, HitPause Force Recovery]
type		= VarSet
triggerall	= !IsHelper
trigger1	= Var(58) = 1
var(2)		= (Var(2) | 131071) - 131071 + 5907
ignorehitpause	= 1

[State -2, HitPause Force Recovery]
type		= StateTypeSet
triggerall	= !IsHelper
trigger1	= Var(58) = 1
type		= S
movetype	= I
physics		= N
ignorehitpause	= 1

[State -2, HitPause Force Recovery]
type		= VarSet
triggerall	= !IsHelper
trigger1	= Var(58) = 1
var(2)		= (Var(2) | 8388608)
ignorehitpause	= 1

;---------------------------------------------------------------------
; 勝敗演出移行
;---------------------------------------------------------------------
;------------------- 復帰用判定リセット
[State -2, Round Decide Force Recovery]
type		= VarSet
triggerall	= !IsHelper
trigger1	= 1
var(58)		= 0
ignorehitpause	= 1

;------------------- 復帰判定
[State -2, Round Decide Force Recovery]
type		= Null;Round Decide
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= Alive
triggerall	= (Var(1) & 4) || !(Var(1) & 16384)
triggerall	= !(Var(2) & 8388608)
triggerall	= NumHelper(20000)
triggerall	= Helper(20000),Var(14) > 44 && RoundState >= 4
trigger1	= !(Var(19) & 32768)
var(58)		= 1
ignorehitpause	= 1

;------------------- 復帰用処理
[State -2, Round Decide Force Recovery]
type		= VarSet
triggerall	= !IsHelper
trigger1	= Var(58) = 1
var(2)		= (Var(2) | 131071) - 131071 + IfElse( DrawGame, 175, IfElse( Lose, 170, 180 ) )
ignorehitpause	= 1

[State -2, Round Decide Force Recovery]
type		= StateTypeSet
triggerall	= !IsHelper
trigger1	= Var(58) = 1
statetype	= S
movetype	= I
physics		= N
ignorehitpause	= 1

[State -2, Round Decide Force Recovery]
type		= VarSet
triggerall	= !IsHelper
trigger1	= Var(58) = 1
var(2)		= (Var(2) | 8388608)
ignorehitpause	= 1

;---------------------------------------------------------------------
; サイクバースト
;---------------------------------------------------------------------
[State -2, Burst Check Reset]
type		= VarSet
triggerall	= !IsHelper
trigger1	= 1
var(0)		= 0
ignorehitpause	= 1

[State -2, Cancel Enable Check Reset]
type		= VarSet
triggerall	= !IsHelper
trigger1	= 1
var(58)		= 0
ignorehitpause	= 1

[State -2, Cancel Enable Check]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= RoundState = 2
trigger1	= Ctrl
trigger2	= Alive && MoveReversed && MoveType != H
trigger3	= (Var(2) & 131071) = [100, 104]
var(58)		= 1
ignorehitpause	= 1

[State -2, Burst Check]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= RoundState = 2
triggerall	= Alive
triggerall	= (Var(2) & 131071) != [4500, 4501]
triggerall	= Const(data.power) > 0
triggerall	= Power >= Floor( 2000 * IfElse(PowerMax<Const(data.power),PowerMax,Const(data.power))/(1.0*Const(data.power)) )
triggerall	= (Var(58) = 1) || (Var(1) & 16384)
triggerall	= !(Var(2) & 8388608)
trigger1	= 1
var(0)		= 1
ignorehitpause	= 1

[State -2, Command Set]	; バースト
type		= VarSet
triggerall	= !IsHelper
triggerall	= (Var(32) & 7) < 4
triggerall	= !(Var(8) & 3145728)
triggerall	= Var(0) = 1
trigger1	= (Var(25) & 8) && (Var(25) & 32768) && (Var(25) & 65536)
trigger2	= (Var(25) & 16384) && (Var(25) & 16) && (Var(25) & 65536)
trigger3	= (Var(25) & 16384) && (Var(25) & 32768) && (Var(25) & 32)
var(8)		= (Var(8) | 3145728) - 3145728 + 1*1048576
ignorehitpause	= 1

[State -2, Burst Check]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(0) = 1
trigger1	= (Var(8) & 3145728)
var(0)		= 2
ignorehitpause	= 1

[State -2, Burst Init]
type		= VarSet
triggerall	= !IsHelper
trigger1	= Var(0) = 2
var(2)		= (Var(2) | 131071 | 393216 | 1572864 | 2097152) - 131071 - 393216 - 1572864 - 2097152 + 4500
ignorehitpause	= 1

[State -2, Burst Init]
type		= StateTypeSet
triggerall	= !IsHelper
trigger1	= Var(0) = 2
statetype	= S
movetype	= I
physics		= N
ignorehitpause	= 1

[State -2, Burst Init]
type		= CtrlSet
triggerall	= !IsHelper
trigger1	= Var(0) = 2
value		= 0
ignorehitpause	= 1

[State -2, Burst Init]
type		= VarSet
triggerall	= !IsHelper
trigger1	= Var(0) = 2
var(2)		= (Var(2) | 8388608)
ignorehitpause	= 1

;---------------------------------------------------------------------
; 強制復帰
;---------------------------------------------------------------------
;------------------- 復帰用判定リセット
[State -2, Force Recovery]
type		= VarSet
triggerall	= !IsHelper
trigger1	= 1
var(58)		= 0
ignorehitpause	= 1

;------------------- デバッグ
[State -2, Debug]
type		= Null;AppendToClipboard
triggerall	= !IsHelper
triggerall	= !Var(50)
triggerall	= (Var(1) & 16384)
trigger1	= (Var(1) & 4)
text		= "%d:%d:%d:%d:%d:"
params		= StateNo, (Var(2) & 131071), (Var(2) & 1572864) = (1572864 / 3 * 2), (Var(1) & 1024), (Var(26) & 4194304)
ignorehitpause	= 1

[State -2, Debug]
type		= Null;AppendToClipboard
triggerall	= !IsHelper
triggerall	= !Var(50)
triggerall	= (Var(1) & 16384)
trigger1	= (Var(1) & 4)
text		= "%d:%d "
params		= Anim, (Var(3) & 131071)
ignorehitpause	= 1

;------------------- デバッグ
[State -2, Debug]
type		= Null;AppendToClipboard
triggerall	= !IsHelper
triggerall	= !Var(50)
triggerall	= !(Var(1) & 32)
trigger1	= Command = "x"
text		= "%d:%d:%d:%d:%d:"
params		= StateNo, (Var(2) & 131071), (Var(2) & 1572864) = (1572864 / 3 * 2), (Var(1) & 1024), (Var(26) & 4194304)
ignorehitpause	= 1

;------------------- デバッグ
[State -2, Debug]
type		= Null;AppendToClipboard
triggerall	= !IsHelper
triggerall	= !Var(50)
triggerall	= !(Var(1) & 32)
trigger1	= Command = "x"
text		= "%d:%d:%d:%d:%d "
params		= (MoveType = H), (Var(1) & 4), (Var(1) & 65536), (Var(18) & 1008), Helper(30000),Var(3)
ignorehitpause	= 1

;------------------- 通常復帰用判定
[State -2, Force Recovery]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= Alive
triggerall	= (Var(1) & 4)
triggerall	= !(Var(2) & 8388608)
triggerall	= (Var(1) & 16384)
trigger1	= (Var(2) & 1572864) = (1572864 / 3 * 2)
trigger2	= (Var(26) & 4194304)
var(58)		= 1
ignorehitpause	= 1

;------------------- 状態継続復帰用判定
[State -2, Force Recovery]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= Alive
triggerall	= (Var(1) & 4)
triggerall	= !(Var(2) & 8388608)
triggerall	= (Var(1) & 16384)
trigger1	= !Var(58)
var(58)		= 2
ignorehitpause	= 1

;------------------- 通常復帰用処理
[State -2, Force Recovery]
type		= VarSet
triggerall	= !IsHelper
trigger1	= Var(58) = 1
var(2)		= (Var(2) | 131071 | 393216 | 1572864 | 2097152) - 131071 - 393216 - 1572864
ignorehitpause	= 1

[State -2, Force Recovery]
type		= VarSet
triggerall	= !IsHelper
trigger1	= Var(58) = 1
var(3)		= (Var(3) | 131071 | 66977792) - 131071 - 66977792
ignorehitpause	= 1

[State -2, Force Recovery]
type		= StateTypeSet
triggerall	= !IsHelper
trigger1	= Var(58) = 1
statetype	= S
movetype	= I
physics		= N
ignorehitpause	= 1

;------------------- 状態継続復帰
[State -2, Force Recovery]
type		= ChangeAnim
triggerall	= !IsHelper
trigger1	= Var(58) = 2
trigger1	= (Var(3) & 131071) != Anim
value		= (Var(3) & 131071)
elem		= (Var(3) & 66977792) / 131072
ignorehitpause	= 1

[State -2, Force Recovery]
type		= StateTypeSet
triggerall	= !IsHelper
trigger1	= Var(58) = 2
statetype	= S
movetype	= I
ignorehitpause	= 1

[State -2, Force Recovery]
type		= StateTypeSet
triggerall	= !IsHelper
trigger1	= Var(58) = 2
trigger1	= (Var(2) & 393216) / 131072 = 1
statetype	= C
ignorehitpause	= 1

[State -2, Force Recovery]
type		= StateTypeSet
triggerall	= !IsHelper
trigger1	= Var(58) = 2
trigger1	= (Var(2) & 393216) / 131072 = 2
statetype	= A
ignorehitpause	= 1

[State -2, Force Recovery]
type		= StateTypeSet
triggerall	= !IsHelper
trigger1	= Var(58) = 2
trigger1	= (Var(2) & 393216) / 131072 = 3
statetype	= L
ignorehitpause	= 1

[State -2, Force Recovery]
type		= StateTypeSet
triggerall	= !IsHelper
trigger1	= Var(58) = 2
trigger1	= (Var(2) & 1572864) / 524288 = 1
movetype	= A
ignorehitpause	= 1

[State -2, Force Recovery]
type		= VarSet
triggerall	= !IsHelper
trigger1	= Var(58)
var(2)		= (Var(2) | 8388608)
ignorehitpause	= 1

;---------------------------------------------------------------------
; (ステート変更)処理
;---------------------------------------------------------------------
;------------------- MoveType=H状態を解除
[State -2, State MoveType=H Reset]
type		= VarSet
triggerall	= !IsHelper
trigger1	= (Var(2) & 8388608)
var(19)		= (Var(19) | 4096) - 4096
ignorehitpause	= 1

;------------------- ステート奪取状態を解除
[State -2, State Steal]
type		= VarSet
triggerall	= !IsHelper
trigger1	= (Var(2) & 8388608)
var(1)		= (Var(1) | 1024) - 1024
ignorehitpause	= 1

;------------------- ステート奪取しないステート変更状態を解除
[State -2, State Not Steal Change Reset]
type		= VarSet
triggerall	= !IsHelper
trigger1	= (Var(2) & 8388608)
var(18)		= (Var(18) | 1073741824) - 1073741824
ignorehitpause	= 1

;------------------- ヒットストップ時間リセット
[State -2, Hit Stop Time Reset]
type		= VarSet
triggerall	= !IsHelper
triggerall	= !Var(50)
trigger1	= !(Var(2) & 8388608)
trigger1	= (Var(1) & 16384)
trigger2	= (Var(2) & 8388608)
trigger2	= (Var(2) & 131071) != (Var(26) & 131071)
var(18)		= (Var(18) | 528482304) - 528482304
ignorehitpause	= 1

;------------------- パワー溜SE消し
[State -2, StopSnd]
type		= StopSnd
triggerall	= !IsHelper
triggerall	= !Var(50)
trigger1	= !((Var(2) & 131071) = [4100, 4199])
trigger2	= !(Var(2) & 8388608)
trigger2	= (Var(1) & 16384)
channel		= 1
ignorehitpause	= 1

;------------------- 残像消し
[State -2, AfterImage Reset]
type		= AfterImageTime
triggerall	= !IsHelper
triggerall	= !Var(50)
trigger1	= !(Var(2) & 8388608)
trigger1	= (MoveType = H && (Var(1) & 16384))
trigger1	= !((Var(2) & 1572864) = 1572864 / 3 * 2)
trigger2	= !(Var(2) & 8388608)
trigger2	= (Var(1) & 1024) && !(Var(26) & 4194304)
trigger3	= !(Var(2) & 8388608)
trigger3	= (Var(18) & 1073741824) && !(Var(26) & 33554432)
trigger4	= (Var(2) & 8388608)
trigger4	= (Var(2) & 131071) != (Var(26) & 131071)
length		= 1
timegap		= 1
framegap	= 1
palbright	= 0, 0, 0
palcontrast	= 0, 0, 0
paladd		= 0, 0, 0
palmul		= 1, 1, 1
time		= 0
ignorehitpause	= 1

;------------------- パレット戻し
[State -2, PalFX]
type		= Null;PalFX
triggerall	= !IsHelper
triggerall	= !Var(50)
trigger1	= !(Var(2) & 8388608)
trigger1	= (MoveType = H && (Var(1) & 16384))
trigger1	= !((Var(2) & 1572864) = 1572864 / 3 * 2)
trigger2	= !(Var(2) & 8388608)
trigger2	= (Var(1) & 1024) && !(Var(26) & 4194304)
trigger3	= !(Var(2) & 8388608)
trigger3	= (Var(18) & 1073741824) && !(Var(26) & 33554432)
trigger4	= (Var(2) & 8388608)
trigger4	= (Var(2) & 131071) != (Var(26) & 131071)
time		= 1
add			= 0, 0, 0
mul			= 256, 256, 256
invertall	= 0
color		= 256
ignorehitpause	= 1

;------------------- ステート変更
[State -2, SelfState]
type		= SelfState
triggerall	= !IsHelper
trigger1	= (Var(2) & 8388608)
value		= (Var(2) & 131071)
ctrl		= (Var(2) & 2097152) != 0
ignorehitpause	= 1

[State -2, SelfState]
type		= SelfState
triggerall	= !IsHelper
trigger1	= (Var(2) & 8388608)
value		= (Var(2) & 131071)
ctrl		= (Var(2) & 2097152) != 0
ignorehitpause	= 1

[State -2, SelfState]
type		= SelfState
triggerall	= !IsHelper
trigger1	= (Var(2) & 8388608)
value		= (Var(2) & 131071)
ctrl		= (Var(2) & 2097152) != 0
ignorehitpause	= 1

;---------------------------------------------------------------------
; ステート履歴開放
;---------------------------------------------------------------------
;------------------- 結果、ステート奪取されていれば、履歴開放
[State -2, VarSet]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= (Var(1) & 1024)
var(2)		= (Var(2) | 131071 | 393216 | 1572864 | 16777216) - 131071 - 393216 - 1572864 - 16777216
ignorehitpause	= 1

;------------------- 奪取中なら、ここでアニメ履歴保持
[State -2, VarSet]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= (Var(1) & 1024)
var(3)		= (Var(3) | 131071 | 66977792) - (131071 | 66977792)
ignorehitpause	= 1

[State -2, VarSet]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= (Var(1) & 1024) && SelfAnimExist(Anim)
var(3)		= Var(3) + (Anim | (131072 * IfElse( AnimElemNo(0) < 511, AnimElemNo(0), 511 )))
ignorehitpause	= 1

;------------------- 奪取中なら、ベクトル解放
[State , Vec Reset]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= (Var(1) & 1024)
fvar(7)		= 0
ignorehitpause	= 1

[State , Vec Reset]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
trigger1	= (Var(1) & 1024)
fvar(8)		= 0
ignorehitpause	= 1

;------------------- 奪取中なら、特定条件化でNoKo
[State , State Steal NoKO]
type		= AssertSpecial
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= !Var(50)
triggerall	= (Var(32) & 7) < 2
triggerall	= Life > 1
trigger1	= (Var(1) & 1024)
flag		= NoKO
ignorehitpause	= 1

;---------------------------------------------------------------------
; 試合終了後の永続Target外しステート戻し
;---------------------------------------------------------------------
[State -2, Match End State Reset]
type		= VarSet
triggerall	= !IsHelper
trigger1	= 1
var(0)		= 0
ignorehitpause	= 1

[State -2, Match End State Set]
type		= VarSet
triggerall	= !IsHelper
triggerall	= Var(59) != 1
triggerall	= Alive
triggerall	= (Var(1) & 16777216)
triggerall	= StateNo = 120
trigger1	= (Var(1) & 33554432)
var(0)		= 1
ignorehitpause	= 1

[State -2, Match End State Reset]
type		= VarSet
triggerall	= !IsHelper
trigger1	= 1
var(1)		= (Var(1) | 33554432) - 33554432
ignorehitpause	= 1

[State -2, Match End State]
type		= SelfState
triggerall	= !IsHelper
trigger1	= Var(0)
value		= (Var(2) & 131071)
ignorehitpause	= 1

[State -2, Match End State]
type		= SelfState
triggerall	= !IsHelper
trigger1	= Var(0)
value		= (Var(2) & 131071)
ignorehitpause	= 1

[State -2, Match End State]
type		= SelfState
triggerall	= !IsHelper
trigger1	= Var(0)
value		= (Var(2) & 131071)
ignorehitpause	= 1

;---------------------------------------------------------------------
; ヘルパー強制復帰
;---------------------------------------------------------------------
;------------------- 初期化ステートへ
[State -2, Helper Force Recovery]
type		= SelfState
triggerall	= !Var(0) || !Var(59)
trigger1	= IsHelper(20000)
value		= 20000 - 1
ignorehitpause	= 1

[State -2, Helper Force Recovery]
type		= SelfState
triggerall	= !Var(0) || !Var(59)
trigger1	= IsHelper(30000)
trigger2	= IsHelper(30001)
trigger3	= IsHelper(30002)
trigger4	= IsHelper(30003)
trigger5	= IsHelper(30004)
trigger6	= IsHelper(30005)
trigger7	= IsHelper(30006)
trigger8	= IsHelper(30007)
value		= 30000 - 1
ignorehitpause	= 1

[State -2, Helper Force Recovery]
type		= SelfState
triggerall	= !Var(0) || !Var(59)
trigger1	= IsHelper(40000)
value		= 40000 - 1
ignorehitpause	= 1

[State -2, Helper Force Recovery]
type		= SelfState
triggerall	= !Var(0) || !Var(59)
trigger1	= IsHelper(50000)
value		= 50000 - 1
ignorehitpause	= 1

[State -2, Helper Force Recovery]
type		= SelfState
triggerall	= !Var(0) || !Var(59)
trigger1	= IsHelper(60000)
value		= 60000 - 1
ignorehitpause	= 1

;------------------- 独自ステートへ
[State -2, Helper Force Recovery]
type		= SelfState
trigger1	= IsHelper(19902)
value		= 19902
ignorehitpause	= 1

[State -2, Helper Force Recovery]
type		= SelfState
trigger1	= IsHelper(19905)
value		= 19905
ignorehitpause	= 1

[State -2, Helper Force Recovery]
type		= SelfState
trigger1	= IsHelper(19906)
value		= 19906
ignorehitpause	= 1

[State -2, Helper Force Recovery]
type		= SelfState
triggerall	= IsHelper(20000)
triggerall	= !(Var(1) & 1024)
trigger1	= StateNo = 20602
trigger2	= StateNo = 20614
trigger3	= StateNo = 21512
trigger4	= StateNo = 21522
value		= StateNo
ignorehitpause	= 1

[State -2, Helper Force Recovery]
type		= SelfState
triggerall	= IsHelper(30000) || IsHelper(30001) || IsHelper(30002) || IsHelper(30003) || IsHelper(30004) || IsHelper(30005) || IsHelper(30006) || IsHelper(30007)
triggerall	= !(Var(1) & 1024)
trigger1	= StateNo = 30010
value		= StateNo
ignorehitpause	= 1

;------------------- 共通ステートへ
[State -2, Helper Force Recovery]
type		= SelfState
triggerall	= IsHelper
trigger1	= 1
value		= 19900
ignorehitpause	= 1

[State -2, Helper Force Recovery]
type		= SelfState
triggerall	= IsHelper
trigger1	= 1
value		= 19900
ignorehitpause	= 1

[State -2, Helper Force Recovery]
type		= SelfState
triggerall	= IsHelper
trigger1	= 1
value		= 19900
ignorehitpause	= 1
