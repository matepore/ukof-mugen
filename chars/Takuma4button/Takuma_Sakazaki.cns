;>>>>>>>>>>>>>>>>>>>>>>>======================<<<<<<<<<<<<<<<<<<<<<<|
;|||||||||||||||||||||||Takuma Sakazaki's CNS |||||||||||||||||||||||
;>>>>>>>>>>>>>>>>>>>>>>>======================<<<<<<<<<<<<<<<<<<<<<<|
;===================================================================|
;                              var List                             |
;===================================================================|
;var(0)  = 4-in-1 / 1 unique mode: 0 = '02 Takuma only              |
;                                  1 = '01 Takuma only              |
;                                  2 = Mr Karate only               |
;                                  3 = Honki ni Natta Mr Karate only|
;                                  4 = Classic Takuma only          |
;                                  5 = 4 modes available            |
;var(1)  = Takuma Select: 0 = '02; 1 = '01; 2 = Mr Karate;          |
;                         4 = Serious Mr Karate; 5 = Classic        |
;var(2)  = Takuma Sound moves: 1 = weak; 2 = medium; 3 = strong     |
;   |_ and... General var for Special/DM/SDM/HSDM Checkers          |
;   |_ and... Long Jump Checker                                     |
;var(3)  = Normal Combo Checker Var                                 |
;var(4)  = Small Jump Checker Var                                   |
;var(5)  = Damage Adjust Code Var                                   |
;var(6)  = Throw Limitter Code Var - Single                         |
;var(7)  = Juggle Code Var                                          |
;var(8)  = Burn Explod Var                                          |
;var(9)  = AI Main Var                                              |
;var(10) = Left/Right Side Checker                                  |
;var(11) = Guard Crush Counter                                      |
;var(12) = Guard Crush Limitter                                     |
;var(13) = Dizzy CountDown                                          |
;var(14) = Dizzy Recovery                                           |
;var(15) = MAX Timer                                                |
;var(16) = MAX Mode Power Limitter                                  |
;var(17) = MAX Timer Going out                                      |
;var(18) = MAX Cancel Checker                                       |
;var(19) = Throw Limitter Code Var - Super                          |
;var(20) = Enable Classic Takuma instead '02 Takuma                 |
;var(21) = AI Level (Editable in Settings.CNS)                      |
;var(22) = AI Projectile Optimization                               |
;var(23) = AI Roll/Dodge Optimization                               |
;var(24) = AI Enemy Size Detector                                   |
;var(25) = AI "in the Enemy's back" detector                        |
;var(26) = Winquote Language Setting                                |
;var(27) = Crouching/Standing Guard Detector                        |
;var(28) = Hien Shippu Kyaku bug fixer                              |
;var(29) = Special win checker                                      |
;var(30) = Mouko Burai Gan optimizer - 1                            |
;var(31) = Mouko Burai Gan optimizer - 2                            |
;var(32) = Enable/disable DMs and SDMs for Serious Takuma           |
;var(47) = Drago Groove Power Attack                                |
;var(48) = Drago Groove Power Attack Life Recovery                  |
;var(49) = Spark optimization                                       |
;var(50) = Multi-Roll preventing var                                |
;var(51) = Power charge optimizer                                   |
;var(52) = AI guard detector                                        |
;var(53) = AI variations: 0 = aggressive                            |
;                         1 = defensive                             |
;                         2 = power charger                         |
;                         4 = grabber (works better for grapplers)  |
;var(54) = Damage adjust code limiter                               |
;var(55) = Unfair Detector System                                   |
;var(56) = Winane AI Var - 1                                        |
;var(57) = Winane AI Var - 2                                        |
;var(58) = Winane AI Var - 3                                        |
;-------------------------------------------------------------------|
;fvar(0)  = RAW posfreeze code                                      |
;===================================================================|
;                             Sound List                            |
;===================================================================|
;Channel 0 = Basic Effects                                          |
;Channel 1 = Takuma's Voice                                         |
;Channel 2 = Move Sound                                             |
;Channel 3 = Effects like run, dash...                              |
;Channel 4 = Gethit Sounds                                          |
;Channel 5 = DM/SDM/HSDM Sounds                                     |
;===================================================================|

[Data]
Life = 3000
Power= 5000
Attack = 100
Defence = 100
Fall.Defence_Up = 90
Liedown.Time = 15
AirJuggle = 15
SparkNo = S8000
Guard.SparkNo = S8010
KO.Echo = 0
Volume = 255
IntPersistIndex = 1,9,15,21,56,57,58
FloatPersistIndex = 0

[Size]
xScale = 1          
yScale = 1          
Ground.Back = 15
Ground.Front = 15
Air.Back = 10
Air.Front = 15
Attack.Dist = 160
Proj.Attack.Dist = 90
z.width = 3
head.pos = 6, -93
mid.pos = -6, -62
shadowoffset = 0
draw.offset = 0,0
proj.doscale = 1

[Velocity]
walk.fwd  = 2.5
walk.back = -2.2
run.fwd  = 5.7
run.back = -11,-5
jump.neu = 0,-10
jump.back = -3,-9.5
jump.fwd = 3,-9.5
runjump.back = -5,-10
runjump.fwd = 5,-10
airjump.neu = 0,-9
airjump.back = -3
airjump.fwd = 3

[Movement]
airjump.num = 0
airjump.height = 35
yaccel = .57
stand.friction = .83
crouch.friction = .82


;============================================================================
; Basic States
;============================================================================
;-----------------------------------
;---------- Pseudo Stand -----------
;-----------------------------------
[Statedef 160]
Type = S
Physics = S
SprPriority = 0
Anim = (var(1) = 3)
facep2 = 1

[State 0, 3]
Type = changestate
Trigger1 = time = 1
value = 0
Ctrl = 1

;-----------------------------------
;--------- Pseudo Stand 2 ----------
;-----------------------------------
[Statedef 161]
Type = S
Physics = S
SprPriority = 0
Anim = (var(1) = 3)
facep2 = 1

[State 0, 3]
Type = changestate
Trigger1 = time = 1
value = 0
Ctrl = 1

;----------------------------
;----- Win Pose 1 All -------
;----------------------------
[Statedef 180]
Type = S
Ctrl = 0
Velset = 0
Sprpriority = -3
Anim = 180

[State 180, 1]; Win Screen
type = Helper
trigger1 = !NumHelper(9998)
trigger1 = MatchOver
Trigger1 = !Numpartner
stateno = 9998
postype = left
pos = 0,0
name = "Win Screen"
id = 9998

[State 191, 9]
Type = Changestate
TriggerAll = !Time
TriggerAll = Command !="holdx"
TriggerAll = Command !="holda"
TriggerAll = Command !="holdc"
TriggerAll = Command !="holdz"
Trigger1 = Random < 250
Trigger2 = Command = "holdy"
Trigger3 = Command = "holdb"
Value = 181

[State 191, 9]
Type = Changestate
TriggerAll = !Time
TriggerAll = Command !="holdx"
TriggerAll = Command !="holda"
TriggerAll = Command !="holdy"
TriggerAll = Command !="holdb"
Trigger1 = Random = [250,500]
Trigger2 = Command = "holdz"
Trigger3 = Command = "holdc"
Value = 182

[State 191, 1]
Type = ChangeAnim
Trigger1 = !Time
Trigger1 = var(1) = 1
Value = 182

[State 191, 1]
Type = ChangeAnim
Trigger1 = !Time
Trigger1 = var(1) = 3
Value = 188

[State 191, 1]
Type = ChangeAnim
Trigger1 = !Time
Trigger1 = var(1) = 4
Value = 183

[State 191, 1]
Type = ChangeAnim
Trigger1 = !Time
Trigger1 = var(29)
Trigger1 = var(1) != [2,3]
Value = 186

[State 191, 1]
Type = PlaySnd
Trigger1 = Anim = 186
Trigger1 = AnimElem = 12
Value = 186,0
Channel = 3

[State 191, 1]
Type = PlaySnd
Trigger1 = Anim != 186
Trigger1 = AnimElem = 5
Trigger1 = var(1) = 1
Value = 180,0
Channel = 1

[State 191, 1]
Type = PlaySnd
Trigger1 = Anim != 186
Trigger1 = AnimElem = 1
Trigger1 = var(1) = 4
Value = 182,0
Channel = 1

[State 191, 1]
Type = PlaySnd
Trigger1 = Anim != 186
Trigger1 = AnimElem = 3
Trigger1 = var(1) = 2
Value = 180,1
Channel = 1

[State 191, 1]
Type = PlaySnd
Trigger1 = Anim != 186
Trigger1 = AnimElem = 4
Trigger1 = var(1) = 3
Value = 180,2
Channel = 1

;----------------------------
;----- Win Pose 2 All -------
;----------------------------
[Statedef 181]
Type = S
Ctrl = 0
Anim = 181
Velset = 0

[State 191, 1]
Type = ChangeAnim
Trigger1 = !Time
Trigger1 = var(1) = 3
Value = 188

[State 191, 1]
Type = ChangeAnim
Trigger1 = !Time
Trigger1 = var(29)
Trigger1 = var(1) != [2,3]
Value = 186

[State 191, 1]
Type = PlaySnd
Trigger1 = Anim = 186
Trigger1 = AnimElem = 12
Value = 186,0
Channel = 3

[State 191, 1]
Type = PlaySnd
TriggerAll = Anim != 186
Trigger1 = AnimElem = 5
Trigger1 = var(1) != 3
Value = 181, (var(1) = 2)
Channel = 1

[State 191, 1]
Type = PlaySnd
Trigger1 = Anim != 186
Trigger1 = AnimElem = 4
Trigger1 = var(1) = 3
Value = 180,2
Channel = 1



;----------------------------
;----- Win Pose 3 All -------
;----------------------------
[Statedef 182]
Type = S
Ctrl = 0
Anim = 183
Velset = 0

[State 191, 1]
Type = ChangeAnim
Trigger1 = !Time
Trigger1 = !var(1)
Value = 184

[State 191, 1]
Type = ChangeAnim
Trigger1 = !Time
Trigger1 = var(1) = 2
Value = 180

[State 191, 1]
Type = ChangeAnim
Trigger1 = !Time
Trigger1 = var(1) = 3
Value = 189

[State 191, 1]
Type = ChangeAnim
Trigger1 = !Time
Trigger1 = var(1) = 4
Value = 187

[State 191, 1]
Type = ChangeAnim
Trigger1 = !Time
Trigger1 = var(29)
Trigger1 = var(1) != [2,3]
Value = 186

[State 191, 1]
Type = PlaySnd
Trigger1 = Anim = 186
Trigger1 = AnimElem = 12
Value = 186,0
Channel = 3

[State 191, 1]
Type = PlaySnd
Trigger1 = Anim != 186
Trigger1 = AnimElem = 4
Trigger1 = !var(1)
Value = 182,1
Channel = 1

[State 191, 1]
Type = PlaySnd
TriggerAll = AnimElem = 1
Trigger1 = Anim != 186
Trigger1 = var(1) = 1
Value = 182,0
Channel = 1

[State 191, 1]
Type = PlaySnd
Trigger1 = Anim != 186
Trigger1 = AnimElem = 3
Trigger1 = var(1) = 2
Value = 180,1
Channel = 1

[State 191, 1]
Type = PlaySnd
Trigger1 = Anim != 186
Trigger1 = AnimElem = 2
Trigger1 = var(1) = 3
Value = 182,2
Channel = 1

[State 191, 1]
Type = AssertSpecial
Trigger1 = Anim != 186
Trigger1 = Time < 310
Trigger1 = var(1) = [3,4]
Flag = roundnotover

;----------------------------
;---------- Intro -----------
;----------------------------
[Statedef 191]
Type = S
Ctrl = 0
Anim = 190+var(1)+(var(1) = 4)
Velset = 0

[State 750, Left LV]
Type = Explod
Trigger1 = var(10) = 1
Trigger1 = Time = 1
Anim = ifelse(var(21) < 0 ||var(21) > 4, 8605, 8600+var(21))
ID =  8600
PosType = Left
Pos = 27,200
BindTime = -1
Ontop = 1
OwnPal = 1

[State 750, Right LV]
Type = Explod
Trigger1 = var(10) = 2
Trigger1 = Time = 1
Anim = ifelse(var(21) < 0 ||var(21) > 4, 8605, 8600+var(21))
ID =  8600
PosType = Right
Pos = -27,200
BindTime = -1
Ontop = 1
OwnPal = 1

[State 191, 1]
Type = AssertSpecial
Trigger1 = 1
flag = intro

[State 191, 1]
Type = Changestate
TriggerAll = Time = 2
TriggerAll = var(1) != [2,3]
TriggerAll = !Numpartner
TriggerAll = NumEnemy < 2
Trigger1 = p2Name = "Robert"
Trigger2 = p2Name = "Robert Garcia"
Trigger3 = p2Name = "Ryo"
Trigger4 = p2Name = "Ryo Sakazaki"
Trigger5 = p2Name = "Yuri"
Trigger6 = p2Name = "Yuri Sakazaki"
value = 192

[State 191, 1]
Type = PlaySnd
TriggerAll = !var(1)
Trigger1 = AnimElem = 8
Trigger2 = AnimElem = 10
Value = 190,0
Channel = 3

[State 191, 1]
Type = PlaySnd
TriggerAll = var(1) = 1
Trigger1 = AnimElem = 5
Trigger2 = AnimElem = 12
Value = 190,1
Channel = 1

[State 191, 1]
Type = PlaySnd
TriggerAll = var(1) = 2
Trigger1 = AnimElem = 2
Value = 190,2
Channel = 1

[State 191, 1]
Type = PlaySnd
TriggerAll = var(1) = 2
Trigger1 = AnimElem = 26
Value = 1100,0
Channel = 1

[State 191, 1]
Type = PlaySnd
TriggerAll = var(1) = 2
Trigger1 = AnimElem = 28
Value = 5,7
Channel = 3

[State 191, 1]
Type = EnvShake
TriggerAll = var(1) = 2
Trigger1 = AnimElem = 28
Time = 12

[State 3000, Mask]
Type = Explod
Trigger1 = var(1) = 2
trigger1 = AnimElem = 22
anim = 1900
PosType = p1
Ownpal = 1
Sprpriority = 3
Removetime = 48
Pos = 25,-125
Velocity = .7,-11
accel = 0, .5
PauseMoveTime = 99
SuperMoveTime = 99
IgnoreHitPause = 1

[State 3000, Spark]
Type = Explod
Trigger1 = var(1) = 2
trigger1 = AnimElem = 28
anim = 8000
PosType = p1
Ownpal = 1
OnTop = 1
Pos = 45,-115
PauseMoveTime = 99
SuperMoveTime = 99
IgnoreHitPause = 1

[State 3000, broken Mask]
Type = Explod
Trigger1 = var(1) = 2
trigger1 = AnimElem = 28
anim = 1910
PosType = p1
Ownpal = 1
Sprpriority = 2
Removetime = 48
Pos = 50,-110
Velocity = 6,-1
accel = 0, .2
PauseMoveTime = 99
SuperMoveTime = 99
IgnoreHitPause = 1

[State 3000, broken Mask]
Type = Explod
Trigger1 = var(1) = 2
trigger1 = AnimElem = 28
anim = 1920
PosType = p1
Ownpal = 1
Sprpriority = -1
Removetime = 48
Pos = 50,-110
Velocity = 6,-1
accel = 0, .3
PauseMoveTime = 99
SuperMoveTime = 99
IgnoreHitPause = 1

[State 191, 1]
Type = PlaySnd
TriggerAll = var(1) = 4
Trigger1 = AnimElem = 2
Value = 195,0
Channel = 1

[State 191, 9]
Type = ChangeState
Trigger1 = !AnimTime
Value = 0

;----------------------------
;--- Special Intro vs AOF ---
;----------------------------
[Statedef 192]
Type = S
Ctrl = 0
Anim = 194
Velset = 0

[State 191, 1]
Type = AssertSpecial
Trigger1 = 1
flag = intro

[State 191, 1]
Type = Varset
Trigger1 = !var(29)
var(29) = 1

[State 191, 9]
Type = ChangeState
Trigger1 = !AnimTime
Value = 0

;----------------------------
;----------- Taunt ----------
;----------------------------
[Statedef 195]
Type = S
MoveType = A
Physics = S
Anim = 195+(var(1) = 3)
Velset = 0
Ctrl = 0

[State 195, 1]
Type = PlaySnd
Trigger1 = AnimElem = 2
Value = 195,(var(1) = 2)+2*(var(1) = 3)
Channel = 1

[State 195, Aof2 style]
Type = TargetPowerAdd
Trigger1 = Timemod = 5,0
Value = -30

[State 195, 2]
Type = Ctrlset
Trigger1 = Time > 20
Value = 1

[State 195, 9]
Type = ChangeState
Trigger1 = !AnimTime
Value = 0
Ctrl=1

;-----------------------------------
;----------- Weak Punch ------------
;-----------------------------------
[Statedef 200]
Type = S
MoveType = A
Physics = S
Anim = 200+5*(P2BodyDist x <= 20)
Velset = 0
Ctrl = 0
Juggle  = 8

[State 200, Sound Set]
Type = ChangeAnim
Trigger1 = !Time
Trigger1 = var(1) = 3
value = 201

[State 200, Sound Set]
Type = ChangeAnim
Trigger1 = !Time
Trigger1 = var(1) = 4
value = 202+4*(P2BodyDist x <= 20)

[State 200, Sound Set]
Type = varSet
Trigger1 = !Time
var(2) = 0

[State 200, Hitdef]
Type = HitDef
Trigger1 = AnimElem = 2
Trigger1 = Anim = 202
Trigger2 = AnimElem = 3
Trigger2 = Anim = [200,201]
attr = S, NA
damage = 20
AnimType = Light
getpower = 30,15
givepower = 15,8
Guardflag = M
Hitflag = MA
pauseTime = 8,10
SparkNo = S8000
Guard.SparkNo = S8010
sparkxy = -15,ifelse(var(49) > -85, var(49), -85)
HitSound = S5,0
GuardSound = S6,0
ground.Type = High
ground.SlideTime = 9
ground.HitTime  = 9
ground.Velocity = -5
Air.Velocity = -4,-5
yAccel = .5
Ground.cornerpush.veloff = 0;-7
Air.cornerpush.veloff = 0;-7

[State 200, Hitdef]
Type = HitDef
Trigger1 = AnimElem = 3
Trigger1 = Anim = [205,206]
attr = S, NA
damage = 20
AnimType = Light
getpower = 30,15
givepower = 15,8
Guardflag = M
Hitflag = MA
pauseTime = 8,10
SparkNo = S8000
Guard.SparkNo = S8010
sparkxy = -15,ifelse(var(49) > -62-20*(Anim = 206), var(49),  -62-20*(Anim = 206))
HitSound = S5,0
GuardSound = S6,0
ground.Type = Low
ground.SlideTime = 9
ground.HitTime  = 9
ground.Velocity = -5
Air.Velocity = -4,-5
yAccel = .5
Ground.cornerpush.veloff = 0;-7
Air.cornerpush.veloff = 0;-7

[State 1000, 1]
type = Helper
trigger1 = var(1) = 3
trigger1 = !Numhelper(1010)
trigger1 = AnimElem = 3
stateno = 205
postype = p1
pos = 60,-85
name = "proj eraser"
id = 1010


[State 200, Over]
Type = ChangeState
Trigger1 = !AnimTime
Value = 0
Ctrl = 1

;-----------------------------------
;--- proj eraser weak punch SVC ----
;-----------------------------------
[Statedef 205]
Type = S
MoveType = I
Physics = N
Anim = 290
Ctrl = 0
PowerAdd = 0
VelSet = 0,0

[State 1000, 9]
type = DestroySelf
Trigger1 = PrevStateNo = 205
ignorehitpause = 1

[State 700, Cancel4]
type = HitBy
Trigger1 = 1
value= SCA,NP,SP,HP
ignorehitpause = 1

[State 0, HitOverride]
type = HitOverride
trigger1 = 1
attr = SCA,NP,SP,HP
slot = 0
stateno = 205
time = 2
ignorehitpause = 1
persistent = 1

[State 1000, 9]
type = DestroySelf
Trigger1 = !AnimTime
Trigger2 = parent, Stateno != 200
Trigger3 = parent, Stateno = 200
Trigger3 = parent, AnimElem = 4, >= 0
ignorehitpause = 1

;-----------------------------------
;------------ Weak Kick ------------
;-----------------------------------
[Statedef 210]
Type = S
MoveType = A
Physics = S
Anim = 210+5*(P2BodyDist x <= 20 && var(1) != 3)+(var(1) = 3)
Velset = 0
Ctrl = 0
Juggle  = 8

[State 200, Sound Set]
Type = ChangeAnim
Trigger1 = !Time
Trigger1 = var(1) = 4
Trigger1 = P2BodyDist x <= 25
value = 216

[State 200, Sound Set]
Type = varSet
Trigger1 = !Time
var(2) = 0

[State 200, Hitdef]
Type = HitDef
Trigger1 = Anim != 216
Trigger1 = AnimElem = 4
attr = S, NA
damage = 25
AnimType = Light
getpower = 30,15
givepower = 15,8
Guardflag = M
Hitflag = MA
pauseTime = 8,10
SparkNo = S8000
Guard.SparkNo = S8010
sparkxy = -15,ifelse(var(49) > -100+25*(Anim = 215), var(49), -100+25*(Anim = 215))
HitSound = S5,1
GuardSound = S6,0
ground.Type = High
ground.SlideTime = 9
ground.HitTime  = 9
ground.Velocity = -5.5
Air.Velocity = -4,-5
yAccel = .5
Ground.cornerpush.veloff = 0;-7.5
Air.cornerpush.veloff = 0;-7.5

[State 200, Hitdef]
Type = HitDef
Trigger1 = Anim = 216
Trigger1 = AnimElem = 3
attr = S, NA
damage = 25
AnimType = Light
getpower = 30,15
givepower = 15,8
Guardflag = L
Hitflag = MA
pauseTime = 8,10
SparkNo = S8000
Guard.SparkNo = S8010
sparkxy = -30,-20
HitSound = S5,1
GuardSound = S6,0
ground.Type = Low
ground.SlideTime = 9
ground.HitTime  = 9
ground.Velocity = -5.5
Air.Velocity = -4,-5
yAccel = .5
Ground.cornerpush.veloff = 0;-7.5
Air.cornerpush.veloff = 0;-7.5

[State 200, Over]
Type = ChangeState
Trigger1 = !AnimTime
Value = 0
Ctrl = 1

;-----------------------------------
;---------- Medium Punch -----------
;-----------------------------------
[Statedef 220]
Type = S
MoveType = A
Physics = S
Anim = 220
Velset = 0
Ctrl = 0
Juggle  = 8

[State 200, Sound Set]
Type = varSet
Trigger1 = !Time
var(2) = 1

[State 200, Hitdef]
Type = HitDef
Trigger1 = AnimElem = 3
attr = S, NA
damage = 40
AnimType = Medium
getpower = 30,15
givepower = 15,8
Guardflag = M
Hitflag = MA
pauseTime = 9,11
SparkNo = S8001
Guard.SparkNo = S8011
sparkxy = -15,ifelse(var(49) > -65, var(49), -65)
sparkxy = -15,-65
HitSound = S5,2
GuardSound = S6,0
ground.Type = Low
ground.SlideTime = 14
ground.HitTime  = 14
ground.Velocity = -7
Air.Velocity = -4,-5
yAccel = .5
Ground.cornerpush.veloff = 0;-7
Air.cornerpush.veloff = 0;-7

[State 200, Over]
Type = ChangeState
Trigger1 = !AnimTime
Value = 0
Ctrl = 1

;-----------------------------------
;---------- Medium Kick ------------
;-----------------------------------
[Statedef 230]
Type = S
MoveType = A
Physics = S
Anim = 230+5*(P2BodyDist x <= 25 && var(1) != [3,4])
Velset = 0
Ctrl = 0
Juggle  = 8

[State 200, SMK anim]
Type = ChangeAnim
TriggerAll = !Time
Trigger1 = var(1) = 3
Trigger1 = p2bodydist x <= 20
Trigger2 = var(1) = 4
value = 236

[State 200, Sound Set]
Type = varSet
Trigger1 = !Time
var(2) = 1

[State 200, Hitdef]
Type = HitDef
Trigger1 = Anim != 235
Trigger1 = AnimElem = 3
attr = S, NA
damage = 50
AnimType = Medium
getpower = 60,30
givepower = 30,15
Guardflag = M
Hitflag = MA
pauseTime = 9,11
SparkNo = S8001
Guard.SparkNo = S8011
sparkxy = -15,ifelse(var(49) > -100, var(49), -100)
HitSound = S5,3
GuardSound = S6,0
ground.Type = High
ground.SlideTime = 14
ground.HitTime = 14
ground.Velocity = -7.5
Air.Velocity = -4,-5
yAccel = .5
Ground.cornerpush.veloff = 0;-11.5
Air.cornerpush.veloff = 0;-11.5

[State 200, Hitdef]
Type = HitDef
Trigger1 = Anim = 235
Trigger1 = AnimElem = 4
attr = S, NA
damage = 50
AnimType = Medium
getpower = 60,30
givepower = 30,15
Guardflag = L
Hitflag = MA
pauseTime = 9,11
SparkNo = S8001
Guard.SparkNo = S8011
sparkxy = -30,-20
HitSound = S5,3
GuardSound = S6,0
ground.Type = Low
ground.SlideTime = 14
ground.HitTime = 14
ground.Velocity = -7.5
Air.Velocity = -4,-5
yAccel = .5
Ground.cornerpush.veloff = 0;-11.5
Air.cornerpush.veloff = 0;-11.5

[State 200, Over]
Type = ChangeState
Trigger1 = !AnimTime
Value = 0
Ctrl = 1

;-----------------------------------
;---------- Strong Punch -----------
;-----------------------------------
[Statedef 240]
Type = S
MoveType = A
Physics = S
Anim = 240+5*(P2BodyDist x <= 23)+(var(1) = 3)
Velset = 0
Ctrl = 0
Juggle  = 8

[State 200, Sound Set]
Type = varSet
Trigger1 = !Time
var(2) = 2

[State 200, Hitdef]
Type = HitDef
Trigger1 = AnimElem = 3
attr = S, NA
damage = 80
AnimType = Heavy
getpower = 120,60
givepower = 30,15
Guardflag = M
Hitflag = MA
pauseTime = 10,12
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,ifelse(var(49) > -77-6*(Anim = 245), var(49), -77-6*(Anim = 245))
HitSound = S5,4
GuardSound = S6,0
ground.Type = High
ground.SlideTime = 17
ground.HitTime = 17
ground.Velocity = -9
Air.Velocity = -4,-5
yAccel = .5
Ground.cornerpush.veloff = 0;-15
Air.cornerpush.veloff = 0;-15
EnvShake.Time = 5

[State 1000, 9]
type = ChangeState
trigger1 = var(9)
trigger1 = !AnimTime
Trigger1 = random < 300
value = 160

[State 200, Over]
Type = ChangeState
Trigger1 = !AnimTime
Value = 0
Ctrl = 1

;-----------------------------------
;---------- Strong Kick ------------
;-----------------------------------
[Statedef 250]
Type = S
MoveType = A
Physics = S
Anim = 250+5*(P2BodyDist x <= 30)
Velset = 0
Ctrl = 0
Juggle  = 8

[State 200, Sound Set]
Type = ChangeAnim
Trigger1 = !Time
Trigger1 = var(1) = 3
value = 251

[State 200, Sound Set]
Type = ChangeAnim
Trigger1 = !Time
Trigger1 = var(1) = 4
Trigger1 = p2bodydist x > 30
value = 252

[State 200, Sound Set]
Type = varSet
Trigger1 = !Time
var(2) = 2

[State 200, Sound Set]
Type = PosAdd
TriggerAll = Anim = 250
Trigger1 = AnimElem = 8
x = 5

[State 200, Sound Set]
Type = PosAdd
TriggerAll = Anim = 250
Trigger1 = AnimElem = 2
Trigger2 = AnimElem = 3
Trigger3 = AnimElem = 5
Trigger4 = AnimElem = 9
Trigger5 = AnimElem = 10
x = 7

[State 200, Hitdef]
Type = HitDef
Trigger1 = Anim = 250
Trigger1 = AnimElem = 6
attr = S, NA
damage = 100
AnimType = Heavy
getpower = 120,60
givepower = 30,15
Guardflag = M
Hitflag = MA
pauseTime = 10,12
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,ifelse(var(49) > -67, var(49), -67)
HitSound = S5,5
GuardSound = S6,0
ground.Type = Low
ground.SlideTime = 17
ground.HitTime = 17
ground.Velocity = -9.5
Air.Velocity = -4,-5
yAccel = .5
Ground.cornerpush.veloff = 0;-15.5
Air.cornerpush.veloff = 0;-15.5
EnvShake.Time = 5

[State 200, Hitdef]
Type = HitDef
TriggerAll = AnimElem = 12
Trigger1 = Anim = 251
Trigger2 = Anim = 255
attr = S, NA
damage = 100
AnimType = Heavy
getpower = 120,60
givepower = 30,15
Guardflag = M
Hitflag = MA
pauseTime = 10,12
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,ifelse(var(49) > -120, var(49), -120)
HitSound = S5,5
GuardSound = S6,0
ground.Type = High
ground.SlideTime = 17
ground.HitTime = 17
ground.Velocity = -9.5
Air.Velocity = -4,-5
yAccel = .5
Ground.cornerpush.veloff = 0;-15.5
Air.cornerpush.veloff = 0;-15.5
EnvShake.Time = 5

[State 200, Hitdef]
Type = HitDef
Trigger1 = AnimElem = 5
Trigger1 = Anim = 252
attr = S, NA
damage = 100
AnimType = Heavy
getpower = 120,60
givepower = 30,15
Guardflag = M
Hitflag = MA
pauseTime = 10,12
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,ifelse(var(49) > -100, var(49), -100)
HitSound = S5,5
GuardSound = S6,0
ground.Type = High
ground.SlideTime = 17
ground.HitTime = 17
ground.Velocity = -9.5
Air.Velocity = -4,-5
yAccel = .5
Ground.cornerpush.veloff = 0;-15.5
Air.cornerpush.veloff = 0;-15.5
EnvShake.Time = 5

[State 1000, 9]
type = ChangeState
trigger1 = var(9)
trigger1 = !AnimTime
Trigger1 = random < 300
value = 160

[State 200, Over]
Type = ChangeState
Trigger1 = !AnimTime
Value = 0
Ctrl = 1

;-----------------------------------
;-------- KnockDown Attack ---------
;-----------------------------------
[Statedef 260]
Type = S
MoveType = A
Physics = S
Anim = 260
Velset = 0
Ctrl = 0
Juggle  = 8
Poweradd = -1000*(prevstateno = [150,152])

[State 700, ChangeAnim]
type = ChangeAnim
Trigger1 = !Time
Trigger1 = var(1) < 2
trigger1 = prevstateno != [150,152]
value = 265

[State 700, Cancel0]
type = VarAdd
Trigger1 = !Time
trigger1 = prevstateno = [150,152]
var(16) = -1000

[State 700, Cancel1]
type = pause
Trigger1 = !Time
trigger1 = prevstateno = [150,152]
time = 3
movetime = 3

[State 700, Cancel2]
type = envcolor
Trigger1 = !Time
trigger1 = prevstateno = [150,152]
time = 2
value= 255,255,255

[State 700, Cancel3]
type = Explod
Trigger1 = !Time
trigger1 = prevstateno = [150,152]
anim = 730
pos = 10,-80
postype = p1
pausemovetime = 9999
bindtime = 1
ownpal = 1
persistent = 0
ontop = 1

[State 700, Cancel4]
type = NotHitBy
Trigger1 = AnimElem = 5, < 0
trigger1 = prevstateno = [150,152]
value= SCA

[State 200, Sound Set]
Type = varSet
Trigger1 = !Time
var(2) = 3

[State 700, Cancel4]
type = posAdd
TriggerAll = Anim = 265
Trigger1 = AnimElem = 1
Trigger2 = AnimElem = 2
Trigger3 = AnimElem = 3
x = 7

[State 700, Cancel4]
type = posAdd
Trigger1 = Anim = 265
Trigger1 = AnimElem = 4
x = 14

[State 200, Hitdef]
Type = HitDef
trigger1 = prevstateno != [150,152]
Trigger1 = AnimElem = 4
attr = S, NA
damage = 100
AnimType = up
getpower = 120,60
givepower = 30,15
Guardflag = M
Hitflag = MA
pauseTime = 11,13
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,ifelse(var(49) > -85+10*(Anim = 265), var(49), -85+10*(Anim = 265))
HitSound = S5,6
GuardSound = S6,0
ground.Type = High
ground.SlideTime = 17
ground.HitTime = 17
ground.Velocity = -3,-7.5
Guard.Velocity = -11.5
Air.Velocity = -3,-7
yAccel = .5
Ground.cornerpush.veloff = 0;-15.5
Air.cornerpush.veloff = 0;-15.5
EnvShake.Time = 15
Fall = 1
Fall.Recover = !var(55)
Fall.RecoverTime = 40

[State 200, Hitdef]
Type = HitDef
Trigger1 = prevstateno = [150,152]
Trigger1 = AnimElem = 4
attr = S, SA
damage = 60
AnimType = DiagUp
getpower = 0,0
givepower = 30,15
Guardflag = M
Hitflag = MA
pauseTime = 11,13
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,ifelse(var(49) > -70, var(49), -70)
HitSound = S5,6
GuardSound = S6,0
ground.Type = High
ground.SlideTime = 17
ground.HitTime = 17
ground.Velocity = -4,-6.5
Guard.Velocity = -11.5
Air.Velocity = -4,-6
yAccel = .45
Ground.cornerpush.veloff = 0;-15.5
Air.cornerpush.veloff = 0;-15.5
EnvShake.Time = 15
Fall = 1
Fall.Recover = !var(55)
Fall.RecoverTime = 40

[State 1000, 9]
type = ChangeState
trigger1 = var(9)
trigger1 = !AnimTime
Trigger1 = random < 200
value = 160

[State 200, Over]
Type = ChangeState
Trigger1 = !AnimTime
Value = 0
Ctrl = 1

;-----------------------------------
;----------- Oniguruma -------------
;-----------------------------------
[Statedef 300]
Type = S
MoveType = A
Physics = S
Anim = 300
Velset = 0
Ctrl = 0
Juggle  = 8

[State 200, Sound Set]
Type = PlaySND
Trigger1 = Time = 1
value = 2*(var(1) > 1),1+2*(var(1) > 1)
channel = 1

[State 200, Sound Set]
Type = PlaySND
Trigger1 = AnimElem = 3
value = 1,2
channel = 3

[State 200, PosAdd]
Type = PosAdd
Trigger1 = AnimElem = 1
Trigger2 = AnimElem = 2
x = 7

[State 200, PosAdd]
Type = PosAdd
Trigger1 = AnimElem = 3
Trigger2 = AnimElem = 4
x = 5

[State 200, PosAdd]
Type = PosAdd
Trigger1 = AnimElem = 5
x = 11

[State 200, PosAdd]
Type = PosAdd
Trigger1 = AnimElem = 6
x = 6

[State 200, Hitdef]
Type = HitDef
TriggerAll = prevstateNo != [200,450]
Trigger1 = AnimElem = 4
attr = S, NA
damage = 100
AnimType = up
getpower = 60,30
givepower = 30,15
Guardflag = H
Hitflag = MA
pauseTime = 10,12
guard.pauseTime = 10,12
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,ifelse(var(49) > -80, var(49), -80)
HitSound = S5,6
GuardSound = S6,0
ground.Type = High
ground.SlideTime = 17
ground.HitTime = 17
ground.Velocity = 0
guard.Velocity = -9.5
Air.Velocity = 0,10
yAccel = 10
Ground.cornerpush.veloff = 0;-10.5
Air.cornerpush.veloff = 0;-10.5
Envshake.time = 10
Fall = 1
Fall.Recover = 0

[State 200, Hitdef]
Type = HitDef
TriggerAll = prevstateNo = [200,450]
Trigger1 = AnimElem = 4
attr = S, NA
damage = 70
AnimType = High
Fall.AnimType = Up
getpower = 60,30
givepower = 30,15
Guardflag = M
Hitflag = MA
pauseTime = 10,12
guard.pauseTime = 10,12
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,ifelse(var(49) > -80, var(49), -80)
sparkxy = -15,-80
HitSound = S5,6
GuardSound = S6,0
ground.Type = High
ground.SlideTime = 17
ground.HitTime = 17
ground.Velocity = -9.5
Air.Velocity = 0,10
yAccel = 10
Ground.cornerpush.veloff = 0;-10.5
Air.cornerpush.veloff = 0;-10.5
Envshake.time = 10
Air.Fall = 1
Fall.Recover = 0

[State 200, Over]
Type = ChangeState
Trigger1 = !AnimTime
Value = 0
Ctrl = 1

;-----------------------------------
;--------- Kawara Wari  -----------
;-----------------------------------
[Statedef 310]
Type = S
MoveType = A
Physics = S
Anim = 310+5*(PrevStateno = [200,450])
Velset = 0
Ctrl = 0
Juggle  = 8

[State 200, Sound Set]
Type = PlaySND
Trigger1 = Time = 1
value = 2*(var(1) > 1),1+(var(1) > 1)
channel = 1

[State 200, Sound Set]
Type = PlaySND
Trigger1 = AnimElem = 3
value = 1,2
channel = 3

[State 200, Hitdef]
Type = HitDef
TriggerAll = PrevStateno != [200,450]
Trigger1 = AnimElem = 6
attr = S, NA
damage = 80
AnimType = Heavy
getpower = 60,30
givepower = 30,15
Guardflag = H
Hitflag = MA
pauseTime = 10,12
guard.pauseTime = 10,12
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,-50
HitSound = S5,4
GuardSound = S6,0
ground.Type = Low
ground.SlideTime = 17
ground.HitTime = 17
ground.Velocity = -9
guard.Velocity = -9
Air.Velocity = -4,-5.5
yAccel = .5
Ground.cornerpush.veloff = 0;-10.5
Air.cornerpush.veloff = 0;-10.5
Envshake.time = 5
Air.Fall = 1
Fall.Recover = !var(35)
Fall.Recovertime = 40

[State 200, Hitdef]
Type = HitDef
TriggerAll = PrevStateno = [200,450]
Trigger1 = AnimElem = 6
attr = S, NA
damage = 80
AnimType = Low
getpower = 60,30
givepower = 30,15
Guardflag = M
Hitflag = MA
pauseTime = 10,12
guard.pauseTime = 10,12
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,-50
HitSound = S5,4
GuardSound = S6,0
ground.Type = Low
ground.SlideTime = 17
ground.HitTime = 17
ground.Velocity = -9
Air.Velocity = -4,-5.5
yAccel = .5
Ground.cornerpush.veloff = 0;-10.5
Air.cornerpush.veloff = 0;-10.5
Envshake.time = 5
Air.Fall = 1
Fall.Recover = !var(35)
Fall.Recovertime = 40

[State 200, Over]
Type = ChangeState
Trigger1 = !AnimTime
Value = 0
Ctrl = 1

;-----------------------------------
;--- Hisha Otoshi: Dan Tsubushi ----
;-----------------------------------
[Statedef 320]
Type = S
MoveType = A
Physics = S
Anim = 320
Velset = 0
Ctrl = 0
Juggle  = 8

[State 200, Sound Set]
Type = PlaySND
Trigger1 = Time = 1
value = 2*(var(1) > 1),1+(var(1) > 1)
channel = 1

[State 200, Sound Set]
Type = PlaySND
Trigger1 = AnimElem = 3
value = 1,2
channel = 3

[State 1000, 1]
type = Helper
trigger1 = !Numhelper(1010)
trigger1 = AnimElem = 7
stateno = 325
postype = p1
pos = 0,0
name = "proj eraser"
id = 1010

[State 1000, 1]
type = Helper
trigger1 = !Numhelper(1010)
trigger1 = AnimElem = 8
stateno = 326
postype = p1
pos = 0,0
name = "proj eraser"
id = 1010


[State 200, Hitdef]
Type = HitDef
Trigger1 = AnimElem = 8
attr = S, NA
damage = 80
AnimType = Heavy
getpower = 60,30
givepower = 30,15
Guardflag = M
Hitflag = MA
pauseTime = 10,12
guard.pauseTime = 10,12
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,-70
HitSound = S5,4
GuardSound = S6,0
ground.Type = High
ground.SlideTime = 17
ground.HitTime = 17
ground.Velocity = -9
Air.Velocity = -4,-5.5
yAccel = .5
Ground.cornerpush.veloff = 0;-10.5
Air.cornerpush.veloff = 0;-10.5
Envshake.time = 5
Air.Fall = 1
Fall.Recover = !var(35)
Fall.Recovertime = 40

[State 200, Over]
Type = ChangeState
Trigger1 = !AnimTime
Value = 0
Ctrl = 1

;-----------------------------------
;--- proj eraser Hisha Otoshi - 1 --
;-----------------------------------
[Statedef 325]
Type = S
MoveType = I
Physics = N
Anim = 325
Ctrl = 0
PowerAdd = 0
VelSet = 0,0

[State 1000, 9]
type = DestroySelf
Trigger1 = PrevStateNo = 325
ignorehitpause = 1

[State 700, Cancel4]
type = HitBy
Trigger1 = 1
value= SCA,NP,SP,HP
ignorehitpause = 1

[State 0, HitOverride]
type = HitOverride
trigger1 = 1
attr = SCA,NP,SP,HP
slot = 0
stateno = 325
time = 2
ignorehitpause = 1
persistent = 1

[State 1000, 9]
type = DestroySelf
Trigger1 = !AnimTime
Trigger2 = parent, Stateno != 320
Trigger3 = parent, Stateno = 320
Trigger3 = parent, AnimElem = 8, >= 0
ignorehitpause = 1

;-----------------------------------
;--- proj eraser Hisha Otoshi - 2 --
;-----------------------------------
[Statedef 326]
Type = S
MoveType = I
Physics = N
Anim = 326
Ctrl = 0
PowerAdd = 0
VelSet = 0,0

[State 1000, 9]
type = DestroySelf
Trigger1 = PrevStateNo = 326
ignorehitpause = 1

[State 700, Cancel4]
type = HitBy
Trigger1 = 1
value= SCA,NP,SP,HP
ignorehitpause = 1

[State 0, HitOverride]
type = HitOverride
trigger1 = 1
attr = SCA,NP,SP,HP
slot = 0
stateno = 326
time = 2
ignorehitpause = 1
persistent = 1

[State 1000, 9]
type = DestroySelf
Trigger1 = !AnimTime
Trigger2 = parent, Stateno != 320
Trigger3 = parent, Stateno = 320
Trigger3 = parent, AnimElem = 9, >= 0
ignorehitpause = 1

;-----------------------------------
;------ Yoke Migi Seiken Zuki ------
;-----------------------------------
[Statedef 330]
Type = S
MoveType = A
Physics = S
Anim = 330
Velset = 0
Ctrl = 0
Juggle  = 8

[State 200, Sound Set]
Type = PlaySND
Trigger1 = AnimElem = 3
value = 2*(var(1) > 1),1+(var(1) > 1)
channel = 1

[State 200, Sound Set]
Type = PlaySND
Trigger1 = AnimElem = 3
value = 1,1
channel = 3

[State 200, Hitdef]
Type = HitDef
Trigger1 = AnimElem = 4
attr = S, NA
damage = 60
AnimType = Heavy
getpower = 60,30
givepower = 30,15
Guardflag = M
Hitflag = MA
pauseTime = 10,12
guard.pauseTime = 10,12
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,ifelse(var(49) > -85, var(49), -85)
HitSound = S5,4
GuardSound = S6,0
ground.Type = High
ground.SlideTime = 17
ground.HitTime = 17
ground.Velocity = -9
Air.Velocity = -4,-5.5
yAccel = .5
Ground.cornerpush.veloff = 0;-10.5
Air.cornerpush.veloff = 0;-10.5
Envshake.time = 5
Air.Fall = 1
Fall.Recover = !var(35)
Fall.Recovertime = 40

[State 200, Over]
Type = ChangeState
Trigger1 = !AnimTime
Value = 0
Ctrl = 1

;-----------------------------------
;--- Shagami Shite Mawashi Geri ----
;-----------------------------------
[Statedef 340]
Type = S
MoveType = A
Physics = S
Anim = 340
Velset = 0
Ctrl = 0
Juggle  = 8

[State 200, Sound Set]
Type = PlaySND
Trigger1 = AnimElem = 3
value = 2*(var(1) > 1),1+(var(1) > 1)
channel = 1

[State 200, Sound Set]
Type = PlaySND
Trigger1 = AnimElem = 5
value = 1,1
channel = 3

[State 200, Hitdef]
Type = HitDef
Trigger1 = AnimElem = 8
attr = S, NA
damage = 60
AnimType = Heavy
getpower = 60,30
givepower = 30,15
Guardflag = M
Hitflag = MA
pauseTime = 10,12
guard.pauseTime = 10,12
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,ifelse(var(49) > -100, var(49), -100)
HitSound = S5,5
GuardSound = S6,0
ground.Type = Low
ground.SlideTime = 17
ground.HitTime = 17
ground.Velocity = -9
Air.Velocity = -4,-5.5
yAccel = .5
Ground.cornerpush.veloff = 0;-10.5
Air.cornerpush.veloff = 0;-10.5
Envshake.time = 5
Air.Fall = 1
Fall.Recover = !var(35)
Fall.Recovertime = 40

[State 200, Over]
Type = ChangeState
Trigger1 = !AnimTime
Value = 0
Ctrl = 1

;-----------------------------------
;------- Crouch Weak Punch ---------
;-----------------------------------
[Statedef 400]
Type = C
MoveType = A
Physics = C
Anim = 401-(var(1) = 4)
Velset = 0
Ctrl = 0
Juggle  = 8

[State 200, Sound Set]
Type = varSet
Trigger1 = !Time
var(2) = 0

[State 200, Hitdef]
Type = HitDef
Trigger1 = AnimElem = 2
attr = C, NA
damage = 20
AnimType = Light
getpower = 30,15
givepower = 15,8
Guardflag = M
Hitflag = MA
pauseTime = 8,10
SparkNo = S8000
Guard.SparkNo = S8010
sparkxy = -15,-60
HitSound = S5,0
GuardSound = S6,0
ground.Type = Low
ground.SlideTime = 9
ground.HitTime  = 9
ground.Velocity = -5
Air.Velocity = -4,-5
yAccel = .5
Ground.cornerpush.veloff = 0;-7
Air.cornerpush.veloff = 0;-7

[State 1000, 1]
type = Helper
trigger1 = var(1) = 3
trigger1 = !Numhelper(1010)
trigger1 = AnimElem = 2
stateno = 405
postype = p1
pos = 50,-65
name = "proj eraser"
id = 1010

[State 200, Over]
Type = ChangeState
Trigger1 = !AnimTime
Value = 11
Ctrl = 1

;-----------------------------------
;--- proj eraser weak punch SVC ----
;-----------------------------------
[Statedef 405]
Type = S
MoveType = I
Physics = N
Anim = 290
Ctrl = 0
PowerAdd = 0
VelSet = 0,0

[State 1000, 9]
type = DestroySelf
Trigger1 = PrevStateNo = 405
ignorehitpause = 1

[State 700, Cancel4]
type = HitBy
Trigger1 = 1
value= SCA,NP,SP,HP
ignorehitpause = 1

[State 0, HitOverride]
type = HitOverride
trigger1 = 1
attr = SCA,NP,SP,HP
slot = 0
stateno = 405
time = 2
ignorehitpause = 1
persistent = 1


[State 1000, 9]
type = DestroySelf
Trigger1 = !AnimTime
Trigger2 = parent, Stateno != 400
Trigger3 = parent, Stateno = 400
Trigger3 = parent, AnimElem = 3, >= 0
ignorehitpause = 1

;-----------------------------------
;-------- Crouch Weak Kick ---------
;-----------------------------------
[Statedef 410]
Type = C
MoveType = A
Physics = C
Anim = 410+(var(1) = 3)
Velset = 0
Ctrl = 0
Juggle  = 8

[State 200, Sound Set]
Type = varSet
Trigger1 = !Time
var(2) = 0

[State 200, Hitdef]
Type = HitDef
Trigger1 = var(1) != 3
Trigger1 = AnimElem = 2
Trigger2 = var(1) = 3
Trigger2 = AnimElem = 5
attr = C, NA
damage = 25
AnimType = Light
getpower = 30,15
givepower = 15,8
Guardflag = L
Hitflag = MA
pauseTime = 8,10
SparkNo = S8000
Guard.SparkNo = S8010
sparkxy = -20,-5
HitSound = S5,1
GuardSound = S6,0
ground.Type = Low
ground.SlideTime = 9
ground.HitTime  = 9
ground.Velocity = -5.5
Air.Velocity = -4,-5
yAccel = .5
Ground.cornerpush.veloff = 0;-7.5
Air.cornerpush.veloff = 0;-7.5

[State 1000, 1]
type = Helper
trigger1 = var(1) = 3
trigger1 = !Numhelper(1010)
trigger1 = AnimElem = 5
stateno = 415
postype = p1
pos = 100,-10
name = "proj eraser"
id = 1010

[State 200, Over]
Type = ChangeState
Trigger1 = !AnimTime
Value = 11
Ctrl = 1

;-----------------------------------
;---- proj eraser weak kick SVC ----
;-----------------------------------
[Statedef 415]
Type = S
MoveType = I
Physics = N
Anim = 290
Ctrl = 0
PowerAdd = 0
VelSet = 0,0

[State 1000, 9]
type = DestroySelf
Trigger1 = PrevStateNo = 415
ignorehitpause = 1

[State 700, Cancel4]
type = HitBy
Trigger1 = 1
value= SCA,NP,SP,HP
ignorehitpause = 1

[State 0, HitOverride]
type = HitOverride
trigger1 = 1
attr = SCA,NP,SP,HP
slot = 0
stateno = 415
time = 2
ignorehitpause = 1
persistent = 1


[State 1000, 9]
type = DestroySelf
Trigger1 = !AnimTime
Trigger2 = parent, Stateno != 410
Trigger3 = parent, Stateno = 410
Trigger3 = parent, AnimElem = 6, >= 0
ignorehitpause = 1

;-----------------------------------
;------ Crouch Medium Punch --------
;-----------------------------------
[Statedef 420]
Type = C
MoveType = A
Physics = C
Anim = 420
Velset = 0
Ctrl = 0
Juggle  = 8

[State 200, Sound Set]
Type = varSet
Trigger1 = !Time
var(2) = 1

[State 200, Hitdef]
Type = HitDef
Trigger1 = AnimElem = 3
attr = C, NA
damage = 40
AnimType = Medium
getpower = 60,30
givepower = 30,15
Guardflag = M
Hitflag = MA
pauseTime = 9,11
SparkNo = S8001
Guard.SparkNo = S8011
sparkxy = -15,-45
HitSound = S5,2
GuardSound = S6,0
ground.Type = Low
ground.SlideTime = 14
ground.HitTime = 14
ground.Velocity = -7
Air.Velocity = -4,-5
yAccel = .5
Ground.cornerpush.veloff = 0;-11
Air.cornerpush.veloff = 0;-11

[State 1000, 9]
type = ChangeState
trigger1 = var(9)
trigger1 = !AnimTime
Trigger1 = random < 300
value = 160

[State 200, Over]
Type = ChangeState
Trigger1 = !AnimTime
Value = 11
Ctrl = 1

;-----------------------------------
;------ Crouch Medium Punch 2 ------
;-----------------------------------
[Statedef 425]
Type = C
MoveType = A
Physics = C
Anim = 420
Velset = 0
Ctrl = 0
Juggle  = 8

[State 200, Sound Set]
Type = varSet
Trigger1 = !Time
var(2) = 1

[State 200, Hitdef]
Type = HitDef
Trigger1 = AnimElem = 3
attr = C, NA
damage = 40
AnimType = Medium
getpower = 60,30
givepower = 30,15
Guardflag = M
Hitflag = MA
pauseTime = 9,11
SparkNo = S8001
Guard.SparkNo = S8011
sparkxy = -15,-45
HitSound = S5,2
GuardSound = S6,0
ground.Type = Low
ground.SlideTime = 14
ground.HitTime = 14
ground.Velocity = -7
Air.Velocity = -4,-5
yAccel = .5
Ground.cornerpush.veloff = 0;-11
Air.cornerpush.veloff = 0;-11

[State 1000, 9]
type = ChangeState
trigger1 = var(9)
trigger1 = !AnimTime
Trigger1 = random < 300
value = 160

[State 200, Over]
Type = ChangeState
Trigger1 = !AnimTime
Value = 11
Ctrl = 1

;-----------------------------------
;------- Crouch Medium Kick --------
;-----------------------------------
[Statedef 430]
Type = C
MoveType = A
Physics = C
Anim = 430
Velset = 0
Ctrl = 0
Juggle  = 8

[State 200, Sound Set]
Type = varSet
Trigger1 = !Time
var(2) = 1

[State 200, Hitdef]
Type = HitDef
Trigger1 = AnimElem = 3
attr = C, NA
damage = 50
AnimType = Medium
getpower = 60,30
givepower = 30,15
Guardflag = L
Hitflag = MA
pauseTime = 9,11
SparkNo = S8001
Guard.SparkNo = S8011
sparkxy = -15,-10
HitSound = S5,3
GuardSound = S6,0
ground.Type = Low
ground.SlideTime = 14
ground.HitTime = 14
ground.Velocity = -7.5
Air.Velocity = -4,-5
yAccel = .5
Ground.cornerpush.veloff = 0;-11.5
Air.cornerpush.veloff = 0;-11.5

[State 1000, 9]
type = ChangeState
trigger1 = var(9)
trigger1 = !AnimTime
Trigger1 = random < 300
value = 160

[State 200, Over]
Type = ChangeState
Trigger1 = !AnimTime
Value = 11
Ctrl = 1

;-----------------------------------
;------ Crouch Strong Punch --------
;-----------------------------------
[Statedef 440]
Type = C
MoveType = A
Physics = C
Anim = 440+(var(1) != 4)
Velset = 0
Ctrl = 0
Juggle  = 8

[State 200, Sound Set]
Type = varSet
Trigger1 = !Time
var(2) = 2

[State 200, Hitdef]
Type = HitDef
Trigger1 = Anim = 440
Trigger1 = AnimElem = 3
Trigger2 = Anim = 441
Trigger2 = AnimElem = 4
attr = C, NA
damage = 80
AnimType = Heavy
getpower = 120,60
givepower = 30,15
Guardflag = M
Hitflag = MA
pauseTime = 10,12
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,ifelse(var(49) > -95, var(49), -95)
HitSound = S5,4
GuardSound = S6,0
ground.Type = High
ground.SlideTime = 17
ground.HitTime = 17
ground.Velocity = -9
Air.Velocity = -4,-5
yAccel = .5
Ground.cornerpush.veloff = 0;-15
Air.cornerpush.veloff = 0;-15
EnvShake.Time = 5

[State 200, Hitdef]
Type = HitDef
TriggerAll = !MoveContact
Trigger1 = Anim = 440
Trigger1 = AnimElem = 4
Trigger2 = Anim = 441
Trigger2 = AnimElem = 5
attr = C, NA
damage = 40
AnimType = Heavy
getpower = 120,60
givepower = 30,15
Guardflag = M
Hitflag = MA
pauseTime = 10,12
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,ifelse(var(49) > -130, var(49), -130)
HitSound = S5,4
GuardSound = S6,0
ground.Type = High
ground.SlideTime = 17
ground.HitTime = 17
ground.Velocity = -9
Air.Velocity = -4,-5
yAccel = .5
Ground.cornerpush.veloff = 0;-15
Air.cornerpush.veloff = 0;-15
EnvShake.Time = 5

[State 1000, 9]
type = ChangeState
trigger1 = var(9)
trigger1 = !AnimTime
Trigger1 = random < 300
value = 160

[State 200, Over]
Type = ChangeState
Trigger1 = !AnimTime
Value = 11
Ctrl = 1

;-----------------------------------
;------- Crouch Strong Kick --------
;-----------------------------------
[Statedef 450]
Type = C
MoveType = A
Physics = C
Anim = 450
Velset = 0
Ctrl = 0
Juggle  = 8

[State 200, Sound Set]
Type = varSet
Trigger1 = !Time
var(2) = 2

[State 200, Hitdef]
Type = HitDef
Trigger1 = AnimElem = 3
attr = C, NA
damage = 80
AnimType = Heavy
getpower = 120,60
givepower = 30,15
Guardflag = L
Hitflag = MA
pauseTime = 10,12
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,-10
HitSound = S5,5
GuardSound = S6,0
ground.Type = Trip
ground.SlideTime = 17
ground.HitTime = 17
Guard.Velocity = -9.5
ground.Velocity = -3,-6.5
Air.Velocity = -3,-6
yAccel = .5
Ground.cornerpush.veloff = 0;-15.5
Air.cornerpush.veloff = 0;-15.5
EnvShake.Time = 5
Fall = 1
Fall.Recover = !var(55)
Fall.RecoverTime = 30

[State 1000, 9]
type = ChangeState
trigger1 = var(9)
trigger1 = !AnimTime
Trigger1 = random < 300
value = 160

[State 200, Over]
Type = ChangeState
Trigger1 = !AnimTime
Value = 11
Ctrl = 1

;-----------------------------------
;------- Keima Uchi: Oiuchi --------
;-----------------------------------
[Statedef 500]
Type = C
MoveType = A
Physics = C
Anim = 500
Velset = 0
Ctrl = 0
Juggle  = 8

[State 200, Sound Set]
Type = PlaySND
Trigger1 = AnimElem = 2
value = 500,0
Channel = 1

[State 200, Sound Set]
Type = PlaySND
Trigger1 = AnimElem = 5
value = 1,2
Channel = 3

[State 200, Hitdef]
Type = HitDef
Trigger1 = prevStateNo != [200,450]
Trigger1 = AnimElem = 6
attr = C, NA
damage = 50
AnimType = Up
getpower = 120,60
givepower = 60,30
Guardflag = L
Hitflag = MAFD
pauseTime = 10,12
guard.pauseTime = 10,12
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,0
HitSound = S5,6
GuardSound = S6,0
ground.Type = Low
ground.SlideTime = 17
ground.HitTime = 17
ground.Velocity = 0,10
guard.Velocity = -9.5
Air.Velocity = -4,10
down.Velocity = 0,0
yAccel = .5
Ground.cornerpush.veloff = 0;-11.5
Air.cornerpush.veloff = 0;-11.5
Fall = 1
Fall.Recover = 0
EnvShake.time = 15

[State 200, Hitdef]
Type = HitDef
Trigger1 = prevStateNo = [200,450]
Trigger1 = AnimElem = 6
attr = C, NA
damage = 50
AnimType = Hard
Fall.AnimType = Up
getpower = 120,60
givepower = 60,30
Guardflag = L
Hitflag = MAFD
pauseTime = 10,12
air.pauseTime = 10,6
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,0
HitSound = S5,4
GuardSound = S6,0
ground.Type = Low
ground.SlideTime = 17
ground.HitTime = 17
ground.Velocity = -9.5
Air.Velocity = -4,10
down.Velocity = -4,-3
yAccel = .5
Ground.cornerpush.veloff = 0;-11.5
Air.cornerpush.veloff = 0;-11.5
Air.Fall = 1
Fall.Recover = 0
EnvShake.time = 5

[State 200, Over]
Type = ChangeState
Trigger1 = !AnimTime
Value = 0
Ctrl = 1

;-----------------------------------
;----------- Jigoku Zuki -----------
;-----------------------------------
[Statedef 510]
Type = S
MoveType = A
Physics = S
Anim = 510
Velset = 0
Ctrl = 0
Juggle  = 8
Poweradd = 0

[State 200, Sound Set]
Type = varSet
Trigger1 = !Time
var(2) = 2

[State 200, Hitdef]
Type = HitDef
Trigger1 = AnimElem = 3
attr = S, NA
damage = 80
AnimType = Back
getpower = 120,60
givepower = 30,15
Guardflag = M
Hitflag = MA
pauseTime = 10,12
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,ifelse(var(49) > -85, var(49), -85)
sparkxy = -15,-85
HitSound = S5,4
GuardSound = S6,0
ground.Type = High
ground.SlideTime = 17
ground.HitTime = 17
ground.Velocity = -3,-6.5
Guard.Velocity = -9
Air.Velocity = -3,-5.5
yAccel = .5
Ground.cornerpush.veloff = 0;-15.5
Air.cornerpush.veloff = 0;-15.5
EnvShake.Time = 5
Fall = 1
Fall.Recover = !var(55)
Fall.RecoverTime = 40

[State 200, Over]
Type = ChangeState
Trigger1 = !AnimTime
Value = 0
Ctrl = 1

;-----------------------------------
;----------- Soku Gatana -----------
;-----------------------------------
[Statedef 520]
Type = C
MoveType = A
Physics = S
Anim = 520
Velset = 0
Ctrl = 0
Juggle  = 8
Poweradd = 0

[State 200, Sound Set]
Type = varSet
Trigger1 = !Time
var(2) = 2

[State 200, Hitdef]
Type = HitDef
Trigger1 = AnimElem = 4
attr = S, NA
damage = 80
AnimType = Hard
getpower = 120,60
givepower = 30,15
Guardflag = L
Hitflag = MA
pauseTime = 10,12
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,-15
HitSound = S5,5
GuardSound = S6,0
ground.Type = Trip
ground.SlideTime = 17
ground.HitTime = 17
ground.Velocity = -3,-6.5
Guard.Velocity = -9.5
Air.Velocity = -3,-5.5
yAccel = .5
Ground.cornerpush.veloff = 0;-15.5
Air.cornerpush.veloff = 0;-15.5
EnvShake.Time = 5
Fall = 1
Fall.Recover = !var(55)
Fall.RecoverTime = 40

[State 200, Over]
Type = ChangeState
Trigger1 = !AnimTime
Value = 0
Ctrl = 1

;-----------------------------------
;------- Aerial Weak Punch ---------
;-----------------------------------
[Statedef 600]
Type = A
MoveType = A
Physics = A
Anim = 600+5*(!vel x)
Ctrl = 0
Juggle  = 8

[State 200, Sound Set]
Type = ChangeAnim
Trigger1 = !Time
Trigger1 = var(1) = 3
value = 601

[State 200, Sound Set]
Type = varSet
Trigger1 = !Time
var(2) = 0

[State 200, Hitdef]
Type = HitDef
Trigger1 = AnimElem = 2
attr = A, NA
damage = 20
AnimType = Light
getpower = 30,15
givepower = 15,8
Guardflag = HA
Hitflag = MA
pauseTime = 8,10
SparkNo = S8000
Guard.SparkNo = S8010
sparkxy = -15,-60-10*(Anim = 605)
HitSound = S5,0
GuardSound = S6,0
ground.Type = Low
ground.SlideTime = 14
ground.HitTime  = 14
ground.Velocity = -5
Air.Velocity = -4,-5
yAccel = .5
Ground.cornerpush.veloff = 0;-5
Air.cornerpush.veloff = 0;-5

;-----------------------------------
;-------- Aerial Weak Kick ---------
;-----------------------------------
[Statedef 610]
Type = A
MoveType = A
Physics = A
Anim = 610+5*(Vel x = 0)
Ctrl = 0
Juggle  = 8

[State 200, Sound Set]
Type = ChangeAnim
Trigger1 = !Time
Trigger1 = var(1) = 3
value = 611

[State 200, Sound Set]
Type = varSet
Trigger1 = !Time
var(2) = 0

[State 200, Hitdef]
Type = HitDef
Trigger1 = Anim != 615
Trigger1 = AnimElem = 2
attr = A, NA
damage = 25
AnimType = Light
getpower = 30,15
givepower = 15,8
Guardflag = HA
Hitflag = MA
pauseTime = 8,10
SparkNo = S8000
Guard.SparkNo = S8010
sparkxy = -15,-50+20*(anim = 611)
HitSound = S5,1
GuardSound = S6,0
ground.Type = Low
ground.SlideTime = 14
ground.HitTime  = 14
ground.Velocity = -5.5
Air.Velocity = -4,-5
yAccel = .5
Ground.cornerpush.veloff = 0;-5.5
Air.cornerpush.veloff = 0;-5.5

[State 200, Hitdef]
Type = HitDef
Trigger1 = Anim = 615
Trigger1 = AnimElem = 4
attr = A, NA
damage = 25
AnimType = Light
getpower = 30,15
givepower = 15,8
Guardflag = HA
Hitflag = MA
pauseTime = 8,10
SparkNo = S8000
Guard.SparkNo = S8010
sparkxy = -15,-75
HitSound = S5,1
GuardSound = S6,0
ground.Type = High
ground.SlideTime = 14
ground.HitTime  = 14
ground.Velocity = -5.5
Air.Velocity = -4,-5
yAccel = .5
Ground.cornerpush.veloff = 0;-5.5
Air.cornerpush.veloff = 0;-5.5

;-----------------------------------
;------ Aerial Medium Punch --------
;-----------------------------------
[Statedef 620]
Type = A
MoveType = A
Physics = A
Anim = 620
Ctrl = 0
Juggle  = 8

[State 200, Sound Set]
Type = varSet
Trigger1 = !Time
var(2) = 1


[State 200, Hitdef]
Type = HitDef
Trigger1 = AnimElem = 4
attr = A, NA
damage = 40
AnimType = Medium
getpower = 60,30
givepower = 30,15
Guardflag = HA
Hitflag = MA
pauseTime = 9,11
SparkNo = S8001
Guard.SparkNo = S8011
sparkxy = -15,-95
HitSound = S5,2
GuardSound = S6,0
ground.Type = High
ground.SlideTime = 14
ground.HitTime  = 14
ground.Velocity = -6
Air.Velocity = -4,-5
yAccel = .5
Ground.cornerpush.veloff = 0;-6
Air.cornerpush.veloff = 0;-6

;-----------------------------------
;------- Aerial Medium Kick --------
;-----------------------------------
[Statedef 630]
Type = A
MoveType = A
Physics = A
Anim = 630+5*(var(1) = 3 && !var(20))
Ctrl = 0
Juggle  = 8

[State 200, Sound Set]
Type = varSet
Trigger1 = !Time
var(2) = 1

[State 200, Hitdef]
Type = HitDef
Trigger1 = AnimElem = 2
attr = A, NA
damage = 50
AnimType = Medium
getpower = 60,30
givepower = 30,15
Guardflag = HA
Hitflag = MA
pauseTime = 9,11
SparkNo = S8001
Guard.SparkNo = S8011
sparkxy = -15,-30
HitSound = S5,3
GuardSound = S6,0
ground.Type = Low
ground.SlideTime = 14
ground.HitTime  = 14
ground.Velocity = -6.5
Air.Velocity = -4,-5
yAccel = .5
Ground.cornerpush.veloff = 0;-6.5
Air.cornerpush.veloff = 0;-6.5

[State 200, Sound Set]
Type = ChangeState
Trigger1 = AnimElem = 3
Trigger1 = var(9)
Trigger1 = vel x <= 0
Trigger1 = vel y = [-2.5,2.5]
trigger1 = backedgedist < 40
trigger1 = Anim = 635
value = ifelse(p2bodydist x < 150, 680, 675)

[State 200, Sound Set]
Type = ChangeState
Trigger1 = AnimElem = 3
Trigger1 = vel x <= 0
Trigger1 = vel y = [-2.5,2.5]
trigger1 = backedgedist < 40
trigger1 = Anim = 635
value = 675+5*(command != "holdup")

;-----------------------------------
;------ Aerial Strong Punch --------
;-----------------------------------
[Statedef 640]
Type = A
MoveType = A
Physics = A
Anim = 640
Ctrl = 0
Juggle  = 8

[State 200, Sound Set]
Type = varSet
Trigger1 = !Time
var(2) = 2

[State 200, Hitdef]
Type = HitDef
Trigger1 = AnimElem = 4
attr = A, NA
damage = 80
AnimType = Heavy
getpower = 120,60
givepower = 30,15
Guardflag = HA
Hitflag = MA
pauseTime = 10,12
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,-60
HitSound = S5,4
GuardSound = S6,0
ground.Type = Low
ground.SlideTime = 14
ground.HitTime  = 14
ground.Velocity = -7
Air.Velocity = -4,-5
yAccel = .5
Ground.cornerpush.veloff = 0;-7
Air.cornerpush.veloff = 0;-7
EnvShake.Time = 5

;-----------------------------------
;------- Aerial Strong Kick --------
;-----------------------------------
[Statedef 650]
Type = A
MoveType = A
Physics = A
Anim = 650+5*(Vel x = 0)
Ctrl = 0
Juggle  = 8

[State 200, Sound Set]
Type = ChangeAnim
Trigger1 = !Time
Trigger1 = var(1) = 4
value = anim+1

[State 200, Sound Set]
Type = varSet
Trigger1 = !Time
var(2) = 2

[State 200, Hitdef]
Type = HitDef
TriggerAll = AnimElem = 3
Trigger1 = Anim = 650
Trigger2 = Anim = 655
attr = A, NA
damage = 80
AnimType = Heavy
getpower = 120,60
givepower = 30,15
Guardflag = HA
Hitflag = MA
pauseTime = 10,12
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,-45-15*(anim = 655)
HitSound = S5,5
GuardSound = S6,0
ground.Type = Low
ground.SlideTime = 14
ground.HitTime  = 14
Guard.Velocity = -7.5
ground.Velocity = -7.5
Air.Velocity = -4,-5
yAccel = .5
Ground.cornerpush.veloff = 0;-7.5
Air.cornerpush.veloff = 0;-7.5
EnvShake.Time = 5

[State 200, Hitdef]
Type = HitDef
Trigger1 = AnimElem = 2
Trigger1 = Anim = 651
attr = A, NA
damage = 80
AnimType = Heavy
getpower = 120,60
givepower = 30,15
Guardflag = HA
Hitflag = MA
pauseTime = 10,12
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,-40
HitSound = S5,5
GuardSound = S6,0
ground.Type = Low
ground.SlideTime = 14
ground.HitTime  = 14
Guard.Velocity = -7.5
ground.Velocity = -7.5
Air.Velocity = -4,-5
yAccel = .5
Ground.cornerpush.veloff = 0;-7.5
Air.cornerpush.veloff = 0;-7.5
EnvShake.Time = 5

[State 200, Hitdef]
Type = HitDef
Trigger1 = AnimElem = 2
Trigger1 = Anim = 656
attr = A, NA
damage = 80
AnimType = Heavy
getpower = 120,60
givepower = 30,15
Guardflag = HA
Hitflag = MA
pauseTime = 10,12
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,-75
HitSound = S5,5
GuardSound = S6,0
ground.Type = High
ground.SlideTime = 14
ground.HitTime  = 14
Guard.Velocity = -7.5
ground.Velocity = -7.5
Air.Velocity = -4,-5
yAccel = .5
Ground.cornerpush.veloff = 0;-7.5
Air.cornerpush.veloff = 0;-7.5
EnvShake.Time = 5

;-----------------------------------
;-------- KnockDown Attack ---------
;-----------------------------------
[Statedef 660]
Type = A
MoveType = A
Physics = A
Anim = 660
Ctrl = 0
Juggle  = 8

[State 200, Sound Set]
Type = varSet
Trigger1 = !Time
var(2) = 3

[State 200, Hitdef]
Type = HitDef
Trigger1 = AnimElem = 3
attr = A, NA
damage = 100
AnimType = Up
getpower = 120,60
givepower = 30,15
Guardflag = MA
Hitflag = MA
pauseTime = 11,13
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,-85
HitSound = S5,6
GuardSound = S6,0
ground.Type = High
ground.SlideTime = 17
ground.HitTime = 17
ground.Velocity = -3,-7.5
Guard.Velocity = -11.5
Air.Velocity = -3,-7
yAccel = .5
Ground.cornerpush.veloff = 0;-15.5
Air.cornerpush.veloff = 0;-15.5
EnvShake.Time = 15
Fall = 1
Fall.Recover = !var(55)
Fall.RecoverTime = 40

;-----------------------------------
;---------- Sankaku Tobi -----------
;-----------------------------------
[Statedef 670]
Type    = A
MoveType = I
Physics = N
Anim = 670
Ctrl = 0
SprPriority = 0
Velset = 0,0

[State 40, 2]
Type = Turn
Trigger1 = !Time
Trigger1 = frontedgedist < 15
Trigger1 = command = "holdback"

[State 40, 2]
Type = PlaySND
Trigger1 = !Time
value = 52,0
Channel = 3

[State 40, 2]
Type = varSet
Trigger1 = !Time
Sysvar(1) = 1

[State 40, 4]
Type = VelSet
Trigger1 = AnimElem = 2
x = Const(Velocity.jump.Fwd.x)+.5
y = Const(Velocity.jump.y)

[State 40, 4]
Type = StateTypeSet
Trigger1 = AnimElem = 2
Physics = A

[State 40, 4]
Type = CtrlSet
Trigger1 = AnimElem = 2
Value = 1

;-----------------------------------
;-------- Shin Sankaku Tobi --------
;-----------------------------------
[Statedef 675]
Type = A
MoveType = I
Physics = N
Anim = 675
Ctrl = 0
SprPriority = 0
Velset = 0,0


[State 40, 2]
Type = PlaySND
Trigger1 = !Time
value = 52,0
Channel = 3

[State 40, 2]
Type = varSet
Trigger1 = !Time
Sysvar(1) = 1

[State 40, 4]
Type = VelSet
Trigger1 = AnimElem = 2
x = Const(Velocity.jump.Fwd.x)+3
y = Const(Velocity.jump.y)+3

[State 40, 4]
Type = StateTypeSet
Trigger1 = AnimElem = 2
Physics = A

[State 40, 4]
Type = CtrlSet
Trigger1 = AnimElem = 4
Value = 1

;-----------------------------------
;------- Shin Sankaku Tobi 2 -------
;-----------------------------------
[Statedef 680]
Type = A
MoveType = A
Physics = N
Anim = 680
Ctrl = 0
SprPriority = 0
Velset = 0,0


[State 40, 2]
Type = PlaySND
Trigger1 = !Time
value = 52,0
Channel = 3

[State 40, 2]
Type = varSet
Trigger1 = !Time
Sysvar(1) = 1

[State 40, 4]
Type = VelSet
Trigger1 = AnimElem = 2
x = Const(Velocity.jump.Fwd.x)+3
y = -4.5

[State 40, 4]
Type = StateTypeSet
Trigger1 = AnimElem = 2
Physics = A

[State 200, Hitdef]
Type = HitDef
Trigger1 = AnimElem = 5
attr = A, NA
damage = 75
AnimType = Heavy
getpower = 120,60
givepower = 30,15
Guardflag = MA
Hitflag = MA
pauseTime = 10,12
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,-30
HitSound = S5,5
GuardSound = S6,0
ground.Type = Low
ground.SlideTime = 14
ground.HitTime = 14
ground.Velocity = -3,-7.5
Guard.Velocity = -11.5
Air.Velocity = -3,-7
yAccel = .5
Ground.cornerpush.veloff = 0;-15.5
Air.cornerpush.veloff = 0;-15.5
EnvShake.Time = 10
Fall = 1
Fall.Recover = !var(55)
Fall.RecoverTime = 40

;============================================================================
; Groove Moves
;============================================================================
;-----------------------------------
;------ KoF'98 Style Roll fwd ------
;-----------------------------------
[statedef 700]
type = S
movetype = I
physics = N
anim = 700
ctrl = 0
velset = 0,0
Poweradd = -1000*(prevstateno = [150,152])

[State 700, Cancel0]
type = VarAdd
Trigger1 = !Time
trigger1 = prevstateno = [150,152]
var(16) = -1000

[State 700, Cancel1]
type = pause
Trigger1 = !Time
trigger1 = prevstateno = [150,152]
time = 3

[State 700, Cancel2]
type = envcolor
Trigger1 = !Time
trigger1 = prevstateno = [150,152]
time = 2
value= 255,255,255

[State 700, AI Roll Limit]
type = VarSet
Trigger1 = !Time
trigger1 = var(9)
var(23) = 1

[State 700, Cancel3]
type = Explod
Trigger1 = !Time
trigger1 = prevstateno = [150,152]
anim = 730
pos = 10,-80
postype = p1
pausemovetime = 9999
bindtime = 1
ownpal = 1
persistent = 0
ontop = 1

[State 700, Takuma voice]
Type = PlaySnd
Trigger1 = !Time
Value = 2*(var(1) = [2,3]),1
Channel = 1

[State 700, HitBy]
Type = HitBy
trigger1 = AnimElem = 7, <= 2
Trigger2 = PrevStateNo = [150,152]
Value = SCA, AT

[State 700, Frame]
type = AfterImage
trigger1 = Time = 3
time = 5
PalBright = 0, 0, 0
PalAdd = 0, 0, 0
PalMul = 1,1,1
Length = 6
PalContrast = 255,255,255

[State 700, To Background]
type = SprPriority
trigger1 = Time = 3
value = -2

[State 700, VelSet]
type = VelSet
trigger1 = AnimElem = 3
x = 5.7+2*(PrevStateno = [100,101])+2*(PrevStateNo = [150,152])

[State 700, Fricction]
type = VelAdd
trigger1 = AnimElem = 3, >= 0
trigger1 = AnimElem = 7, < 0
x = -.1

[State 700, Stop]
type = VelSet
trigger1 = AnimElem = 7, >= 0
x = 0

[State 700, To Background2]
type = PlayerPush
trigger1 = Time < 24
value = 0

[State 700, To Background 3]
type = PlayerPush
trigger1 = Time >= 24
value = 1

[State 700, End]
type = ChangeState
trigger1 = !AnimTime
value = 0
ctrl = 1

;-----------------------------------
;----- KoF'98 Style Roll Back ------
;-----------------------------------
[statedef 710]
type = S
movetype = I
physics = N
anim = 710
ctrl = 0
velset = 0,0
Poweradd = -1000*(prevstateno = [150,152])

[State 700, Cancel0]
type = VarAdd
Trigger1 = !Time
trigger1 = prevstateno = [150,152]
var(16) = -1000

[State 700, Takuma voice]
Type = PlaySnd
Trigger1 = !Time
Value = 2*(var(1) = [2,3]),1
Channel = 1

[State 700, Cancel1]
type = pause
Trigger1 = !Time
trigger1 = prevstateno = [150,152]
time = 3

[State 700, Cancel2]
type = envcolor
Trigger1 = !Time
trigger1 = prevstateno = [150,152]
time = 2
value= 255,255,255


[State 700, Cancel3]
type = Explod
Trigger1 = !Time
trigger1 = prevstateno = [150,152]
anim = 730
pos = 10,-80
postype = p1
pausemovetime = 9999
bindtime = 1
ownpal = 1
persistent = 0
ontop = 1

[State 700, HitBy]
Type = HitBy
trigger1 = AnimElem = 7, <= 2
Trigger2 = PrevStateNo = [150,152]
Value = SCA, AT

[State 700, Frame]
type = AfterImage
trigger1 = Time = 3
time = 5
PalBright = 0, 0, 0
PalAdd = 0, 0, 0
PalMul = 1,1,1
Length = 6
PalContrast = 255,255,255

[State 700, To Background]
type = SprPriority
trigger1 = Time = 3
value = -2

[State 700, VelSet]
type = VelSet
trigger1 = AnimElem = 4
x = -6.7

[State 700, Fricction]
type = VelAdd
trigger1 = AnimElem = 4, >= 0
trigger1 = AnimElem = 9, < 0
x = .1


[State 700, Stop]
type = VelSet
trigger1 = AnimElem = 9, >= 0
x = 0

[State 700, To Background2]
type = PlayerPush
trigger1 = Time < 24
value = 0

[State 700, To Background 3]
type = PlayerPush
trigger1 = Time >= 24
value = 1

[State 700, End]
type = ChangeState
trigger1 = !AnimTime
value = 0
ctrl = 1

;-----------------------------------
;-------- KoF'95 Style Dodge -------
;-----------------------------------
[statedef 720]
type = S
movetype = I
physics = N
anim = 720
ctrl = 0
velset = 0,0

[State 700, Takuma voice]
Type = PlaySnd
Trigger1 = !Time
Value = 2*(var(1) = [2,3]),1
Channel = 1

[State 700, HitBy]
Type = HitBy
Trigger1 = 1
Value = SCA, AT

[State 700, Frame]
type = AfterImage
trigger1 = Time = 3
time = 5
PalBright = 0, 0, 0
PalAdd = 0, 0, 0
PalMul = 1,1,1
Length = 6
PalContrast = 255,255,255

[State 700, To Background]
type = SprPriority
trigger1 = !Time
value = -2

[State 700, To Background2]
type = PlayerPush
trigger1 = 1
value = 0

[State 700, End]
type = ChangeState
trigger1 = !AnimTime
value = 0
ctrl = 1

;-----------------------------------
;---------- Dodge Attack -----------
;-----------------------------------
[Statedef 730]
Type = S
MoveType = A
Physics = S
Anim = 725
Velset = 0
Ctrl = 0
Juggle  = 8

[State 700, HitBy]
Type = HitBy
Trigger1 = AnimElem = 2, < 2
Value = SCA, AT

[State 700, Takuma voice]
Type = PlaySnd
Trigger1 = !Time
Value = 2*(var(1) = [2,3]),1
Channel = 1

[State -3, Attack FXSound]
type = PlaySnd
Trigger1 = Time = 1
Value = 1,2
Channel = 2

[State 200, Hitdef]
Type = HitDef
Trigger1 = AnimElem = 4
attr = S, NA
damage = 80
AnimType = Heavy
getpower = 120,60
givepower = 30,15
Guardflag = M
Hitflag = MA
pauseTime = 10,12
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,ifelse(var(49) > -82, var(49), -82)
HitSound = S5,4
GuardSound = S6,0
ground.Type = High
ground.SlideTime = 17
ground.HitTime = 17
ground.Velocity = -9
Air.Velocity = -4,-5
yAccel = .5
Ground.cornerpush.veloff = 0;-15
Air.cornerpush.veloff = 0;-15
EnvShake.Time = 5

[State 200, Over]
Type = ChangeState
Trigger1 = !AnimTime
Value = 0
Ctrl = 1

;-----------------------------------
;------- KoF'98/2K2 MAX timer ------
;-----------------------------------
[Statedef 750]
type = S
movetype = I
physics = S
anim = 750+var(1)-3*(var(1) = 4)
velset = 0
ctrl = 0

[State 750, DM effect]
Type = Explod
Trigger1 = Time = 7
Anim = 760
BindTime = 1
OwnPal = 1
SprPriority = 2
PosType = p1
Pos = 0, 0

[State 750, earthquake]
type = EnvShake
trigger1 = time = 2
time = 10
freq = 45
ampl = -6

[State 750, sound]
type = PlaySnd
trigger1 = Time = 0
value = 750,(prevstateno = [200,599])
channel = 5

[State 750, subtract 1 powerbar]
type = poweradd
trigger1 = Time = 0
value = -1000-1000*(prevstateno = [200,599])

[State 750, set power]
Type = varSet
Trigger1 = !Time
var(16) = power

[State 1000, geese voice]
type = PlaySnd
trigger1 = time = 3
value = 2*(var(1) = [2,3]),2
channel = 1

[State 750, Left Timer]
Type = Explod
Trigger1 = var(10) = 1
Trigger1 = !Time
Anim = 8230
ID =  8230
PosType = Left
Pos = 25,210
BindTime = -1
RemoveTime = -1
SprPriority = 6
OwnPal = 1

[State 750, Right Timer]
Type = Explod
Trigger1 = var(10) = 2
Trigger1 = !Time
Anim = 8231
ID =  8230
PosType = Right
Pos = -25,210
BindTime = -1
RemoveTime = -1
SprPriority = 6
OwnPal = 1

[State 750, Left Meter]
Type = Explod
Trigger1 = var(10) = 1
Trigger1 = !Time
Anim = 8232
ID =  8231
PosType = Left
Pos = 25,210
BindTime = -1
RemoveTime = -1
SprPriority = 7
OwnPal = 1

[State 750, Right Meter]
Type = Explod
Trigger1 = var(10) = 2
Trigger1 = !Time
Anim = 8232
ID =  8231
PosType = Right
Pos = -25,210
BindTime = -1
RemoveTime = -1
Facing = -1
SprPriority = 7
OwnPal = 1

[State 750, timer countdown]
type = varset
trigger1 = !time
var(15) = 1000

[State 750, Timer explod var]
type = varset
trigger1 = !time
var(17) = 20

[State 790, AI end]
type = ChangeState
trigger1 = !Time
trigger1 = var(1)
trigger1 = var(9) > 3
trigger1 = p2dist x < ifelse(var(1) = 3, 70,60)
Trigger1 = prevstateno = [420,440]
value = 425

[State 790, AI end]
type = ChangeState
trigger1 = !Time
trigger1 = var(1) = 3
trigger1 = var(9) > 3
trigger1 = p2dist x > 70
Trigger1 = prevstateno = [420,440]
value = 1200

[State 790, AI end]
type = ChangeState
trigger1 = !Time
Trigger1 = prevstateno = [200,599]
trigger1 = var(9)
value = 100

[State 750, end1]
type = ChangeState
trigger1 = Time = 1 && prevstateno =[200,599]
trigger1 = command = "holdfwd"
value = 100

[State 750, end2]
type = ChangeState
trigger1 = Time = 1 && prevstateno =[200,599]
value = ifelse(command = "holdup",40,ifelse(command = "holddown",11,0))
ctrl = ifelse(command = "holdup",0,1)

[State 750, end3]
type = ChangeState
trigger1 = !AnimTime
value = 0
ctrl = 1

;-----------------------------------
;- KoF Series Extra Power Charging -
;-----------------------------------
[statedef 770]
type    = S
movetype= I
physics = S
juggle  = 0
poweradd= 0
ctrl = 0
velset = 0,0
anim = 770
sprpriority = 0

[State 800, Sound]
type = playsnd
trigger1 = !Time
value = 770+(var(1) = [2,3]),0
Channel = 6

[State 800, Sound]
type = playsnd
trigger1 = Time = 5
value = 770,1
channel = 7
volume = 120

[State 810, Powerup]
type = powerAdd
triggerall = power < const(data.power)
trigger1 = time > 7
value = 10

[State 3000, 1]
type = Explod
trigger1 = time = 0
anim = 8400
Id = 8400
bindtime = -1
ownpal = 1
sprpriority = 2
postype = p1
pos = 0,0
removetime = -1

[State -1, End]
type = ChangeState
triggerall = !var(9)
trigger1 = command != "holdx"
trigger2 = command != "holdy"
trigger3 = power >= const(data.power)
value = 775

[State -1, CPU end]
type = ChangeState
triggerall = var(9)
trigger1 = p2bodydist x <= 140
trigger1 = p2movetype != H
trigger1 = p2statetype != L
trigger2 = power >= const(data.power)
trigger3 = p2movetype = A
trigger4 = Enemy, numproj
value = 775

;-----------------------------------
;----- KoF Power Charging End ------
;-----------------------------------
[statedef 775]
type    = S
movetype= I
physics = S
juggle  = 0
poweradd= 0
ctrl = 0
velset = 0,0
anim = 775
sprpriority = 0

[State 800, Sound]
type = playsnd
trigger1 = !Time
trigger1 = power >= const(data.power)
value = 750,0
Channel = 1

[State -1, End]
type = ChangeState
trigger1 = !AnimTime
value = 0
Ctrl = 1

;============================================================================
; Throws
;============================================================================
;-----------------------------------
;------------ Oosotogari -----------
;-----------------------------------
[Statedef 800]
type = S
movetype= A
physics = S
juggle = 8
velset = 0,0
ctrl = 0
anim = 800

[State 1000, Power set]
Type = varSet
Trigger1 = !Time
var(2) = IfElse(command = "z",1,0)

[State 800, 1]
type = HitDef
Trigger1 = !var(6)
Trigger1 = !Time
attr = S, NT
hitflag = M-
priority = 5, Miss
sparkno = -1
HitSound = S800,0
sprpriority = 1
p1facing = ifelse (command = "holdback", -1, 1)
p2facing = 1
p1stateno = 801
p2stateno = 802
Fall = 1
Fall.Recover = !var(55)
ID = 800

[State 800, 2]
type = ChangeState
Trigger1 = !AnimTime
Trigger1 = !var(9)
Trigger1 = !var(2)
Trigger1 = command = "holdfwd"
Trigger1 = var(1) = [1,2]
value = 300

[State 800, 2]
type = ChangeState
Trigger1 = !AnimTime
Trigger1 = !var(2)
Trigger1 = command = "holdback"
Trigger1 = !var(9)
Trigger1 = var(1) = 3
value = 330

[State 800, 2]
type = ChangeState
Trigger1 = !AnimTime
value = 220+20*var(2)

;----------------------------------------------------------------------
[Statedef 801]
type = S
movetype= A
physics = N
anim = 801
poweradd = 0
SprPriority = 1

[State 810, Bind 1]
type = Width
trigger1 = 1
Edge = 40,0

[State 900, Escape Varset]
type = varset
Trigger1 = time = 0
Trigger2 = time = 8
var(2) = 0

[State 311, Escape Command]
type = varset
Triggerall = prevstateno != 815
Triggerall = prevstateno != [950,960]
TriggerAll = Time = [0,7]
trigger1 = target, command = "x" || target, command = "y"|| target, command = "z"
trigger2 = target, command = "a" || target, command = "b"|| target, command = "c"
var(2) = 1

[State 3000, Spark]
Type = Explod
trigger1 = AnimElem = 2
anim = 8220
PosType = p1
Ownpal = 1
Sprpriority = 0
Pos = 42,-80
PauseMoveTime = 99
SuperMoveTime = 99
IgnoreHitPause = 1

[State 311, SVC Pause]
type = pause
Trigger1 = prevstateno = [950,960]
Trigger1 = AnimElem = 2
time = 8

[State 301, Escape p1]
type = changestate
Trigger1 = Time = [5,7]
trigger1 = var(2) = 1
value = 910

[State 301, Escape Enemy]
type = targetstate
Trigger1 = Time = [5,7]
trigger1 = var(2) = 1
value = 911

[State 810, Bind 1]
type = PlaySnd
trigger1 = AnimElem = 9
trigger2 = AnimElem = 15
Value = 2*(var(1) = [2,3]), 2
Channel = 1

[State 810, Bind 1]
type = PlaySnd
trigger1 = AnimElem = 16
Value = 1, 1
Channel = 2

[State 810, Bind 1]
type = TargetBind
trigger1 = AnimElem = 1, >= 0
trigger1 = AnimElem = 2, < 0
pos = 40, 0

[State 810, Bind 2]
type = TargetBind
trigger1 = AnimElem = 2, >= 0
trigger1 = AnimElem = 3, < 0
pos = 40, -95

[State 810, Bind 3]
type = TargetBind
trigger1 = AnimElem = 3, >= 0
trigger1 = AnimElem = 4, < 0
pos = 41, -96

[State 810, Bind 4]
type = POsAdd
trigger1 = AnimElem = 4
trigger2 = AnimElem = 6
x = 25

[State 810, Bind 4]
type = TargetBind
trigger1 = AnimElem = 4, >= 0
trigger1 = AnimElem = 5, < 0
pos = 25, -91

[State 810, Bind 5]
type = TargetBind
trigger1 = AnimElem = 5, >= 0
trigger1 = AnimElem = 6, < 0
pos = 17, -91

[State 810, Bind 5]
type = TargetBind
trigger1 = AnimElem = 6, >= 0
trigger1 = AnimElem = 8, < 0
pos = 15, -100

[State 810, Bind 5]
type = TargetBind
trigger1 = AnimElem = 8, >= 0
trigger1 = AnimElem = 9, < 0
pos = 17, -89

[State 810, Bind 5]
type = TargetBind
trigger1 = AnimElem = 9, >= 0
trigger1 = AnimElem = 10, < 0
pos = 13, -20

[State 810, Bind 5]
type = TargetBind
trigger1 = AnimElem = 10, >= 0
trigger1 = AnimElem = 11, < 0
pos = 23, 0

[State 810, Bind 5]
type = TargetBind
trigger1 = AnimElem = 11, >= 0
trigger1 = AnimElem = 12, < 0
pos = 33, 0

[State 810, Bind 1]
type = PlaySnd
trigger1 = AnimElem = 8
Value = 50, 1
Channel = 2

[State 3000, Spark]
Type = Explod
trigger1 = AnimElem = 9
anim = 8002
PosType = p1
Ownpal = 1
OnTop = 1
Pos = 15,-30
PauseMoveTime = 99
SuperMoveTime = 99
IgnoreHitPause = 1

[State 810, Bind 1]
type = PlaySnd
trigger1 = AnimElem = 9
Value = 5,5
Channel = 4

[State 810, Bind 1]
type = EnvShake
trigger1 = AnimElem = 10
Time = 15

[State 810, Bind 1]
type = PlaySnd
trigger1 = AnimElem = 11
Value = 801,0
Channel = 3

[State 3000, OTG FX]
Type = Explod
trigger1 = AnimElem = 11
anim = 8300
PosType = p1
Ownpal = 1
Sprpriority = -3
Pos = 35,0
PauseMoveTime = 99
SuperMoveTime = 99
IgnoreHitPause = 1

[State 810, Hurt]
type = TargetLifeAdd
trigger1 = AnimElem = 9
trigger2 = AnimElem = 11
value = -45
Kill = 0

[State 810, Bind 1]
type = Sprpriority
trigger1 = AnimElem = 13
Value = -2

[State 200, Hitdef]
Type = HitDef
Trigger1 = AnimElem = 17
attr = C, NT
damage = 40
AnimType = back
getpower = 0,0
givepower = 30,15
Guardflag = L
Hitflag = MAFD
pauseTime = 10,6
guard.pauseTime = 10,12
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,0
HitSound = S5,4
GuardSound = S6,0
ground.Type = Low
ground.SlideTime = 17
ground.HitTime = 17
ground.Velocity = -4,-3
guard.Velocity = -9.5
Air.Velocity = -4,-3
down.Velocity = -4,-3
yAccel = .5
Ground.cornerpush.veloff = 0;-11.5
Air.cornerpush.veloff = 0;-11.5
Fall = 1
Fall.Recover = 0
EnvShake.time = 15
ChainID = 800

[State 810, State End]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;----------------------------------------------------------------------
[Statedef 802]
type = A
movetype = H
physics = N
velset = 0,0
Sprpriority = -1

[State 820, 1]
type = Screenbound
Trigger1 = 1
MoveCamera = 0,0

[State 820, 1]
type = ChangeAnim2
Trigger1 = Time = 0
value = 802

[State 821, 4] ;Hit ground
type = SelfState
trigger1 = !AnimTime
trigger1 = Alive
value = 5120

[State 821, 4] ;Hit ground
type = SelfState
trigger1 = !AnimTime
trigger1 = !Alive
value = 5150


;-----------------------------------
;------------ Ippon Seoi -----------
;-----------------------------------
[Statedef 810]
type = S
movetype= A
physics = S
juggle = 8
ctrl = 0
anim = 800
Velset = 0,0

[State 1000, Power set]
Type = varSet
Trigger1 = !Time
var(2) = IfElse(command = "c",1,0)

[State 810, 1]
type = HitDef
Trigger1 = !var(6)
Trigger1 = !Time
attr = S, NT
hitflag = M-
priority = 5, Miss
sparkno = -1
HitSound = S800,0
sprpriority = 1
p1facing = ifelse (command = "holdfwd", -1, 1)
p2facing = 1
p1stateno = 811
p2stateno = 814
fall = 1
snap = 10, 0

[State 800, 2]
type = ChangeState
Trigger1 = !AnimTime
Trigger1 = !var(2)
Trigger1 = !var(9)
Trigger1 = command = "holdfwd"
Trigger1 = var(1) != [3,4]
value = 310

[State 800, 2]
type = ChangeState
Trigger1 = !AnimTime
value = 230+20*var(2)

;----------------------------------------------------------------------
[Statedef 811]
movetype= A
physics = N
anim = 811
poweradd = 0
sprpriority = 1
Velset = 0,0

[State 900, Escape Varset]
type = varset
Trigger1 = time = 0
Trigger2 = time = 8
var(2) = 0

[State 311, Escape Command]
type = varset
Triggerall = prevstateno != 815
Triggerall = prevstateno != [950,960]
TriggerAll = Time = [0,7]
trigger1 = target, command = "x" || target, command = "y"|| target, command = "z"
trigger2 = target, command = "a" || target, command = "b"|| target, command = "c"
var(2) = 1

[State 301, Escape p1]
type = changestate
Trigger1 = Time = [5,7]
trigger1 = var(2) = 1
value = 910

[State 301, Escape Enemy]
type = targetstate
Trigger1 = Time = [5,7]
trigger1 = var(2) = 1
value = 911

[State 3000, Spark]
Type = Explod
trigger1 = AnimElem = 2
anim = 8220
PosType = p1
Ownpal = 1
Sprpriority = 0
Pos = 42,-80
PauseMoveTime = 99
SuperMoveTime = 99
IgnoreHitPause = 1

[State 311, SVC Pause]
type = pause
Trigger1 = prevstateno = [950,960]
Trigger1 = AnimElem = 2
time = 8

[State 810, Out of corners]
type = Width
trigger1 = AnimElem = 3, < 0
Edge = 0,40

[State 810, Out of corners]
type = Width
trigger1 = AnimElem = 3, > 0
Edge = 0,65

[State 810, Bind 1]
type = PlaySnd
trigger1 = AnimElem = 3
Value = 2*(var(1) = [2,3]),1+2*(var(1) = [2,3])
Channel = 1

[State 810, Bind 1]
type = TargetBind
trigger1 = AnimElem = 1, >= 0
trigger1 = AnimElem = 2, < 0
pos = 40, 0

[State 810, Bind 2]
type = TargetBind
trigger1 = AnimElem = 2, >= 0
trigger1 = AnimElem = 3, < 0
pos = 40, -95

[State 810, Bind 1]
type = Turn
trigger1 = AnimElem = 3

[State 820, Bind 1]
type = TargetBind
trigger1 = AnimElem = 3, >= 0
trigger1 = AnimElem = 4, < 0
pos = -29, -95

[State 810, Bind 1]
type = PlaySnd
trigger1 = AnimElem = 4
Value = 1, 2
Channel = 2

[State 820, Bind 4]
type = TargetBind
trigger1 = AnimElem = 4, >= 0
trigger1 = AnimElem = 5, < 0
pos = 15, -100

[State 820, Bind 5]
type = TargetBind
trigger1 = AnimElem = 5, >= 0
trigger1 = AnimElem = 6, < 0
pos = 65, -78

[State 820, Bind 10]
type = TargetBind
trigger1 = AnimElem = 6, >= 0
trigger1 = AnimElem = 7, < 0
pos = 60, 0

[State -3, OTG FX]
type = Explod
Trigger1 = AnimElem = 6
anim = 8310
pos = 60,0
bindtime = 1
ownpal = 1
sprpriority = -3

[State -3, OTG FX]
type = Explod
Trigger1 = AnimElem = 6
anim = 8320
pos = 60,0
bindtime = 1
ownpal = 1
sprpriority = 3

[State 810, Bind 1]
type = PlaySnd
trigger1 = AnimElem = 6
Value = 801, 1
Channel = 3

[State 191, 1]
Type = EnvShake
Trigger1 = AnimElem = 6
Time = 20
Ampl = 4
Phase = 2

[State 820, Hurt]
type = TargetLifeAdd
trigger1 = AnimElem = 6
value = -125

[State 820, State End]
type = ChangeState
trigger1 = !AnimTime
value = 0
ctrl = 1

;----------------------------------------------------------------------
[Statedef 814]
type = A
movetype = H
physics = N
velset = 0,0
Sprpriority = -1

[State 820, 1]
type = Screenbound
Trigger1 = AnimElem = 7, < 0
MoveCamera = 0,0

[State 820, 1]
type = ChangeAnim2
Trigger1 = !Time
value = 814

[State 820, 1]
type = Velset
Trigger1 = AnimElem = 7
x = 4
y = -5.5

[State 821, 1] ;Gravity
type = VelAdd
Trigger1 = AnimElem = 7, > 0
y = .5


[State 821, 4] ;Hit ground
type = SelfState
triggerAll = Vel Y > 0
triggerAll = Pos Y >= -25
triggerAll = Alive
triggerAll = CanRecover
trigger1 = command = "recovery"
value = 5201

[State 821, 4] ;Hit ground
type = SelfState
Trigger1 = AnimElem = 7, > 0
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
value = 5100

;============================================================================
; Custom Gethit by groove States
;============================================================================
;----------------------------
;-------- Guard crush -------
;----------------------------
[Statedef 900]
type = S
movetype = I
physics = S
anim = 900
ctrl = 0

[State -2, 3]
type = Explod
trigger1 = var(10) = 1
trigger1 = !time
anim = 8210
postype = left
bindtime = -1
ownpal = 1
ontop = 1
ignorehitpause = 1
pos = 60,65

[State -2, 3]
type = Explod
trigger1 = var(10) = 2
trigger1 = !time
anim = 8210
postype = right
bindtime = -1
ownpal = 1
ontop = 1
ignorehitpause = 1
pos = -60,65

[State 9100, 2]
type = ChangeAnim
trigger1 = AnimElem = 2, >= 0
trigger1 = GetHitVar(HitTime) > 0
value = 900
Elem = 2
ignorehitpause = 1

[State 9100, 2]
type = Envcolor
trigger1 = Time = 0
value = 248,248,248
time = 3
under = 1
ignorehitpause = 1

[State 9100, 3]
type = Varset
trigger1 = time = 0
var(11) = 0
ignorehitpause = 1

[State 9100, 4]
type = Envshake
trigger1 = time = 0
time = 8
ignorehitpause = 1

[State 9100, 5]
type = Velset
trigger1 = time >= 3
trigger1 = time <= 10
x = -3
ignorehitpause = 1

[State 9100, 6]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1
ignorehitpause = 1

;----------------------------
;-------- Grab Escape -------
;----------------------------
[Statedef 910]
type    = S
movetype= I
physics = S
velset = 0,0
anim = 900
ctrl = 0

[State 911, Invincible]
type = nothitby
trigger1 = 1
value = sca

[State 805, 2]
type = Playsnd
trigger1 = !time
Value = 5000,0

[State 3318, 6]
type = velset
trigger1 = time = 5
x = -8

[State 3318, 6]
type = targetstate
trigger1 = !time
value = 911

[State 305, Dust]
type = makedust
Trigger1 = 1
pos = 0,0
spacing = 3

[State 305, END]
type = changestate
Trigger1 = !AnimTime
Trigger2 = !Enemy, AnimTime
value = 0
ctrl = 1

;----------------------------
;---- Grab Escape p2state ---
;----------------------------
[Statedef 911]
type    = S
movetype= I
physics = S
velset = 0,0
ctrl = 0

[State 911, stay on the floor]
type = posset
trigger1 = time = 0
y = 0

[State 911, Speed]
type = velset
trigger1 = time = 5
trigger1 = enemy,backedgebodydist < 3
x = -8

[State 911, Invincible]
type = nothitby
trigger1 = 1
value = sca

[State 911, Sander];anim for compatibility with Sander 71113 chars
type = changeanim
trigger1 = selfanimexist(306)
Trigger1 = time = 0
value = 306

[State 911, Generic]
type = changeanim
trigger1 = !selfanimexist(306)
trigger1 = selfanimexist(200)
Trigger1 = Time = 0
value = 200

[State 911, Generic];if anim 200 doesn't exist
type = changeanim
trigger1 = !selfanimexist(306)
trigger1 = !selfanimexist(200)
Trigger1 = !Time
value = 5000

[State 911, END]
type = selfstate
Trigger1 = !AnimTime
Trigger2 = time  >= 25
value = 0
ctrl = 1

;-----------------------------------
;---------- SVC Oosotogari ---------
;-----------------------------------
[Statedef 950]
type = S
movetype= A
physics = S
juggle = 8
velset = 0,0
ctrl = 0
anim = 950

[State 800, 1]
type = HitDef
Trigger1 = !var(6)
Trigger1 = !Time
attr = S, NT
hitflag = M-
priority = 5, Miss
sparkno = -1
HitSound = S800,0
sprpriority = 1
p1facing = ifelse (command = "holdback", -1, 1)
p2facing = 1
p1stateno = 801
p2stateno = 802
Fall = 1
Fall.Recover = !var(55)
ID = 800

[State 800, 9]
type = poweradd
trigger1 = !var(15)
trigger1 = animelem = 2
value = -300

[State 800, 9]
type = varadd
trigger1 = var(15)
trigger1 = animelem = 2
var(15) = -250

[State 800, 2]
type = ChangeState
Trigger1 = !AnimTime
value = 0
Ctrl = 1

;-----------------------------------
;--------- SVC Ippon Seoi ----------
;-----------------------------------
[Statedef 960]
type = S
movetype= A
physics = S
juggle = 8
velset = 0,0
ctrl = 0
anim = 950

[State 800, 1]
type = HitDef
Trigger1 = !var(6)
Trigger1 = !Time
attr = S, NT
hitflag = M-
priority = 5, Miss
sparkno = -1
HitSound = S800,0
p1facing = ifelse (command = "holdfwd", -1, 1)
sprpriority = 1
p2facing = 1
p1stateno = 811
p2stateno = 814
Fall = 1
Fall.Recover = !var(55)

[State 800, 9]
type = poweradd
trigger1 = !var(15)
trigger1 = animelem = 2
value = -300

[State 800, 9]
type = varadd
trigger1 = var(15)
trigger1 = animelem = 2
var(15) = -250

[State 800, 2]
type = ChangeState
Trigger1 = !AnimTime
value = 0
Ctrl = 1

;============================================================================
; Super Moves
;============================================================================
;-----------------------------------
;------------ Kooh Ken -------------
;-----------------------------------
[Statedef 1000]
Type = S
MoveType = A
Physics = S
Anim = 1000
VelSet = 0
Ctrl = 0
PowerAdd = 100
SprPriority = 1

[State -1, Cancel Combo]
Type = Varadd
TriggerAll = var(15)
TriggerAll = !time
Trigger1 = prevstateno = [1000, 2000]
Trigger2 = prevstateno = [200, 730]
Trigger2 = var(1) = 3
IgnoreHitPause = 1
var(15) = -200

[State 3000, PALFX]
type = PalFX
TriggerAll = gametime%2 = 0
TriggerAll = time <= 7
Trigger1 = prevstateno = [1000, 2000]
Trigger2 = prevstateno = [200, 730]
Trigger2 = var(1) = 3
time = 1
add = 255,255,255
sinadd = -100,-100,-100, 2
ignorehitpause = 1

[State 1000, buffer setting1]
Type = varSet
Trigger1 = !Time
Trigger1 = helper(2000),var(1) >= helper(2000), var(2)
Trigger1 = helper(2000),var(1) >= helper(2000), var(3)
var(2) = 0

[State 1000, buffer setting2]
Type = varSet
Trigger1 = !Time
Trigger1 = helper(2000),var(2) >= helper(2000), var(1)
Trigger1 = helper(2000),var(2) >= helper(2000), var(3)
var(2) = 1

[State 1000, buffer setting3]
Type = varSet
Trigger1 = !Time
Trigger1 = helper(2000),var(3) >= helper(2000), var(1)
Trigger1 = helper(2000),var(3) >= helper(2000), var(2)
var(2) = 2

[State 1000, Power Set]
Type = varSet
TriggerAll = !Time
Trigger1 = command="x"
Trigger2 = command="y"
Trigger3 = command="z"
var(2) = IfElse(command = "y",1,IfElse(Command = "z",2,0))

[State 1000, Power set]
Type = varSet
Trigger1 = !Time
Trigger1 = var(9)
var(2) = IfElse((p2StateNo = [5120,5210]),0,2)

[State 1000, Power set]
Type = varSet
Trigger1 = !Time
Trigger1 = var(9)
Trigger1 = var(1) = 3
var(2) = IfElse(p2dist x > 225, 2, ifelse(p2dist x > 170, 1, 0))

[State 1000, Power set]
Type = varSet
Trigger1 = !Time
Trigger1 = var(9)
Trigger1 = !var(1)
var(2) = IfElse(p2dist x > 118, 2, ifelse(p2dist x > 95, 1, 0))

[State 1000, Power set]
Type = varSet
TriggerAll = !Time
TriggerAll = var(9)
TriggerAll = !var(1)
TriggerAll = p2StateNo = [5000,5002]
Trigger1 = prevStateNo = [220,240]
Trigger2 = prevStateNo = [420,440]
Trigger3 = prevStateNo = 310
var(2) = 0

[State 1000, Power set]
Type = varSet
TriggerAll = !Time
TriggerAll = var(9)
TriggerAll = !var(1)
Trigger1 = p2MoveType = A
Trigger2 = p2StateNo = [150,153]
Trigger2 = power >= ifelse(!var(15), 2000, ifelse(var(9) = 4,1000,0))
Trigger2 = Random < 250
var(2) = 2

[State 1000, Kooh Ken 02-SVC]
type = ChangeAnim
Trigger1 = !Time
value = 1000+var(2)+10*(var(1) = 3)

[State 1000, Kooh Ken proj]
type = ChangeAnim
TriggerAll = !Time
Trigger1 = var(1) = 4
Trigger2 = var(1) = [1,2]
value = 1020

[State 1000, Takuma Voice]
type = PlaySnd
Trigger1 = AnimElem = 2
value = 1000,(var(1) = 2)+2*(var(1) = 3)
Channel = 1

[State 1000, Kooh Ken FX sound]
type = PlaySnd
trigger1 = AnimElem = 6
value = ifelse(var(1), 1050,1),2*(!var(1))
Channel = 3

[State 310, 1]
type = reversaldef
triggerAll = !var(1)
triggerAll = var(2) = 2
triggerAll = animelem = 4, >= 0
triggerAll = animelem = 5, <= 0
trigger1 = prevStateNo != [200,2000]
trigger2 = p2MoveType != H
reversal.attr = SCA, AA, AP
pausetime = 8,10
sparkno = S8012
sparkxy = 10,0
hitsound = S6,0
numhits = 0
hitflag = MAP
Attr = SCA, SP

[State 1300, Lifeadd]
type = Lifeadd
trigger1 = Movehit
trigger1 = Enemynear, hitdefattr = SCA,SA,HA,SP,HP
trigger1 = !var(1)
trigger1 = var(2) = 2
trigger1 = animelem = 4, >= 0
trigger1 = animelem = 5, <= 0
value = -10
kill = 0
ignorehitpause = 1

[State 1300, GCrushStart]
type = VarSet
trigger1 = !var(1)
trigger1 = var(2) = 2
trigger1 = AnimElem = 2
var(4) = 0
ignorehitpause = 1

[State 1300, GCrushLimit]
type = Varadd
trigger1 = !var(1)
trigger1 = var(2) = 2
trigger1 = Movehit
trigger1 = animelem = 4, >= 0
trigger1 = animelem = 5, <= 0
var(4) = 1
ignorehitpause = 1

[State 1300, GCrushAdd]
type = Varadd
trigger1 = !var(1)
trigger1 = var(2) = 2
trigger1 = Movehit
trigger1 = animelem = 4, >= 0
trigger1 = animelem = 5, <= 0
var(11) = floor(120/var(4))
ignorehitpause = 1

[State 1300, GCrushState]
type = ChangeState
trigger1 = var(11) >= 1000
trigger1 = !var(1)
trigger1 = var(2) = 2
trigger1 = Movehit
trigger1 = animelem = 4, >= 0
trigger1 = animelem = 5, <= 0
value = 900
ctrl = 0
ignorehitpause = 1

[State 310, 1]
type = MoveHitReset
trigger1 = !var(1)
trigger1 = var(2) = 2
trigger1 = animelem = 5, <= 0
ignoreHitPause = 1

[State 1027, Sound]
type = EnvShake
trigger1 = !var(1)
trigger1 = var(2) = 2
trigger1 = AnimElem = 7
Ampl = -3
Time = 13

[State -3, OTG FX]
type = Explod
trigger1 = var(1) = 3
Trigger1 = AnimElem = 6
anim = 8310
pos = 50,0
bindtime = 1
ownpal = 1
sprpriority = -3
Scale = .8+.1*var(2),.8+.1*var(2)

[State -3, OTG FX]
type = Explod
trigger1 = var(1) = 3
Trigger1 = AnimElem = 6
anim = 8320
pos = 50,0
bindtime = 1
ownpal = 1
sprpriority = 3
Scale = .8+.1*var(2),.8+.1*var(2)

[State 1027, Sound]
type = EnvShake
trigger1 = var(1) = 3
Trigger1 = AnimElem = 6
Ampl = -2-var(2)
Time = 13

[State -3, 2K2 UM FX]
type = Explod
trigger1 = !var(1)
Trigger1 = AnimElem = 7
anim = 1051
pos = 72,-75
bindtime = 1
ownpal = 1
sprpriority = 3
Scale = .5,.6
IgnoreHitPause = 1
PauseMoveTime = 10
SuperMoveTime = 10

[State 1000, 3]
type = Projectile
trigger1 = !var(1)
trigger1 = AnimElem = 7
attr = S, SP
ownpal = 1
damage = 80+10*var(2),8+var(2)
animtype = Heavy
fall.animtype = back
getpower = 120,60
givepower = 60,30
guardflag = M
hitflag = MA
pausetime = 3,12
sparkno = -1
guard.sparkno = S8012
sparkxy = 15,-5
hitsound = S5,7
guardsound = S6,0
ground.type = High
air.type = low
ground.slidetime = 17
ground.hittime  = 17
guard.slidetime = 17
guard.hittime = 17
air.hittime = 30
guard.ctrltime = 17
guard.velocity = -9
ground.velocity = -5.5, -6.5
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.velocity = -4.5,-5.5
yaccel = .6
air.juggle = 15
projanim = 1052
projhitanim = 1060
projremanim = -1
projcancelanim = 1060
ProjRemoveTime = 5
ProjPriority = ifelse(var(2) = 2,9999, ifelse(var(2) = 1, 5,1))
velocity = 10+4*var(2)
offset = 60,-70
projid = 1000
Fall = 1
Fall.Recover = !var(55)
Fall.RecoverTime = 35
ID = 1001

[State 1000, 3]
type = Projectile
trigger1 = var(1) = 3
trigger1 = AnimElem = 6, = 1
attr = S, SP
ownpal = 1
damage = 70+10*var(2),7+var(2)
animtype = Heavy
fall.animtype = back
getpower = 120,60
givepower = 60,30
guardflag = MA
hitflag = MA
pausetime = 3,12
sparkno = S8002
guard.sparkno = S8012
sparkxy = 15,-5
hitsound = S5,7
guardsound = S6,0
ground.type = High
air.type = low
ground.slidetime = 17
ground.hittime  = 17
guard.slidetime = 17
guard.hittime = 17
air.hittime = 30
guard.ctrltime = 10
guard.velocity = -9
ground.velocity = -9
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.velocity = -4.5,-5.5
yaccel = .5
air.juggle = 15
projanim = 1053
projhitanim = -1
projremanim = -1
projcancelanim = -1
ProjRemoveTime = 5
velocity = 20+10*var(2)
offset = 80,-65
projid = 1000
air.fall = 1
Fall.Recover = !var(55)
Fall.RecoverTime = 35
ID = 1000

[State -3, OTG FX]
type = Explod
triggerAll = AnimElem = 6
trigger1 = var(1) = [1,2]
trigger2 = var(1) = 4
anim = 1030
pos = 75,-75
bindtime = 1
ownpal = 1
sprpriority = 3
RemoveonGetHit = 1

[State 1000, 3]
type = Projectile
triggerAll = AnimElem = 6, = 4
trigger1 = var(1) = [1,2]
trigger2 = var(1) = 4
attr = S, SP
ownpal = 1
damage = 70+10*var(2),7+var(2)
animtype = Back
getpower = 120,60
givepower = 60,30
guardflag = MA
hitflag = MA
pausetime = 0,12
sparkno = S8002
guard.sparkno = S8050
sparkxy = 20,-5
hitsound = S5,7
guardsound = S6,0
ground.type = High
air.type = low
ground.slidetime = 17
ground.hittime  = 17
guard.slidetime = 17
guard.hittime = 17
air.hittime = 30
guard.ctrltime = 17
ground.velocity = -9.5
air.velocity = -4,-3.5
air.juggle = 15
projanim = 1050
projhitanim = 1060
projremanim = 1060
projcancelanim = 1060
velocity = 4+var(2)
offset = 75,-75
projid = 1000
Air.Fall = 1
Fall.Recover = !var(55)
Fall.RecoverTime = 35
ID = 1000

[State 301, Escape Enemy]
type = targetstate
Trigger1 = !var(1)
Trigger1 = var(2) = 2
Trigger1 = ProjGuarded(1000) = 1
trigger1 = Numtarget(1001)
trigger1 = Target, alive
trigger1 = p2StateNo != 1610
Value = 1610
ignorehitpause = 1
persistent = 0

[State 1000, 9]
type = ChangeState
triggerAll = var(9)
triggerAll = !AnimTime
Trigger1 = random < 500
Trigger1 = NumProj
Trigger2 = random < 500
Trigger2 = var(1) = 3
Trigger2 = var(2)
Trigger3 = var(1) = 3
Trigger3 = p2StateType = A
Trigger3 = p2MoveType = H
Trigger3 = p2StateNo = [6000,6005]
Trigger3 = random < 750
value = 160

[State 1000, 9]
type = ChangeState
trigger1 = !AnimTime
value = 0
ctrl = 1

;-----------------------------------
;-------------- Kohou --------------
;-----------------------------------
[Statedef 1100]
Type = S
MoveType = A
Physics = N
Anim = 1100
VelSet = 0
Ctrl = 0
PowerAdd = 150
Juggle = 8

[State -1, Cancel Combo]
Type = Varadd
TriggerAll = var(15)
TriggerAll = !time
Trigger1 = prevstateno = [1000, 2000]
Trigger2 = prevstateno = [200, 730]
Trigger2 = var(1) = 3
IgnoreHitPause = 1
var(15) = -200

[State 3000, PALFX]
type = PalFX
TriggerAll = gametime%2 = 0
TriggerAll = time <= 7
Trigger1 = prevstateno = [1000, 2000]
Trigger2 = prevstateno = [200, 730]
Trigger2 = var(1) = 3
time = 1
add = 255,255,255
sinadd = -100,-100,-100, 2
ignorehitpause = 1

[State 1000, buffer setting1]
Type = varSet
Trigger1 = !Time
Trigger1 = helper(2000),var(1) >= helper(2000), var(2)
Trigger1 = helper(2000),var(1) >= helper(2000), var(3)
var(2) = 0

[State 1000, buffer setting2]
Type = varSet
Trigger1 = !Time
Trigger1 = helper(2000),var(2) >= helper(2000), var(1)
Trigger1 = helper(2000),var(2) >= helper(2000), var(3)
var(2) = 1

[State 1000, buffer setting3]
Type = varSet
Trigger1 = !Time
Trigger1 = helper(2000),var(3) >= helper(2000), var(1)
Trigger1 = helper(2000),var(3) >= helper(2000), var(2)
var(2) = 2

[State 1000, Power Set]
Type = varSet
TriggerAll = !Time
Trigger1 = command="x"
Trigger2 = command="y"
Trigger3 = command="z"
var(2) = IfElse(command = "y",1,IfElse(Command = "z",2,0))

[State 1000, Kohou set AI]
Type = varSet
TriggerAll = !Time
TriggerAll = var(9)
Trigger1 = var(1) = [1,2]
Trigger1 = p2StateType != A
Trigger1 = p2BodyDist x < 15+10*(Enemy, p2Dist x < 0)
Trigger2 = p2StateType = A
Trigger3 = var(1) != [1,2]
Trigger3 = p2StateType != A
Trigger3 = p2Movetype = A
var(2) = 2

[State 1000, Invincible]
type = ChangeAnim
Trigger1 = !Time
Trigger1 = var(1) = 3
value = 1110+var(2)

[State 1000, Invincible]
type = NotHitBy
TriggerAll = var(1) = 3
Trigger1 = animelem = 12, < 0
Trigger2 = var(2) = 1
Trigger2 = animelem = 12, <= 0
Trigger3 = var(2) = 2
value = SCA
IgnoreHitPause = 1

[State 1000, Takuma Voice]
type = PlaySnd
Trigger1 = AnimElem = 2
value = 1100,(var(1) = 3)
Channel = 1

[State 1100, First Hit]
Type = HitDef
Trigger1 = var(1) = 2
Trigger1 = AnimElem = 3
attr = S, SA
damage    = 90+10*var(2),9+var(2)
animtype = Heavy
Fall.animtype = Up
getpower = 120,60
givepower = 30,15
guardflag = M
hitflag = MA
pausetime = 11,13
sparkno = S8002
guard.sparkno = S8012
sparkxy = -15,ifelse(var(49) > -95, var(49), -95)
hitsound = S5,7
guardsound = S6,0
ground.type = low
ground.slidetime = 20
ground.hittime  = 20
guard.slidetime = 17
guard.hittime = 17
guard.ctrltime = 17
guard.velocity = -9.3
ground.velocity = -4.5, -7.5
ground.cornerpush.veloff = 0;0
guard.cornerpush.veloff = 0;-11.3
air.velocity = -4.5,-6.5
yAccel = .5
Fall = 1
Fall.Recover = !var(55)
Fall.RecoverTime = 40
EnvShake.Time = 10
ID = 1100

[State 1100, 2nd Hit]
Type = HitDef
Trigger1 = var(1) = 2
Trigger1 = AnimElem = 4
Trigger1 = !Numtarget(1100)
attr = A, SA
damage    = 90+10*var(2),9+var(2)
animtype = Heavy
Fall.animtype = Up
getpower = 120,60
givepower = 30,15
guardflag = M
hitflag = MA
pausetime = 11,13
sparkno = S8002
guard.sparkno = S8012
sparkxy = -15,ifelse(var(49) > -140, var(49), -140)
hitsound = S5,7
guardsound = S6,0
ground.type = low
ground.slidetime = 20
ground.hittime  = 20
guard.slidetime = 17
guard.hittime = 17
guard.ctrltime = 17
guard.velocity = -9.3
ground.velocity = -4.5, -7.5
ground.cornerpush.veloff = 0;0
guard.cornerpush.veloff = 0;-11.3
air.velocity = -4.5,-6.5
yAccel = .5
Fall = 1
Fall.Recover = !var(55)
Fall.RecoverTime = 40
EnvShake.Time = 10
ID = 1100

[State 1100, 1st Hit Serious]
Type = HitDef
Trigger1 = AnimElem = 9
attr = S, SA
damage    = 90,9
animtype = Heavy
getpower = 40,30
givepower = 30,15
guardflag = M
hitflag = MA
pausetime = 25,25
sparkno = S8002
guard.sparkno = S8012
sparkxy = -15,ifelse(var(49) > -67, var(49), -67)
hitsound = S5,7
guardsound = S6,0
ground.type = Low
ground.slidetime = 20
ground.hittime  = 20
guard.slidetime = 17
guard.hittime = 17
guard.ctrltime = 17
guard.velocity = 0
ground.velocity = -4.5*(!var(2)), -7.5*(!var(2))
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.velocity = -4.5*(!var(2)),-6.5-5*(var(2) > 0)
yAccel = .5
Fall = !var(2)
Air.Fall = 1
Fall.Recover = !var(55)
Fall.RecoverTime = 55
Air.Fall = 1
EnvShake.Time = 15

[State 1100, 1st Hit Serious]
Type = HitDef
Trigger1 = AnimElem = 11
attr = S, SA
damage = 30,3
animtype = Heavy
getpower = 40,30
givepower = 30,15
guardflag = M
hitflag = MA
pausetime = 25,25
sparkno = S8002
guard.sparkno = S8012
sparkxy = -15,ifelse(var(49) > -95, var(49), -95)
hitsound = S5,7
guardsound = S6,0
ground.type = High
ground.slidetime = 20
ground.hittime  = 20
guard.slidetime = 17
guard.hittime = 17
guard.ctrltime = 17
guard.velocity = 0
ground.velocity = -4.5*(var(2)< 2), -7.5*(var(2)< 2)
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.velocity = -4.5*(var(2)< 2),-6.5-5*(var(2) > 1)
yAccel = .5
Fall = (var(2)< 2)
Air.Fall = 1
Fall.Recover = !var(55)
Fall.RecoverTime = 55
Air.Fall = 1
EnvShake.Time = 15

[State 1000, Juggle set]
Type = varSet
TriggerAll = MoveHit
TriggerAll = var(1) = 3
Trigger1 = AnimElem = 11, < 0
Trigger1 = var(2) = 1
Trigger2 = AnimElem = 12, < 0
Trigger2 = var(2) = 2
var(7) = 1
IgnoreHitPause = 1

[State 3020, 2]
Type = EnvColor
Trigger1 = Movehit
Trigger1 = var(1) = 3
Trigger1 = AnimElem = 9, > 0
Trigger1 = AnimElem = 10, <= 0
Time = 3
Value = 255,255,255
Under = 1
IgnoreHitPause = 1
Persistent = 0

[State 3020, 2]
Type = EnvColor
Trigger1 = Movehit
Trigger1 = var(1) = 3
Trigger1 = AnimElem = 11, > 0
Trigger1 = AnimElem = 12, <= 0
Time = 3
Value = 255,255,255
Under = 1
IgnoreHitPause = 1
Persistent = 0

[State 3020, 2]
Type = EnvColor
Trigger1 = Movehit
Trigger1 = var(1) = 3
Trigger1 = AnimElem = 12, > 0
Time = 3
Value = 255,255,255
Under = 1
IgnoreHitPause = 1
Persistent = 0

[State 1100, change to air]
Type = StateTypeSet
Trigger1 = AnimElem = 4
Trigger1 = var(1) != 3
Trigger2 = AnimElem = 12
Trigger2 = var(1) = 3
StateType = A

[State 1100, Air Velocity]
Type = VelSet
Trigger1 = AnimElem = 4
Trigger1 = var(1) != 3
Trigger2 = AnimElem = 12
Trigger2 = var(1) = 3
x = 3+var(2)
y = -7-2*var(2)

[State -3, Jump Sound]
type = PlaySnd
Trigger1 = AnimElem = 4
Value = 50,1
Channel = 3
IgnoreHitPause = 1

[State 1100, reduce x Vel]
Type = VelAdd
Trigger1 = Vel x > .2
x = -.2

[State 1100, reduce x Vel]
Type = VelSet
Trigger1 = Vel x < .2
Trigger1 = Vel x != 0
x = 0

[State 1100, Gravity]
Type = Gravity
Trigger1 = AnimElem = 4, > 0
Trigger1 = var(1) != 3
Trigger2 = AnimElem = 12, > 0
Trigger2 = var(1) = 3

[State 1100, Third Hit]
Type = HitDef
Trigger1 = AnimElem = 12
Trigger1 = var(1)= 3
attr = A, SA
damage    = 20,2
animtype = Up
getpower = 40,30
givepower = 30,15
guardflag = MA
hitflag = MA
pausetime = 20,20
sparkno = S8002
guard.sparkno = S8012
sparkxy = -15,ifelse(var(49) > -140, var(49), -140)
hitsound = S5,7
guardsound = S6,0
ground.type = High
ground.slidetime = 20
ground.hittime  = 20
guard.slidetime = 17
guard.hittime = 17
guard.ctrltime = 17
guard.velocity = -9.3
ground.velocity = -4.5, -9.5
air.velocity = -4.5,-8.5
ground.cornerpush.veloff = 0;0
guard.cornerpush.veloff = 0;-11.3
yAccel = .5
Fall = 1
Fall.Recover = (!var(55) && var(2) < 2)
Fall.RecoverTime = 55
EnvShake.Time = 5+10*(var(1) = 3)

[State 3020, 2]
Type = MovehitReset
Trigger1 = Movecontact

[State 1000, 9]
type = ChangeState
TriggerAll = Vel y > -1
Trigger1 = AnimElem = 4, > 0
Trigger1 = var(1) != 3
Trigger2 = AnimElem = 12, > 0
Trigger2 = var(1) = 3
value = 1101

;-------- Kohou - Part 2 -------
[Statedef 1101]
Type = A
MoveType = I
Physics = N
Anim = 1101
Ctrl = 0
PowerAdd = 0
VelSet = 0

[State 3020, After Set]
type = AfterImagetime
trigger1 = 1
time = 2
ignorehitpause=1

[State 1100, Gravity]
Type = Gravity
Trigger1 = 1

[State 1101, End]
type = ChangeState
Trigger1 = Pos y >= 0
value = IfElse(PrevStateNo = 4101, 4102, 1102)

;-------- Kohou - Part 3 -------
[Statedef 1102]
Type = S
MoveType = I
Physics = N
Anim = 1102
Ctrl = 0
PowerAdd = 0
VelSet = 0,0

[State 1100, PosSet]
Type = PosSet
Trigger1 = !time
y = 0

[State 1000, 9]
type = ChangeState
Trigger1 = !AnimTime
Trigger2 = AnimElem = 3
Trigger2 = var(1) = 3
value = 0
Ctrl = 1

;-----------------------------------
;-------- Jaeiken Type Fall --------
;-----------------------------------
[Statedef 1170]
type = A
movetype= H
physics = N
velset = 0,0

[State 6000, Change by HitType1]
type = ChangeAnim
trigger1 = !Time
trigger1 = GetHitVar(animtype) != [3,5]
value = ifelse((GetHitVar(airtype) = 1),5000,5010) + GetHitVar(animtype)

[State 6000, Change by HitType2]
type = ChangeAnim
trigger1 = !Time
trigger1 = GetHitVar(animtype) = [3,5]
value = 5012

[State 6000, Change by HitType3]
type = ChangeAnim
trigger1 = !Time
trigger1 = (GetHitVar(animtype) = [4,5]) && (SelfAnimExist(5047 + GetHitVar(animtype)))
value = 5047 + GetHitVar(animtype) ;5051 - 4 + type

[State 6000, Change by HitType4]
type = ChangeAnim
trigger1 = Time > 0
value = anim

[State 6000, end]
type = ChangeState
trigger1 = HitShakeOver
value = 1171

[State 6000, FFB Light]
type = ForceFeedback
trigger1 = anim = 5000
trigger2 = anim = 5010
persistent = 0
time = 6
waveform = square

[State 6000, FFB Medium]
type = ForceFeedback
trigger1 = anim = 5001
trigger2 = anim = 5011
persistent = 0
time = 8
waveform = sinesquare
ampl = 110,-1,-.3

[State 6000, FFB Hard]
type = ForceFeedback
trigger1 = anim = 5012
trigger2 = anim = 5002
trigger3 = anim = 5030
trigger4 = anim = [5051,5059]
persistent = 0
time = 15
waveform = sinesquare
ampl = 140

;---------------------------------------------------------------------------
[Statedef 1171]
type = A
movetype= H
physics = N
ctrl = 0

[State 6001, Change by HitType1]
type = Changeanim
trigger1 = !Time
trigger1 = anim = 5012
value = 5030

[State 6001, HitVelAdd]
type = VelAdd
trigger1 = 1
y = GetHitVar(yaccel)

[State 6001, HitVelSet]
type = HitVelSet
trigger1 = !Time
x = 1
y = 1

[State 5050, 6]
type = ChangeState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= ifelse((anim = [5051,5059]) || (anim = [5061,5069]), 0, 25)
value = 1180

[State 6001, end2]
type = ChangeState
trigger1 = AnimTime = 0
value = 1172

;---------------------------------------------------------------------------
[Statedef 1172]
type = A
movetype= H
physics = N

[State 6000, Change by HitType1]
type = ChangeAnim
trigger1 = !Time
trigger1 = SelfAnimExist(5035)
trigger1 = Anim != [5051,5059]
trigger1 = Anim != 5090
value = 5035

[State 6002, HitVelAdd]
type = VelAdd
trigger1 = 1
y = GetHitVar(yaccel)

[State 5050, 6]
type = ChangeState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= ifelse((anim = [5051,5059]) || (anim = [5061,5069]), 0, 25)
value = 1180

[State 6003, End2]
type = ChangeState
trigger1 = HitOver
trigger2 = AnimTime = 0
trigger3 = Time = 0
trigger3 = Anim != 5035
value = 1173

;---------------------------------------------------------------------------

[Statedef 1173]
type = A
movetype= H
physics = N

[State 6000, Change by HitType1]
type = ChangeAnim
trigger1 = AnimTime = 0
trigger1 = Anim = 5035
trigger2 = Time = 0
trigger2 = Anim != 5035
trigger2 = (Anim != [5051, 5059]) && (Anim != [5061, 5069])
trigger2 = Anim != 5090
value = 5050

[State 6000, Change by HitType2]
type = ChangeAnim
trigger1 = anim = [5050,5059]
trigger1 = Vel Y >= ifelse(anim = 5050, 1, -2)
trigger1 = SelfAnimExist(anim+10)
value = anim+10
persistent = 0

[State 6003, HitVelAdd]
type = VelAdd
trigger1 = 1
y = GetHitVar(yaccel)

[State 5050, 6]
type = ChangeState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= ifelse((anim = [5051,5059]) || (anim = [5061,5069]), 0, 25)
value = 1180

;---------------------------------------------------------------------------
; HIT_LIEDOWN
[Statedef 1180]
type    = L
movetype= H
physics = N

[State 5110, EnvShake]
type = FallEnvShake
trigger1 = !Time

[State 5110, 1]
type = ChangeAnim2
trigger1 = !Time
value = 1190

[State 5110, 4]
type = HitFallDamage
trigger1 = !Time

[State 5110, 5]
type = PosSet
trigger1 = !Time
y = 0

[State 5110, 5]
type = VelSet
trigger1 = !Time
y = 0

[State 5110, 6]
type = PlaySnd
trigger1 = !Time
trigger1 = !SysVar(0)
value = F7, (sysvar(1) > 5) + (sysvar(1) > 14)

[State 5110, 7]
type = GameMakeAnim
trigger1 = !Time
trigger1 = !SysVar(0)
value = 60 + (sysvar(1) > 5) + (sysvar(1) > 14)
pos = 0, 0
under = sysvar(1) <= 14

[State 5110, 7]
type = Makedust
trigger1 = vel X < -1
trigger2 = vel X > 1
spacing = 3


[State 5110, 11] ;If just died
type = SelfState
trigger1 = !AnimTime
value = ifelse(alive, 5120, 5150)

[State 5110, 12]
type = VarSet
trigger1 = SysVar(0)
trigger1 = !Time
sysvar(0) = 0

[State 5110, 13] ;Friction
type = VelMul
trigger1 = 1
x = 0.91

[State 5110, 14]
type = ForceFeedback
trigger1 = alive
trigger1 = !Time
time = 8
ampl = 240
waveform = sine

[State 5110, 15]
type = ForceFeedback
trigger1 = !alive
trigger1 = !Time
ampl = 200, 7, -.467
time = 30
waveform = sine

;-----------------------------------
;-------- Hien Shippukyaku ---------
;-----------------------------------
[Statedef 1200]
Type = S
MoveType = A
Physics = N
Anim = 1200
VelSet = 0
Ctrl = 0
PowerAdd = 120
Juggle = 8

[State -1, Cancel Combo]
Type = Varadd
TriggerAll = var(15)
TriggerAll = !time
Trigger1 = prevstateno = [1000, 2000]
Trigger2 = prevstateno = [200, 730]
Trigger2 = var(1) = 3
IgnoreHitPause = 1
var(15) = -200

[State 3000, PALFX]
type = PalFX
TriggerAll = gametime%2 = 0
TriggerAll = time <= 7
Trigger1 = prevstateno = [1000, 2000]
Trigger2 = prevstateno = [200, 730]
Trigger2 = var(1) = 3
time = 1
add = 255,255,255
sinadd = -100,-100,-100, 2
ignorehitpause = 1

[State 1000, buffer setting1]
Type = varSet
Trigger1 = !Time
Trigger1 = helper(2000),var(4) >= helper(2000), var(5)
Trigger1 = helper(2000),var(4) >= helper(2000), var(6)
var(2) = 0

[State 1000, buffer setting2]
Type = varSet
Trigger1 = !Time
Trigger1 = helper(2000),var(5) >= helper(2000), var(4)
Trigger1 = helper(2000),var(5) >= helper(2000), var(6)
var(2) = 1

[State 1000, buffer setting3]
Type = varSet
Trigger1 = !Time
Trigger1 = helper(2000),var(6) >= helper(2000), var(4)
Trigger1 = helper(2000),var(6) >= helper(2000), var(5)
var(2) = 2

[State 1000, Power Set]
Type = varSet
TriggerAll = !Time
Trigger1 = command="a"
Trigger2 = command="b"
Trigger3 = command="c"
var(2) = IfElse(command = "b",1,IfElse(Command = "c",2,0))

[State 1000, Tatsumaki set]
Type = varSet
Trigger1 = !Time
Trigger1 = var(9)
var(2) = 2

[State 1000, Invincible]
type = ChangeAnim
Trigger1 = !Time
value = 1200+var(2)

[State 1000, Takuma Voice]
type = PlaySnd
Trigger1 = AnimElem = 2
value = 1200,(var(1)-1)*(var(1) != 4)
Channel = 1

[State 1200, jump]
Type = StateTypeSet
Trigger1 = AnimElem = 4
StateType = A

[State 1200, Speed]
Type = VelSet
Trigger1 = AnimElem = 4
x = 8+var(2)
y = -.2

[State 1200, Speed]
Type = VelAdd
Trigger1 = AnimElem = 4, > 0
y = .025


[State 1200, FX Snd]
Type = PlaySnd
Trigger1 = AnimElem = 4
Value = 50, 1
Channel = 3

[State 1100, Hit 1]
Type = HitDef
Trigger1 = AnimElem = 5
attr = A, SA
damage = ifelse(anim = 1200, 45, 100), ifelse(anim = 1200, 5, 10)
animtype = Hard
fall.animtype = Hard
getpower = 60,30
givepower = 30,15
guardflag = M
hitflag = MA
pausetime = 10+5*(var(1) = 3),12+5*(var(1) = 3)
sparkno = S8002
guard.sparkno = S8012
sparkxy = -15,-60
hitsound = S5,5+2*(var(1) = 3)
guardsound = S6,0
ground.type = Low
ground.SlideTime = 17
ground.HitTime = 17
air.hittime = 40
guard.slidetime = 17
guard.hittime = 17
guard.ctrltime = 17
guard.velocity = -10.5
ground.velocity = -9.5+3*(anim = 1200), -5.5*(anim = 1200)
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.velocity = -4.5,-4.5
yAccel = .5
Fall = (anim = 1200)
air.Fall = 1
Fall.Recover = 0
EnvShake.Time = 10+5*(var(1) = 3)
NoChainID = 1210

[State 3020, 2]
Type = EnvColor
Trigger1 = Movehit
Trigger1 = var(1) = 3
Time = 3
Value = 255,255,255
Under = 1
IgnoreHitPause = 1
Persistent = 0

[State 1000, Juggle set1]
Type = varSet
Trigger1 = MoveHit
Trigger1 = anim != 1200
var(7) = 1
IgnoreHitPause = 1

[State 1000, Juggle set1]
Type = ChangeState
Trigger1 = MoveContact
Trigger1 = anim != 1200
Value = 1210

[State 1000, Juggle set1]
Type = MoveHitReset
Trigger1 = MoveHit

[State 1200, End]
type = ChangeState
Trigger1 = !AnimTime
value = 1201

;-------- Landing -------
[Statedef 1201]
Type = S
MoveType = I
Physics = N
Anim = 1205
Ctrl = 0
PowerAdd = 0
VelSet = 0,0

[State 1000, 9]
type = Posset
Trigger1 = !Time
y = 0

[State 1000, 9]
type = ChangeState
trigger1 = var(9)
trigger1 = !AnimTime
Trigger1 = NumTarget(1210)
value = 160

[State 1000, 9]
type = ChangeState
Trigger1 = !AnimTime
value = 0
Ctrl = 1

;-----------------------------------
;---- Hien Shippukyaku Finisher ----
;-----------------------------------
[Statedef 1210]
Type = A
MoveType = A
Physics = N
Anim = 1210
Ctrl = 0
PowerAdd = 0
Juggle = 8
Velset = 10,0

[State 1000, Takuma Voice]
type = PlaySnd
Trigger1 = var(1) = 3
Trigger1 = AnimElem = 2
value = 1200,3
Channel = 1

[State 1200, FX Snd]
Type = PlaySnd
Trigger1 = AnimElem = 3
Value = 1, 2
Channel = 3

[State 1100, Multi Hits2]
Type = HitDef
Trigger1 = var(1) != 3
Trigger1 = AnimElem = 4
attr = A, SA
damage = 45,5
animtype = up
getpower = 60,30
givepower = 30,15
guardflag = M
hitflag = MA
pausetime = 10,12
sparkno = S8002
guard.sparkno = S8012
sparkxy = -15,-65
hitsound = S5,5
guardsound = S6,0
ground.type = High
ground.SlideTime = 17
ground.HitTime = 17
air.hittime = 40
guard.slidetime = 17
guard.hittime = 17
guard.ctrltime = 17
guard.velocity = -10.5
ground.velocity = -1.25-(var(2) = 1), -12+2*(var(2) = 1)
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.velocity = -1.25-(var(2) = 1),-11+2*(var(2) = 1)
yAccel = .55
Fall = 1
Fall.Recover = 0
EnvShake.Time = 10
ID = 1210

[State 1100, Multi Hits2]
Type = HitDef
Trigger1 = var(1) = 3
Trigger1 = AnimElem = 4
attr = A, SA
damage = 45,5
animtype = up
getpower = 60,30
givepower = 30,15
guardflag = M
hitflag = MA
pausetime = 20,22
sparkno = S8002
guard.sparkno = S8012
sparkxy = -15,-65
hitsound = S5,7
guardsound = S6,0
ground.type = High
ground.SlideTime = 17
ground.HitTime = 17
air.hittime = 40
guard.slidetime = 17
guard.hittime = 17
guard.ctrltime = 17
guard.velocity = -10.5
ground.velocity = -.9-(var(2) = 1), -12+2*(var(2) = 1)
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.velocity = -.9-(var(2) = 1),-11+2*(var(2) = 1)
yAccel = .55
Fall = 1
Fall.Recover = 0
EnvShake.Time = 20
ID = 1210

[State 3020, 2]
Type = EnvColor
Trigger1 = Movehit
Trigger1 = var(1) = 3
Time = 3
Value = 255,255,255
Under = 1
IgnoreHitPause = 1
Persistent = 0

[State 1000, Juggle set]
Type = varSet
Trigger1 = MoveHit
var(7) = 1
IgnoreHitPause = 1

[State 1000, Juggle set]
Type = MoveHitReset
Trigger1 = MoveHit

[State 1200, End]
type = ChangeState
Trigger1 = !AnimTime
value = 1201

;-----------------------------------
;------ Hien Shippukyaku 2002 ------
;-----------------------------------
[Statedef 1220]
Type = S
MoveType = A
Physics = N
Anim = 1220
VelSet = 0
Ctrl = 0
PowerAdd = 120
Juggle = 8

[State -1, Cancel Combo]
Type = Varadd
TriggerAll = var(15)
TriggerAll = !time
Trigger1 = prevstateno = [1000, 2000]
Trigger2 = prevstateno = [200, 730]
Trigger2 = var(1) = 3
IgnoreHitPause = 1
var(15) = -200

[State 3000, PALFX]
type = PalFX
TriggerAll = gametime%2 = 0
TriggerAll = time <= 7
Trigger1 = prevstateno = [1000, 2000]
Trigger2 = prevstateno = [200, 730]
Trigger2 = var(1) = 3
time = 1
add = 255,255,255
sinadd = -100,-100,-100, 2
ignorehitpause = 1

[State 1000, buffer setting1]
Type = varSet
Trigger1 = !Time
Trigger1 = helper(2000),var(4) >= helper(2000), var(5)
Trigger1 = helper(2000),var(4) >= helper(2000), var(6)
var(2) = 0

[State 1000, buffer setting2]
Type = varSet
Trigger1 = !Time
Trigger1 = helper(2000),var(5) >= helper(2000), var(4)
Trigger1 = helper(2000),var(5) >= helper(2000), var(6)
var(2) = 1

[State 1000, buffer setting3]
Type = varSet
Trigger1 = !Time
Trigger1 = helper(2000),var(6) >= helper(2000), var(4)
Trigger1 = helper(2000),var(6) >= helper(2000), var(5)
var(2) = 2

[State 1000, Power Set]
Type = varSet
TriggerAll = !Time
Trigger1 = command="a"
Trigger2 = command="b"
Trigger3 = command="c"
var(2) = IfElse(command = "b",1,IfElse(Command = "c",2,0))

[State 1000, Tatsumaki set]
Type = varSet
Trigger1 = !Time
Trigger1 = var(9)
var(2) = ifelse(prevStateNo = 310, 2, 1)

[State 1000, Invincible]
type = ChangeAnim
Trigger1 = !Time
value = 1220+var(2)

[State 1200, Speed]
Type = VelSet
Trigger1 = AnimElem = 4
Trigger1 = var(2)
x = 4+var(2)

[State 1200, Speed]
Type = VelMul
Trigger1 = AnimElem = 10, > 0
Trigger1 = AnimElem = 15, < 0
x = .9

[State 1200, Speed]
Type = VelSet
Trigger1 = AnimElem = 15
x = 0

[State 1200, FX Snd]
Type = PlaySnd
Trigger1 = AnimElem = 4
Trigger2 = AnimElem = 8
Value = 1, 2
Channel = 3

[State 1100, Hit 1]
Type = HitDef
Trigger1 = AnimElem = 5
attr = S, SA
damage = 40+10*var(2), 4+var(2)
animtype = Hard
fall.animtype = Hard
getpower = 60,30
givepower = 30,15
guardflag = M
hitflag = MA
pausetime = 6+2*var(2),8+2*var(2)
sparkno = S8002
guard.sparkno = S8012
sparkxy = -15,-80
hitsound = S5,5
guardsound = S6,0
ground.type = Low
ground.SlideTime = 17
ground.HitTime = 17
air.hittime = 40
guard.slidetime = 17
guard.hittime = 17
guard.ctrltime = 17
ground.velocity = -4*var(2)
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.velocity = -2.5,-4.5
yAccel = .55
air.Fall = 1
Fall.Recover = 1
Fall.RecoverTime = 40
EnvShake.Time = 5

[State 1100, Hit 1]
Type = HitDef
Trigger1 = p2MoveType != A
Trigger1 = AnimElem = 10
attr = S, SA
damage = 40+10*var(2), 4+var(2)
animtype = Hard
fall.animtype = Hard
getpower = 60,30
givepower = 30,15
guardflag = M
hitflag = MA
pausetime = 8,10
sparkno = S8002
guard.sparkno = S8012
sparkxy = -15,-80
hitsound = S5,5
guardsound = S6,0
ground.type = Low
ground.SlideTime = 17
ground.HitTime = 17
air.hittime = 40
guard.slidetime = 17
guard.hittime = 17
guard.ctrltime = 17
guard.velocity = -9.5
ground.velocity = -5.5, -4.5*(!var(2))
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.velocity = -5.5,-3.5*(!var(2))
yAccel = .5+6*(var(2) > 0)
Fall = 1
Fall.Recover = 0
EnvShake.Time = 10
ID = 1220

[State 1100, Hit 1]
Type = HitDef
Trigger1 = p2MoveType = A
Trigger1 = AnimElem = 10
attr = S, SA
damage = 40+10*var(2), 4+var(2)
animtype = Hard
fall.animtype = Hard
getpower = 60,30
givepower = 30,15
guardflag = M
hitflag = MA
priority = 4, miss
pausetime = 8,10
sparkno = S8002
guard.sparkno = S8012
sparkxy = -15,-75
hitsound = S5,5
guardsound = S6,0
ground.type = Low
ground.SlideTime = 17
ground.HitTime = 17
air.hittime = 40
guard.slidetime = 17
guard.hittime = 17
guard.ctrltime = 17
guard.velocity = -9.5
ground.velocity = -5.5, -4.5*(!var(2))
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.velocity = -5.5,-3.5*(!var(2))
yAccel = .5
Fall = 1
Fall.Recover = 0
EnvShake.Time = 10
ID = 1221

[State 301, Escape Enemy]
type = targetstate
Trigger1 = MoveHit
trigger1 = Numtarget(1220)
trigger1 = !var(2)
trigger1 = p2StateNo != [1170,1190]
Value = 1170
ignorehitpause = 1
persistent = 0

[State 301, Escape Enemy]
type = targetstate
Trigger1 = MoveHit
trigger1 = Numtarget(1221)
trigger1 = p2StateNo != [6400,6405]
Value = 6400
ignorehitpause = 1
persistent = 0

[State 1000, Juggle set1]
Type = varSet
Trigger1 = MoveHit
Trigger1 = AnimElem = 6, < 0
var(7) = 1
IgnoreHitPause = 1

[State 1200, End]
type = ChangeState
Trigger1 = !AnimTime
value = 0
Ctrl = 1

;-----------------------------------
;--------- Mouko Burai Gan ---------
;-----------------------------------
[Statedef 1300]
Type = S
MoveType = A
Physics = S
Anim = 1300
Velset = 0
Ctrl = 0
Juggle  = 8
Poweradd = 150

[State -1, Cancel Combo]
Type = Varadd
TriggerAll = var(15)
TriggerAll = !time
Trigger1 = prevstateno = [1000, 2000]
Trigger2 = prevstateno = [200, 730]
Trigger2 = var(1) = 3
IgnoreHitPause = 1
var(15) = -200

[State 3000, PALFX]
type = PalFX
TriggerAll = gametime%2 = 0
TriggerAll = time <= 7
Trigger1 = prevstateno = [1000, 2000]
Trigger2 = prevstateno = [200, 730]
Trigger2 = var(1) = 3
time = 1
add = 255,255,255
sinadd = -100,-100,-100, 2
ignorehitpause = 1

[State 1000, buffer setting1]
Type = varSet
Trigger1 = !Time
Trigger1 = helper(2000),var(1) >= helper(2000), var(2)
Trigger1 = helper(2000),var(1) >= helper(2000), var(3)
var(2) = 0

[State 1000, buffer setting2]
Type = varSet
Trigger1 = !Time
Trigger1 = helper(2000),var(2) >= helper(2000), var(1)
Trigger1 = helper(2000),var(2) >= helper(2000), var(3)
var(2) = 1

[State 1000, buffer setting3]
Type = varSet
Trigger1 = !Time
Trigger1 = helper(2000),var(3) >= helper(2000), var(1)
Trigger1 = helper(2000),var(3) >= helper(2000), var(2)
var(2) = 2

[State 1000, Power Set]
Type = varSet
TriggerAll = !Time
Trigger1 = command="x"
Trigger2 = command="y"
Trigger3 = command="z"
var(2) = IfElse(command = "y",1,IfElse(Command = "z",2,0))

[State 1000, Power set]
Type = varSet
Trigger1 = !Time
Trigger1 = var(9)
var(2) = 1

[State 1000, Takuma Voice]
type = ChangeAnim
Trigger1 = !Time
value = 1300+var(2)+10*(var(1) = 3)

[State 1000, 1frame of invul]
type = NotHitBy
trigger1 = !Time
value = SCA

[State 1000, Takuma Voice]
type = PlaySnd
Trigger1 = AnimElem = 2
value = ifelse(var(1) = 2, 2,1300),2*(var(1) = 2)
Channel = 1

[State 1000, Kooh Ken FX sound]
type = PlaySnd
trigger1 = AnimElem = 6
value = 1,2
Channel = 3

[State 310, 1]
type = reversaldef
triggerAll = prevStateNo != [200,2000]
triggerAll = animelem = 2, >= 0
trigger1 = !var(2)
trigger1 = animelem = 3, < 0
trigger2 = var(2) = 1
trigger2 = animelem = 8, < 0
trigger3 = var(2) = 2
trigger3 = animelem = 6, < 0
reversal.attr = SCA, AA, AP
pausetime = 8,10
sparkno = S8012
sparkxy = 10,0
hitsound = S6,0
numhits = 0
hitflag = MAP

[State 1300, GCrushStart]
type = VarSet
trigger1 = !Time
var(4) = 0
ignorehitpause = 1

[State 1300, Lifeadd]
type = Lifeadd
triggerAll = Movehit
triggerAll = Enemynear, hitdefattr = SCA,SA,HA,SP,HP
trigger1 = !var(2)
trigger1 = animelem = 3, < 0
trigger2 = var(2) = 1
trigger2 = animelem = 8, < 0
trigger3 = var(2) = 2
trigger3 = animelem = 6, < 0
value = -10
kill = 0
ignorehitpause = 1

[State 1300, GCrushLimit]
type = Varadd
triggerAll = Movehit
trigger1 = !var(2)
trigger1 = animelem = 3, < 0
trigger2 = var(2) = 1
trigger2 = animelem = 8, < 0
trigger3 = var(2) = 2
trigger3 = animelem = 6, < 0
var(4) = 1
ignorehitpause = 1

[State 1300, GCrushAdd]
type = Varadd
triggerAll = Movehit
trigger1 = !var(2)
trigger1 = animelem = 3, < 0
trigger2 = var(2) = 1
trigger2 = animelem = 8, < 0
trigger3 = var(2) = 2
trigger3 = animelem = 6, < 0
var(11) = floor(100/var(4))
ignorehitpause = 1

[State 1300, GCrushState]
type = ChangeState
triggerAll = var(11) >= 1000
trigger1 = !var(2)
trigger1 = animelem = 3, < 0
trigger2 = var(2) = 1
trigger2 = animelem = 8, < 0
trigger3 = var(2) = 2
trigger3 = animelem = 6, < 0
value = 900
ctrl = 0
ignorehitpause = 1

[State 310, 1]
type = MoveHitReset
trigger1 = !var(2)
trigger1 = animelem = 3, < 0
trigger2 = var(2) = 1
trigger2 = animelem = 8, < 0
trigger3 = var(2) = 2
trigger3 = animelem = 6, < 0
ignoreHitPause = 1

[State 1000, 3]
type = HitDef
trigger1 = !var(2)
trigger1 = AnimElem = 6
attr = S, SA
ownpal = 1
damage = 20,2
animtype = light
getpower = 60,30
givepower = 30,15
guardflag = M
hitflag = M
pausetime = 4,6
sparkno = S8000
guard.sparkno = S8010
sparkxy = -15,-75
hitsound = S5,6
guardsound = S6,0
ground.type = High
air.type = low
ground.slidetime = 17
ground.hittime  = 17
guard.slidetime = 17
guard.hittime = 17
air.hittime = 30
guard.ctrltime = 17
ground.velocity = 0
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.velocity = -4.5,-5.5
yaccel = .5
air.fall = 1
Fall.Recover = !var(55)
Fall.RecoverTime = 40


[State 1000, 3]
type = HitDef
trigger1 = AnimElem = 9
attr = S, SA
ownpal = 1
damage = 80+10*var(2),8+var(2)
animtype = DiagUp
getpower = 60,30
givepower = 30,15
guardflag = M
hitflag = MA
pausetime = 15,15
sparkno = S8002
guard.sparkno = S8012
sparkxy = -15,-65
hitsound = S5,6
guardsound = S6,0
ground.type = High
air.type = low
ground.slidetime = 17
ground.hittime  = 17
guard.slidetime = 17
guard.hittime = 17
air.hittime = 30
guard.ctrltime = 17
ground.velocity = -6, -9
guard.velocity = -9
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.velocity = -6,-8
yaccel = .5
Fall = 1
Fall.Recover = 0
Fall.EnvShake.Time = 25
EnvShake.Time = 20
ID = 1300

[State 1000, 9]
type = ChangeState
triggerAll = Numtarget(1300)
triggerAll = Target, StateNo = [5000,6005]
trigger1 = AnimElem = 11
trigger1 = !var(2)
trigger2 = AnimElem = 12
value = 1310

[State 1000, 9]
type = ChangeState
trigger1 = !AnimTime
value = 0
ctrl = 1

;-----------------------------------
;------- Mouko Burai Gan Hit -------
;-----------------------------------
[Statedef 1310]
Type = S
MoveType = I
Physics = N
Anim = 1310
Ctrl = 0
PowerAdd = 0
VelSet = 0,0

[State 1000, Takuma Voice]
type = PlaySnd
Trigger1 = AnimElem = 1, = 1
Trigger1 = var(1) < 2
value = 1300,1
Channel = 1

[State 1000, 9]
type = ChangeState
Trigger1 = !AnimTime
value = 0
Ctrl = 1

;-----------------------------------
;--------- Sanchin No Kata ---------
;-----------------------------------
[Statedef 1350]
Type = S
MoveType = I
Physics = S
Anim = 1350
Velset = 0,0
Ctrl = 0

[State 1300, GCrushStart]
type = VarSet
trigger1 = !Time
var(4) = 0
ignorehitpause = 1

[State 1000, Takuma Voice]
type = PlaySnd
Trigger1 = AnimElem = 2
value = 0,3
Channel = 1

[State 310, Normal moves]
type = reversaldef
trigger1 = 1
reversal.attr = SCA, NA
pausetime = 10,12
sparkno = S8012
sparkxy = 10,0
hitsound = S6,0
numhits = 0
PowerAdd = 30,15
IgnoreHitPause = 1

[State 1300, GCrushLimit]
type = Varadd
trigger1 = Movehit
var(4) = 1
ignorehitpause = 1

[State 1300, GCrushAdd]
type = Varadd
trigger1 = Movehit
var(11) = floor(100/var(4))
ignorehitpause = 1

[State 1300, GCrushState]
type = ChangeState
trigger1 = var(11) >= 1000
value = 900
ctrl = 0
ignorehitpause = 1

[State 1300, Reset]
type = MoveHitReset
trigger1 = Movehit
ignorehitpause = 1

[State 0, HitOverride]
type = HitOverride
trigger1 = AnimTime
attr = SCA,SA,HA,AP
slot = 1
stateno = 1360
time = 1
ignorehitpause = 1

[State 1000, Takuma Voice]
type = PlaySnd
Trigger1 = AnimElem = 8
value = 801,1
Channel = 3

[State 1000, quake]
type = EnvShake
Trigger1 = AnimElem = 8
Time = 14
Ampl = 3

[State -3, OTG FX]
type = Explod
Trigger1 = AnimElem = 8
anim = 8310
pos = 0,0
bindtime = 1
ownpal = 1
sprpriority = -3

[State -3, OTG FX]
type = Explod
Trigger1 = AnimElem = 8
anim = 8320
pos = 0,0
bindtime = 1
ownpal = 1
sprpriority = 3

[State 1000, 9]
type = ChangeState
trigger1 = !AnimTime
value = 0
ctrl = 1

;-----------------------------------
;--- Sanchin No Kata - being hit ---
;-----------------------------------
[Statedef 1360]
Type = S
MoveType = I
Physics = S
Velset = 0,0
Ctrl = 0
Poweradd = 0

[State 1000, Armor anim]
type = Lifeadd
trigger1 = !Time
value = -ceil(gethitvar(damage)/4)
kill = 0

[State 1000, Armor anim]
type = ChangeAnim
trigger1 = Time <= gethitvar(hitshaketime)
value = anim
Elem = animelemno(0)

[State 1300, GCrushLimit]
type = Varadd
trigger1 = !Time
var(4) = 1
ignorehitpause = 1

[State 1300, GCrushAdd]
type = Varadd
trigger1 = !Time
var(11) = floor((ifelse(GetHitVar(hitshaketime) <= 12,GetHitVar(hitshaketime)*10,125))/var(4))
ignorehitpause = 1

[State 1000, Takuma Voice]
type = PlaySnd
Trigger1 = AnimElem = 2
trigger1 = Time > gethitvar(hitshaketime)
value = 0,3
Channel = 1

[State 310, Normal moves]
type = reversaldef
trigger1 = 1
reversal.attr = SCA, NA
pausetime = 10,12
sparkno = S8012
sparkxy = 10,0
hitsound = S6,0
numhits = 0
PowerAdd = 30,15
IgnoreHitPause = 1

[State 1300, GCrushLimit]
type = Varadd
trigger1 = Movehit
var(4) = 1
ignorehitpause = 1

[State 1300, GCrushAdd]
type = Varadd
trigger1 = Movehit
var(11) = floor(100/var(4))
ignorehitpause = 1

[State 1300, GCrushState]
type = ChangeState
trigger1 = var(11) >= 1000
value = 900
ctrl = 0
ignorehitpause = 1

[State 1300, Reset]
type = MoveHitReset
trigger1 = Movehit
ignorehitpause = 1

[State 0, HitOverride]
type = HitOverride
trigger1 = AnimTime
attr = SCA,SA,HA,AP
slot = 1
stateno = 1360
time = 1
ignorehitpause = 1


[State 1000, Takuma Voice]
type = PlaySnd
Trigger1 = AnimElem = 8
trigger1 = Time > gethitvar(hitshaketime)
value = 801,1
Channel = 3

[State 1000, quake]
type = EnvShake
Trigger1 = AnimElem = 8
trigger1 = Time > gethitvar(hitshaketime)
Time = 14
Ampl = 3

[State -3, OTG FX]
type = Explod
Trigger1 = AnimElem = 8
trigger1 = Time > gethitvar(hitshaketime)
anim = 8310
pos = 0,0
bindtime = 1
ownpal = 1
sprpriority = -3

[State -3, OTG FX]
type = Explod
Trigger1 = AnimElem = 8
trigger1 = Time > gethitvar(hitshaketime)
anim = 8320
pos = 0,0
bindtime = 1
ownpal = 1
sprpriority = 3

[State 1000, 9]
type = ChangeState
trigger1 = !AnimTime
value = 0
ctrl = 1

;-----------------------------------
;----- Zanretsu Ken - Startup ------
;-----------------------------------
[Statedef 1400]
Type = S
MoveType = A
Physics = N
Anim = 1400
VelSet = 0
Ctrl = 0
PowerAdd = 150
Juggle = 8

[State -1, Cancel Combo]
Type = Varadd
TriggerAll = var(15)
TriggerAll = !time
Trigger1 = prevstateno = [1000, 2000]
Trigger2 = prevstateno = [200, 730]
Trigger2 = var(1) = 3
IgnoreHitPause = 1
var(15) = -200

[State 3000, PALFX]
type = PalFX
TriggerAll = gametime%2 = 0
TriggerAll = time <= 7
Trigger1 = prevstateno = [1000, 2000]
Trigger2 = prevstateno = [200, 730]
Trigger2 = var(1) = 3
time = 1
add = 255,255,255
sinadd = -100,-100,-100, 2
ignorehitpause = 1

[State 1000, buffer setting1]
Type = varSet
Trigger1 = !Time
Trigger1 = helper(2000),var(1) >= helper(2000), var(2)
Trigger1 = helper(2000),var(1) >= helper(2000), var(3)
var(2) = 0

[State 1000, buffer setting2]
Type = varSet
Trigger1 = !Time
Trigger1 = helper(2000),var(2) >= helper(2000), var(1)
Trigger1 = helper(2000),var(2) >= helper(2000), var(3)
var(2) = 1

[State 1000, buffer setting3]
Type = varSet
Trigger1 = !Time
Trigger1 = helper(2000),var(3) >= helper(2000), var(1)
Trigger1 = helper(2000),var(3) >= helper(2000), var(2)
var(2) = 2

[State 1000, Power Set]
Type = varSet
TriggerAll = !Time
Trigger1 = command="x"
Trigger2 = command="y"
Trigger3 = command="z"
var(2) = IfElse(command = "y",1,IfElse(Command = "z",2,0))

[State 1000, zanretsu set AI]
Type = varSet
Trigger1 = !Time
Trigger1 = var(9)
var(2) = 0

[State 1000, Invincible]
type = ChangeAnim
Trigger1 = !Time
value = 1400+var(2)

[State 1000, Takuma Voice]
type = PlaySnd
Trigger1 = AnimElem = 2
value = 1400, (var(1)-1)*(var(1) != 4)
Channel = 1


[State 1000, 9]
type = ChangeState
Trigger1 = !AnimTime
value = 1410

;-----------------------------------
;----- Zanretsu Ken - Striking -----
;-----------------------------------
[Statedef 1410]
Type = S
MoveType = A
Physics = S
Anim = 1410+(var(1) = 3)
Velset = 0
Ctrl = 0
Juggle = 8
Poweradd = 0


[State 1000, FX sound]
type = PlaySnd
Trigger1 = AnimElem = 1
Trigger2 = AnimElem = 5
Trigger3 = AnimElem = 10
Trigger4 = AnimElem = 16
Trigger5 = AnimElem = 22
value = 1,1
Channel = 2

[State 1000, FX sound]
type = PlaySnd
Trigger1 = AnimElem = 3
Trigger2 = AnimElem = 7
Trigger3 = AnimElem = 13
Trigger4 = AnimElem = 19
Trigger5 = AnimElem = 25
value = 1,1
Channel = 3

[State 1000, 3]
type = HitDef
Trigger1 = var(1) != 3
trigger1 = AnimElem = 2
trigger2 = AnimElem = 8
Trigger3 = var(1) = 3
trigger3 = AnimElem = 11
Trigger4 = var(1) = 3
trigger4 = AnimElem = 20
attr = S, SA
damage = 5,5
animtype = light
getpower = 5,1
givepower = 5,1
guardflag = M
hitflag = MA
pausetime = 1,4
guard.pausetime = 3,4
sparkno = S8000
guard.sparkno = S8010
sparkxy = -15,-85
hitsound = S5,2
guardsound = S6,0
ground.type = High
air.type = low
ground.slidetime = 17
ground.hittime  = 17
guard.slidetime = 17
guard.hittime = 17
air.hittime = 30
guard.ctrltime = 17
ground.velocity = ifelse(var(1) = 3, 0, -8)
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.velocity = -4.5,-5.5
yaccel = .5
fall = 1
Fall.Recover = !var(55)
Fall.RecoverTime = 40
Kill = 0
ID = 1400

[State 1000, 3]
type = HitDef
Trigger1 = var(1) != 3
trigger1 = AnimElem = 5
Trigger2 = var(1) = 3
trigger2 = AnimElem = 14
Trigger3 = var(1) = 3
trigger3 = AnimElem = 17
Trigger4 = var(1) = 3
trigger4 = AnimElem = 26
attr = S, SA
damage = 5,5
animtype = light
getpower = 5,1
givepower = 5,1
guardflag = M
hitflag = MA
pausetime = 1,4
guard.pausetime = 3,4
sparkno = S8000
guard.sparkno = S8010
sparkxy = -15,-110
hitsound = S5,2
guardsound = S6,0
ground.type = High
air.type = low
ground.slidetime = 17
ground.hittime  = 17
guard.slidetime = 17
guard.hittime = 17
air.hittime = 30
guard.ctrltime = 17
ground.velocity = ifelse(var(1) = 3, 0, -8)
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.velocity = -4.5,-5.5
yaccel = .5
fall = 1
Fall.Recover = !var(55)
Fall.RecoverTime = 40
Kill = 0
ID = 1400

[State 1000, 3]
type = HitDef
Trigger1 = var(1) != 3
trigger1 = AnimElem = 11
Trigger2 = var(1) = 3
trigger2 = AnimElem = 2
Trigger3 = var(1) = 3
trigger3 = AnimElem = 5
Trigger4 = var(1) = 3
trigger4 = AnimElem = 23
attr = S, SA
damage = 5,5
animtype = light
getpower = 5,1
givepower = 5,1
guardflag = M
hitflag = MA
pausetime = 1,4
guard.pausetime = 3,4
sparkno = S8000
guard.sparkno = S8010
sparkxy = -15,-50
hitsound = S5,2
guardsound = S6,0
ground.type = High
air.type = low
ground.slidetime = 17
ground.hittime  = 17
guard.slidetime = 17
guard.hittime = 17
air.hittime = 30
guard.ctrltime = 17
ground.velocity = ifelse(var(1) = 3, 0, -8)
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.velocity = -4.5,-5.5
yaccel = .5
fall = 1
Fall.Recover = !var(55)
Fall.RecoverTime = 40
Kill = 0
ID = 1400

[State 1000, 9]
type = TargetState
trigger1 = MoveHit
trigger1 = Numtarget(1400)
Trigger1 = target, alive
value = 1470+(var(1) = 3)

[State 1000, 9]
type = ChangeState
trigger1 = MoveHit
trigger1 = Numtarget(1400)
Trigger1 = target, alive
value = 1450

[State 1000, 9]
type = MoveHitReset
trigger1 = MoveContact

[State 1000, 9]
type = ChangeState
trigger1 = Time > 50+25*var(2)
value = 1420

;-----------------------------------
;------- Zanretsu Ken - End -------
;-----------------------------------
[Statedef 1420]
Type = S
MoveType = I
Physics = N
Anim = 1420
Ctrl = 0
PowerAdd = 0
VelSet = 0,0

[State 1000, 9]
type = ChangeState
Trigger1 = !AnimTime
value = 0
Ctrl = 1

;-----------------------------------
;------- Zanretsu Ken - Hit --------
;-----------------------------------
[Statedef 1450]
Type = S
MoveType = A
Physics = S
Anim = 1450+(var(1) = 3)+2*(var(1) = 4)
Ctrl = 0
PowerAdd = 0
SprPriority = 1
Velset = 0,0

[State 1501, Turn]
Type = Targetbind
Trigger1 = !Time
pos = 55,0
IgnoreHitPause = 1

[State 1501, Turn]
Type = NotHitBy
Trigger1 = 1
Value = SCA
Time = 2
IgnoreHitPause = 1

[State 1000, 3]
type = HitDef
trigger1 = AnimElem = 2
trigger2 = AnimElem = 5
trigger3 = AnimElem = 8
trigger4 = var(1) = [3,4]
trigger4 = AnimElem = 11
trigger5 = var(1) = 3
trigger5 = AnimElem = 14
trigger6 = var(1) = 3
trigger6 = AnimElem = 17
attr = S, SA
damage = ifelse(var(1) = 3, 6, ifelse(var(1) = 4, 10, 12)),1
animtype = light
getpower = 5,1
givepower = 5,1
guardflag = M
hitflag = MAF
pausetime = 0,0
sparkno = S8000
guard.sparkno = S8010
sparkxy = -20+floor(random/100),-55+floor(random/100)
hitsound = S5,2
guardsound = S6,0
ground.type = High
air.type = low
ground.slidetime = 17
ground.hittime  = 17
guard.slidetime = 17
guard.hittime = 17
air.hittime = 30
guard.ctrltime = 17
ground.velocity = -9.5
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.velocity = -4.5,-5.5
yaccel = .5
air.fall = 1
Fall.Recover = !var(55)
Fall.RecoverTime = 40
P2StateNo = 1470+(var(1) = 3)
Kill = 0
ID = 1400

[State 1000, 3]
type = HitDef
trigger1 = var(1) != [3,4]
trigger1 = AnimElem = 11
trigger2 = var(1) != 3
trigger2 = AnimElem = 14
trigger3 = var(1) != 3
trigger3 = AnimElem = 17
trigger4 = var(1) = [3,4]
trigger4 = AnimElem = 20
trigger5 = var(1) = [3,4]
trigger5 = AnimElem = 23
trigger6 = var(1) = [3,4]
trigger6 = AnimElem = 26
trigger7 = var(1) = 3
trigger7 = AnimElem = 29
trigger8 = var(1) = 3
trigger8 = AnimElem = 32
trigger9 = var(1) = 3
trigger9 = AnimElem = 35
attr = S, SA
damage = ifelse(var(1) = 3, 6, ifelse(var(1) = 4, 10, 12)),1
animtype = light
getpower = 5,1
givepower = 5,1
guardflag = M
hitflag = MAF
pausetime = 0,0
sparkno = S8000
guard.sparkno = S8010
sparkxy = -20+floor(random/100),-90+floor(random/100)
hitsound = S5,2
guardsound = S6,0
ground.type = High
air.type = low
ground.slidetime = 17
ground.hittime  = 17
guard.slidetime = 17
guard.hittime = 17
air.hittime = 30
guard.ctrltime = 17
ground.velocity = -8
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.velocity = -4.5,-5.5
yaccel = .5
fall = 1
Fall.Recover = !var(55)
Fall.RecoverTime = 40
P2StateNo = 1470+(var(1) = 3)
Kill = 0
ID = 1400

[State 1000, 3]
type = HitDef
trigger1 = var(1) != [3,4]
trigger1 = AnimElem = 20
trigger2 = var(1) != [3,4]
trigger2 = AnimElem = 23
trigger3 = var(1) != 3
trigger3 = AnimElem = 26
trigger4 = var(1) != 3
trigger4 = AnimElem = 29
trigger5 = var(1) != 3
trigger5 = AnimElem = 32
trigger6 = var(1) = 4
trigger6 = AnimElem = 35
trigger7 = var(1) = [3,4]
trigger7 = AnimElem = 38
trigger8 = var(1) = [3,4]
trigger8 = AnimElem = 41
trigger9 = var(1) = 3
trigger9 = AnimElem = 44
trigger10 = var(1) = 3
trigger10 = AnimElem = 47
trigger11 = var(1) = 3
trigger11 = AnimElem = 50
trigger12 = var(1) = 3
trigger12 = AnimElem = 53
trigger13 = var(1) = 3
trigger13 = AnimElem = 56
trigger14 = var(1) = 3
trigger14 = AnimElem = 59
trigger15 = var(1) = 3
trigger15 = AnimElem = 62
trigger16 = var(1) = 3
trigger16 = AnimElem = 65
attr = S, SA
damage = ifelse(var(1) = 3, 6, ifelse(var(1) = 4, 10, 12)),1
animtype = light
getpower = 5,1
givepower = 5,1
guardflag = M
hitflag = MAF
pausetime = 0,0
sparkno = S8000
guard.sparkno = S8010
sparkxy = -20+floor(random/100),-115+floor(random/100)
hitsound = S5,2
guardsound = S6,0
ground.type = High
air.type = low
ground.slidetime = 17
ground.hittime  = 17
guard.slidetime = 17
guard.hittime = 17
air.hittime = 30
guard.ctrltime = 17
ground.velocity = -9.5
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.velocity = -4.5,-5.5
yaccel = .5
fall = 1
Fall.Recover = !var(55)
Fall.RecoverTime = 40
P2StateNo = 1470+(var(1) = 3)
Kill = 0
ID = 1400

[State 1000, 3]
type = HitDef
trigger1 = var(1) != [3,4]
trigger1 = AnimElem = 41
trigger2 = var(1) = 4
trigger2 = AnimElem = 50
trigger3 = var(1) = 3
trigger3 = AnimElem = 74
attr = S, SA
damage = 19,2
animtype = Up
getpower = 5,1
givepower = 5,1
guardflag = M
hitflag = MAF
pausetime = 25,25
sparkno = S8002
guard.sparkno = S8012
sparkxy = -15,-105
hitsound = S5,6+(var(1) = 3)
guardsound = S6,0
ground.type = High
air.type = low
ground.slidetime = 17
ground.hittime  = 17
guard.slidetime = 17
guard.hittime = 17
air.hittime = 30
guard.ctrltime = 17
ground.velocity = -2, -12
guard.velocity = -9.5
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.velocity = -2,-11
yaccel = .5
Fall = 1
Fall.Recover = 0
Envshake.time = 25
ID = 1401

[State 3020, 2]
Type = EnvColor
TriggerAll = Movehit
trigger1 = var(1) != [3,4]
trigger1 = AnimElem = 41, > 0
trigger2 = var(1) = 4
trigger2 = AnimElem = 50, > 0
trigger3 = var(1) = 3
trigger3 = AnimElem = 74, > 0
Time = 3
Value = 255,255,255
Under = 1
IgnoreHitPause = 1
persistent = 0

[State 3020, 2]
Type = varset
TriggerAll = Movehit
trigger1 = var(1) != [3,4]
trigger1 = AnimElem = 41, > 0
trigger2 = var(1) = 4
trigger2 = AnimElem = 50, > 0
trigger3 = var(1) = 3
trigger3 = AnimElem = 74, > 0
var(7) = 1
IgnoreHitPause = 1

[State 3020, 2]
Type = MoveHitReset
Trigger1 = Movehit

[State 200, Over]
Type = ChangeState
TriggerAll = !Numtarget(1400)
trigger1 = var(1) != [3,4]
trigger1 = AnimElem = 41, < 0
trigger2 = var(1) = 4
trigger2 = AnimElem = 50, < 0
trigger3 = var(1) = 3
trigger3 = AnimElem = 74, < 0
Value = 0
Ctrl = 1

[State 200, Over]
Type = ChangeState
Trigger1 = !Animtime
Value = 0
Ctrl = 1

;-----------------------------------
;-- Hit by Zanretsu Ken (Normal) ---
;-----------------------------------
[Statedef 1470]
Type = A
MoveType = H
Physics = N
Ctrl = 0
PowerAdd = 0
VelSet = .05,-.5

[State 1000, 9]
type = HitFallSet
Trigger1 = 1
value = 0
ignorehitpause = 1

[State 1000, 9]
type = Playerpush
Trigger1 = 1
value = 0
ignorehitpause = 1

[State 1000, 9]
type = ChangeAnim2
Trigger1 = !Time
value = 1470
ignorehitpause = 1

[State 1000, 9]
type = SelfState
Trigger1 = !AnimTime
value = 5050

;-----------------------------------
;-- Hit by Zanretsu Ken (Serious) --
;-----------------------------------
[Statedef 1471]
Type = A
MoveType = H
Physics = N
Ctrl = 0
PowerAdd = 0
VelSet = .05,-.5

[State 1000, 9]
type = HitFallSet
Trigger1 = 1
value = 0
ignorehitpause = 1

[State 1000, 9]
type = Playerpush
Trigger1 = 1
value = 0
ignorehitpause = 1

[State 1000, 9]
type = ChangeAnim2
Trigger1 = !Time
value = 1471
ignorehitpause = 1

[State 1000, 9]
type = SelfState
Trigger1 = !AnimTime
value = 5050

;-----------------------------------
;------- Shorankyaku Startup -------
;-----------------------------------
[Statedef 1500]
Type = S
MoveType = A
Physics = N
Anim = 1500+(var(1) = 2)
VelSet = 0
PowerAdd = 120
Juggle = 8
SprPriority = 1
Ctrl = 0

[State -1, Cancel Combo]
Type = Varadd
TriggerAll = var(15)
TriggerAll = !time
Trigger1 = prevstateno = [1000, 2000]
Trigger2 = prevstateno = [200, 730]
Trigger2 = var(1) = 3
IgnoreHitPause = 1
var(15) = -200

[State 3000, PALFX]
type = PalFX
TriggerAll = gametime%2 = 0
TriggerAll = time <= 7
Trigger1 = prevstateno = [1000, 2000]
Trigger2 = prevstateno = [200, 730]
Trigger2 = var(1) = 3
time = 1
add = 255,255,255
sinadd = -100,-100,-100, 2
ignorehitpause = 1

[State 1000, buffer setting1]
Type = varSet
Trigger1 = !Time
Trigger1 = helper(2000),var(4) >= helper(2000), var(5)
Trigger1 = helper(2000),var(4) >= helper(2000), var(6)
var(2) = 0

[State 1000, buffer setting2]
Type = varSet
Trigger1 = !Time
Trigger1 = helper(2000),var(5) >= helper(2000), var(3)
Trigger1 = helper(2000),var(5) >= helper(2000), var(6)
var(2) = 1

[State 1000, buffer setting3]
Type = varSet
Trigger1 = !Time
Trigger1 = helper(2000),var(6) >= helper(2000), var(4)
Trigger1 = helper(2000),var(6) >= helper(2000), var(5)
var(2) = 2

[State 1000, Power Set]
Type = varSet
TriggerAll = !Time
Trigger1 = command="a"
Trigger2 = command="b"
Trigger3 = command="c"
var(2) = IfElse(command = "b",1,IfElse(Command = "c",2,0))

[State 1000, Kohou set AI]
Type = varSet
TriggerAll = !Time
TriggerAll = var(9)
Trigger1 = var(1) = [1,2]
Trigger1 = p2StateType != A
Trigger1 = p2BodyDist x < 15+10*(Enemy, p2Dist x < 0)
Trigger2 = p2StateType = A
Trigger3 = var(1) != [1,2]
Trigger3 = p2StateType != A
Trigger3 = p2Movetype = A
var(2) = 2

[State 1000, Takuma Voice]
type = PlaySnd
Trigger1 = AnimElem = 1, = 1
value = 1500, (var(1)-1)*(var(1) != 4)
Channel = 1

[State 1000, Cancel checker]
type = VarSet
Trigger1 = !Time
var(4) = ifelse((prevStateNo = [200,2000]), 1,0)
IgnoreHitPause = 1

[State 1000, Dash]
type = Velset
Trigger1 = AnimElem = 2
x = const(velocity.run.fwd.x)+var(2)

[State 100, Sound]
Type = PlaySnd
Trigger1 = AnimElem = 3 || AnimElem = 6
Value = 100,0
Channel = 3

[State 1000, 9]
type = ChangeState
Trigger1 = p2bodydist x < 5
Trigger1 = AnimElem = 2, >= 0
Trigger1 = var(1) != 4
value = 1510

[State 800, 1]
type = HitDef
Trigger1 = var(1) = 4
Trigger1 = AnimElem = 2
attr = S, ST
guardflag = M
hitflag = M
priority = 2, Miss
PauseTime = 0,0
Guard.PauseTime = 0,8
Guard.velocity = -8
ground.cornerpush.veloff = 0
Ground.hittime = 15
sparkno = S8220
guard.sparkno = -1
sparkxy = -15,-80
HitSound = S800,1
guardSound = -1
sprpriority = 1
p1facing = 1
p2facing = 1
p1stateno = 1520
p2stateno = 1530
Fall = 1
Fall.Recover = 0
ID = 1500

[State 1000, 9]
type = ChangeState
Trigger1 = Moveguarded
Trigger2 = Time > 9+7*(var(1) = 2)+25+5*var(2)
value = 1502-(!moveguarded)

;-----------------------------------
;-------- Shorankyaku - Miss -------
;-----------------------------------
[Statedef 1501]
Type = S
MoveType = I
Physics = S
Anim = 1505
Velset = 0,0

[State 1200, End]
type = ChangeState
Trigger1 = !AnimTime
value = 0
Ctrl = 1

;-----------------------------------
;------- Shorankyaku - guard -------
;-----------------------------------
[Statedef 1502]
Type = S
MoveType = I
Physics = S
Anim = 1506

[State 1200, End]
type = ChangeState
Trigger1 = !AnimTime
value = 0
Ctrl = 1

;-----------------------------------
;------ Shorankyaku - Attempt ------
;-----------------------------------
[Statedef 1510]
type = S
movetype= A
physics = S
juggle = 8
velset = 0,0
ctrl = 0
anim = 1510

[State 1000, invul]
type = HitBy
trigger1 = AnimElem = 4, < 0
value = SCA, AA, AP
ignorehitpause = 1

[State 800, 1]
type = HitDef
Trigger1 = p2StateNo!= [40,52]
Trigger1 = !var(4)
Trigger1 = !var(6)
Trigger1 = AnimElem = 4
Trigger1 = p2dist x < 75
attr = S, ST
hitflag = M-
priority = 2, Miss
sparkno = S8220
sparkxy = -15,-80
HitSound = S800,1
sprpriority = 1
p1facing = 1
p2facing = 1
p1stateno = 1520
p2stateno = 1530
Fall = 1
Fall.Recover = 0
ID = 1500

[State 800, 1]
type = HitDef
Trigger1 = p2StateNo!= [40,52]
Trigger1 = var(4)
Trigger1 = !var(19)
Trigger1 = AnimElem = 4
Trigger1 = p2dist x < 75
attr = S, ST
hitflag = M
priority = 2, Miss
sparkno = S8220
sparkxy = -15,-80
HitSound = S800,1
sprpriority = 1
p1facing = 1
p2facing = 1
p1stateno = 1520
p2stateno = 1530
Fall = 1
Fall.Recover = 0
ID = 1500

[State 800, 2]
type = ChangeState
Trigger1 = !AnimTime
value = 0
Ctrl = 1

;-----------------------------------
;------ Shorankyaku - success ------
;-----------------------------------
[Statedef 1520]
type = A
movetype= A
physics = N
velset = 0,0
ctrl = 0
anim = 1520+(var(1) = 4)

[State 1000, Takuma Voice]
type = PlaySnd
Trigger1 = !Time
Trigger1 = prevstateNo = 1550
value = 1500, 0
Channel = 1

[State 1520, Bind to target]
type = Targetbind
Trigger1 = AnimElem = 1, >= 0
Trigger1 = AnimElem = 2, < 0
pos = 40,0

[State 1520, Bind to target]
type = BindtoTarget
Trigger1 = AnimElem = 2, > 0
Trigger1 = AnimElem = 14, < 0
pos = 25,75, head

[State 3000, Spark]
Type = Explod
trigger1 = AnimElem = 2, = 1
trigger2 = AnimElem = 6
trigger3 = AnimElem = 10
anim = 8000
PosType = p1
Ownpal = 1
OnTop = 1
Pos = 20,-55
PauseMoveTime = 99
SuperMoveTime = 99
IgnoreHitPause = 1

[State 3000, Spark]
Type = Explod
trigger1 = AnimElem = 4
trigger2 = AnimElem = 8
trigger3 = AnimElem = 12
anim = 8000
PosType = p1
Ownpal = 1
OnTop = 1
Pos = 30,-65
PauseMoveTime = 99
SuperMoveTime = 99
IgnoreHitPause = 1

[State 3000, Hurt]
Type = TargetLifeAdd
trigger1 = AnimElem = 2
trigger2 = AnimElem = 4
trigger3 = AnimElem = 6
trigger4 = AnimElem = 8
trigger5 = AnimElem = 10
trigger6 = AnimElem = 12
Value = -15
Kill = 0

[State 3000, HitSound 1]
Type = PlaySND
trigger1 = AnimElem = 2
trigger2 = AnimElem = 6
trigger3 = AnimElem = 10
Value = 5,3
Channel = 3

[State 3000, HitSound 2]
Type = PlaySND
trigger1 = AnimElem = 4
trigger2 = AnimElem = 8
trigger3 = AnimElem = 12
Value = 5,3
Channel = 4

[State 200, Hitdef]
Type = HitDef
Trigger1 = AnimElem = 14
attr = A, ST
damage = 60,6
AnimType = Back
getpower = 0,0
givepower = 30,15
Guardflag =
Hitflag = MAF
pauseTime = 6,9
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,-50-10*(var(1) = 4)
HitSound = S5,6
GuardSound = S6,0
ground.Type = High
ground.SlideTime = 17
ground.HitTime = 17
ground.Velocity = -4,-7.5
Guard.Velocity = -11.5
Air.Velocity = -4,-7
yAccel = .5
Ground.cornerpush.veloff = 0;-15.5
Air.cornerpush.veloff = 0;-15.5
EnvShake.Time = 15
Fall = 1
Fall.Recover = !var(55)
Fall.RecoverTime = 40
ChainID = 1500
NumHits = 0

[State 1520, End]
type = Velset
Trigger1 = Anim = 1521
Trigger1 = AnimElem = 15
Trigger2 = Anim = 1520
Trigger2 = AnimElem = 17
x = -3.5
y = -10

[State 1520, End]
type = gravity
Trigger1 = Anim = 1521
Trigger1 = AnimElem = 15, > 0
Trigger2 = Anim = 1520
Trigger2 = AnimElem = 17, > 0

[State 1520, End]
type = ChangeState
Trigger1 = Pos y >= 0
Trigger1 = vel y > 0
Trigger1 = AnimElem = 20, > 0
value = 1101

;-----------------------------------
;-------- Hit by Shorankyaku -------
;-----------------------------------
[Statedef 1530]
Type = A
MoveType = H
Physics = N
Ctrl = 0
PowerAdd = 0
VelSet = 0,0

[State 1000, 9]
type = Playerpush
Trigger1 = 1
value = 0
ignorehitpause = 1

[State 1000, 9]
type = Hitby
Trigger1 = 1
value = A, ST

[State 1000, 9]
type = ChangeAnim2
Trigger1 = !Time
value = 1530
ignorehitpause = 1

[State 1000, 9]
type = SelfState
Trigger1 = !AnimTime
value = 0
Ctrl = 1

;-----------------------------------
;-------- Shorankyaku grab ---------
;-----------------------------------
[Statedef 1550]
Type = S
MoveType = A
Physics = N
Anim = 1550
VelSet = 0
PowerAdd = 60
Juggle = 8
SprPriority = 1
Ctrl = 0

[State -1, Cancel Combo]
Type = Varadd
TriggerAll = var(15)
TriggerAll = !time
Trigger1 = prevstateno = [1000, 2000]
Trigger2 = prevstateno = [200, 730]
Trigger2 = var(1) = 3
IgnoreHitPause = 1
var(15) = -200

[State 3000, PALFX]
type = PalFX
TriggerAll = gametime%2 = 0
TriggerAll = time <= 7
Trigger1 = prevstateno = [1000, 2000]
Trigger2 = prevstateno = [200, 730]
Trigger2 = var(1) = 3
time = 1
add = 255,255,255
sinadd = -100,-100,-100, 2
ignorehitpause = 1

[State 800, 1]
type = HitDef
Triggerall = p2dist x < 75
Trigger1 = PrevStateNo = [200,2000]
Trigger1 = !var(19)
Trigger1 = !Time
attr = S, ST
hitflag = M
guardflag =
priority = 6, Miss
sparkno = S8220
sparkxy = -15,-80
HitSound = S800,1
guardSound = S6,0
sprpriority = 1
p1facing = 1
p2facing = 1
p1stateno = 1520
p2stateno = 1530
Fall = 1
Fall.Recover = 0
ID = 1500

[State 800, 1]
type = HitDef
Triggerall = p2dist x < 75
Trigger1 = PrevStateNo != [200,2000]
Trigger1 = !var(6)
Trigger1 = !Time
attr = S, ST
hitflag = M-
guardflag =
priority = 6, Miss
sparkno = S8220
sparkxy = -15,-80
HitSound = S800,1
guardSound = S6,0
sprpriority = 1
p1facing = 1
p2facing = 1
p1stateno = 1520
p2stateno = 1530
Fall = 1
Fall.Recover = 0
ID = 1500

[State 800, 2]
type = ChangeState
Trigger1 = !AnimTime
value = 0
Ctrl = 1

;-----------------------------------
;-------- Haoh Shikoken '02 --------
;-----------------------------------
[Statedef 1600]
Type = S
MoveType = A
Physics = S
Anim = 1600
VelSet = 0
Ctrl = 0
PowerAdd = 150
SprPriority = 1

[State -1, Cancel Combo]
Type = Varadd
TriggerAll = var(15)
TriggerAll = !time
Trigger1 = prevstateno = [1000, 2000]
Trigger2 = prevstateno = [200, 730]
Trigger2 = var(1) = 3
IgnoreHitPause = 1
var(15) = -200

[State 3000, PALFX]
type = PalFX
TriggerAll = gametime%2 = 0
TriggerAll = time <= 7
Trigger1 = prevstateno = [1000, 2000]
Trigger2 = prevstateno = [200, 730]
Trigger2 = var(1) = 3
time = 1
add = 255,255,255
sinadd = -100,-100,-100, 2
ignorehitpause = 1

[State 1000, buffer setting1]
Type = varSet
Trigger1 = !Time
Trigger1 = helper(2000),var(1) >= helper(2000), var(2)
Trigger1 = helper(2000),var(1) >= helper(2000), var(3)
var(2) = 0

[State 1000, buffer setting2]
Type = varSet
Trigger1 = !Time
Trigger1 = helper(2000),var(2) >= helper(2000), var(1)
Trigger1 = helper(2000),var(2) >= helper(2000), var(3)
var(2) = 1

[State 1000, buffer setting3]
Type = varSet
Trigger1 = !Time
Trigger1 = helper(2000),var(3) >= helper(2000), var(1)
Trigger1 = helper(2000),var(3) >= helper(2000), var(2)
var(2) = 2

[State 1000, Power Set]
Type = varSet
TriggerAll = !Time
Trigger1 = command="x"
Trigger2 = command="y"
Trigger3 = command="z"
var(2) = IfElse(command = "y",1,IfElse(Command = "z",2,0))

[State 1000, Power set]
Type = varSet
Trigger1 = !Time
Trigger1 = var(9)
var(2) = 0

[State 1000, Power set]
Type = varSet
TriggerAll = !Time
TriggerAll = var(9)
Trigger1 = prevStateNo = 52
Trigger2 = prevStateNo = 200
Trigger3 = prevStateNo = [400,410]
Trigger4 = p2StateNo = 5120
var(2) = 2

[State 1000, Takuma Voice]
type = ChangeAnim
Trigger1 = !Time
value = 1600+var(2)

[State 1000, Takuma Voice]
type = PlaySnd
Trigger1 = AnimElem = 2
value = 3000,0
Channel = 1

[State 1000, Kooh Ken FX sound]
type = PlaySnd
trigger1 = AnimElem = 10
value = 1,2
Channel = 3

[State -3, 2K2 UM FX]
type = Explod
Trigger1 = AnimElem = 12
anim = 1051
pos = 45,-70
bindtime = 1
ownpal = 1
sprpriority = 3
Scale = .7+.15*(2-var(2)),1+.2*var(2)
IgnoreHitPause = 1
PauseMoveTime = 10
SuperMoveTime = 10

[State 1000, 3]
type = Projectile
Trigger1 = p2MoveType != A
Trigger1 = AnimElem = 12
attr = S, SP
ownpal = 1
damage = 80+20*var(2),8+2*var(2)
animtype = Heavy
fall.animtype = back
getpower = 120,60
givepower = 60,30
guardflag = M
hitflag = MA
pausetime = 0,12
sparkno = -1
guard.sparkno = -1
sparkxy = -15,-70
hitsound = S5,7
guardsound = S6,0
ground.type = High
air.type = low
ground.slidetime = 17
ground.hittime  = 17
guard.slidetime = 17
guard.hittime = 17
air.hittime = 30
guard.ctrltime = 17
guard.velocity = -9.5
ground.velocity = -5.5, -3
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.velocity = -5.5,0
yaccel = .5
air.juggle = 15
projanim = 1650
projhitanim = 1060
projremanim = -1
projcancelanim = 1060
ProjRemoveTime = 10
velocity = 9-1.5*var(2)
offset = 50,-70
projid = 1600
Projpriority = 9999
Fall = 1
air.fall = 1
Fall.Recover = 0
Id = 1600

[State 1000, 3]
type = Projectile
Trigger1 = p2MoveType = A
Trigger1 = AnimElem = 12
attr = S, SP
ownpal = 1
damage = 80+20*var(2),8+2*var(2)
animtype = Heavy
priority = 4,miss
fall.animtype = back
getpower = 120,60
givepower = 60,30
guardflag = MA
hitflag = MA
pausetime = 0,12
sparkno = -1
guard.sparkno = -1
sparkxy = -15,-70
hitsound = S5,7
guardsound = S6,0
ground.type = High
air.type = low
ground.slidetime = 17
ground.hittime  = 17
guard.slidetime = 17
guard.hittime = 17
air.hittime = 30
guard.ctrltime = 17
guard.velocity = -9.5
ground.velocity = -5.5, -3
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.velocity = -5.5,0
yaccel = .5
air.juggle = 15
projanim = 1650
projhitanim = 1060
projremanim = -1
projcancelanim = 1060
ProjRemoveTime = 10
velocity = 10-2*var(2)
offset = 35,-70
projid = 1600
Projpriority = 9999
Fall = 1
air.fall = 1
Fall.Recover = 0
ID = 1601

[State 301, Escape Enemy]
type = targetstate
Trigger1 = ProjHit = 1
trigger1 = Numtarget(1600)
trigger1 = p2StateNo != [1170,1190]
Value = 1170
ignorehitpause = 1
persistent = 0

[State 301, Escape Enemy]
type = targetstate
Trigger1 = ProjHit(1600) = 1
trigger1 = Numtarget(1601)
trigger1 = p2StateNo != [6400,6409]
Value = 6400
ignorehitpause = 1
persistent = 0

[State 301, Escape Enemy]
type = targetstate
TriggerAll = ProjGuarded(1600) = 1
TriggerAll = var(2)
triggerAll = p2StateNo != 1610
triggerAll = Target, alive
trigger1 = Numtarget(1600)
trigger2 = Numtarget(1601)
Value = 1610
ignorehitpause = 1
persistent = 0

[State 1000, 9]
type = ChangeState
trigger1 = !AnimTime
value = 0
ctrl = 1


;----------------------------
;Guard crushed by projectiles
;----------------------------
[Statedef 1610]
type = S
movetype = H
physics = S
ctrl = 0
Velset = 0,0,0

[State 1610, idle]
Type = StateTypeSet
trigger1 = Time = 1
movetype = I
ignorehitpause = 1

[State 9100, 2]
type = ChangeAnim
trigger1 = !Time
trigger1 = AuthorName = "Don Drago"
trigger1 = SelfAnimExist(900)
value = 900
ignorehitpause = 1

[State 9100, 2]
type = ChangeAnim
trigger1 = !Time
trigger1 = AuthorName = "Sander71113"
trigger1 = SelfAnimExist(307)
value = 307
ignorehitpause = 1

[State 9100, 2]
type = ChangeAnim
trigger1 = !Time
trigger1 = AuthorName = "zzzasd"
trigger1 = SelfAnimExist(811)
value = 311
ignorehitpause = 1

[State 9100, 2]
type = ChangeAnim2
trigger1 = !Time
trigger1 = Anim != 307
trigger1 = Anim != 811
trigger1 = Anim != 900
value = 1610
ignorehitpause = 1

[State 9100, 2]
type = Envcolor
trigger1 = Time = 0
value = 248,248,248
time = 3
under = 1
ignorehitpause = 1

[State 9100, 6]
type = SelfState
trigger1 = !AnimTime
trigger2 = Time > 30
value = 0
ctrl = 1
ignorehitpause = 1

;-----------------------------------
;-- Normal Haoh Shikoken startup ---
;-----------------------------------
[Statedef 1700]
Type = S
MoveType = A
Physics = S
Anim = 1700+(var(1) = 3)
VelSet = 0
Ctrl = 0
PowerAdd = 0
SprPriority = 1

[State -1, Cancel Combo]
Type = Varadd
TriggerAll = var(15)
TriggerAll = !time
Trigger1 = prevstateno = [1000, 2000]
Trigger2 = prevstateno = [200, 730]
Trigger2 = var(1) = 3
IgnoreHitPause = 1
var(15) = -200

[State 3000, PALFX]
type = PalFX
TriggerAll = gametime%2 = 0
TriggerAll = time <= 7
Trigger1 = prevstateno = [1000, 2000]
Trigger2 = prevstateno = [200, 730]
Trigger2 = var(1) = 3
time = 1
add = 255,255,255
sinadd = -100,-100,-100, 2
ignorehitpause = 1

[State 1000, buffer setting1]
Type = varSet
Trigger1 = !Time
Trigger1 = helper(2000),var(1) > helper(2000), var(2)
Trigger1 = helper(2000),var(1) > helper(2000), var(3)
var(2) = 0

[State 1000, buffer setting2]
Type = varSet
Trigger1 = !Time
Trigger1 = helper(2000),var(2) > helper(2000), var(1)
Trigger1 = helper(2000),var(2) > helper(2000), var(3)
var(2) = 1

[State 1000, buffer setting3]
Type = varSet
Trigger1 = !Time
Trigger1 = helper(2000),var(3) > helper(2000), var(1)
Trigger1 = helper(2000),var(3) > helper(2000), var(2)
var(2) = 2

[State 1000, Power Set]
Type = varSet
TriggerAll = !Time
Trigger1 = command="x"
Trigger2 = command="y"
Trigger3 = command="z"
var(2) = IfElse(command = "y",1,IfElse(Command = "z",2,0))

[State 1000, Power set]
Type = varSet
Trigger1 = !Time
Trigger1 = var(9)
var(2) = IfElse((p2StateNo = [5120,5210]),0,2)

[State 1000, Takuma Voice]
type = PlaySnd
Trigger1 = var(1) != 3
Trigger1 = AnimElem = 2
value = 3000,0
Channel = 1

[State 1000, Karate Voice]
type = PlaySnd
Trigger1 = var(1) = 3
Trigger1 = AnimElem = 2
value = 771,0
Channel = 1

[State 1000, Hadouken FX sound]
type = PlaySnd
Trigger1 = var(1) != 3
trigger1 = AnimElem = 6
value = 3050,0
Channel = 3

[State -3, HSK appears]
type = Explod
trigger1 = var(1) = 4
Trigger1 = AnimElem = 7
anim = 3030
pos = 50,-75
bindtime = 1
ownpal = 1
sprpriority = 3
RemoveonGetHit = 1

[State 1000, Invincible]
type = NotHitBy
Trigger1 = var(1) = 3
Trigger1 = AnimElem = 8, <= -1
value = SCA
IgnoreHitPause = 1

[State 1000, 3]
type = Projectile
trigger1 = var(1) != 3
trigger1 = AnimElem = 8
attr = S, SP
ownpal = 1
damage = 150,15
animtype = Back
getpower = 0,0
givepower = 30,15
guardflag = M
hitflag = MA
pausetime = 3,10
sparkno = S8002
guard.sparkno = S8050
sparkxy = 20,-5
hitsound = S5,6
guardsound = S6,0
ground.type = High
air.type = low
ground.slidetime = 17
ground.hittime  = 17
guard.slidetime = 17
guard.hittime = 17
air.hittime = 30
guard.ctrltime = 17
ground.velocity = -4.5, -6.5
guard.velocity = -10
air.velocity = -4.5, -5.5
yaccel = .5
juggle = 15
projanim = 3055
projhitanim = 3070
projremanim = 3070
projcancelanim = 3070
velocity = 4+1.5*var(2)
offset = 50,-75
projid = 1000
projpriority = 9999
Fall = 1
Fall.Recover = 0
ID = 1000
EnvShake.time = 15

[State 1000, Posadds]
type = PosAdd
Trigger1 = var(1) = 3
Trigger1 = AnimElem = 3
x = -20

[State 1000, Posadds]
type = PosAdd
Trigger1 = var(1) = 3
Trigger1 = AnimElem = 4
x = -10

[State 1000, Posadds]
type = PosAdd
Trigger1 = var(1) = 3
Trigger1 = AnimElem = 5
x = -5

[State 1000, 9]
type = VarSet
trigger1 = !Time
trigger1 = var(1) = 3
var(4) = 0

[State 1000, 9]
type = VarAdd
triggerAll = var(1) = 3
trigger1 = Time = 35
trigger2 = Time = 50
trigger3 = Time = 65
trigger4 = Time = 80
trigger5 = Time = 95
trigger6 = Time = 110
var(4) = 1

[State 1000, 9]
type = ChangeState
triggerAll = Time > 19
triggerAll = var(9)
triggerAll = var(1) = 3
trigger1 = Time >= 110
trigger2 = prevStateNo = 1450
trigger2 = time >= 29
trigger3 = NumTarget(1210)
trigger3 = prevStateNo = 160
trigger4 = p2StateNo = 5120
trigger4 = EnemyNear, AnimTime = [-14,-11]
trigger5 = p2StateType != L
trigger5 = p2StateType != A
trigger6 = p2MoveType = A
trigger7 = p2StateType = A
trigger7 = p2MoveType != H
trigger8 = p2StateNo = 40
trigger9 = p2StateType != A
trigger9 = p2StateType != L
trigger9 = p2MoveType = H
trigger10 = time >= 35
trigger10 = prevStateNo = 1100 || prevStateNo = 1800
value = 1710

[State 1000, 9]
type = ChangeState
triggerAll = var(1) = 3
triggerAll = Time > 19
triggerAll = !var(9)
trigger1 = Time >= 110
trigger2 = Command != "holdx"
trigger2 = Command != "holdy"
trigger2 = Command != "holdz"
value = 1710

[State 1000, 9]
type = ChangeState
trigger1 = var(1) != 3
trigger1 = !AnimTime
value = ifelse(var(9), 160, 0)
ctrl = ifelse(var(9), 0, 1)

;-----------------------------------
;--- Normal Haoh Shikoken launch ---
;-----------------------------------
[Statedef 1710]
Type = S
MoveType = A
Physics = S
Anim = 3020
VelSet = 0
Ctrl = 0
PowerAdd = 0
SprPriority = 1

[State 1000, Karate Voice]
type = PlaySnd
Trigger1 = AnimElem = 3
value = 3000,2
Channel = 1

[State 1000, Hadouken FX sound]
type = PlaySnd
trigger1 = AnimElem = 4
value = 3050,0
Channel = 3

[State 1000, Posadds]
type = PosAdd
Trigger1 = AnimElem = 3
x = 37

[State 1000, 3]
type = Projectile
trigger1 = var(4) < 6
trigger1 = AnimElem = 4, = 1
attr = S, SP
ownpal = 1
damage = 100+10*var(4),10+var(4)
animtype = Back
getpower = 0,0
givepower = 30,15
guardflag = M
hitflag = MA
pausetime = 3,10
sparkno = S8002
guard.sparkno = S8050
sparkxy = 20,-5
hitsound = S5,6+(var(4) > 1)+(var(4) > 3)
guardsound = S6,0
ground.type = High
air.type = low
ground.slidetime = 17
ground.hittime  = 17
guard.slidetime = 17
guard.hittime = 17
air.hittime = 30
guard.ctrltime = 17
ground.velocity = -4.5, -6.5
guard.velocity = -10
air.velocity = -4.5, -5.5
yaccel = .5
juggle = 15
projanim = 3050+5*(var(4) > 2)+5*(var(4) > 3)
projhitanim = 3070
projremanim = 3070
projcancelanim = 3070
velocity = 4+4*var(2)
offset = 65,-75
projid = 1000
projpriority = 9999
Fall = 1
Fall.Recover = 0
ID = 1000
EnvShake.time = 15

[State 1000, 3]
type = Projectile
trigger1 = var(4) >= 6
trigger1 = AnimElem = 4, = 1
attr = S, SP
ownpal = 1
damage = 150,150
animtype = DiagUp
getpower = 0,0
givepower = 30,15
guardflag =
hitflag = MA
pausetime = 3,10
sparkno = S8002
guard.sparkno = S8050
sparkxy = 20,-5
hitsound = S5,8
guardsound = S6,0
ground.type = High
air.type = low
ground.slidetime = 17
ground.hittime  = 17
guard.slidetime = 17
guard.hittime = 17
air.hittime = 30
guard.ctrltime = 17
ground.velocity = -5.5, -7.5
guard.velocity = -10
air.velocity = -5.5, -8.5
yaccel = .5
juggle = 15
projanim = 3060
projhitanim = 3070
projremanim = 3070
projcancelanim = 3070
velocity = 4+3*var(2)
offset = 65,-75
projid = 1000
projpriority = 9999
Fall = 1
Fall.Recover = 0
ID = 1000
EnvShake.time = 15

[State 1000, 9]
type = ChangeState
trigger1 = !AnimTime
value = 0
ctrl = 1

;-----------------------------------
;-- Triple Haoh Shikoken startup ---
;-----------------------------------
[Statedef 1750]
Type = S
MoveType = A
Physics = S
Anim = 1701
VelSet = 0
Ctrl = 0
PowerAdd = 0
SprPriority = 1

[State -1, Cancel Combo]
Type = Varadd
TriggerAll = var(15)
TriggerAll = !time
Trigger1 = prevstateno = [1000, 2000]
Trigger2 = prevstateno = [200, 730]
Trigger2 = var(1) = 3
IgnoreHitPause = 1
var(15) = -200

[State 3000, PALFX]
type = PalFX
TriggerAll = gametime%2 = 0
TriggerAll = time <= 7
Trigger1 = prevstateno = [1000, 2000]
Trigger2 = prevstateno = [200, 730]
Trigger2 = var(1) = 3
time = 1
add = 255,255,255
sinadd = -100,-100,-100, 2
ignorehitpause = 1

[State 1000, buffer setting1]
Type = varSet
Trigger1 = !Time
Trigger1 = helper(2000),var(1) > helper(2000), var(2)
Trigger1 = helper(2000),var(1) > helper(2000), var(3)
var(2) = 0

[State 1000, buffer setting2]
Type = varSet
Trigger1 = !Time
Trigger1 = helper(2000),var(2) > helper(2000), var(1)
Trigger1 = helper(2000),var(2) > helper(2000), var(3)
var(2) = 1

[State 1000, buffer setting3]
Type = varSet
Trigger1 = !Time
Trigger1 = helper(2000),var(3) > helper(2000), var(1)
Trigger1 = helper(2000),var(3) > helper(2000), var(2)
var(2) = 2

[State 1000, power Set]
Type = varSet
TriggerAll = !Time
Trigger1 = command = "x"
Trigger2 = command = "y"
Trigger3 = command = "z"
var(2) = IfElse((command = "z"||var(9)),2,IfElse(Command = "x",0,1))

[State 1000, Power set]
Type = varSet
Trigger1 = !Time
Trigger1 = var(9)
var(2) = IfElse((p2StateNo = [5120,5210]),0,2)

[State 1000, power Set]
Type = varSet
Trigger1 = !Time
Trigger1 = var(9)
Trigger1 = prevStateNo = [1000,1999]
var(2) = 0

[State 1000, Invincible]
type = NotHitBy
Trigger1 = AnimElem = 8, <= -1
value = SCA
IgnoreHitPause = 1

[State 1000, Posadds]
type = PosAdd
Trigger1 = AnimElem = 3
x = -20

[State 1000, Posadds]
type = PosAdd
Trigger1 = AnimElem = 4
x = -10

[State 1000, Posadds]
type = PosAdd
Trigger1 = AnimElem = 5
x = -5

[State 1000, 9]
type = VarSet
trigger1 = !Time
var(4) = 0

[State 1000, 9]
type = VarAdd
trigger1 = Time = 35
trigger2 = Time = 50
trigger3 = Time = 65
trigger4 = Time = 80
trigger5 = Time = 95
trigger6 = Time = 110
var(4) = 1

[State 1000, 9]
type = ChangeState
triggerAll = AnimElem = 8, >= -1
triggerAll = var(9)
trigger1 = Time >= 110
trigger2 = prevStateNo = 1450
trigger2 = time >= 29
trigger3 = NumTarget(1210)
trigger3 = prevStateNo = 160
trigger4 = p2StateNo = 5120
trigger4 = EnemyNear, AnimTime = [-14,-11]
trigger5 = p2StateType != L
trigger5 = p2StateType != A
trigger6 = p2MoveType = A
trigger7 = p2StateType = A
trigger7 = p2MoveType != H
trigger8 = p2StateNo = 40
trigger9 = p2StateType != A
trigger9 = p2StateType != L
trigger9 = p2MoveType = H
trigger10 = time >= 35
trigger10 = prevStateNo = 1100 || prevStateNo = 1800
value = 1751

[State 1000, 9]
type = ChangeState
triggerAll = var(1) = 3
triggerAll = Time > 19
triggerAll = !var(9)
trigger1 = Time >= 110
trigger2 = Command != "holdx"
trigger2 = Command != "holdy"
trigger2 = Command != "holdz"
value = 1751

;-----------------------------------
;---- Chou Haoh Shikoken launch ----
;-----------------------------------
[Statedef 1751]
Type = S
MoveType = A
Physics = S
Anim = 4210
VelSet = 0, 0
Ctrl = 0
PowerAdd = 0
SprPriority = 1

[State 1000, Karate Voice]
type = PlaySnd
Trigger1 = AnimElem = 1, = 1
value = 4200,2
Channel = 1

[State 1000, Posadds]
type = PosAdd
Trigger1 = AnimElem = 3
x = 37

[State 1000, Posadds]
type = PosAdd
Trigger1 = AnimElem = 6
Trigger2 = AnimElem = 12
x = 25

[State 1000, Hadouken FX sound]
type = PlaySnd
trigger1 = AnimElem = 3, = 1
trigger2 = var(2)
trigger2 = AnimElem = 8, = 1
trigger3 = var(2)
trigger3 = AnimElem = 14, = 1
value = 3050,0
Channel = 3

[State 1000, 3]
type = Projectile
trigger1 = AnimElem = 3, = 1
trigger2 = AnimElem = 9, = 1
attr = S, HP
ownpal = 1
damage = 30+5*var(4),3+floor(var(4)/2)
animtype = High
getpower = 0,0
givepower = 30,15
guardflag = M
hitflag = MA
pausetime = 3,12
sparkno = S8002
guard.sparkno = S8012
sparkxy = 20,-5
hitsound = S5,6
guardsound = S6,0
ground.type = High
air.type = low
ground.slidetime = 17
ground.hittime  = 17
guard.slidetime = 17
guard.hittime = 17
air.hittime = 30
guard.ctrltime = 17
ground.velocity = 0
air.velocity = -4.5, -5.5
yaccel = .5
projanim = 3060
projhitanim = 3070
projremanim = 3070
projcancelanim = 3070
velocity = 6+4*var(2)
offset = 65,-75
projid = 1750
projpriority = 1000
Air.Fall = 1
Fall.Recover = 0
ID = 1000
EnvShake.time = 15
ProjHits = 2

[State 1000, 3]
type = Projectile
trigger1 = AnimElem = 15, = 1
trigger1 = var(4) < 6
attr = S, HP
ownpal = 1
damage = 10,1
animtype = DiagUp
getpower = 0,0
givepower = 30,15
guardflag = M
hitflag = MAF
pausetime = 3,12
sparkno = S8002
guard.sparkno = S8012
sparkxy = 20,-5
hitsound = S5,7
guardsound = S6,0
ground.type = High
air.type = low
ground.slidetime = 17
ground.hittime  = 17
guard.slidetime = 17
guard.hittime = 17
air.hittime = 30
guard.ctrltime = 17
ground.velocity = -5.5, -8.5
guard.velocity = -10
air.velocity = -5.5, -7.5
yaccel = .5
projanim = 3060
projhitanim = 3070
projremanim = 3070
projcancelanim = 3070
velocity = 6+4*var(2)
offset = 65,-75
projid = 1000
projpriority = 1000
Fall = 1
Fall.Recover = 0
ID = 1000
EnvShake.time = 15
ProjHits = 2

[State 1000, 3]
type = Projectile
trigger1 = AnimElem = 15, = 1
trigger1 = var(4) >= 6
attr = S, HP
ownpal = 1
damage = 10,1
animtype = DiagUp
getpower = 0,0
givepower = 30,15
guardflag =
hitflag = MAF
pausetime = 3,12
sparkno = S8002
guard.sparkno = S8012
sparkxy = 20,-5
hitsound = S5,7
guardsound = S6,0
ground.type = High
air.type = low
ground.slidetime = 17
ground.hittime  = 17
guard.slidetime = 17
guard.hittime = 17
air.hittime = 30
guard.ctrltime = 17
ground.velocity = -5.5, -8.5
air.velocity = -5.5, -7.5
yaccel = .5
projanim = 3060
projhitanim = 3070
projremanim = 3070
projcancelanim = 3070
velocity = 6+4*var(2)
offset = 65,-75
projid = 1000
projpriority = 1000
Fall = 1
Fall.Recover = 0
ID = 1000
EnvShake.time = 15
ProjHits = 2

[State 1000, 9]
type = ChangeState
trigger1 = !AnimTime
value = 0
ctrl = 1

;-----------------------------------
;------ Normal Kyokugen Kohou ------
;-----------------------------------
[Statedef 1800]
Type = S
MoveType = A
Physics = N
Anim = 1800
VelSet = 0
Ctrl = 0
PowerAdd = 0
Juggle = 8

[State -1, Cancel Combo]
Type = Varadd
TriggerAll = var(15)
TriggerAll = !time
Trigger1 = prevstateno = [1000, 2000]
Trigger2 = prevstateno = [200, 730]
Trigger2 = var(1) = 3
IgnoreHitPause = 1
var(15) = -200

[State 3000, PALFX]
type = PalFX
TriggerAll = gametime%2 = 0
TriggerAll = time <= 7
Trigger1 = prevstateno = [1000, 2000]
Trigger2 = prevstateno = [200, 730]
Trigger2 = var(1) = 3
time = 1
add = 255,255,255
sinadd = -100,-100,-100, 2
ignorehitpause = 1

[State 1000, Invincible]
type = NotHitBy
Trigger1 = animelem = 12, < 0
value = SCA
IgnoreHitPause = 1

[State 1000, Takuma Voice]
type = PlaySnd
Trigger1 = AnimElem = 1, = 1
value = 3100,2
Channel = 1

[State 1000, Takuma Voice]
type = PlaySnd
Trigger1 = AnimElem = 12
value = 3100,3
Channel = 1

[State 3000, Flames]
Type = Explod
Trigger1 = AnimElem = 12
Anim = 3150
PosType = p1
Ownpal = 1
SprPriority = 2
BindTime = 18
IgnoreHitPause = 0
Pos = 0,0
RemoveOnGetHit = 1

[State 1100, 1st Hit Serious]
Type = HitDef
Trigger1 = AnimElem = 9
attr = S, SA
damage = 35,3
animtype = Heavy
getpower = 0,0
givepower = 30,15
guardflag = M
hitflag = MA
pausetime = 25,25
sparkno = S8002
guard.sparkno = S8012
sparkxy = -15,-67
hitsound = S5,7
guardsound = S6,0
ground.type = Low
ground.slidetime = 20
ground.hittime  = 20
guard.slidetime = 17
guard.hittime = 17
guard.ctrltime = 17
guard.velocity = 0
ground.velocity = 0
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.velocity = 0,-11.5
yAccel = .5
Air.Fall = 1
Fall.Recover = !var(55)
Fall.RecoverTime = 35
Air.Fall = 1
EnvShake.Time = 15

[State 1100, 1st Hit Serious]
Type = HitDef
Trigger1 = AnimElem = 11
attr = S, SA
damage = 30,3
animtype = Heavy
Fall.animtype = Up
getpower = 0,0
givepower = 30,15
guardflag = M
hitflag = MA
pausetime = 25,25
sparkno = S8002
guard.sparkno = S8012
sparkxy = -15,-85
hitsound = S5,7
guardsound = S6,0
ground.type = High
ground.slidetime = 20
ground.hittime  = 20
guard.slidetime = 17
guard.hittime = 17
guard.ctrltime = 17
guard.velocity = 0
ground.velocity = 0
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.velocity = 0,-11.5
yAccel = .5
Air.Fall = 1
Fall.Recover = !var(55)
Fall.RecoverTime = 35
Air.Fall = 1
EnvShake.Time = 15

[State 1000, Juggle set]
Type = varSet
TriggerAll = MoveHit
Trigger1 = AnimElem = 12, < 0
var(7) = 1
IgnoreHitPause = 1

[State 1100, change to air]
Type = StateTypeSet
Trigger1 = AnimElem = 12
StateType = A

[State 1100, Air Velocity]
Type = VelSet
Trigger1 = AnimElem = 12
x = 5
y = -12

[State -3, Jump Sound]
type = PlaySnd
Trigger1 = AnimElem = 12
Value = 50,1
Channel = 3
IgnoreHitPause = 1

[State 1100, reduce x Vel]
Type = VelMul
Trigger1 = AnimElem = 12, > 0
x = .98

[State 1100, Gravity]
Type = Gravity
Trigger1 = AnimElem = 12, > 0

[State 1100, Final Hits2]
Type = HitDef
Trigger1 = AnimElem = 12
Trigger2 = AnimElem = 13
Trigger3 = AnimElem = 13, = 2
Trigger4 = AnimElem = 13, = 4
attr = A, SA
damage = 20,2
animtype = Heavy
getpower = 0,0
givepower = 3,1
guardflag = M
hitflag = MA
pausetime = 3,2
guard.pausetime = 3,2
sparkno = S8000
guard.sparkno = S8012
sparkxy = -15-floor(random/70),-75-floor(random/15)
hitsound = S5,4
guardsound = S6,0
ground.type = low
ground.slidetime = 20
ground.hittime  = 20
air.hittime = 55
guard.slidetime = 17
guard.hittime = 17
guard.ctrltime = 17
guard.velocity = -9.3
ground.velocity = 0, -10.5
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.velocity = 0,-9.5
yAccel = .6
Fall = 1
Fall.Recover = !var(55)
Fall.RecoverTime = 55
EnvShake.Time = 3

[State 1100, Final Hits4]
Type = HitDef
Trigger1 = AnimElem = 13, = 6
attr = A, SA
damage = 20, 2
animtype = Up
getpower = 0,0
givepower = 30,15
guardflag = M
hitflag = MA
pausetime = 2,2
guard.pausetime = 2,2
sparkno = S8002
guard.sparkno = S8012
sparkxy = -15,-105
hitsound = S5,7
guardsound = S6,0
ground.type = low
ground.slidetime = 20
ground.hittime  = 20
air.hittime = 55
guard.slidetime = 17
guard.hittime = 17
guard.ctrltime = 17
guard.velocity = -9.3
ground.velocity = -2.5, -8.5
ground.cornerpush.veloff = 0;0
guard.cornerpush.veloff = 0;-11.3
air.velocity = -2.5,-8
yAccel = .5
Fall = 1
Fall.Recover = !var(55)
Fall.RecoverTime = 55
EnvShake.Time = 13

[State 3020, 2]
Type = EnvColor
Trigger1 = Movehit
Trigger1 = AnimElem = 9, > 0
Trigger1 = AnimElem = 10, <= 0
Time = 3
Value = 255,255,255
Under = 1
IgnoreHitPause = 1
Persistent = 0

[State 3020, 2]
Type = EnvColor
Trigger1 = Movehit
Trigger1 = AnimElem = 11, > 0
Trigger1 = AnimElem = 12, <= 0
Time = 3
Value = 255,255,255
Under = 1
IgnoreHitPause = 1
Persistent = 0

[State 3020, 2]
Type = EnvColor
Trigger1 = Movehit
Trigger1 = AnimElem = 12, > 0
Time = 3
Value = 255,255,255
Under = 1

[State 3020, 2]
Type = VarSet
TriggerAll = Movehit
Trigger1 = AnimElem = 13, < 6
var(7) = 1
IgnorehitPause = 1

[State 3020, 2]
Type = MovehitReset
Trigger1 = Movecontact

[State 1000, 9]
type = ChangeState
TriggerAll = Vel y > -1
Trigger1 = AnimElem = 12, > 0
value = 1101

;-----------------------------------
;--- Normal Kishin Geki Startup ----
;-----------------------------------
[Statedef 1900]
Type = S
MoveType = A
Physics = N
Anim = 1901
VelSet = 0
Ctrl = 0
PowerAdd = 0
Juggle = 8

[State -1, Cancel Combo]
Type = Varadd
TriggerAll = var(15)
TriggerAll = !time
Trigger1 = prevstateno = [1000, 2000]
Trigger2 = prevstateno = [200, 730]
Trigger2 = var(1) = 3
IgnoreHitPause = 1
var(15) = -200

[State 3000, PALFX]
type = PalFX
TriggerAll = gametime%2 = 0
TriggerAll = time <= 7
Trigger1 = prevstateno = [1000, 2000]
Trigger2 = prevstateno = [200, 730]
Trigger2 = var(1) = 3
time = 1
add = 255,255,255
sinadd = -100,-100,-100, 2
ignorehitpause = 1

[State 1000, Takuma voice]
type = PlaySnd
Trigger1 = AnimElem = 2
value = 1200,2
Channel = 1

[State 1000, Takuma voice]
type = PlaySnd
Trigger1 = AnimElem = 10
value = 1200,3
Channel = 1

[State 3000, invincible]
type = NotHitBy
Trigger1 = AnimElem = 7, < 0
Value = SCA
IgnoreHitPause = 1

[State 3000, Move Sound]
type = PlaySnd
Trigger1 = AnimElem = 6
Trigger2 = AnimElem = 13
Value = 1,2
Channel = 3
IgnoreHitPause = 1

[State 3000, After]
type = AfterImage
trigger1 = time = 1
time = 2
palmul = .65,.65,.75
palbright = 30,30,30
palcontrast = 120,120,220
timegap = 1
framegap = 5
Trans = add1
color = 6

[State 3020, After Set]
type = AfterImagetime
trigger1 = time > 1
time = 2
ignorehitpause=1

[State 3100, First Hits]
Type = HitDef
Trigger1 = AnimElem = 7
attr = S, SA
damage = 60,6
animtype = Heavy
getpower = 0,0
givepower = 30,15
guardflag =
hitflag = MA
pausetime = 25,25
sparkno = S8002
guard.sparkno = S8012
sparkxy = -15,-80
hitsound = S5,6
guardsound = S6,0
ground.type = High
ground.slidetime = 17
ground.hittime  = 17
air.hittime = 30
guard.slidetime = 17
guard.hittime = 17
guard.ctrltime = 17
guard.velocity = -9.3
ground.velocity = 0
ground.cornerpush.veloff = 0;0
guard.cornerpush.veloff = 0;-11.3
air.velocity = -5,-5.5
yAccel = .5
Air.Fall = 1
Fall.Recover = !var(55)
Fall.RecoverTime = 35
EnvShake.Time = 25
EnvShake.Ampl = -5

[State 3100, First Hits]
Type = HitDef
Trigger1 = AnimElem = 14
attr = S, SA
damage = 50,5
animtype = Heavy
getpower = 0,0
givepower = 30,15
guardflag = M
hitflag = MA
pausetime = 25,25
guard.pausetime = 12,12
sparkno = S8002
guard.sparkno = S8012
sparkxy = -15,-65
hitsound = S5,6
guardsound = S6,0
ground.type = low
ground.slidetime = 17
ground.hittime  = 17
air.hittime = 30
guard.slidetime = 17
guard.hittime = 17
guard.ctrltime = 17
guard.velocity = -9.3
ground.velocity = 0
ground.cornerpush.veloff = 0;0
guard.cornerpush.veloff = 0;-11.3
air.velocity = -5,-5.5
yAccel = .5
Air.Fall = 1
Fall.Recover = !var(55)
Fall.RecoverTime = 35
EnvShake.Time = 25
EnvShake.Ampl = -5
ID = 3201

[State 3020, 2]
Type = EnvColor
Trigger1 = Movehit
Trigger1 = AnimElem = 7, > 0
Time = 3
Value = 255,255,255
Under = 1
IgnoreHitPause = 1
Persistent = 0

[State 3020, 2]
Type = EnvColor
Trigger1 = Movehit
Trigger1 = AnimElem = 14, > 0
Time = 3
Value = 255,255,255
Under = 1
IgnoreHitPause = 1
Persistent = 0

[State 301, Escape Enemy]
type = targetstate
Trigger1 = MoveGuarded
trigger1 = numtarget(3201)
trigger1 = Target, alive
trigger1 = Target, stateno != 1610
Value = 1610
ignorehitpause = 1
persistent = 0

[State 3020, 2]
Type = MovehitReset
Trigger1 = Movecontact

[State 1000, 9]
type = ChangeState
Trigger1 = !AnimTime
value = 1901

;-----------------------------------
;--- Normal Kishin Geki Finisher ---
;-----------------------------------
[Statedef 1901]
Type = S
MoveType = A
Physics = N
Anim = 3201
VelSet = 0
Ctrl = 0
PowerAdd = 0
Juggle = 8

[State 3020, After Set]
type = AfterImagetime
trigger1 = 1
time = 2
ignorehitpause=1

[State 1000, Invencible]
type = Width
Trigger1 = 1
Edge = 15,0

[State 3000, Move Sound]
type = PlaySnd
Trigger1 = AnimElem = 5
Value = 1,2
Channel = 3
IgnoreHitPause = 1

[State 3000, POsadds]
type = PosAdd
Trigger1 = AnimElem = 2
Trigger2 = AnimElem = 3
Trigger3 = AnimElem = 8
x = 20

[State 3000, POsadds]
type = PosAdd
Trigger1 = AnimElem = 4
x = 10

[State 3000, POsadds]
type = PosAdd
Trigger1 = AnimElem = 6
x = 15

[State 3000, POsadds]
type = PosAdd
Trigger1 = AnimElem = 9
x = 56

[State 1000, Takuma voice]
type = PlaySnd
Trigger1 = AnimElem = 5
value = 3100,3
Channel = 1

[State 3100, First Hits]
Type = HitDef
Trigger1 = AnimElem = 6
attr = S, SA
damage = 50,5
animtype = Diagup
getpower = 0,0
givepower = 30,15
guardflag =
hitflag = MA
pausetime = 25,25
sparkno = S8002
guard.sparkno = S8012
sparkxy = -15,-70
hitsound = S5,8
guardsound = S6,0
ground.type = High
ground.slidetime = 17
ground.hittime  = 17
air.hittime = 30
guard.slidetime = 17
guard.hittime = 17
guard.ctrltime = 17
guard.velocity = -9.3
ground.velocity = -5, -6.5
ground.cornerpush.veloff = 0;0
guard.cornerpush.veloff = 0;-11.3
air.velocity = -5,-5.5
yAccel = .5
Fall = 1
Fall.Recover = 0
EnvShake.Time = 25
EnvShake.Ampl = -5
ID = 3201

[State 3020, 2]
Type = EnvColor
Trigger1 = Movehit
Time = 3
Value = 255,255,255
Under = 1
IgnoreHitPause = 1
Persistent = 0

[State 301, Escape Enemy]
type = targetstate
Trigger1 = MoveGuarded
trigger1 = numtarget(3201)
trigger1 = Target, alive
trigger1 = Target, stateno != 1610
Value = 1610
ignorehitpause = 1
persistent = 0

[State 3020, 2]
Type = MovehitReset
Trigger1 = Movecontact

[State 1000, 9]
type = ChangeState
Trigger1 = !AnimTime
value = 0
Ctrl = 1

;-----------------------------------
;---- Drago Groove Power Attack ----
;-----------------------------------
[Statedef 1950]
type = S
movetype= I
physics = S
juggle = 8
velset = 0,0
ctrl = 0
anim = 960

[State 8300, OTG FX]
type = Explod
trigger1 = AnimElem = 2, > 0
trigger1 = !NumExplod(1950)
anim = 8300
ID = 1950
pos = 0,0
bindtime = 1
ownpal = 1
sprpriority = -3
PauseMoveTime = 99
SuperMoveTime = 99
RemoveOnGetHit = 1

[State 800, Sound]
type = playsnd
trigger1 = animelem = 3
value = 750,0
Channel = 3

[State 800, Sound]
type = playsnd
trigger1 = animelem = 3, = 20
value = 770,1
Channel = 6

[State 800, 9]
type = NotHitBy
trigger1 = AnimElem = 2, <= 0
value = SCA

[State 800, 9]
type = poweradd
trigger1 = !var(15)
trigger1 = animelem = 1, = 1
value = -500

[State 800, 9]
type = varadd
trigger1 = var(15)
trigger1 = animelem = 1, = 1
var(15) = -500

[State 800, Sound]
type = playsnd
trigger1 = animelem = 2
value = 3100,0
Channel = 1

[State 0, HitOverride]
type = HitOverride
trigger1 = 1
attr = SCA,AA,AP
slot = 0
stateno = 1960
time = 1
ignorehitpause = 1
persistent = 1

[State 700, Cancel4]
type = posAdd
Trigger1 = AnimElem = 1
Trigger2 = AnimElem = 2
Trigger3 = AnimElem = 3
x = 7

[State 700, Cancel3]
type = Explod
Trigger1 = AnimElem = 2
anim = 1950
pos = 12,-65
postype = p1
pausemovetime = 9999
bindtime = 1
ownpal = 1
persistent = 0
ontop = 1

[State 800, 9]
type = varset
trigger1 = !Time
var(47) = 0

[State 800, 9]
type = varAdd
trigger1 = Time
var(47) = 1

[State -2, 11]
type = PalFX
trigger1 = (GameTime%6) = 0
trigger1 = var(47) < 40
time = 3
add = 0,0,120
ignorehitpause = 1

[State -2, 11]
type = PalFX
trigger1 = (GameTime%6) = 0
trigger1 = var(47) = [40,79]
time = 3
add = 0,120,0
ignorehitpause = 1

[State -2, 11]
type = PalFX
trigger1 = (GameTime%6) = 0
trigger1 = var(47) = [80,119]
time = 3
add = 120,120,0
ignorehitpause = 1

[State -2, 11]
type = PalFX
trigger1 = (GameTime%6) = 0
trigger1 = var(47) >= 120
time = 3
add = 120,0,0
ignorehitpause = 1

[State 800, 2]
type = ChangeState
TriggerAll = AnimElem = 3, >= 26
Trigger1 = AnimTime >= -2
trigger2 = Command != "holdy"
trigger2 = Command != "holdb"
value = 1970

;-----------------------------------
;----- Power Attack Armor Out ------
;-----------------------------------
[Statedef 1960]
type = S
movetype= H
physics = S
juggle = 8
velset = 0,0
ctrl = 0

[State 800, Sound]
type = playsnd
trigger1 = animelem = 3
value = 750,0
Channel = 3

[State 800, Sound]
type = playsnd
trigger1 = animelem = 3, = 20
value = 770,1
Channel = 6

[State 8300, OTG FX]
type = Explod
trigger1 = !NumExplod(1950)
anim = 8300
ID = 1950
pos = 0,0
bindtime = 1
ownpal = 1
sprpriority = -3
PauseMoveTime = 99
SuperMoveTime = 99
RemoveOnGetHit = 1

[State 800, 9]
type = varset
trigger1 = !Time
var(48) = gethitvar(damage)
IgnoreHitPause = 1

[State 800, 9]
type = ChangeState
trigger1 = Life <= 0
value = 5020
ignorehitpause = 1

[State 800, 9]
type = StateTypeSet
trigger1 = Time = 2
movetype = I
ignorehitpause = 1

[State 800, 9]
type = varAdd
trigger1 = 1
var(47) = 1
IgnoreHitPause = 1

[State -2, 11]
type = PalFX
trigger1 = !Time
time = 9
add = 120,120,120
ignorehitpause = 1

[State -2, 11]
type = PalFX
trigger1 = Time > 10
trigger1 = (GameTime%6) = 0
trigger1 = var(47) < 40
time = 3
add = 0,0,120
ignorehitpause = 1

[State -2, 11]
type = PalFX
trigger1 = Time > 10
trigger1 = (GameTime%6) = 0
trigger1 = var(47) = [40,79]
time = 3
add = 0,120,0
ignorehitpause = 1

[State -2, 11]
type = PalFX
trigger1 = Time > 10
trigger1 = (GameTime%6) = 0
trigger1 = var(47) = [80,119]
time = 3
add = 120,120,0
ignorehitpause = 1

[State -2, 11]
type = PalFX
trigger1 = Time > 10
trigger1 = (GameTime%6) = 0
trigger1 = var(47) >= 120
time = 3
add = 120,0,0
ignorehitpause = 1

[State 800, 2]
type = ChangeState
TriggerAll = AnimElem = 3, >= 26
Trigger1 = AnimTime >= -2
trigger2 = Command != "holdy"
trigger2 = Command != "holdb"
trigger3 = var(9)
value = 1970

;-----------------------------------
;------ Power Attack Released ------
;-----------------------------------
[Statedef 1970]
Type = S
MoveType = A
Physics = S
Velset = 0
Ctrl = 0
Juggle = 0

[State -2, 11]
type = ChangeAnim
trigger1 = Time = 1
Value = 970
ignorehitpause = 1

[State -2, 11]
type = PalFX
trigger1 = (GameTime%6) = 0
trigger1 = var(47) < 40
time = 3
add = 0,0,120
ignorehitpause = 1

[State -2, 11]
type = PalFX
trigger1 = (GameTime%6) = 0
trigger1 = var(47) = [40,79]
time = 3
add = 0,120,0
ignorehitpause = 1

[State -2, 11]
type = PalFX
trigger1 = (GameTime%6) = 0
trigger1 = var(47) = [80,119]
time = 3
add = 120,120,0
ignorehitpause = 1

[State -2, 11]
type = PalFX
trigger1 = (GameTime%6) = 0
trigger1 = var(47) >= 120
time = 3
add = 120,0,0
ignorehitpause = 1

[State 700, Cancel4]
type = posAdd
Trigger1 = !Time
x = 14

[State 200, Sound Set]
Type = PlaySND
Trigger1 = !Time
value = 2*(var(1) = [1,3]),2+(var(1) != [1,3])
Channel = 1

[State 200, Sound Set]
Type = PlaySND
Trigger1 = AnimElem = 3
value = 1,2
Channel = 2

[State 200, No Charge]
Type = HitDef
Trigger1 = var(47) < 40
Trigger1 = AnimElem = 2
attr = S, HA
damage = 50,5
Priority = 4, miss
AnimType = Heavy
Fall.AnimType = Heavy
getpower = 0,0
givepower = 30,15
Guardflag = M
Hitflag = MA
pauseTime = 11,13
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,-75
HitSound = S5,6
GuardSound = S6,0
ground.Type = High
ground.SlideTime = 17
ground.HitTime = 17
ground.Velocity = -3,-9
Guard.Velocity = -9.5
Air.Velocity = -3,-8
yAccel = .5
Ground.CornerPush.Veloff = 0;-15.5
Air.CornerPush.Veloff = 0;-15.5
EnvShake.Time = 12
Fall = 1
Fall.Recover = !var(55)
Fall.RecoverTime = 35
ID = 1950+(p2MoveType = A)

[State 200, LV1 Charge]
Type = HitDef
Trigger1 = var(47) = [40,79]
Trigger1 = AnimElem = 2
attr = S, HA
damage = 50,5
Priority = 4, miss
AnimType = Heavy
Fall.AnimType = Heavy
getpower = 0,0
givepower = 30,15
Guardflag =
Hitflag = MA
pauseTime = 11,13
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,-75
HitSound = S5,6
GuardSound = S6,0
ground.Type = High
ground.SlideTime = 17
ground.HitTime = 17
ground.Velocity = -3, -9
Guard.Velocity = -9.5
Air.Velocity = -3,-8
yAccel = .5
Ground.CornerPush.Veloff = 0;-15.5
Air.CornerPush.Veloff = 0;-15.5
EnvShake.Time = 12
Fall = 1
Fall.Recover = !var(55)
Fall.RecoverTime = 35
ID = 1950+(p2MoveType = A)

[State 200, LV2 Charge]
Type = HitDef
Trigger1 = var(47) = [80,119]
Trigger1 = AnimElem = 2
attr = S, HA
damage = 50,5
Priority = 4, miss
AnimType = Heavy
Fall.AnimType = Heavy
getpower = 0,0
givepower = 30,15
Guardflag =
Hitflag = MA
pauseTime = 11,13
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,-75
HitSound = S5,6
GuardSound = S6,0
ground.Type = High
ground.SlideTime = 17
ground.HitTime = 17
ground.Velocity = -9.5
Guard.Velocity = -9.5
Air.Velocity = -3,-9
yAccel = .5
Ground.CornerPush.Veloff = 0;-15.5
Air.CornerPush.Veloff = 0;-15.5
EnvShake.Time = 12
Fall = 1
Fall.Recover = !var(55)
Fall.RecoverTime = 35
ID = 1951

[State 200, LV3 Charge]
Type = HitDef
Trigger1 = var(47) >= 120
Trigger1 = AnimElem = 2
attr = S, HA
damage = 50,5
Priority = 4, miss
AnimType = Heavy
Fall.AnimType = Heavy
getpower = 0,0
givepower = 30,15
Guardflag =
Hitflag = MA
pauseTime = 11,13
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,-75
HitSound = S9995,0
GuardSound = S6,0
ground.Type = High
ground.SlideTime = 17
ground.HitTime = 17
ground.Velocity = -9.5
Guard.Velocity = -9.5
Air.Velocity = -3,-9
yAccel = .5
Ground.CornerPush.Veloff = 0;-15.5
Air.CornerPush.Veloff = 0;-15.5
EnvShake.Time = 12
Fall = 1
Fall.Recover = !var(55)
Fall.RecoverTime = 35
ID = 1952

[State 200, Over]
Type = TargetState
TriggerAll = MoveGuarded
TriggerAll = Target, StateNo != [6000,6600]
Trigger1 = Numtarget(1950)
Value = 6600
IgnoreHitPause = 1
Persistent = 0

[State 200, Over]
Type = TargetState
TriggerAll = MoveHit
TriggerAll = Target, StateNo != [6000,6600]
Trigger1 = Numtarget(1950)
Value = 6000
IgnoreHitPause = 1
Persistent = 0

[State 200, Over]
Type = TargetState
TriggerAll = MoveHit
TriggerAll = Target, StateNo != [6000,6600]
Trigger1 = Numtarget(1951)
Trigger2 = Numtarget(1952)
Trigger2 = Target, pos y != [-1,1]
Value = 6400
IgnoreHitPause = 1
Persistent = 0

[State 200, Over]
Type = TargetState
TriggerAll = MoveHit
TriggerAll = Target, StateNo != [6000,6600]
TriggerAll = Numtarget(1952)
Trigger1 = Target, StateType = S
Trigger2 = Target, StateType = C
Trigger3 = Target, pos y = [-5,5]
Value = 6500
IgnoreHitPause = 1
Persistent = 0

[State 200, Over]
Type = MoveHitReset
Trigger1 = MoveContact

[State 200, Over]
Type = ChangeState
Trigger1 = !AnimTime
Value = 0
Ctrl = 1

;============================================================================
; Danger Moves/Super Danger Moves
;============================================================================
;-----------------------------------
;-------- Haoh Shikoken DM ---------
;-----------------------------------
[Statedef 3000]
Type = S
MoveType = A
Physics = N
Anim = 3000+(var(1) = 2)
VelSet = 0
Ctrl = 0
PowerAdd = 0
Juggle = 8

[State 3000,SCancel1]
type = Explod
trigger1 = time = 10 && prevstateno = [1000,2000]
anim = 11100+10*(prevstateno = [1000,1010])
pos = 65,75
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -1
bindtime = -1
ownpal = 1
removeongethit = 1

[State 3000,SCancel2]
type = Explod
trigger1 = !time && prevstateno = [1000,2000]
anim = 11101
pos = 0,75
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -2
bindtime = -1
ownpal = 1
removeongethit = 1

[State 3000,SCancel3]
type = Explod
trigger1 = !time && prevstateno = [1100,2000]
anim = 11102
pos = 0,75
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -3
bindtime = -1
ownpal = 1
removeongethit = 1

[State -1, Cancel Combo]
Type = Poweradd
Trigger1 = !time
Trigger1 = prevstateno = [1000, 2000]
IgnoreHitPause = 1
value = -1000

[State 3000, PALFX]
type = PalFX
Trigger1 = timemod = 2,0
Trigger1 = time <= 15
ignorehitpause = 1
trigger1 = prevstateno = [1000, 2000]
time = 1
add = 255,255,255
sinadd = -100,-100,-100, 2
ignorehitpause = 1

[State 1000, buffer setting1]
Type = varSet
Trigger1 = !Time
Trigger1 = helper(2000),var(1) >= helper(2000), var(2)
Trigger1 = helper(2000),var(1) >= helper(2000), var(3)
var(2) = 0

[State 1000, buffer setting2]
Type = varSet
Trigger1 = !Time
Trigger1 = helper(2000),var(2) >= helper(2000), var(1)
Trigger1 = helper(2000),var(2) >= helper(2000), var(3)
var(2) = 1

[State 1000, buffer setting2]
Type = varSet
Trigger1 = !Time
Trigger1 = helper(2000),var(3) >= helper(2000), var(1)
Trigger1 = helper(2000),var(3) >= helper(2000), var(2)
var(2) = 2

[State 1000, power Set]
Type = varSet
TriggerAll = !Time
Trigger1 = command = "x"
Trigger2 = command = "y"
Trigger3 = command = "z"
var(2) = IfElse((command = "z"||var(9)),2,IfElse(Command = "x",0,1))

[State 1000, Power set]
Type = varSet
Trigger1 = !Time
Trigger1 = var(9)
var(2) = 2

[State 3000, SDM Set]
Type = AssertSpecial
Trigger1 = AnimElem = 2
Flag = NoBG
Flag2 = NoFG
time = 26+16*(PrevStateNo = [1000, 2000])

[State 3000, SDM Set]
Type = EnvColor
Trigger1 = AnimElem = 2
Value = 255*(prevstateno = [1000,1010]),0,0
Under = 1
time = 26+16*(PrevStateNo = [1000, 2000])

[State 1000, Invincible]
type = NotHitBy
Trigger1 = var(1) = 3
Trigger1 = AnimElem = 8, <= -1
value = SCA
IgnoreHitPause = 1

[State 3000, SDM Set]
Type = PowerAdd
Trigger1 = !Time
Trigger1 = !var(15)
value = -1000

[State 3000, SDM Set]
Type = VarSet
Trigger1 = !Time
Trigger1 = var(15)
var(15) = 1

[State 3000, DM Pause]
type = superpause
trigger1 = animelem = 2
time = 26+16*(PrevStateNo = [1000, 2000])
anim = -1
pos = -10,-130
darken = 1
poweradd = 0
movetime = 26
persistent = 0
ontop = 1
p2defmul = 1

[State 3000, DM FX Sound]
type = PlaySnd
Trigger1 = AnimElem = 2
Value = 8000, 0
Channel = 5
IgnoreHitPause = 1

[State 3000, DM FX1]
Type = Explod
trigger1 = animelem = 2
anim = 8100
PosType = p1
Ownpal = 1
SprPriority = -2
BindTime = -1
IgnoreHitPause = 1
Pos = -45+55*(var(1) = 2),-55-30*(var(1) = 2)
RemoveOnGetHit = 1
PauseMoveTime = 99
SuperMoveTime = 99

[State 3000, DM FX 2]
Type = Explod
trigger1 = animelem = 2
anim = 8101
PosType = p1
Ownpal = 1
SprPriority = 2
BindTime = -1
IgnoreHitPause = 1
Pos = -45+55*(var(1) = 2),-55-30*(var(1) = 2)
RemoveOnGetHit = 1
PauseMoveTime = 99
SuperMoveTime = 99

[State 1000, Karate Voice]
type = PlaySnd
Trigger1 = var(1) = 2
Trigger1 = AnimElem = 2
value = 771,0
Channel = 1

[State 1000, Karate Voice]
type = PlaySnd
Trigger1 = var(1) = 1
Trigger1 = AnimElem = 2
value = 3000,0
Channel = 1

[State 1000, Posadds]
type = PosAdd
Trigger1 = AnimElem = 3
x = -20

[State 1000, Posadds]
type = PosAdd
Trigger1 = AnimElem = 4
x = -10

[State 1000, Posadds]
type = PosAdd
Trigger1 = AnimElem = 5
x = -5

[State 1000, 9]
type = VarSet
trigger1 = !Time
var(4) = 0

[State 1000, 9]
type = VarAdd
triggerAll = var(1) != 2
trigger1 = Time = 45
trigger2 = Time = 59
trigger3 = Time = 73
trigger4 = Time = 87
trigger5 = Time = 100
var(4) = 1

[State 1000, 9]
type = VarAdd
triggerAll = var(1) = 2
trigger1 = Time = 60
trigger2 = Time = 73
trigger3 = Time = 86
trigger4 = Time = 99
trigger5 = Time = 110
var(4) = 1

[State 1000, 9]
type = ChangeState
triggerAll = AnimElem = 8, >= -1
triggerAll = var(9)
trigger1 = Time >= 100+10*(var(1) = 2)
trigger2 = prevStateNo = 1450
trigger2 = time >= 55
trigger3 = var(1) = 1
trigger3 = NumTarget(1210)
trigger3 = prevStateNo = 160
trigger3 = Time > 35
trigger4 = p2StateNo = 5120
trigger4 = EnemyNear, AnimTime = [-14,-11]
trigger5 = p2StateType != L
trigger5 = p2StateType != A
trigger6 = p2MoveType = A
trigger7 = p2StateType = A
trigger7 = p2MoveType != H
trigger8 = p2StateNo = 40
trigger9 = p2StateType != A
trigger9 = p2StateType != L
trigger9 = p2MoveType = H
value = 3010

[State 1000, 9]
type = ChangeState
triggerAll = AnimElem = 8, >= -1
triggerAll = !var(9)
trigger1 = Time >= 100+10*(var(1) = 2)
trigger2 = Command != "holdx"
trigger2 = Command != "holdy"
trigger2 = Command != "holdz"
value = 3010

;-----------------------------------
;----- DM Haoh Shikoken launch -----
;-----------------------------------
[Statedef 3010]
Type = S
MoveType = A
Physics = S
Anim = 3020
VelSet = 0
Ctrl = 0
PowerAdd = 0
SprPriority = 1

[State 1000, Karate Voice]
type = PlaySnd
Trigger1 = var(1) = 2
Trigger1 = AnimElem = 2
value = 3000,1
Channel = 1

[State 1000, Hadouken FX sound]
type = PlaySnd
trigger1 = AnimElem = 4
value = 3050,0
Channel = 3

[State 1000, Posadds]
type = PosAdd
Trigger1 = AnimElem = 3
x = 37

[State 1000, 3]
type = Projectile
trigger1 = AnimElem = 4, = 1
attr = S, HP
ownpal = 1
damage = 200+25*var(4),20+3*var(4)
animtype = DiagUp
getpower = 0,0
givepower = 30,15
guardflag = M
hitflag = MA
pausetime = 3,10
sparkno = S8002
guard.sparkno = S8050
sparkxy = 20,-5
hitsound = S5,6+(var(4) > 2)+(var(4) > 4)
guardsound = S6,0
ground.type = High
air.type = low
ground.slidetime = 17
ground.hittime  = 17
guard.slidetime = 17
guard.hittime = 17
air.hittime = 30
guard.ctrltime = 17
ground.velocity = -4.5, -8.5
guard.velocity = -10
air.velocity = -4.5, -7.5
yaccel = .5
juggle = 15
projanim = 3060
projhitanim = 3070
projremanim = 3070
projcancelanim = 3070
velocity = 4+4*var(2)
offset = 65,-75
projid = 3000
projpriority = 9999
Fall = 1
Fall.Recover = 0
ID = 1000
EnvShake.time = 15

[State 1000, 9]
type = ChangeState
trigger1 = !AnimTime
value = 0
ctrl = 1

;-----------------------------------
;------ Kyokugen Kohou (S)DM -------
;-----------------------------------
[Statedef 3100]
Type = S
MoveType = A
Physics = N
Anim = 3100
VelSet = 0
Ctrl = 0
PowerAdd = 0
Juggle = 8

[State 3000,SCancel1]
type = Explod
trigger1 = time = 10 && prevstateno = [1000,2000]
anim = 11100+10*(prevstateno = 1000)
pos = 65,75
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -1
bindtime = -1
ownpal = 1
removeongethit = 1

[State 3000,SCancel2]
type = Explod
trigger1 = !time && prevstateno = [1000,2000]
anim = 11101
pos = 0,75
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -2
bindtime = -1
ownpal = 1
removeongethit = 1

[State 3000,SCancel3]
type = Explod
trigger1 = !time && prevstateno = [1100,2000]
anim = 11102
pos = 0,75
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -3
bindtime = -1
ownpal = 1
removeongethit = 1

[State -1, Cancel Combo]
Type = Poweradd
Trigger1 = !time
Trigger1 = prevstateno = [1000, 2000]
IgnoreHitPause = 1
value = -1000

[State 3000, PALFX]
type = PalFX
Trigger1 = timemod = 2,0
Trigger1 = time <= 15
ignorehitpause = 1
Trigger1 = prevstateno = [1000, 2000]
time = 1
add = 255,255,255
sinadd = -100,-100,-100, 2
ignorehitpause = 1

[State 3000, SDM Set]
Type = AssertSpecial
Trigger1 = AnimElem = 1, = 1
Flag = NoBG
Flag2 = NoFG
time = 26+16*(PrevStateNo = [1000, 2000])

[State 3000, SDM Set]
Type = EnvColor
Trigger1 = AnimElem = 1, = 1
Value = 255*(PrevStateNo = 1000),0,0
Under = 1
time = 26+16*(PrevStateNo = [1000, 2000])

[State 3000, SDM Set]
Type = varSet
Trigger1 = !Time
var(2) = 0

[State 3000, SDM Set]
Type = varSet
TriggerAll = !Time
TriggerAll = Power >= 1000+2000*(!var(15))
Trigger1 = Command = "2kicks"
Trigger2 = helper(2000), var(8)
Trigger3 = var(9)
Trigger3 = p2Life > 300
var(2) = 1

[State 3000, SDM Set]
Type = BgPalFx
Trigger1 = var(2)
InvertAll = 1
Color = 6
Time = 3
IgnoreHitPause = 1

[State 3000, SDM Set]
Type = PowerAdd
Trigger1 = !Time
Trigger1 = !var(15)
value = ifelse(var(2), -2000, -1000)

[State 3000, SDM Set]
Type = VarSet
Trigger1 = !Time
Trigger1 = var(15)
var(15) = 1

[State 1000, Invencible]
type = NotHitBy
Trigger1 = animelem = 12, < 0
value = SCA
IgnoreHitPause = 1

[State 1000, Invencible]
type = Width
Trigger1 = StateType = A
Edge = 15,0

[State 1000, Ken Voice1a]
type = PlaySnd
Trigger1 = AnimElem = 1, = 1
value = 3100,0
Channel = 1

[State 3000, Move Sound]
type = PlaySnd
Trigger1 = AnimElem = 12
Value = 50,2
Channel = 3
IgnoreHitPause = 1

[State 3000, Move Sound]
type = PlaySnd
Trigger1 = AnimElem = 12
Value = 3100,1
Channel = 1
IgnoreHitPause = 1


[State 3000, DM Pause]
type = superpause
trigger1 = animelem = 1, = 1
time = 26+16*(PrevStateNo = [1000, 2000])
anim = -1
pos = 25,-90
darken = 1
poweradd = -1000*var(2)
movetime = 26
persistent = 0
ontop = 1
p2defmul = 1

[State 3000, DM FX Sound]
type = PlaySnd
Trigger1 = AnimElem = 1, = 1
Value = 8000, var(2)
Channel = 5
IgnoreHitPause = 1

[State 3000, DM FX1]
Type = Explod
trigger1 = animelem = 1, = 1
anim = 8100+10*var(2)
PosType = p1
Ownpal = 1
SprPriority = -2
BindTime = -1
IgnoreHitPause = 1
pos = 25,-90
RemoveOnGetHit = 1
PauseMoveTime = 99
SuperMoveTime = 99

[State 3000, DM FX 2]
Type = Explod
trigger1 = animelem = 1, = 1
anim = 8101+10*var(2)
PosType = p1
Ownpal = 1
SprPriority = 2
BindTime = -1
IgnoreHitPause = 1
pos = 25,-90
RemoveOnGetHit = 1
PauseMoveTime = 99
SuperMoveTime = 99

[State 3000, Flames]
Type = Explod
Trigger1 = AnimElem = 12
Anim = 3150+var(2)
PosType = p1
Ownpal = 1
SprPriority = 2
BindTime = -1
IgnoreHitPause = 0
Pos = 0,0
RemoveOnGetHit = 1

[State 3000, Flames]
Type = Explod
Trigger1 = AnimElem = 12
Trigger1 = var(2)
Anim = 3152
PosType = p1
Ownpal = 1
SprPriority = 3
BindTime = -1
IgnoreHitPause = 0
Pos = 0,0
RemoveOnGetHit = 1

[State 3100, First Hits]
Type = HitDef
Trigger1 = AnimElem = 9
attr = S, HA
damage    = 100+10*var(2), 10+var(2)
animtype = Heavy
getpower = 0,0
givepower = 30,15
guardflag = M
hitflag = MA
pausetime = 18+8*var(2),18+8*var(2)
sparkno = S8002
guard.sparkno = S8012
sparkxy = -15,-65
hitsound = S5,4+2*var(2)
guardsound = S6,0
ground.type = low
ground.slidetime = 17
ground.hittime  = 22
air.hittime = 30
guard.slidetime = 17
guard.hittime = 17
guard.ctrltime = 17
guard.velocity = 0
ground.velocity = 0
ground.cornerpush.veloff = 0;0
guard.cornerpush.veloff = 0;-11.3
air.velocity = -1.5,-7.5
yAccel = .5
Air.Fall = 1
Fall.Recover = 0
EnvShake.Time = 16+8*var(2)

[State 3100, First Hits]
Type = HitDef
Trigger1 = AnimElem = 11
attr = S, HA
damage    = 100+10*var(2), 10+var(2)
animtype = Heavy
air.animtype = Up
getpower = 0,0
givepower = 30,15
guardflag = M
hitflag = MA
pausetime = 18+8*var(2),18+8*var(2)
sparkno = S8002
guard.sparkno = S8012
sparkxy = -15,-80
hitsound = S5,4+2*var(2)
guardsound = S6,0
ground.type = High
ground.slidetime = 17
ground.hittime  = 22
air.hittime = 30
guard.slidetime = 17
guard.hittime = 17
guard.ctrltime = 17
guard.velocity = 0
ground.velocity = 0
ground.cornerpush.veloff = 0;0
guard.cornerpush.veloff = 0;-11.3
air.velocity = -1.5,-7.5
yAccel = .5
Air.Fall = 1
Fall.Recover = 0
EnvShake.Time = 16+8*var(2)

[State 1100, change to air]
Type = StateTypeSet
Trigger1 = AnimElem = 12
StateType = A
Physics = N

[State 1100, Air Velocity]
Type = VelSet
Trigger1 = AnimElem = 12
x = 5
y = -12-3*var(2)

[State 1100, Air Velocity]
Type = VelMul
Trigger1 = AnimElem = 12, > 0
x = .98

[State 1100, Final Hits2]
Type = HitDef
Trigger1 = AnimElem = 12
Trigger2 = AnimElem = 13
Trigger3 = AnimElem = 13, = 2
Trigger4 = AnimElem = 13, = 4
Trigger5 = var(2)
Trigger5 = AnimElem = 13, = 6
Trigger6 = var(2)
Trigger6 = AnimElem = 13, = 8
Trigger7 = var(2)
Trigger7 = AnimElem = 13, = 10
attr = A, HA
damage = 20+10*var(2),2+var(2)
Priority = 4, miss
animtype = Heavy
getpower = 0,0
givepower = 3,1
guardflag = M
hitflag = MA
pausetime = 3,2
guard.pausetime = 3,2
sparkno = S8000
guard.sparkno = S8012
sparkxy = -15-floor(random/70),-75-floor(random/15)
hitsound = S5,4
guardsound = S6,0
ground.type = low
ground.slidetime = 17
ground.hittime  = 17
air.hittime = 55
guard.slidetime = 17
guard.hittime = 17
guard.ctrltime = 17
guard.velocity = -9.3
ground.velocity = 0, -10.5
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.velocity = 0,-9.5
yAccel = .6
Fall = 1
Fall.Recover = 0
EnvShake.Time = 3

[State 1100, Final Hits4]
Type = HitDef
Trigger1 = !var(2)
Trigger1 = AnimElem = 13, = 6
Trigger2 = var(2)
Trigger2 = AnimElem = 13, = 12
attr = A, HA
damage = 20, 2
animtype = Up
getpower = 0,0
givepower = 30,15
guardflag = M
hitflag = MA
pausetime = 2,2
guard.pausetime = 2,2
sparkno = S8002
guard.sparkno = S8012
sparkxy = -15,-105
hitsound = S5,4+3*var(2)
guardsound = S6,0
ground.type = low
ground.slidetime = 17
ground.hittime  = 17
air.hittime = 55
guard.slidetime = 17
guard.hittime = 17
guard.ctrltime = 17
guard.velocity = -9.3
ground.velocity = -2.5, -8.5
ground.cornerpush.veloff = 0;0
guard.cornerpush.veloff = 0;-11.3
air.velocity = -2.5,-8
yAccel = .5
Fall = 1
Fall.Recover = 0
EnvShake.Time = 3+10*var(2)

[State 3020, 2]
Type = VarSet
TriggerAll = Movehit
Trigger1 = AnimElem = 13, < 6
Trigger1 = !var(2)
Trigger2 = AnimElem = 13, < 12
Trigger2 = var(2)
var(7) = 1
IgnorehitPause = 1

[State -1, Mr Karate DC]
type = Changestate
TriggerAll = MoveContact
TriggerAll = animelem = 12, < 0
TriggerAll = power >= 3000
TriggerAll = Life <= LifeMax/4
TriggerAll = !var(2)
Trigger1 = Command ="Haoh Shikoken"
Trigger1 = Command ="2punches"
Value = 4200

[State 3020, 2]
Type = EnvColor
Trigger1 = Movehit
Trigger1 = AnimElem = 9, > 0
Time = 3
Value = 255,255,255
Under = 1
IgnoreHitPause = 1
persistent = 0

[State 3020, 2]
Type = EnvColor
Trigger1 = Movehit
Trigger1 = AnimElem = 11, > 0
Time = 3
Value = 255,255,255
Under = 1
IgnoreHitPause = 1
persistent = 0

[State 3020, 2]
Type = MovehitReset
Trigger1 = Movecontact

[State 1100, Gravity]
Type = Gravity
Trigger1 = Vel y < 0

[State 1000, 9]
type = ChangeState
Trigger1 = Vel y > -1.5
Trigger1 = AnimElem = 12, > 0
value = 1101

;-----------------------------------
;-------- Kyokugen Kohou DM --------
;-----------------------------------
[Statedef 3150]
Type = S
MoveType = A
Physics = N
Anim = 3100
VelSet = 0
Ctrl = 0
PowerAdd = 0
Juggle = 8

[State 3000,SCancel1]
type = Explod
triggerAll = time = 10
Trigger1 = prevstateno = [1000,2000]
Trigger2 = prevstateno = [200,730]
anim = 11100+10*(prevstateno = 1000)
pos = 65,75
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -1
bindtime = -1
ownpal = 1
removeongethit = 1

[State 3000,SCancel2]
type = Explod
triggerAll = !time
Trigger1 = prevstateno = [1000,2000]
Trigger2 = prevstateno = [200,730]
anim = 11101
pos = 0,75
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -2
bindtime = -1
ownpal = 1
removeongethit = 1

[State 3000,SCancel3]
type = Explod
triggerAll = !time
Trigger1 = prevstateno = [1100,2000]
Trigger2 = prevstateno = [200,730]
anim = 11102
pos = 0,75
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -3
bindtime = -1
ownpal = 1
removeongethit = 1

[State -1, Cancel Combo]
Type = Poweradd
triggerAll = !time
Trigger1 = prevstateno = [1000,2000]
Trigger2 = prevstateno = [200,730]
IgnoreHitPause = 1
value = -1000

[State 3000, PALFX]
type = PalFX
TriggerAll = gametime%2 = 0
TriggerAll = time <= 15
Trigger1 = prevstateno = [1000,2000]
Trigger2 = prevstateno = [200,730]
ignorehitpause = 1
time = 1
add = 255,255,255
sinadd = -100,-100,-100, 2
ignorehitpause = 1

[State 3000, SDM Set]
Type = AssertSpecial
Trigger1 = AnimElem = 1, = 1
Flag = NoBG
Flag2 = NoFG
time = 26+16*((PrevStateNo = [1000, 2000]) || (prevStateNo = [200,730]))

[State 3000, SDM Set]
Type = EnvColor
Trigger1 = AnimElem = 1, = 1
Value = 255*(PrevStateNo = 1000),0,0
Under = 1
time = 26+16*((PrevStateNo = [1000, 2000]) || (prevStateNo = [200,730]))

[State 3000, SDM Set]
Type = varSet
Trigger1 = !Time
var(2) = 0

[State 3000, SDM Set]
Type = PowerAdd
Trigger1 = !Time
Trigger1 = !var(15)
value = -1000

[State 3000, SDM Set]
Type = VarSet
Trigger1 = !Time
Trigger1 = var(15)
var(15) = 1

[State 1000, Invencible]
type = NotHitBy
Trigger1 = animelem = 12, < 0
value = SCA
IgnoreHitPause = 1

[State 1000, Invencible]
type = Width
Trigger1 = StateType = A
Edge = 15,0

[State 1000, Takuma Voice]
type = PlaySnd
Trigger1 = AnimElem = 1, = 1
value = 3100,2
Channel = 1

[State 3000, Move Sound]
type = PlaySnd
Trigger1 = AnimElem = 12
Value = 50,2
Channel = 3
IgnoreHitPause = 1

[State 3000, Move Sound]
type = PlaySnd
Trigger1 = AnimElem = 12
Value = 3100,3
Channel = 1
IgnoreHitPause = 1


[State 3000, DM Pause]
type = superpause
trigger1 = animelem = 1, = 1
time = 26+16*((PrevStateNo = [1000, 2000]) || (prevStateNo = [200,730]))
anim = -1
pos = 25,-90
darken = 1
poweradd = 0
movetime = 26
persistent = 0
ontop = 1
p2defmul = 1

[State 3000, DM FX Sound]
type = PlaySnd
Trigger1 = AnimElem = 1, = 1
Value = 8000, 0
Channel = 5
IgnoreHitPause = 1

[State 3000, DM FX1]
Type = Explod
trigger1 = animelem = 1, = 1
anim = 8100
PosType = p1
Ownpal = 1
SprPriority = -2
BindTime = -1
IgnoreHitPause = 1
pos = 25,-90
RemoveOnGetHit = 1
PauseMoveTime = 99
SuperMoveTime = 99

[State 3000, DM FX 2]
Type = Explod
trigger1 = animelem = 1, = 1
anim = 8101
PosType = p1
Ownpal = 1
SprPriority = 2
BindTime = -1
IgnoreHitPause = 1
pos = 25,-90
RemoveOnGetHit = 1
PauseMoveTime = 99
SuperMoveTime = 99

[State 3000, Flames]
Type = Explod
Trigger1 = AnimElem = 12
Anim = 3151
PosType = p1
Ownpal = 1
SprPriority = 2
BindTime = -1
IgnoreHitPause = 0
Pos = 0,0
RemoveOnGetHit = 1

[State 3000, Flames]
Type = Explod
Trigger1 = AnimElem = 12
Anim = 3152
PosType = p1
Ownpal = 1
SprPriority = 3
BindTime = -1
IgnoreHitPause = 0
Pos = 0,0
RemoveOnGetHit = 1

[State 3100, First Hits]
Type = HitDef
Trigger1 = AnimElem = 9
attr = S, HA
damage = 100, 10
animtype = Heavy
getpower = 0,0
givepower = 30,15
guardflag = M
hitflag = MA
pausetime = 26,26
sparkno = S8002
guard.sparkno = S8012
sparkxy = -15,-65
hitsound = S5,8
guardsound = S6,0
ground.type = low
ground.slidetime = 17
ground.hittime  = 17
air.hittime = 30
guard.slidetime = 17
guard.hittime = 17
guard.ctrltime = 17
guard.velocity = 0
ground.velocity = 0
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.velocity = 0,-11.5
yAccel = .5
Air.Fall = 1
Fall.Recover = 0
EnvShake.Time = 16+8*var(2)

[State 3100, First Hits]
Type = HitDef
Trigger1 = AnimElem = 11
attr = S, HA
damage = 100, 10
animtype = Heavy
air.animtype = Up
getpower = 0,0
givepower = 30,15
guardflag = M
hitflag = MA
pausetime = 26,26
sparkno = S8002
guard.sparkno = S8012
sparkxy = -15,-80
hitsound = S5,8
guardsound = S6,0
ground.type = High
ground.slidetime = 17
ground.hittime  = 17
air.hittime = 30
guard.slidetime = 17
guard.hittime = 17
guard.ctrltime = 17
guard.velocity = 0
ground.velocity = 0
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.velocity = 0,-11.5
yAccel = .5
Air.Fall = 1
Fall.Recover = 0
EnvShake.Time = 16+8*var(2)

[State 1100, change to air]
Type = StateTypeSet
Trigger1 = AnimElem = 12
StateType = A
Physics = N

[State 1100, Air Velocity]
Type = VelSet
Trigger1 = AnimElem = 12
x = 5
y = -15

[State 1100, Air Velocity]
Type = VelMul
Trigger1 = AnimElem = 12, > 0
x = .98

[State 1100, Final Hits2]
Type = HitDef
Trigger1 = AnimElem = 12
Trigger2 = AnimElem = 13
Trigger3 = AnimElem = 13, = 2
Trigger4 = AnimElem = 13, = 4
Trigger5 = AnimElem = 13, = 6
Trigger6 = AnimElem = 13, = 8
Trigger7 = AnimElem = 13, = 10
attr = A, HA
damage = 15,2
Priority = 4, miss
animtype = Heavy
getpower = 0,0
givepower = 3,1
guardflag = M
hitflag = MA
pausetime = 3,2
guard.pausetime = 3,2
sparkno = S8000
guard.sparkno = S8012
sparkxy = -15-floor(random/70),-75-floor(random/30)
hitsound = S5,4
guardsound = S6,0
ground.type = low
ground.slidetime = 20
ground.hittime  = 20
air.hittime = 55
guard.slidetime = 17
guard.hittime = 17
guard.ctrltime = 17
guard.velocity = -9.3
ground.velocity = 0, -10.5
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.velocity = 0,-9.5
yAccel = .6
Fall = 1
Fall.Recover = 0
EnvShake.Time = 3

[State 1100, Final Hits4]
Type = HitDef
Trigger1 = AnimElem = 13, = 12
attr = A, HA
damage = 15, 2
animtype = Up
getpower = 0,0
givepower = 30,15
guardflag = M
hitflag = MA
pausetime = 2,2
guard.pausetime = 2,2
sparkno = S8002
guard.sparkno = S8012
sparkxy = -15,-105
hitsound = S5,7
guardsound = S6,0
ground.type = low
ground.slidetime = 20
ground.hittime  = 20
air.hittime = 55
guard.slidetime = 17
guard.hittime = 17
guard.ctrltime = 17
guard.velocity = -9.3
ground.velocity = -2.5, -8.5
ground.cornerpush.veloff = 0;0
guard.cornerpush.veloff = 0;-11.3
air.velocity = -2.5,-8
yAccel = .5
Fall = 1
Fall.Recover = 0
EnvShake.Time = 13

[State 3020, 2]
Type = EnvColor
Trigger1 = Movehit
Trigger1 = AnimElem = 9, > 0
Trigger1 = AnimElem = 10, <= 0
Time = 3
Value = 255,255,255
Under = 1
IgnoreHitPause = 1
Persistent = 0

[State 3020, 2]
Type = EnvColor
Trigger1 = Movehit
Trigger1 = AnimElem = 11, > 0
Trigger1 = AnimElem = 12, <= 0
Time = 3
Value = 255,255,255
Under = 1
IgnoreHitPause = 1
Persistent = 0

[State 3020, 2]
Type = EnvColor
Trigger1 = Movehit
Trigger1 = AnimElem = 12, > 0
Time = 3
Value = 255,255,255
Under = 1

[State 3020, 2]
Type = VarSet
TriggerAll = Movehit
Trigger1 = AnimElem = 13, < 12
var(7) = 1
IgnorehitPause = 1

[State -1, Serious DC]
type = Changestate
TriggerAll = MoveContact
TriggerAll = AnimElem = 12, < 0
TriggerAll = power >= 3000
TriggerAll = Life <= LifeMax/4
Trigger1 = Command ="Ryuko Rambu"
Trigger1 = Command ="2punches"
Value = 4300

[State 3020, 2]
Type = MovehitReset
Trigger1 = Movecontact

[State 1100, Gravity]
Type = Gravity
Trigger1 = Vel y < 0

[State 1000, 9]
type = ChangeState
Trigger1 = Vel y > -1.5
Trigger1 = AnimElem = 12, > 0
value = 1101

;-----------------------------------
;------ Kishin Geki Startup --------
;-----------------------------------
[Statedef 3200]
Type = S
MoveType = A
Physics = N
Anim = 3200
VelSet = 0
Ctrl = 0
PowerAdd = 0
Juggle = 8

[State 3000,SCancel1]
type = Explod
trigger1 = time = 10 && prevstateno = [1000,2000]
anim = 11100+10*(prevstateno = 1000)
pos = 65,75
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -1
bindtime = -1
ownpal = 1
removeongethit = 1

[State 3000,SCancel2]
type = Explod
trigger1 = !time && prevstateno = [1000,2000]
anim = 11101
pos = 0,75
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -2
bindtime = -1
ownpal = 1
removeongethit = 1

[State 3000,SCancel3]
type = Explod
trigger1 = !time && prevstateno = [1100,2000]
anim = 11102
pos = 0,75
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -3
bindtime = -1
ownpal = 1
removeongethit = 1

[State -1, Cancel Combo]
Type = Poweradd
Trigger1 = !time
Trigger1 = prevstateno = [1000, 2000]
IgnoreHitPause = 1
value = -1000

[State 3000, PALFX]
type = PalFX
Trigger1 = gametime%2 = 0
Trigger1 = time <= 15
ignorehitpause = 1
Trigger1 = prevstateno = [1000, 2000]
time = 1
add = 255,255,255
sinadd = -100,-100,-100, 2
ignorehitpause = 1

[State 3000, SDM Set]
Type = AssertSpecial
Trigger1 = AnimElem = 1, = 1
Flag = NoBG
Flag2 = NoFG
time = 26+16*(PrevStateNo = [1000, 2000])

[State 3000, SDM Set]
Type = EnvColor
Trigger1 = AnimElem = 1, = 1
Value = 255*(PrevStateNo = 1000),0,0
Under = 1
time = 26+16*(PrevStateNo = [1000, 2000])

[State 3000, SDM Set]
Type = varSet
Trigger1 = !Time
var(2) = 0

[State 3000, SDM Set]
Type = varSet
TriggerAll = !Time
TriggerAll = Power >= 1000+2000*(!var(15))
TriggerAll = var(1)
Trigger1 = Command = "2punches"
Trigger2 = helper(2000), var(7)
Trigger3 = var(9)
Trigger3 = p2Life > 300
Trigger3 = !(life < LifeMax/4 && power >= 3000+1000*(!var(15)))
var(2) = 1

[State 3000, After]
type = AfterImage
trigger1 = time = 27
time = 2
palmul = .65,.65,.75
palbright = 30,30,30
palcontrast = 120,120,220
timegap = 1
framegap = 5
Trans = add1
color = 6

[State 3020, After Set]
type = AfterImagetime
trigger1 = time > 27
time = 2
ignorehitpause=1

[State 3000, SDM Set]
Type = BgPalFx
Trigger1 = var(2)
InvertAll = 1
Color = 6
Time = 3
IgnoreHitPause = 1

[State 3000, SDM Set]
Type = PowerAdd
Trigger1 = !Time
Trigger1 = !var(15)
value = ifelse(var(2), -2000, -1000)

[State 3000, SDM Set]
Type = VarSet
Trigger1 = !Time
Trigger1 = var(15)
var(15) = 1

[State 3000, invincible]
type = NotHitBy
Trigger1 = var(1) = 1
Trigger1 = AnimElem = 7, < 0
Value = SCA
IgnoreHitPause = 1

[State 800, 1]
type = HitDef
Triggerall = p2dist x < 75
Triggerall = !var(1)
Trigger1 = PrevStateNo != [200,2000]
Trigger1 = !var(6)
Trigger1 = !Time
attr = S, HT
hitflag = M-
fall.animtype = heavy
ground.type = High
ground.hittime = 17
priority = 5, Miss
sparkno = -1
HitSound = -1
sprpriority = 1
p1facing = 1
p2facing = 1
p2stateno = 6200
NumHits = 0
ID = 3200
kill = 0
Snap = 50, 0

[State 800, 1]
type = HitDef
Triggerall = p2dist x < 75
Triggerall = !var(1)
Trigger1 = PrevStateNo = [200,2000]
Trigger1 = !var(19)
Trigger1 = !Time
attr = S, HT
hitflag = M
fall.animtype = heavy
priority = 1, Miss
ground.type = High
ground.hittime = 17
sparkno = -1
sparkxy = -30,-70
HitSound = -1
sprpriority = 1
p1facing = 1
p2facing = 1
p2stateno = 6200
NumHits = 0
ID = 3200
kill = 0
Snap = 50, 0

[State 1000, Invencible]
type = Width
Trigger1 = 1
Edge = 15,0

[State 1000, Takuma voice]
type = PlaySnd
Trigger1 = AnimElem = 1, = 1
value = 3200,0
Channel = 1

[State 3000, Move Sound]
type = PlaySnd
Trigger1 = AnimElem = 6
Trigger2 = AnimElem = 13
Value = 1,2
Channel = 3
IgnoreHitPause = 1

[State 3000, DM Pause]
type = superpause
trigger1 = animelem = 1, = 1
time = 26+16*(PrevStateNo = [1000, 2000])
anim = -1
pos = 30,-55
darken = 1
poweradd = -1000*var(2)
movetime = 26
persistent = 0
ontop = 1
p2defmul = 1

[State 3000, DM FX Sound]
type = PlaySnd
Trigger1 = AnimElem = 1, = 1
Value = 8000, var(2)
Channel = 5
IgnoreHitPause = 1

[State 3000, DM FX1]
Type = Explod
trigger1 = animelem = 1, = 1
anim = 8100+10*var(2)
PosType = p1
Ownpal = 1
SprPriority = -2
BindTime = -1
IgnoreHitPause = 1
pos = 30,-55
RemoveOnGetHit = 1
PauseMoveTime = 99
SuperMoveTime = 99

[State 3000, DM FX 2]
Type = Explod
trigger1 = animelem = 1, = 1
anim = 8101+10*var(2)
PosType = p1
Ownpal = 1
SprPriority = 2
BindTime = -1
IgnoreHitPause = 1
pos = 30,-55
RemoveOnGetHit = 1
PauseMoveTime = 99
SuperMoveTime = 99

[State 3000, DM FX 2]
Type = ChangeState
trigger1 = animelem = 5
trigger1 = !var(1)
trigger1 = !numtarget(3200)
value = 3210

[State 3100, First Hits]
Type = HitDef
Trigger1 = AnimElem = 7
attr = S, HA
damage = 120,12
animtype = Heavy
getpower = 0,0
givepower = 30,15
guardflag =
hitflag = MA
pausetime = 25,25
sparkno = S8002
guard.sparkno = S8012
sparkxy = -15,-80
hitsound = S5,6
guardsound = S6,0
ground.type = High
ground.slidetime = 17
ground.hittime  = 20
air.hittime = 30
guard.slidetime = 17
guard.hittime = 17
guard.ctrltime = 17
guard.velocity = -9.3
ground.velocity = 0
ground.cornerpush.veloff = 0;0
guard.cornerpush.veloff = 0;-11.3
air.velocity = -5,-5.5
yAccel = .5
Air.Fall = 1
Fall.Recover = 0
EnvShake.Time = 25
EnvShake.Ampl = -5

[State 3100, First Hits]
Type = HitDef
Trigger1 = AnimElem = 14
attr = S, HA
damage = 100,10
animtype = Heavy
getpower = 0,0
givepower = 30,15
guardflag = M
hitflag = MA
pausetime = 25,25
guard.pausetime = 12,12
sparkno = S8002
guard.sparkno = S8012
sparkxy = -15,-65
hitsound = S5,6
guardsound = S6,0
ground.type = low
ground.slidetime = 17
ground.hittime  = 20
air.hittime = 30
guard.slidetime = 17
guard.hittime = 17
guard.ctrltime = 17
guard.velocity = -9.3
ground.velocity = 0
ground.cornerpush.veloff = 0;0
guard.cornerpush.veloff = 0;-11.3
air.velocity = -5,-5.5
yAccel = .5
Air.Fall = 1
Fall.Recover = 0
EnvShake.Time = 25
EnvShake.Ampl = -5
ID = 3201

[State 3020, 2]
Type = EnvColor
Trigger1 = Movehit
Trigger1 = AnimElem = 7, > 0
Time = 3
Value = 255,255,255
Under = 1
IgnoreHitPause = 1
Persistent = 0

[State 3020, 2]
Type = EnvColor
Trigger1 = Movehit
Trigger1 = AnimElem = 14, > 0
Time = 3
Value = 255,255,255
Under = 1
IgnoreHitPause = 1
Persistent = 0

[State 301, Escape Enemy]
type = targetstate
Trigger1 = MoveGuarded
trigger1 = numtarget(3201)
trigger1 = Target, alive
trigger1 = Target, stateno != 1610
Value = 1610
ignorehitpause = 1
persistent = 0

[State -1, Normal Takuma DC]
type = Changestate
TriggerAll = !var(1)
TriggerAll = MoveContact
TriggerAll = AnimElem = 7, > 0
TriggerAll = power >= 3000
TriggerAll = Life <= LifeMax/4
TriggerAll = !var(2)
Trigger1 = Command ="Kosatsu Jin"
Trigger1 = !var(9)
Trigger2 = AnimElem = 14, > 0
Trigger2 = AnimElem = 15, < 0
Trigger2 = p2life > 200
Trigger2 = var(9) > 2
Value = 4000

[State -1, Normal Takuma DC]
type = Changestate
TriggerAll = var(1) = 1
TriggerAll = MoveContact
TriggerAll = AnimElem = 7, > 0
TriggerAll = power >= 3000
TriggerAll = Life <= LifeMax/4
TriggerAll = !var(2)
Trigger1 = Command ="Haoh Shikoken"
Trigger1 = Command ="2punches"
Trigger1 = !var(9)
Value = 4200

[State 3020, 2]
Type = MovehitReset
Trigger1 = Movecontact

[State 1000, 9]
type = ChangeState
Trigger1 = !AnimTime
value = 3201+var(2)

;-----------------------------------
;----- Kishin Geki DM Finisher -----
;-----------------------------------
[Statedef 3201]
Type = S
MoveType = A
Physics = N
Anim = 3201
VelSet = 0
Ctrl = 0
PowerAdd = 0
Juggle = 8

[State 3020, After Set]
type = AfterImagetime
trigger1 = 1
time = 2
ignorehitpause=1

[State 1000, Invencible]
type = Width
Trigger1 = 1
Edge = 15,0

[State 3000, Move Sound]
type = PlaySnd
Trigger1 = AnimElem = 5
Value = 1,2
Channel = 3
IgnoreHitPause = 1

[State 3000, POsadds]
type = PosAdd
Trigger1 = AnimElem = 2
Trigger2 = AnimElem = 3
Trigger3 = AnimElem = 8
x = 20

[State 3000, POsadds]
type = PosAdd
Trigger1 = AnimElem = 4
x = 10

[State 3000, POsadds]
type = PosAdd
Trigger1 = AnimElem = 6
x = 15

[State 3000, POsadds]
type = PosAdd
Trigger1 = AnimElem = 9
x = 56

[State 3100, First Hits]
Type = HitDef
Trigger1 = AnimElem = 6
attr = S, HA
damage = 100,10
animtype = Diagup
getpower = 0,0
givepower = 30,15
guardflag =
hitflag = MA
pausetime = 25,25
sparkno = S8002
guard.sparkno = S8012
sparkxy = -15,-70
hitsound = S5,8
guardsound = S6,0
ground.type = High
ground.slidetime = 17
ground.hittime  = 20
air.hittime = 30
guard.slidetime = 17
guard.hittime = 17
guard.ctrltime = 17
guard.velocity = -9.3
ground.velocity = -5, -6.5
ground.cornerpush.veloff = 0;0
guard.cornerpush.veloff = 0;-11.3
air.velocity = -5,-5.5
yAccel = .5
Fall = 1
Fall.Recover = 0
EnvShake.Time = 25
EnvShake.Ampl = -5
ID = 3201

[State 301, Escape Enemy]
type = targetstate
Trigger1 = MoveGuarded
trigger1 = numtarget(3201)
trigger1 = Target, alive
trigger1 = Target, stateno != 1610
Value = 1610
ignorehitpause = 1

[State 3020, 2]
Type = EnvColor
Trigger1 = Movehit
Time = 3
Value = 255,255,255
Under = 1
IgnoreHitPause = 1
Persistent = 0

[State -1, Normal Takuma DC]
type = Changestate
TriggerAll = var(1) = 1
TriggerAll = MoveContact
TriggerAll = power >= 3000
TriggerAll = Life <= LifeMax/4
TriggerAll = !var(2)
Trigger1 = Command ="Haoh Shikoken"
Trigger1 = Command ="2punches"
Trigger1 = !var(9)
Trigger2 = var(9) > 2
Value = 4200

[State 3020, 2]
Type = MovehitReset
Trigger1 = Movecontact

[State 1000, 9]
type = ChangeState
Trigger1 = !AnimTime
value = 0
Ctrl = 1

;-----------------------------------
;---- Kishin Geki SDM Finisher -----
;-----------------------------------
[Statedef 3202]
Type = S
MoveType = A
Physics = N
Anim = 3202
VelSet = 0
Ctrl = 0
PowerAdd = 0
Juggle = 8

[State 3020, After Set]
type = AfterImagetime
trigger1 = 1
time = 2
ignorehitpause=1

[State 3000, SDM Set]
Type = BgPalFx
Trigger1 = var(2)
InvertAll = 1
Color = 6
Time = 3
IgnoreHitPause = 1

[State 1000, Invencible]
type = Width
Trigger1 = 1
Edge = 15,0

[State 3000, Move Sound]
type = PlaySnd
Trigger1 = AnimElem = 4
Trigger2 = AnimElem = 12
Trigger3 = AnimElem = 21
Value = 1,2
Channel = 3
IgnoreHitPause = 1

[State 3000, Takuma Voice]
type = PlaySnd
Trigger1 = AnimElem = 28
Value = 3200,1
Channel = 1

[State 3000, POsadds]
type = PosAdd
Trigger1 = AnimElem = 5
Trigger2 = AnimElem = 17
Trigger3 = AnimElem = 23
x = 7

[State 3000, POsadds]
type = PosAdd
Trigger1 = AnimElem = 20
x = 3

[State 3000, POsadds]
type = PosAdd
Trigger1 = AnimElem = 22
x = 15

[State 3000, POsadds]
type = PosAdd
Trigger1 = AnimElem = 37
x = -3

[State 3100, First Hits]
Type = HitDef
Trigger1 = AnimElem = 5
attr = S, HA
damage = 50,5
animtype = Heavy
getpower = 0,0
givepower = 30,15
guardflag = M
hitflag = MA
pausetime = 25,25
sparkno = S8002
guard.sparkno = S8012
sparkxy = -15,-75
hitsound = S5,6
guardsound = S6,0
ground.type = High
ground.slidetime = 17
ground.hittime  = 20
air.hittime = 30
guard.slidetime = 17
guard.hittime = 17
guard.ctrltime = 17
guard.velocity = -9.3
ground.velocity = 0
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.velocity = -5,-5.5
yAccel = .5
Air.Fall = 1
Fall.Recover = 0
EnvShake.Time = 25
EnvShake.Ampl = -5
ID = 3201

[State 3020, 2]
Type = EnvColor
Trigger1 = Movehit
Trigger1 = AnimElem = 5, > 0
Time = 3
Value = 255,255,255
Under = 1
IgnoreHitPause = 1
Persistent = 0

[State 3100, First Hits]
Type = HitDef
Trigger1 = AnimElem = 14
attr = S, HA
damage = 95,9
animtype = Heavy
getpower = 0,0
givepower = 30,15
guardflag = M
hitflag = MA
pausetime = 25,25
sparkno = S8002
guard.sparkno = S8012
sparkxy = -15,-50
hitsound = S5,8
guardsound = S6,0
ground.type = Low
ground.slidetime = 17
ground.hittime  = 20
air.hittime = 30
guard.slidetime = 17
guard.hittime = 17
guard.ctrltime = 17
guard.velocity = -9.3
ground.velocity = 0
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.velocity = -5,-5.5
yAccel = .5
Air.Fall = 1
Fall.Recover = 0
EnvShake.Time = 25
EnvShake.Ampl = -5
ID = 3201

[State 3020, 2]
Type = EnvColor
Trigger1 = Movehit
Trigger1 = AnimElem = 14, > 0
Time = 3
Value = 255,255,255
Under = 1
IgnoreHitPause = 1
Persistent = 0

[State 3100, First Hits]
Type = HitDef
Trigger1 = AnimElem = 22
attr = S, HA
damage = 100,10
animtype = Heavy
getpower = 0,0
givepower = 30,15
guardflag = M
hitflag = MA
pausetime = 30,30
sparkno = S8002
guard.sparkno = S8012
sparkxy = -15,-85
hitsound = S5,8
guardsound = S6,0
ground.type = High
ground.slidetime = 17
ground.hittime  = 20
air.hittime = 30
guard.slidetime = 17
guard.hittime = 17
guard.ctrltime = 17
guard.velocity = -9.3
ground.velocity = 0
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.velocity = -5,-5.5
yAccel = .5
Air.Fall = 1
Fall.Recover = 0
EnvShake.Time = 25
EnvShake.Ampl = -5
ID = 3201

[State 3020, 2]
Type = EnvColor
Trigger1 = Movehit
Trigger1 = AnimElem = 22, > 0
Time = 3
Value = 255,255,255
Under = 1
IgnoreHitPause = 1
Persistent = 0

[State 3100, First Hits]
Type = HitDef
Trigger1 = AnimElem = 23
attr = S, HA
damage = 50,5
animtype = Heavy
getpower = 0,0
givepower = 30,15
guardflag = M
hitflag = MA
pausetime = 25,25
priority = 4, miss
sparkno = S8002
guard.sparkno = S8012
sparkxy = -15,-85
hitsound = S5,8
guardsound = S6,0
ground.type = High
ground.slidetime = 17
ground.hittime  = 20
air.hittime = 30
guard.slidetime = 17
guard.hittime = 17
guard.ctrltime = 17
guard.velocity = -9.3
ground.velocity = -5, -6.5
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.velocity = -5,-5.5
yAccel = .5
Air.Fall = 1
Fall.Recover = 0
EnvShake.Time = 25
EnvShake.Ampl = -5
p2StateNo = 3250
p2facing = 1
ID = 3201

[State 3020, 2]
Type = EnvColor
Trigger1 = Movehit
Trigger1 = AnimElem = 23, > 0
Time = 3
Value = 255,255,255
Under = 1
IgnoreHitPause = 1
Persistent = 0

[State 301, Escape Enemy]
type = targetstate
Trigger1 = MoveGuarded
trigger1 = numtarget(3201)
trigger1 = Target, alive
trigger1 = Target, stateno != 1610
Value = 1610
ignorehitpause = 1

[State 3020, 2]
Type = MovehitReset
Trigger1 = Movecontact

[State 1000, 9]
type = ChangeState
Trigger1 = !AnimTime
value = 0
Ctrl = 1

;-----------------------------------
;-------- Kishin Geki Miss ---------
;-----------------------------------
[Statedef 3210]
Type = S
MoveType = I
Physics = N
Anim = 3210
Ctrl = 0
PowerAdd = 0
VelSet = 0,0

[State 1000, 9]
type = ChangeState
Trigger1 = !AnimTime
value = 0
Ctrl = 1

;-----------------------------------
;------ Kishin Geki Startup --------
;-----------------------------------
[Statedef 3220]
Type = S
MoveType = A
Physics = N
Anim = 3200
VelSet = 0
Ctrl = 0
PowerAdd = 0
Juggle = 8

[State 3000,SCancel1]
type = Explod
triggerAll = time = 10
Trigger1 = prevstateno = [1000,2000]
Trigger2 = prevstateno = [200,730]
anim = 11100+10*(prevstateno = 1000)
pos = 65,75
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -1
bindtime = -1
ownpal = 1
removeongethit = 1

[State 3000,SCancel2]
type = Explod
triggerAll = !time
Trigger1 = prevstateno = [1000,2000]
Trigger2 = prevstateno = [200,730]
anim = 11101
pos = 0,75
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -2
bindtime = -1
ownpal = 1
removeongethit = 1

[State 3000,SCancel3]
type = Explod
triggerAll = !time
Trigger1 = prevstateno = [1100,2000]
Trigger2 = prevstateno = [200,730]
anim = 11102
pos = 0,75
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -3
bindtime = -1
ownpal = 1
removeongethit = 1

[State -1, Cancel Combo]
Type = Poweradd
triggerAll = !time
Trigger1 = prevstateno = [1000,2000]
Trigger2 = prevstateno = [200,730]
IgnoreHitPause = 1
value = -1000

[State 3000, PALFX]
type = PalFX
TriggerAll = gametime%2 = 0
TriggerAll = time <= 15
Trigger1 = prevstateno = [1000,2000]
Trigger2 = prevstateno = [200,730]
ignorehitpause = 1
Trigger1 = prevstateno = [1000, 2000]
time = 1
add = 255,255,255
sinadd = -100,-100,-100, 2
ignorehitpause = 1

[State 3000, SDM Set]
Type = AssertSpecial
Trigger1 = AnimElem = 1, = 1
Flag = NoBG
Flag2 = NoFG
time = 26+16*((PrevStateNo = [1000, 2000]) || (prevStateNo = [200,730]))

[State 3000, SDM Set]
Type = EnvColor
Trigger1 = AnimElem = 1, = 1
Value = 255*(PrevStateNo = 1000),0,0
Under = 1
time = 26+16*((PrevStateNo = [1000, 2000]) || (prevStateNo = [200,730]))

[State 3000, After]
type = AfterImage
trigger1 = time = 27
time = 2
palmul = .65,.65,.75
palbright = 30,30,30
palcontrast = 120,120,220
timegap = 1
framegap = 5
Trans = add1
color = 6

[State 3020, After Set]
type = AfterImagetime
trigger1 = time > 27
time = 2
ignorehitpause=1

[State 3000, SDM Set]
Type = PowerAdd
Trigger1 = !Time
Trigger1 = !var(15)
value = -1000

[State 3000, SDM Set]
Type = VarSet
Trigger1 = !Time
Trigger1 = var(15)
var(15) = 1

[State 3000, invincible]
type = NotHitBy
Trigger1 = AnimElem = 7, < 0
Value = SCA
IgnoreHitPause = 1

[State 1000, Invencible]
type = Width
Trigger1 = 1
Edge = 15,0

[State 1000, Takuma voice]
type = PlaySnd
Trigger1 = AnimElem = 1, = 1
value = 1200,2
Channel = 1

[State 1000, Takuma voice]
type = PlaySnd
Trigger1 = AnimElem = 10
value = 1200,3
Channel = 1

[State 3000, Move Sound]
type = PlaySnd
Trigger1 = AnimElem = 6
Trigger2 = AnimElem = 13
Value = 1,2
Channel = 3
IgnoreHitPause = 1

[State 3000, DM Pause]
type = superpause
trigger1 = animelem = 1, = 1
time = 26+16*((PrevStateNo = [1000, 2000]) || (prevStateNo = [200,730]))
anim = -1
pos = 30,-55
darken = 1
poweradd = 0
movetime = 26
persistent = 0
ontop = 1
p2defmul = 1

[State 3000, DM FX Sound]
type = PlaySnd
Trigger1 = AnimElem = 1, = 1
Value = 8000, 0
Channel = 5
IgnoreHitPause = 1

[State 3000, DM FX1]
Type = Explod
trigger1 = animelem = 1, = 1
anim = 8100
PosType = p1
Ownpal = 1
SprPriority = -2
BindTime = -1
IgnoreHitPause = 1
pos = 30,-55
RemoveOnGetHit = 1
PauseMoveTime = 99
SuperMoveTime = 99

[State 3000, DM FX 2]
Type = Explod
trigger1 = animelem = 1, = 1
anim = 8101
PosType = p1
Ownpal = 1
SprPriority = 2
BindTime = -1
IgnoreHitPause = 1
pos = 30,-55
RemoveOnGetHit = 1
PauseMoveTime = 99
SuperMoveTime = 99

[State 3100, First Hits]
Type = HitDef
Trigger1 = AnimElem = 7
attr = S, HA
damage = 100,10
animtype = Heavy
getpower = 0,0
givepower = 30,15
guardflag =
hitflag = MA
pausetime = 25,25
sparkno = S8002
guard.sparkno = S8012
sparkxy = -15,-80
hitsound = S5,6
guardsound = S6,0
ground.type = High
ground.slidetime = 17
ground.hittime  = 20
air.hittime = 30
guard.slidetime = 17
guard.hittime = 17
guard.ctrltime = 17
guard.velocity = -9.3
ground.velocity = 0
ground.cornerpush.veloff = 0;0
guard.cornerpush.veloff = 0;-11.3
air.velocity = -5,-5.5
yAccel = .5
Air.Fall = 1
Fall.Recover = 0
EnvShake.Time = 25
EnvShake.Ampl = -5

[State 3100, First Hits]
Type = HitDef
Trigger1 = AnimElem = 14
attr = S, HA
damage = 60,6
animtype = Heavy
getpower = 0,0
givepower = 30,15
guardflag = M
hitflag = MA
pausetime = 25,25
guard.pausetime = 12,12
sparkno = S8002
guard.sparkno = S8012
sparkxy = -15,-65
hitsound = S5,6
guardsound = S6,0
ground.type = low
ground.slidetime = 17
ground.hittime  = 20
air.hittime = 30
guard.slidetime = 17
guard.hittime = 17
guard.ctrltime = 17
guard.velocity = -9.3
ground.velocity = 0
ground.cornerpush.veloff = 0;0
guard.cornerpush.veloff = 0;-11.3
air.velocity = -5,-5.5
yAccel = .5
Air.Fall = 1
Fall.Recover = 0
EnvShake.Time = 25
EnvShake.Ampl = -5
ID = 3201

[State 3020, 2]
Type = EnvColor
Trigger1 = Movehit
Trigger1 = AnimElem = 7, > 0
Time = 3
Value = 255,255,255
Under = 1
IgnoreHitPause = 1
Persistent = 0

[State 3020, 2]
Type = EnvColor
Trigger1 = Movehit
Trigger1 = AnimElem = 14, > 0
Time = 3
Value = 255,255,255
Under = 1
IgnoreHitPause = 1
Persistent = 0

[State 301, Escape Enemy]
type = targetstate
Trigger1 = MoveGuarded
trigger1 = numtarget(3201)
trigger1 = Target, alive
trigger1 = Target, stateno != 1610
Value = 1610
ignorehitpause = 1
persistent = 0

[State -1, Serious DC]
type = Changestate
TriggerAll = MoveContact
TriggerAll = power >= 3000
TriggerAll = Life <= LifeMax/4
Trigger1 = Command ="Ryuko Rambu"
Trigger1 = Command ="2punches"
Trigger1 = (var(9) < 4) || (var(9) = [5,6])
Value = 4300

[State 3020, 2]
Type = MovehitReset
Trigger1 = Movecontact

[State 1000, 9]
type = ChangeState
Trigger1 = !AnimTime
value = 3221

;-----------------------------------
;---- Kishin Geki SDM Finisher -----
;-----------------------------------
[Statedef 3221]
Type = S
MoveType = A
Physics = N
Anim = 3202
VelSet = 0
Ctrl = 0
PowerAdd = 0
Juggle = 8

[State 3020, After Set]
type = AfterImagetime
trigger1 = 1
time = 2
ignorehitpause=1

[State 1000, Invencible]
type = Width
Trigger1 = 1
Edge = 15,0

[State 3000, Move Sound]
type = PlaySnd
Trigger1 = AnimElem = 4
Trigger2 = AnimElem = 12
Trigger3 = AnimElem = 21
Value = 1,2
Channel = 3
IgnoreHitPause = 1

[State 3000, Takuma Voice]
type = PlaySnd
Trigger1 = AnimElem = 28
Value = 180,2
Channel = 1

[State 3000, POsadds]
type = PosAdd
Trigger1 = AnimElem = 5
Trigger2 = AnimElem = 17
Trigger3 = AnimElem = 23
x = 7

[State 3000, POsadds]
type = PosAdd
Trigger1 = AnimElem = 20
x = 3

[State 3000, POsadds]
type = PosAdd
Trigger1 = AnimElem = 22
x = 15

[State 3000, POsadds]
type = PosAdd
Trigger1 = AnimElem = 37
x = -3

[State 3100, First Hits]
Type = HitDef
Trigger1 = AnimElem = 5
attr = S, HA
damage = 30,3
animtype = Heavy
getpower = 0,0
givepower = 30,15
guardflag = M
hitflag = MA
pausetime = 25,25
sparkno = S8002
guard.sparkno = S8012
sparkxy = -15,-75
hitsound = S5,6
guardsound = S6,0
ground.type = High
ground.slidetime = 17
ground.hittime  = 20
air.hittime = 30
guard.slidetime = 17
guard.hittime = 17
guard.ctrltime = 17
guard.velocity = -9.3
ground.velocity = 0
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.velocity = -5,-5.5
yAccel = .5
Air.Fall = 1
Fall.Recover = 0
EnvShake.Time = 25
EnvShake.Ampl = -5
ID = 3201

[State 3020, 2]
Type = EnvColor
Trigger1 = Movehit
Trigger1 = AnimElem = 5, > 0
Time = 3
Value = 255,255,255
Under = 1
IgnoreHitPause = 1
Persistent = 0

[State 3100, First Hits]
Type = HitDef
Trigger1 = AnimElem = 14
attr = S, HA
damage = 50,5
animtype = Heavy
getpower = 0,0
givepower = 30,15
guardflag = M
hitflag = MA
pausetime = 25,25
sparkno = S8002
guard.sparkno = S8012
sparkxy = -15,-50
hitsound = S5,8
guardsound = S6,0
ground.type = Low
ground.slidetime = 17
ground.hittime  = 20
air.hittime = 30
guard.slidetime = 17
guard.hittime = 17
guard.ctrltime = 17
guard.velocity = -9.3
ground.velocity = 0
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.velocity = -5,-5.5
yAccel = .5
Air.Fall = 1
Fall.Recover = 0
EnvShake.Time = 25
EnvShake.Ampl = -5
ID = 3201

[State 3020, 2]
Type = EnvColor
Trigger1 = Movehit
Trigger1 = AnimElem = 14, > 0
Time = 3
Value = 255,255,255
Under = 1
IgnoreHitPause = 1
Persistent = 0

[State 3100, First Hits]
Type = HitDef
Trigger1 = AnimElem = 22
attr = S, HA
damage = 50,5
animtype = Heavy
getpower = 0,0
givepower = 30,15
guardflag = M
hitflag = MA
pausetime = 30,30
sparkno = S8002
guard.sparkno = S8012
sparkxy = -15,-85
hitsound = S5,8
guardsound = S6,0
ground.type = High
ground.slidetime = 17
ground.hittime  = 20
air.hittime = 30
guard.slidetime = 17
guard.hittime = 17
guard.ctrltime = 17
guard.velocity = -9.3
ground.velocity = 0
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.velocity = -5,-5.5
yAccel = .5
Air.Fall = 1
Fall.Recover = 0
EnvShake.Time = 25
EnvShake.Ampl = -5
ID = 3201

[State 3020, 2]
Type = EnvColor
Trigger1 = Movehit
Trigger1 = AnimElem = 22, > 0
Time = 3
Value = 255,255,255
Under = 1
IgnoreHitPause = 1
Persistent = 0

[State 3100, First Hits]
Type = HitDef
Trigger1 = AnimElem = 23
attr = S, HA
damage = 50,5
animtype = Heavy
getpower = 0,0
givepower = 30,15
guardflag = M
hitflag = MA
pausetime = 25,25
priority = 4, miss
sparkno = S8002
guard.sparkno = S8012
sparkxy = -15,-85
hitsound = S5,8
guardsound = S6,0
ground.type = High
ground.slidetime = 17
ground.hittime  = 20
air.hittime = 30
guard.slidetime = 17
guard.hittime = 17
guard.ctrltime = 17
guard.velocity = -9.3
ground.velocity = -5, -6.5
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.velocity = -5,-5.5
yAccel = .5
Air.Fall = 1
Fall.Recover = 0
EnvShake.Time = 25
EnvShake.Ampl = -5
p2StateNo = 3250
p2facing = 1
ID = 3201

[State 3020, 2]
Type = EnvColor
Trigger1 = Movehit
Trigger1 = AnimElem = 23, > 0
Time = 3
Value = 255,255,255
Under = 1
IgnoreHitPause = 1
Persistent = 0

[State -1, Serious DC]
type = Changestate
TriggerAll = MoveContact
TriggerAll = power >= 3000
TriggerAll = Life <= LifeMax/4
Trigger1 = Command ="Ryuko Rambu"
Trigger1 = Command ="2punches"
Trigger1 = (var(9) < 4) || (var(9) = [5,6])
Trigger2 = AnimElem = 22, > 0
Trigger2 = AnimElem = 23, < 0
Trigger2 = p2life > 350
Trigger2 = var(9) = 4 || var(9) > 6
Value = 4300

[State 301, Escape Enemy]
type = targetstate
Trigger1 = MoveGuarded
trigger1 = numtarget(3201)
trigger1 = Target, alive
trigger1 = Target, stateno != 1610
Value = 1610
ignorehitpause = 1
persistent = 0

[State 3020, 2]
Type = MovehitReset
Trigger1 = Movecontact

[State 1000, 9]
type = ChangeState
Trigger1 = !AnimTime
value = 0
Ctrl = 1

;-----------------------------------
;----------- p2 Spinning -----------
;-----------------------------------
[Statedef 3250]
Type = A
Movetype = H
Physics = N
Ctrl = 0
Velset = 0,0,0

[STate 3200, Change to hit anim]
type = Changeanim2
trigger1 = !Time
value = 3250

[State 3200,Speed]
type = velset
Trigger1 = AnimElem = 2
x = -1.5
y = -18
persistent = 0

[State 3200, Gravity]
type = veladd
trigger1 = AnimElem = 2, > 0
y = .7

[State 3200,end]
type = EnvShake
trigger1 = Pos Y >= 0
Trigger1 = Vel Y > 0
Trigger1 = AnimElem = 2, > 0
Time = 25
Ampl = 6

[State 3200,end]
type = selfstate
trigger1 = Pos Y >= 0
Trigger1 = Vel Y > 0
Trigger1 = AnimElem = 2, > 0
value = 5100
;-----------------------------------
;----------- Ryuko Rambu -----------
;-----------------------------------
[Statedef 3300]
Type = S
MoveType = A
Physics = N
Anim = 3300
VelSet = 0
Ctrl = 0
PowerAdd = 0
Juggle = 8

[State 3000,SCancel1]
type = Explod
trigger1 = time = 10 && prevstateno = [1000,2000]
anim = 11100+10*(prevstateno = 1000)
pos = 65,75
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -1
bindtime = -1
ownpal = 1
removeongethit = 1

[State 3000,SCancel2]
type = Explod
trigger1 = !time && prevstateno = [1000,2000]
anim = 11101
pos = 0,75
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -2
bindtime = -1
ownpal = 1
removeongethit = 1

[State 3000,SCancel3]
type = Explod
trigger1 = !time && prevstateno = [1100,2000]
anim = 11102
pos = 0,75
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -3
bindtime = -1
ownpal = 1
removeongethit = 1

[State -1, Cancel Combo]
Type = Poweradd
Trigger1 = !time
Trigger1 = prevstateno = [1000, 2000]
IgnoreHitPause = 1
value = -1000

[State 3000, PALFX]
type = PalFX
Trigger1 = gametime%2 = 0
Trigger1 = time <= 15
ignorehitpause = 1
Trigger1 = prevstateno = [1000, 2000]
time = 1
add = 255,255,255
sinadd = -100,-100,-100, 2
ignorehitpause = 1

[State 1000, buffer setting2]
Type = varSet
Trigger1 = !Time
Trigger1 = helper(2000),var(2) >= helper(2000), var(1)
Trigger1 = helper(2000),var(2) >= helper(2000), var(3)
var(4) = 1

[State 1000, buffer setting1]
Type = varSet
Trigger1 = !Time
Trigger1 = helper(2000),var(1) >= helper(2000), var(2)
Trigger1 = helper(2000),var(1) >= helper(2000), var(3)
var(4) = 0

[State 1000, buffer setting3]
Type = varSet
Trigger1 = !Time
Trigger1 = helper(2000),var(3) >= helper(2000), var(1)
Trigger1 = helper(2000),var(3) >= helper(2000), var(2)
var(4) = 2

[State 1000, power Set]
Type = varSet
TriggerAll = !Time
Trigger1 = command = "x"
Trigger2 = command = "y"
Trigger3 = command = "z"
var(4) = IfElse((command = "z"||var(9)),2,IfElse(Command = "x",0,1))

[State 1000, power Set]
Type = varSet
Trigger1 = !Time
Trigger1 = var(9)
var(4) = Ifelse((prevstateno = [200,2000]), 0, 2)

[State 1000, power Set]
Type = ChangeAnim
Trigger1 = !Time
Value = 3300+var(4)

[State 3000, SDM Set]
Type = AssertSpecial
Trigger1 = AnimElem = 1, = 1
Flag = NoBG
Flag2 = NoFG
time = 26+16*(PrevStateNo = [1000, 2000])

[State 3000, SDM Set]
Type = EnvColor
Trigger1 = AnimElem = 1, = 1
Value = 255*(PrevStateNo = 1000),0,0
Under = 1
time = 26+16*(PrevStateNo = [1000, 2000])

[State 3000, SDM Set]
Type = varSet
Trigger1 = !Time
var(2) = 0

[State 3000, SDM Set]
Type = varSet
TriggerAll = !Time
TriggerAll = Power >= 1000+2000*(!var(15))
Trigger1 = Command = "2punches"
Trigger2 = helper(2000), var(7)
Trigger3 = var(9)
Trigger3 = p2Life > 300
Trigger3 = !(life < LifeMax/4 && power >= 3000+1000*(!var(15)))
var(2) = 1

[State 3000, After]
type = AfterImage
trigger1 = AnimElem = 4
time = 2
palmul = .65,.65,.75
palbright = 30,30,30
palcontrast = 120,120,220
timegap = 1
framegap = 3
length = 10
Trans = add1
color = 6

[State 3020, After Set]
type = AfterImagetime
trigger1 = AnimElem = 4, > 0
time = 2
ignorehitpause = 1

[State 3000, SDM Set]
Type = BgPalFx
Trigger1 = var(2)
InvertAll = 1
Color = 6
Time = 3
IgnoreHitPause = 1

[State 3000, SDM Set]
Type = PowerAdd
Trigger1 = !Time
Trigger1 = !var(15)
value = ifelse(var(2), -2000, -1000)

[State 3000, SDM Set]
Type = VarSet
Trigger1 = !Time
Trigger1 = var(15)
var(15) = 1

[State 1000, Invencible]
type = NotHitBy
Trigger1 = AnimElem = 4, < 0
value = SCA
IgnoreHitPause = 1
Time = var(4)+1

[State 1000, Invencible]
type = Width
Trigger1 = 1
Edge = 15,0

[State 1000, Takuma voice]
type = PlaySnd
Trigger1 = AnimElem = 1, = 1
value = 3300,0
Channel = 1

[State 3000, Move Sound]
type = PlaySnd
Trigger1 = AnimElem = 4
Value = 50,1
Channel = 3
IgnoreHitPause = 1

[State 3000, DM Pause]
type = superpause
trigger1 = animelem = 1, = 1
time = 26+16*(PrevStateNo = [1000, 2000])
anim = -1
pos = 30,-55
darken = 1
poweradd = -1000*var(2)
movetime = 26
persistent = 0
ontop = 1
p2defmul = 1

[State 3000, DM FX Sound]
type = PlaySnd
Trigger1 = AnimElem = 1, = 1
Value = 8000, var(2)
Channel = 5
IgnoreHitPause = 1

[State 3000, DM FX1]
Type = Explod
trigger1 = animelem = 1, = 1
anim = 8100+10*var(2)
PosType = p1
Ownpal = 1
SprPriority = -2
BindTime = -1
IgnoreHitPause = 1
pos = 15,-90
RemoveOnGetHit = 1
PauseMoveTime = 99
SuperMoveTime = 99

[State 3000, DM FX 2]
Type = Explod
trigger1 = animelem = 1, = 1
anim = 8101+10*var(2)
PosType = p1
Ownpal = 1
SprPriority = 2
BindTime = -1
IgnoreHitPause = 1
pos = 15,-90
RemoveOnGetHit = 1
PauseMoveTime = 99
SuperMoveTime = 99

[State 301, Stateset]
type = StateTypeSet
Trigger1 = AnimElem = 4
StateType = A

[State 301, Dash]
type = VelSet
Trigger1 = AnimElem = 4
x = 10+var(4)
y = -1-.25*var(4)

[State 301, Gravity]
type = VelAdd
Trigger1 = AnimElem = 4, > 0
y = .1

[State 3100, First Hits]
Type = HitDef
Trigger1 = AnimElem = 4
attr = S, HA
damage = 0,30+15*var(2)
animtype = Heavy
fall.animtype = Heavy
getpower = 0,0
givepower = 0,15
guardflag = M
hitflag = MA
pausetime = 3,12
sparkno = S8002
guard.sparkno = S8012
sparkxy = -15,-70
hitsound = S5,4
guardsound = S6,0
ground.type = Low
ground.slidetime = 17
ground.hittime  = 17
air.hittime = 30
guard.slidetime = 17
guard.hittime = 17
guard.ctrltime = 17
guard.velocity = -9.5
ground.velocity = 0
ground.cornerpush.veloff = 0;0
guard.cornerpush.veloff = 0;-11.3
air.velocity = -5,-5.5
yAccel = .5
Fall = 1
Fall.Recover = !var(55)
Fall.RecoverTime = 35
ID = 3300
Kill = 0
Guard.Kill = 1
NoChainID = 1210

[State 301, Escape Enemy]
type = targetstate
Trigger1 = MoveHit
trigger1 = Numtarget(3300)
trigger1 = Target, alive
Value = 6200

[State 301, Escape Enemy]
type = Changestate
Trigger1 = MoveHit
trigger1 = Numtarget(3300)
trigger1 = Target, alive
Value = 3350+var(2)

[State 1000, 9]
type = ChangeState
Trigger1 = !AnimTime
Trigger2 = Moveguarded
Trigger3 = MoveHit
trigger3 = !Numtarget(3300)
Trigger4 = MoveHit
trigger4 = Numtarget(3300)
trigger4 = !Target, alive
value = 3310

;-----------------------------------
;-------- Ryuko Rambu Miss ---------
;-----------------------------------
[Statedef 3310]
Type = S
MoveType = I
Physics = N
Anim = 3310
Ctrl = 0
PowerAdd = 0
VelSet = vel x, 0

[State 3020, After Set]
type = AfterImagetime
trigger1 = AnimElem = 4, > 0
time = 2
ignorehitpause = 1

[State 3000, SDM Set]
Type = VelMul
Trigger1 = 1
x = .9

[State 3000, SDM Set]
Type = BgPalFx
Trigger1 = var(2)
Trigger1 = prevstateno = 3300
InvertAll = 1
Color = 6
Time = 3
IgnoreHitPause = 1

[State 1000, 9]
type = Posset
Trigger1 = !Time
y = 0

[State 1000, 9]
type = ChangeState
Trigger1 = !AnimTime
value = 0
Ctrl = 1

;-----------------------------------
;-------- Ryuko Rambu DM Hit -------
;-----------------------------------
[Statedef 3350]
Type = S
MoveType = A
Physics = N
Anim = 3350+2*(!var(1))
VelSet = 0, 0
Ctrl = 0
PowerAdd = 0

[State 700, Cancel2]
type = envcolor
Trigger1 = !Time
time = 3
Under = 1
value= 255,255,255

[State 1000, 9]
type = Posset
Trigger1 = !Time
y = 0

[State 810, Bind 1]
type = NotHitBy
trigger1 = 1
Value = SCA
Ignorehitpause = 1

[State 810, Bind 1]
type = Width
trigger1 = !Time
Edge = 65,0

[State 810, Bind 1]
type = TargetBind
trigger1 = AnimElem = 1
pos = 65, 0

[State 200, light high]
Type = HitDef
Trigger1 = AnimElem = 3
Trigger2 = AnimElem = 29
attr = S, HA
damage = 21, 2
AnimType = Light
getpower = 0,0
givepower = 3,1
Guardflag = M
Hitflag = MAF
pauseTime = 3,3
SparkNo = S8000
Guard.SparkNo = S8010
sparkxy = -15,-85+10*(AnimElem = 29)
HitSound = S5,(AnimElem = 29)
GuardSound = S6,0
ground.Type = High
ground.SlideTime = 20
ground.HitTime  = 20
ground.Velocity = 0
Air.Velocity = 0
Ground.cornerpush.veloff = 0;0
Air.cornerpush.veloff = 0;0
Kill = 0
ID = 3300

[State 200, medium high]
Type = HitDef
Trigger1 = AnimElem = 25
attr = S, HA
damage = 30, 3
AnimType = Medium
getpower = 0,0
givepower = 3,1
Guardflag = M
Hitflag = MAF
pauseTime = 3,3
SparkNo = S8001
Guard.SparkNo = S8011
sparkxy = -15,-75
HitSound = S5,2
GuardSound = S6,0
ground.Type = High
ground.SlideTime = 20
ground.HitTime  = 20
ground.Velocity = 0
Air.Velocity = 0
Ground.cornerpush.veloff = 0;0
Air.cornerpush.veloff = 0;0
Kill = 0
ID = 3300

[State 200, medium Low]
Type = HitDef
Trigger1 = AnimElem = 16
Trigger2 = AnimElem = 21
attr = S, HA
damage = 30, 3
AnimType = Medium
getpower = 0,0
givepower = 3,1
Guardflag = M
Hitflag = MAF
pauseTime = 3,3
SparkNo = S8001
Guard.SparkNo = S8011
sparkxy = -15,-90+25*(AnimElem = 21)
HitSound = S5,3-(AnimElem = 21)
GuardSound = S6,0
ground.Type = High
ground.SlideTime = 20
ground.HitTime  = 20
ground.Velocity = 0
Air.Velocity = 0
Ground.cornerpush.veloff = 0;0
Air.cornerpush.veloff = 0;0
Kill = 0
ID = 3300

[State 200, Strong high]
Type = HitDef
Trigger1 = AnimElem = 8
Trigger2 = AnimElem = 35
attr = S, HA
damage = 30, 3
AnimType = Heavy
getpower = 0,0
givepower = 3,1
Guardflag = M
Hitflag = MAF
pauseTime = 3,3
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,-75-5*(animElem = 35)
HitSound = S5,4
GuardSound = S6,0
ground.Type = High
ground.SlideTime = 20
ground.HitTime  = 20
ground.Velocity = 0
Air.Velocity = 0
Ground.cornerpush.veloff = 0;0
Air.cornerpush.veloff = 0;0
Kill = 0
Kill = 0
ID = 3300

[State 200, Finisher]
Type = HitDef
Trigger1 = AnimElem = 39
attr = S, HA
damage = 30, 3
AnimType = Heavy
getpower = 0,0
givepower = 3,1
Guardflag = M
Hitflag = MAF
pauseTime = 10,15
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,-65
HitSound = S5,6
GuardSound = S6,0
ground.Type = High
ground.SlideTime = 17
ground.HitTime  = 17
ground.Velocity = 0
Air.Velocity = 0
Ground.cornerpush.veloff = 0;0
Air.cornerpush.veloff = 0;0
Kill = 0
ID = 3300

[State 700, Cancel2]
type = envcolor
Trigger1 = MoveHit
Trigger1 = AnimElem = 39, < 0
time = 1
value= 255,255,255
Under = 1
IgnoreHitPause = 1

[State 700, Cancel2]
type = envcolor
Trigger1 = MoveHit
Trigger1 = AnimElem = 39 > 0
time = 3
value= 255,255,255
Under = 1
IgnoreHitPause = 1
Persistent = 0

[State -1, Normal Takuma DC]
type = Changestate
TriggerAll = !var(1)
TriggerAll = AnimElem = 3, > 0
TriggerAll = AnimElem = 40, < 0
TriggerAll = power >= 3000
TriggerAll = Life <= LifeMax/4
Trigger1 = Command ="Kosatsu Jin"
Trigger1 = !var(9)
Trigger2 = AnimElem = 39, >= 0
Trigger2 = p2life > 200
Trigger2 = var(9) > 2
Value = 4000

[State -1, Normal Takuma DC]
type = Changestate
TriggerAll = var(1) = 4
TriggerAll = AnimElem = 3, > 0
TriggerAll = AnimElem = 40, < 0
TriggerAll = power >= 3000
TriggerAll = Life <= LifeMax/4
Trigger1 = Command ="Shin Ryuko Rambu"
Trigger1 = !var(9)
Value = 4100

[State -1, Normal Takuma DC]
type = Changestate
TriggerAll = var(1) = 1
TriggerAll = AnimElem = 3, > 0
TriggerAll = AnimElem = 40, < 0
TriggerAll = power >= 3000
TriggerAll = Life <= LifeMax/4
Trigger1 = Command ="Haoh Shikoken"
Trigger1 = Command ="2punches"
Trigger1 = !var(9)
Value = 4200

[State 3020, 2]
Type = TargetState
Trigger1 = MoveHit
Trigger1 = Target, StateNo != [6200,6250]
Value = 6200
ignoreHitpause = 1

[State 3020, 2]
Type = StateTypeSet
Trigger1 = AnimElem = 44, = 3
StateType = A
ignoreHitpause = 1

[State 3020, 2]
Type = Velset
Trigger1 = AnimElem = 44, = 3
x = -6
y = -3

[State 3020, 2]
Type = playSND
Trigger1 = AnimElem = 44, = 3
Value = 105,0
Channel = 3

[State 3020, 2]
Type = gravity
Trigger1 = AnimElem = 44, > 3

[State 3000, After]
type = AfterImage
trigger1 = AnimElem = 45
time = 2
palmul = .65,.65,.75
palbright = 30,30,30
palcontrast = 120,120,220
timegap = 1
framegap = 3
length = 10
Trans = add1
color = 6

[State 3020, After Set]
type = AfterImagetime
trigger1 = AnimElem = 45, > 0
time = 2
ignorehitpause = 1

[State 3020, 2]
Type = MovehitReset
Trigger1 = Movecontact

[State 1000, 9]
type = ChangeState
Trigger1 = pos y >= 0
Trigger1 = vel y > 0
trigger1 = AnimElem = 45, > 0
value = 3360+10*(!var(1))

;-----------------------------------
;------- Ryuko Rambu SDM Hit -------
;-----------------------------------
[Statedef 3351]
Type = S
MoveType = A
Physics = N
Anim = 3351+2*(!var(1))
VelSet = 0, 0
Ctrl = 0
PowerAdd = 0

[State 3000, SDM Set]
Type = BgPalFx
Trigger1 = 1
InvertAll = 1
Color = 6
Time = 3
Under = 1
IgnoreHitPause = 1

[State 1000, 9]
type = Posset
Trigger1 = !Time
y = 0

[State 810, Bind 1]
type = NotHitBy
trigger1 = 1
Value = SCA
Ignorehitpause = 1

[State 810, Bind 1]
type = Width
trigger1 = !Time
Edge = 65,0

[State 810, Bind 1]
type = TargetBind
trigger1 = AnimElem = 1
pos = 65, 0

[State 200, light low]
Type = HitDef
Trigger1 = AnimElem = 5
attr = S, HA
damage = 30, 3
AnimType = Light
getpower = 0,0
givepower = 3,1
Guardflag = M
Hitflag = MAF
pauseTime = 3,3
SparkNo = S8000
Guard.SparkNo = S8010
sparkxy = -15,-60
HitSound = S5,0
GuardSound = S6,0
ground.Type = High
ground.SlideTime = 20
ground.HitTime  = 20
ground.Velocity = 0
Air.Velocity = 0
Ground.cornerpush.veloff = 0;0
Air.cornerpush.veloff = 0;0
Kill = 0
ID = 3300

[State 200, light high]
Type = HitDef
Trigger1 = AnimElem = 7
Trigger2 = AnimElem = 47
attr = S, HA
damage = 22, 2
AnimType = Light
getpower = 0,0
givepower = 3,1
Guardflag = M
Hitflag = MAF
pauseTime = 3,3
SparkNo = S8000
Guard.SparkNo = S8010
sparkxy = -15,-85-15*(AnimElem = 47)
HitSound = S5,(AnimElem = 47)
GuardSound = S6,0
ground.Type = High
ground.SlideTime = 20
ground.HitTime  = 20
ground.Velocity = 0
Air.Velocity = 0
Ground.cornerpush.veloff = 0;0
Air.cornerpush.veloff = 0;0
Kill = 0
ID = 3300

[State 200, medium Low]
Type = HitDef
Trigger1 = AnimElem = 41
Trigger2 = AnimElem = 57
attr = S, HA
damage = 30, 3
AnimType = Medium
getpower = 0,0
givepower = 3,1
Guardflag = M
Hitflag = MAF
pauseTime = 3,3
SparkNo = S8001
Guard.SparkNo = S8011
sparkxy = -15,-90+25*(AnimElem = 41)
HitSound = S5,3-(AnimElem = 41)
GuardSound = S6,0
ground.Type = High
ground.SlideTime = 20
ground.HitTime  = 20
ground.Velocity = 0
Air.Velocity = 0
Ground.cornerpush.veloff = 0;0
Air.cornerpush.veloff = 0;0
Kill = 0
ID = 3300

[State 200, Strong high]
Type = HitDef
Trigger1 = AnimElem = 12
Trigger2 = AnimElem = 17
attr = S, HA
damage = 30, 3
AnimType = Heavy
getpower = 0,0
givepower = 3,1
Guardflag = M
Hitflag = MAF
pauseTime = 3,3
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,-75-5*(animElem = 17)
HitSound = S5,4
GuardSound = S6,0
ground.Type = High
ground.SlideTime = 20
ground.HitTime  = 20
ground.Velocity = 0
Air.Velocity = 0
Ground.cornerpush.veloff = 0;0
Air.cornerpush.veloff = 0;0
Kill = 0
ID = 3300

[State 200, Strong Low]
Type = HitDef
Trigger1 = AnimElem = 24
Trigger2 = AnimElem = 37
attr = S, HA
damage = 30, 3
AnimType = Heavy
getpower = 0,0
givepower = 3,1
Guardflag = M
Hitflag = MAF
pauseTime = 3,3
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,-50-20*(AnimElem = 37)
HitSound = S5,4+2*(AnimElem = 37)
GuardSound = S6,0
ground.Type = High
ground.SlideTime = 20
ground.HitTime  = 20
ground.Velocity = 0
Air.Velocity = 0
Ground.cornerpush.veloff = 0;0
Air.cornerpush.veloff = 0;0
Kill = 0
ID = 3300

[State 200, Finisher]
Type = HitDef
Trigger1 = AnimElem = 65
attr = S, HA
damage = 29, 3
AnimType = Heavy
getpower = 0,0
givepower = 3,1
Guardflag = M
Hitflag = MAF
pauseTime = 10,15
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,-85
HitSound = S5,6
GuardSound = S6,0
ground.Type = High
ground.SlideTime = 17
ground.HitTime  = 17
ground.Velocity = 0
Air.Velocity = 0
Ground.cornerpush.veloff = 0;0
Air.cornerpush.veloff = 0;0
Kill = 0
ID = 3300

[State 700, Cancel2]
type = envcolor
Trigger1 = MoveHit
Trigger1 = AnimElem = 65, < 0
time = 1
value= 255,255,255
Under = 1
IgnoreHitPause = 1

[State 700, Cancel2]
type = envcolor
Trigger1 = MoveHit
Trigger1 = AnimElem = 65 > 0
time = 3
value= 255,255,255
Under = 1
IgnoreHitPause = 1
Persistent = 0

[State 3020, 2]
Type = TargetState
Trigger1 = MoveHit
Trigger1 = Target, StateNo != [6200,6250]
Value = 6200
ignoreHitpause = 1

[State 3020, 2]
Type = StateTypeSet
Trigger1 = AnimElem = 69, = 3
StateType = A
ignoreHitpause = 1

[State 3020, 2]
Type = Velset
Trigger1 = AnimElem = 69, = 3
x = -6
y = -3

[State 3020, 2]
Type = playSND
Trigger1 = AnimElem = 69, = 3
Value = 105,0
Channel = 3

[State 3020, 2]
Type = gravity
Trigger1 = AnimElem = 69, > 3

[State 3000, After]
type = AfterImage
trigger1 = AnimElem = 70
time = 2
palmul = .65,.65,.75
palbright = 30,30,30
palcontrast = 120,120,220
timegap = 1
framegap = 3
length = 10
Trans = add1
color = 6

[State 3020, After Set]
type = AfterImagetime
trigger1 = AnimElem = 70, > 0
time = 2
ignorehitpause = 1

[State 3020, 2]
Type = MovehitReset
Trigger1 = Movecontact

[State 1000, 9]
type = ChangeState
Trigger1 = pos y >= 0
Trigger1 = vel y > 0
trigger1 = AnimElem = 70, > 0
value = 3360+10*(!var(1))

;-----------------------------------
;-------- Ryuko Rambu Finish -------
;-----------------------------------
[Statedef 3360]
Type = S
MoveType = A
Physics = S
Anim = 3360+var(2)
VelSet = vel x, 0
Ctrl = 0
PowerAdd = 0
SprPriority = 1

[State 3000, SDM Set]
Type = Posset
Trigger1 = !Time
y = 0
IgnoreHitPause = 1

[State 3000, SDM Set]
Type = BgPalFx
Trigger1 = var(2)
InvertAll = 1
Color = 6
Time = 3
IgnoreHitPause = 1

[State -1, Normal Takuma DC]
type = Changestate
TriggerAll = !var(2)
TriggerAll = var(1) = 4
TriggerAll = AnimElem = 2, < 0
TriggerAll = power >= 3000
TriggerAll = Life <= LifeMax/4
Trigger1 = Command ="Shin Ryuko Rambu"
Trigger1 = !var(9)
Trigger2 = AnimElem = 1, > 2
Trigger2 = p2life > 200
Trigger2 = var(9) > 2
Value = 4100

[State -1, Normal Takuma DC]
type = Changestate
TriggerAll = !var(2)
TriggerAll = var(1) = 1
TriggerAll = AnimElem = 2, < 0
TriggerAll = power >= 3000
TriggerAll = Life <= LifeMax/4
Trigger1 = Command ="Haoh Shikoken"
Trigger1 = Command ="2punches"
Trigger1 = !var(9)
Trigger2 = AnimElem = 1, > 2
Trigger2 = p2life > 250
Trigger2 = var(9) = [3,4]
Value = 4200

[State 3020, 2]
Type = TargetState
Trigger1 = MoveHit
Trigger1 = Target, StateNo != [6200,6250]
Value = 6200
ignoreHitpause = 1

[State 1000, Karate Voice]
type = PlaySnd
Trigger1 = AnimElem = 1, = 1
value = 3300,1
Channel = 1

[State 1000, Hadouken FX sound]
type = PlaySnd
trigger1 = AnimElem = 3, = 1
trigger2 = var(2)
trigger2 = AnimElem = 8, = 1
trigger3 = var(2)
trigger3 = AnimElem = 14, = 1
value = 3050,0
Channel = 3

[State 1000, 3]
type = Projectile
trigger1 = !var(2)
trigger1 = AnimElem = 3, = 1
attr = S, HP
ownpal = 1
damage = 111,12
animtype = Back
getpower = 0,0
givepower = 30,15
guardflag = M
hitflag = MAF
pausetime = 3,12
sparkno = S8002
guard.sparkno = S8012
sparkxy = 20,-5
hitsound = S5,6
guardsound = S6,0
ground.type = High
air.type = low
ground.slidetime = 17
ground.hittime  = 17
guard.slidetime = 17
guard.hittime = 17
air.hittime = 30
guard.ctrltime = 17
ground.velocity = -4.5, -8.5
air.velocity = -4.5, -7.5
yaccel = .5
projanim = 3050
projhitanim = 3070
projremanim = 3070
projcancelanim = 3070
velocity = 6+4*var(4)
offset = 65,-75
projid = 3000
projpriority = 9999
Fall = 1
Fall.Recover = 0
ID = 1000
EnvShake.time = 15

[State 1000, 3]
type = Projectile
triggerAll = var(2)
trigger1 = AnimElem = 3, = 1
trigger2 = AnimElem = 8, = 1
attr = S, HP
ownpal = 1
damage = 72,7
animtype = High
getpower = 0,0
givepower = 30,15
guardflag = M
hitflag = MAF
pausetime = 3,12
sparkno = S8002
guard.sparkno = S8012
sparkxy = 20,-5
hitsound = S5,6
guardsound = S6,0
ground.type = High
air.type = low
ground.slidetime = 17
ground.hittime  = 17
guard.slidetime = 17
guard.hittime = 17
air.hittime = 30
guard.ctrltime = 17
ground.velocity = 0
air.velocity = -4.5, -6.5
yaccel = .5
projanim = 3060
projhitanim = 3070
projremanim = 3070
projcancelanim = 3070
velocity = 6+4*var(4)
offset = 65,-75
projid = 3300
projpriority = 9999
Air.Fall = 1
Fall.Recover = 0
ID = 1000
EnvShake.time = 15

[State 1000, 3]
type = Projectile
trigger1 = var(2)
trigger1 = AnimElem = 14, = 1
attr = S, HP
ownpal = 1
damage = 72,7
animtype = DiagUp
getpower = 0,0
givepower = 30,15
guardflag = M
hitflag = MAF
pausetime = 3,12
sparkno = S8002
guard.sparkno = S8012
sparkxy = 20,-5
hitsound = S5,7
guardsound = S6,0
ground.type = High
air.type = low
ground.slidetime = 17
ground.hittime  = 17
guard.slidetime = 17
guard.hittime = 17
air.hittime = 30
guard.ctrltime = 17
ground.velocity = -4.5, -8.5
air.velocity = -4.5, -7.5
yaccel = .5
projanim = 3060
projhitanim = 3070
projremanim = 3070
projcancelanim = 3070
velocity = 6+4*var(4)
offset = 65,-75
projid = 3000
projpriority = 9999
Fall = 1
Fall.Recover = 0
ID = 1000
EnvShake.time = 15

[State 1000, 9]
type = ChangeState
trigger1 = !AnimTime
value = 100*(var(9) > 0)
ctrl = !var(9)

;-----------------------------------
;------ Ryuko Rambu Finish '02 -----
;-----------------------------------
[Statedef 3370]
Type = S
MoveType = A
Physics = S
Anim = 3370+var(2)
VelSet = 0, 0
Ctrl = 0
PowerAdd = 0
SprPriority = 1

[State 3000, SDM Set]
Type = AssertSpecial
trigger1 = var(2)
Trigger1 = AnimElem = 1, = 1
Flag = NoBG
Flag2 = NoFG
time = 26

[State 3000, SDM Set]
Type = EnvColor
trigger1 = var(2)
Trigger1 = AnimElem = 1, = 1
Value = 0,0,0
Under = 1
time = 26

[State 3000, DM Pause]
type = superpause
trigger1 = var(2)
trigger1 = animelem = 1, = 1
time = 26
anim = -1
pos = 30,-55
darken = 1
poweradd = 0
movetime = 26
persistent = 0
ontop = 1
p2defmul = 1

[State 3000, DM FX Sound]
type = PlaySnd
trigger1 = var(2)
Trigger1 = AnimElem = 1, = 1
Value = 8000, 1
Channel = 5
IgnoreHitPause = 1

[State 3000, DM FX1]
Type = Explod
trigger1 = var(2)
trigger1 = animelem = 1, = 1
anim = 8110
PosType = p1
Ownpal = 1
SprPriority = -2
BindTime = -1
IgnoreHitPause = 1
pos = 35,-55
RemoveOnGetHit = 1
PauseMoveTime = 99
SuperMoveTime = 99

[State 3000, DM FX 2]
Type = Explod
trigger1 = var(2)
trigger1 = animelem = 1, = 1
anim = 8111
PosType = p1
Ownpal = 1
SprPriority = 2
BindTime = -1
IgnoreHitPause = 1
pos = 35,-55
RemoveOnGetHit = 1
PauseMoveTime = 99
SuperMoveTime = 99

[State 3000, SDM Set]
Type = BgPalFx
Trigger1 = var(2)
InvertAll = 1
Color = 6
Time = 3
IgnoreHitPause = 1

[State 1000, Karate Voice]
type = PlaySnd
Trigger1 = !var(2)
Trigger1 = AnimElem = 1, = 1
Trigger2 = var(2)
Trigger2 = AnimElem = 9, = 3
value = 3300,1
Channel = 1

[State -3, 2K2 UM FX]
type = Explod
trigger1 = !var(2)
Trigger1 = AnimElem = 4
anim = 1051
pos = 45,-70
bindtime = 1
ownpal = 1
sprpriority = 3
IgnoreHitPause = 1
PauseMoveTime = 10
SuperMoveTime = 10

[State -3, 2K2 UM FX]
type = Explod
trigger1 = var(2)
Trigger1 = AnimElem = 11
anim = 1051
pos = 72,-75
bindtime = 1
ownpal = 1
sprpriority = 3
Scale = .5,.6
IgnoreHitPause = 1
PauseMoveTime = 10
SuperMoveTime = 10

[State 1000, 3]
type = Projectile
Trigger1 = !var(2)
Trigger1 = AnimElem = 4
Trigger2 = var(2)
Trigger2 = AnimElem = 11
attr = S, HP
ownpal = 1
damage = 111+106*var(2),11+10*var(2)
animtype = Back
getpower = 0,0
givepower = 30,15
guardflag = M
hitflag = MA
pausetime = 0,20+30*var(2)
sparkno = S8002
guard.sparkno = S8012
sparkxy = 15,-25
hitsound = S5,6
guardsound = S6,0
ground.type = High
air.type = low
ground.slidetime = 17
ground.hittime  = 17
guard.slidetime = 17
guard.hittime = 17
air.hittime = 30
guard.ctrltime = 17
ground.velocity = -5.5, -5
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.velocity = -5.5,-3
yaccel = .5
projanim = 1053
projhitanim = 1053
projremanim = 1053
projcancelanim = 1053
projremove = 0
velocity = 30
offset = 35,-40
projid = 4250
projpriority = 9999
Fall = 1
Fall.Recover = 0
EnvShake.time = 15
EnvShake.ampl = -3-2*var(2)
ID = 3370

[State 301, Escape Enemy]
type = targetstate
Trigger1 = var(2)
Trigger1 = ProjHit = 1
trigger1 = Numtarget(3370)
trigger1 = p2StateNo != [1170,1190]
Value = 1170
ignorehitpause = 1
persistent = 0

[State 301, Escape Enemy]
type = MoveHitReset
Trigger1 = MoveHit

[State 1000, 9]
type = ChangeState
trigger1 = !AnimTime
value = 0
ctrl = 1

;============================================================================
; Hidden Super Danger Moves
;============================================================================
;-----------------------------------
;----------- Kosatsu Jin -----------
;-----------------------------------
[Statedef 4000]
Type = S
MoveType = I
Physics = S
Anim = 4000+(prevstateno = [1000,3999])
VelSet = 0, 0
Ctrl = 0
PowerAdd = 0
Juggle = 8*(prevstateno != [3000,3999])

[State 3000,SCancel1]
type = StateTypeSet
trigger1 = !time
Trigger1 = prevstateno = [1000,3999]
MoveType = A

[State 3000,SCancel1]
type = Explod
trigger1 = time = 10 && prevstateno = [1000,2000]
anim = 11100+10*(prevstateno = [1000,1010])
pos = 65,75
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -1
bindtime = -1
ownpal = 1
removeongethit = 1

[State 3000,SCancel2]
type = Explod
trigger1 = !time && prevstateno = [1000,2000]
anim = 11101
pos = 0,75
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -2
bindtime = -1
ownpal = 1
removeongethit = 1

[State 3000,SCancel3]
type = Explod
trigger1 = !time && prevstateno = [1100,2000]
anim = 11102
pos = 0,75
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -3
bindtime = -1
ownpal = 1
removeongethit = 1

[State 3000,Dcancel1]
type = Explod
trigger1 = !time && prevstateno = [3000,4000]
anim = 11200
pos = 0,85
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -1
bindtime = -1
ownpal = 1
removeongethit = 1

[State 3000,Dcancel2]
type = Explod
trigger1 = !time && prevstateno = [3000,4000]
anim = 11201
pos = 0,85
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -2
bindtime = -1
ownpal = 1
removeongethit = 1

[State 3000,Dcancel3]
type = Explod
trigger1 = !time && prevstateno = [3000,4000]
anim = 11202
pos = 0,85
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -3
bindtime = -1
ownpal = 1
removeongethit = 1

[State -1, Cancel Combo]
Type = Poweradd
Trigger1 = !time
Trigger1 = prevstateno = [1000, 3999]
IgnoreHitPause = 1
value = -1000

[State 3000, PALFX]
type = PalFX
Trigger1 = timemod = 2,0
Trigger1 = time <= 15
ignorehitpause = 1
Trigger1 = prevstateno = [1000, 3999]
time = 1
add = 255,255,255
sinadd = -100,-100,-100, 2
ignorehitpause = 1

[State 3000, SDM Set]
Type = AssertSpecial
Trigger1 = AnimElem = 1, = 1
Trigger1 = PrevStateNo = [1000, 4000]
Flag = NoBG
Flag2 = NoFG
time = 42

[State 3000, SDM Set]
Type = EnvColor
Trigger1 = AnimElem = 1, = 1
Trigger1 = PrevStateNo = [1000, 4000]
Value = 255*(prevstateno = [1000,1010]),0,0
Under = 1
time = 42
ignorehitpause = 1

[State 3000, SDM Set]
Type = PowerAdd
Trigger1 = !Time
value = -1000-2000*(!var(15))+1000*(prevstateNo = [3000,3999])

[State 3000, SDM Set]
Type = VarSet
Trigger1 = !Time
Trigger1 = var(15)
var(15) = 1

[State 1000, Invincible]
type = HitBy
Trigger1 = anim = 4000
Trigger1 = animelem = 4, < 0
Trigger2 = anim = 4001
Trigger2 = animelem = 8, < 0
value = SCA, AT
IgnoreHitPause = 1

[State 3000, DM Pause]
type = superpause
trigger1 = animelem = 1, = 1
Trigger1 = PrevStateNo = [1000, 4000]
time = 42
anim = -1
darken = 1
poweradd = 0
movetime = 26
persistent = 0
ontop = 1
p2defmul = 1

[State 3000, DM FX Sound]
type = PlaySnd
Trigger1 = PrevStateNo = [1000, 4000]
Trigger1 = AnimElem = 1, = 1
Value = 8000, 2
Channel = 5
IgnoreHitPause = 1

[State 3000, DM FX1]
Type = Explod
trigger1 = animelem = 1, = 1
Trigger1 = PrevStateNo = [1000, 4000]
anim = 8120
PosType = p1
Ownpal = 1
SprPriority = -2
BindTime = -1
IgnoreHitPause = 1
Pos = 5,-75
RemoveOnGetHit = 1
PauseMoveTime = 99
SuperMoveTime = 99

[State 3000, DM FX 2]
Type = Explod
trigger1 = animelem = 1, = 1
Trigger1 = PrevStateNo = [1000, 4000]
anim = 8121
PosType = p1
Ownpal = 1
SprPriority = 2
BindTime = -1
IgnoreHitPause = 1
Pos = 5,-75
RemoveOnGetHit = 1
PauseMoveTime = 99
SuperMoveTime = 99

[State 3000,HSDM BG]
type = Helper
trigger1 = time = 28
Trigger1 = PrevStateNo = [1000, 4000]
stateno = 9994
Ownpal = 1
pos = 0,0
name = "HSDM BG"
id = 9994
IgnoreHitPause = 1

[State 1100, normal]
type = ReversalDef
Trigger1 = Anim = 4000
trigger1 = AnimElem = 1
attr = S, HT
reversal.attr = SCA, NA, SA, HA
pausetime = 12,12
sparkno = S8012
sparkxy = 15,0
hitsound = S6,0
p1stateno = 4010
p2stateno = 4020
sprpriority = 1
numhits = 0
AnimType = diagUp
P2Facing = 1

[State 3000, DM FX Sound]
type = PlaySnd
Trigger1 = Anim = 4001
Trigger1 = AnimElem = 6
Value = 3200, 1
Channel = 1
IgnoreHitPause = 1

[State 1100, Canceled into]
Type = HitDef
Trigger1 = Anim = 4001
Trigger1 = AnimElem = 7
attr = S, HA
damage = 500,50
animtype = up
getpower = 0,0
givepower = 30,15
guardflag = M
hitflag = MA
pausetime = 20,30
guard.pausetime = 15,15
sparkno = S8002
guard.sparkno = S8012
sparkxy = -15,-50
hitsound = S5,6
guardsound = S6,0
ground.type = Low
ground.slidetime = 22
ground.hittime  = 22
guard.slidetime = 17
guard.hittime = 22
guard.ctrltime = 22
guard.velocity = -9.3
ground.velocity = -3.5, -20
ground.cornerpush.veloff = 0;0
guard.cornerpush.veloff = 0;-11.3
air.velocity = -3.5, -20
yAccel = .8
Fall = 1
Fall.Recover = 0
EnvShake.Time = 25
EnvShake.Ampl = -6
P2StateNo = 4040
Snap = 75,0
p1sprpriority = -1
p2sprpriority = 1

[State 3000,HSDM BG]
type = Explod
trigger1 = MoveHit
Trigger1 = PrevStateNo = [1000, 4000]
anim = 4050
pos = 43,-24
postype = p1
supermove = 1
supermovetime = 9999
sprpriority = 5
bindtime = 1
ownpal = 1
IgnoreHitpause = 1
Persistent = 0

[State 1000, 9]
type = ChangeState
Trigger1 = !AnimTime
value = 0
Ctrl = 1

;-----------------------------------
;------ Kosatsu Jin Follow-up ------
;-----------------------------------
[Statedef 4010]
Type = S
MoveType = A
Physics = S
Anim = 4010
VelSet = 0
Ctrl = 0
PowerAdd = 0
Juggle = 8
Sprpriority = 1

[State 3000, DM Pause]
type = superpause
trigger1 = Time = 1
time = 28
anim = -1
darken = 0
poweradd = 0
movetime = 26
persistent = 0
ontop = 1
p2defmul = 1

[State 3000, DM FX Sound]
type = PlaySnd
Trigger1 = Time = 1
Value = 8000, 2
Channel = 5
IgnoreHitPause = 1

[State 3000, DM FX1]
Type = Explod
trigger1 = Time = 1
anim = 8120
PosType = p1
Ownpal = 1
SprPriority = -2
BindTime = -1
IgnoreHitPause = 1
Pos = 5,-75
RemoveOnGetHit = 1
PauseMoveTime = 99
SuperMoveTime = 99

[State 3000, DM FX 2]
Type = Explod
trigger1 = Time = 1
anim = 8121
PosType = p1
Ownpal = 1
SprPriority = 2
BindTime = -1
IgnoreHitPause = 1
Pos = 5,-75
RemoveOnGetHit = 1
PauseMoveTime = 99
SuperMoveTime = 99

[State 3000,HSDM BG]
type = Helper
trigger1 = time = 1
stateno = 9994
Ownpal = 1
pos = 0,0
name = "HSDM BG"
id = 9994
IgnoreHitPause = 1

[State 1000, Invincible]
type = NotHitBy
Trigger1 = 1
value = SCA
IgnoreHitPause = 1

[State 1000, Bind]
type = TargetBind
Trigger1 = !Time
pos = 45,0

[State 3000, DM FX Sound]
type = PlaySnd
Trigger1 = AnimElem = 5
Trigger1 = Anim = 4010
Value = 3200, 1
Channel = 1
IgnoreHitPause = 1

[State 1100, Canceled into]
Type = HitDef
Trigger1 = AnimElem = 6
attr = C, HT
damage = 500,50
animtype = diagUp
getpower = 0,0
givepower = 30,15
guardflag = M
hitflag = MAFD
pausetime = 20,30
guard.pausetime = 12,12
sparkno = S8002
guard.sparkno = S8012
sparkxy = -15,-20
hitsound = S5,6
guardsound = S6,0
ground.type = Low
ground.slidetime = 22
ground.hittime  = 22
guard.slidetime = 17
guard.hittime = 22
guard.ctrltime = 22
guard.velocity = -9.3
ground.velocity = -3.5, -20
ground.cornerpush.veloff = 0;0
guard.cornerpush.veloff = 0;-11.3
air.velocity = -3.5, -20
yAccel = .8
Fall = 1
Fall.Recover = 0
EnvShake.Time = 25
EnvShake.Ampl = -6
fall.EnvShake.Time = 25
fall.EnvShake.Ampl = -6
P2StateNo = 4040
Snap = 75,0
p1sprpriority = -1
p2sprpriority = 1

[State 3000,HSDM BG]
type = Explod
trigger1 = MoveHit
trigger1 = time > 5
anim = 4050
pos = 43,-24
postype = p1
supermove = 1
supermovetime = 9999
sprpriority = 5
bindtime = 1
ownpal = 1
IgnoreHitpause = 1
Persistent = 0

[State -3, OTG FX]
type = Explod
Trigger1 = AnimElem = 6, = 10
anim = 8310
pos = 60,0
bindtime = 1
ownpal = 1
sprpriority = -3

[State -3, OTG FX]
type = Explod
Trigger1 = AnimElem = 6, = 10
anim = 8320
pos = 60,0
bindtime = 1
ownpal = 1
sprpriority = 3

[State 1000, 9]
type = ChangeState
Trigger1 = !AnimTime
value = 0
Ctrl = 1

;-----------------------------------
;-------- Kosatsu Jin P2 Hit -------
;-----------------------------------
[Statedef 4020]
type = L
ctrl = 0
movetype = H
velset = 0,0,0

[State 5302, 4]
type = ChangeAnim2
trigger1 = !Time
trigger1 = SelfAnimExist(5111)
value = 4020

[State 5302, 4]
type = ChangeAnim2
trigger1 = !Time
trigger1 = !SelfAnimExist(5111)
value = 4021

[State 5302, 4]
type = Turn
trigger1 = !Time
trigger1 = !SelfAnimExist(5111)

[STate 4110, Playerpush]
type = playerpush
trigger1 = 1
value = 0

[State 1830,1]
type = Changestate
Trigger1 = !AnimTime
value = 4030

;-----------------------------------
;------- Kosatsu Jin P2 Hit 2 ------
;-----------------------------------
[Statedef 4030]
type    = L
movetype= H
physics = N
velset = 0,0
anim = 5110

[State 5302, 4]
type = ChangeAnim
trigger1 = !Time
trigger1 = SelfAnimExist(5111)
value = 5111
ignorehitpause = 1

[State 5303, 2]
type = posset
trigger1 = time = 0
y = 0

[State 5303, 6]
type = PlaySnd
trigger1 = Time = 0
value = F7,0

[State 5303, 7]
type = GameMakeAnim
trigger1 = Time = 0
value = 60
pos = 0, 0
under = 1

[State 5303, 3.1]
type = ChangeState
trigger1 = !alive
trigger1 = !Time
value = 5150

[State 5303, 3.2]
type = SelfState
triggerall = alive
trigger1 = Time = 50
value = 5120

;-----------------------------------
;------- Kosatsu Jin P2 Hit 3 ------
;-----------------------------------
[Statedef 4040]
type    = A
movetype= H
physics = N
velset = 0,0

[State 6000, Change by HitType1]
type = ChangeAnim
trigger1 = !HitShakeOver
trigger1 = SelfAnimExist(5101)
value = 5101
IgnoreHitPause = 1

[State 6000, Change by HitType2]
type = ChangeAnim
trigger1 = !HitShakeOver
trigger1 = !SelfAnimExist(5101)
value = 5100
IgnoreHitPause = 1

[State 6000, Change by HitType1]
type = posAdd
trigger1 = !HitShakeOver
trigger1 = gametime%2 = 0
x = 2
IgnoreHitPause = 1

[State 6000, Change by HitType1]
type = posAdd
trigger1 = !HitShakeOver
trigger1 = gametime%2 = 1
x = -2
IgnoreHitPause = 1

[State 6000, end]
type = ChangeState
trigger1 = HitShakeOver
value = 4041

[State 6000, FFB Hard]
type = ForceFeedback
trigger1 = !Time
persistent = 0
time = 15
waveform = sinesquare
ampl = 140
ignoreHitPause = 1

;-----------------------------------
;------- Kosatsu Jin P2 Hit 4 ------
;-----------------------------------
[Statedef 4041]
type    = L
movetype= H
physics = N
ctrl = 0

[State 6000, Change by HitType1]
type = ChangeAnim
trigger1 = !Time
trigger1 = SelfAnimExist(5161)
value = 5161
IgnoreHitPause = 1

[State 6000, Change by HitType2]
type = ChangeAnim
trigger1 = !HitShakeOver
trigger1 = !SelfAnimExist(5161)
value = 5170
IgnoreHitPause = 1

[State 6000, End]
type = ChangeState
trigger1 = Time >= 12
value = 4030

;-----------------------------------
;-------- Shin Ryuko Rambu ---------
;-----------------------------------
[Statedef 4100]
Type = S
MoveType = A
Physics = N
Anim = 4100+(prevStateNo = [3000,3999])
VelSet = 0, 0
Ctrl = 0
PowerAdd = 0
Juggle = 8*(prevStateNo != [3000,3999])

[State 3000,SCancel1]
type = Explod
triggerAll = time = 10
Trigger1 = prevstateno = [1000,2000]
anim = 11100+10*(prevstateno = [1000,1010])
pos = 65,75
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -1
bindtime = -1
ownpal = 1
removeongethit = 1

[State 3000,SCancel2]
type = Explod
triggerAll = !Time
Trigger1 = prevstateno = [1000,2000]
anim = 11101
pos = 0,75
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -2
bindtime = -1
ownpal = 1
removeongethit = 1

[State 3000,SCancel3]
type = Explod
triggerAll = !Time
Trigger1 = prevstateno = [1100,2000]
anim = 11102
pos = 0,75
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -3
bindtime = -1
ownpal = 1
removeongethit = 1

[State 3000,Dcancel1]
type = Explod
trigger1 = !time && prevstateno = [3000,4000]
anim = 11200
pos = 0,85
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -1
bindtime = -1
ownpal = 1
removeongethit = 1

[State 3000,Dcancel2]
type = Explod
trigger1 = !time && prevstateno = [3000,4000]
anim = 11201
pos = 0,85
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -2
bindtime = -1
ownpal = 1
removeongethit = 1

[State 3000,Dcancel3]
type = Explod
trigger1 = !time && prevstateno = [3000,4000]
anim = 11202
pos = 0,85
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -3
bindtime = -1
ownpal = 1
removeongethit = 1

[State -1, Cancel Combo]
Type = Poweradd
triggerAll = !time
Trigger1 = prevstateno = [1000,3999]
IgnoreHitPause = 1
value = -1000

[State 3000, PALFX]
type = PalFX
TriggerAll = gametime%2 = 0
TriggerAll = time <= 15
Trigger1 = prevstateno = [1000,3999]
ignorehitpause = 1
time = 1
add = 255,255,255
sinadd = -100,-100,-100, 2
ignorehitpause = 1

[State 3000, SDM Set]
Type = AssertSpecial
Trigger1 = !Time
Flag = NoBG
Flag2 = NoFG
time = 26+16*(PrevStateNo = [1000, 3999])

[State 3000, SDM Set]
Type = EnvColor
Trigger1 = !Time
Value = 255*(prevstateno = [1000,1010]),0,0
Under = 1
time = 26+16*(PrevStateNo = [1000, 3999])

[State 3000, SDM Set]
Type = PowerAdd
Trigger1 = !Time
Trigger1 = !var(15)
value = -2000+1000*(prevstateNo = [3000,3999])

[State 3000, SDM Set]
Type = VarSet
Trigger1 = !Time
var(15) = 1

[State 3000,HSDM BG]
type = Helper
trigger1 = time = 28
stateno = 9994
Ownpal = 1
pos = 0,0
name = "HSDM BG"
id = 9994
IgnoreHitPause = 1

[State 3000, DM Pause]
type = superpause
trigger1 = animelem = 1, = 1
time = 26+16*(PrevStateNo = [1000, 3999])
anim = -1
darken = 1
poweradd = -1000
movetime = 26
persistent = 0
ontop = 1
p2defmul = 1

[State 3000, Takuma voice]
type = PlaySnd
Trigger1 = AnimElem = 1, = 1
Value = 770,0
Channel = 1
IgnoreHitPause = 1

[State 3000, DM FX SND]
type = PlaySnd
Trigger1 = AnimElem = 1, = 1
Value = 8000,2
Channel = 5
IgnoreHitPause = 1

[State 3000, DM FX1]
Type = Explod
trigger1 = animelem = 1, = 1
anim = 8120
PosType = p1
Ownpal = 1
SprPriority = -2
BindTime = -1
IgnoreHitPause = 1
Pos = 10,-85
RemoveOnGetHit = 1
PauseMoveTime = 99
SuperMoveTime = 99

[State 3000, DM FX 2]
Type = Explod
trigger1 = animelem = 1, = 1
anim = 8121
PosType = p1
Ownpal = 1
SprPriority = 2
BindTime = -1
IgnoreHitPause = 1
Pos = 10,-85
RemoveOnGetHit = 1
PauseMoveTime = 99
SuperMoveTime = 99


[State 3000, Dash snd]
type = PlaySnd
Trigger1 = AnimElem = 7
Value = 1050, 0
Channel = 3
IgnoreHitPause = 1

[State 301, Dash]
type = VelSet
Trigger1 = AnimElem = 7
x = 8.5

[State 301, Dash]
type = VelMul
Trigger1 = AnimElem = 8, >= 0
x = .82

[State 3100, First Hits]
Type = HitDef
Trigger1 = prevStateNo != [3000,3999]
Trigger1 = AnimElem = 7
attr = S, HA
damage = 0
animtype = Heavy
Fall.animtype = Heavy
getpower = 0,0
givepower = 0,15
guardflag =
hitflag = MA
pausetime = 3,12
sparkno = -1
guard.sparkno = S8012
sparkxy = -15,-70
hitsound = -1
guardsound = S6,0
ground.type = Low
ground.slidetime = 17
ground.hittime  = 17
air.hittime = 30
guard.slidetime = 17
guard.hittime = 17
guard.ctrltime = 17
guard.velocity = -9.5
ground.velocity = 0
ground.cornerpush.veloff = 0;0
guard.cornerpush.veloff = 0;-11.3
air.velocity = -5,-5.5
yAccel = .5
Fall = 1
Fall.Recover = !var(55)
Fall.RecoverTime = 35
ID = 4100
Kill = 0
Guard.kill = 1
NoChainID = 1210

[State 3100, First Hits]
Type = HitDef
Trigger1 = prevStateNo = [3000,3999]
Trigger1 = AnimElem = 7
attr = S, HA
damage = 0, 50
animtype = Heavy
Fall.animtype = Heavy
getpower = 0,0
givepower = 0,15
guardflag = M
hitflag = MA
pausetime = 3,12
sparkno = -1
guard.sparkno = S8012
sparkxy = -15,-70
hitsound = -1
guardsound = S6,0
ground.type = Low
ground.slidetime = 17
ground.hittime  = 17
air.hittime = 30
guard.slidetime = 17
guard.hittime = 17
guard.ctrltime = 17
guard.velocity = -9.5
ground.velocity = 0
ground.cornerpush.veloff = 0;0
guard.cornerpush.veloff = 0;-11.3
air.velocity = -5,-5.5
yAccel = .5
Fall = 1
Fall.Recover = !var(55)
Fall.RecoverTime = 35
ID = 4100
Kill = 0
Guard.kill = 1
NoChainID = 1210

[State 301, Escape Enemy]
type = targetstate
Trigger1 = MoveHit
trigger1 = Numtarget(4100)
trigger1 = Target, alive
Value = 6200

[State 301, Escape Enemy]
type = Changestate
Trigger1 = MoveHit
trigger1 = Numtarget(4100)
trigger1 = Target, alive
Value = 4110

[State 1000, 9]
type = ChangeState
Trigger1 = !AnimTime
value = 0
Ctrl = 1

;-----------------------------------
;------- Shin Ryuko Rambu Hit ------
;-----------------------------------
[Statedef 4110]
Type = S
MoveType = A
Physics = N
Anim = 4110
Ctrl = 0
PowerAdd = 0
Velset = 0,0

[State 810, Bind 1]
type = NotHitBy
trigger1 = 1
Value = SCA
Ignorehitpause = 1

[State 810, Bind 1]
type = Width
trigger1 = !Time
Edge = 60,0

[State 810, Bind 1]
type = TargetBind
trigger1 = !Time
pos = 60, 0

[State 200, Strong high]
Type = HitDef
Trigger1 = AnimElem = 3
Trigger2 = AnimElem = 8
Trigger3 = AnimElem = 15
Trigger4 = AnimElem = 19
Trigger5 = AnimElem = 25
Trigger6 = AnimElem = 36
attr = S, HA
damage = 40, 4
AnimType = Heavy
getpower = 0,0
givepower = 5,5
Guardflag = M
Hitflag = MAF
pauseTime = 3,3
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,-85+10*(AnimElem = 8 || AnimElem = 15 || AnimElem = 25)
HitSound = S5,4+(AnimElem = 15)
GuardSound = S6,0
ground.Type = High
ground.SlideTime = 20
ground.HitTime  = 20
ground.Velocity = 0
Air.Velocity = 0
Ground.cornerpush.veloff = 0;0
Air.cornerpush.veloff = 0;0
Kill = 0
ID = 3300
EnvShake.Time = 10

[State 200, Strong Low]
Type = HitDef
Trigger1 = AnimElem = 31
Trigger2 = AnimElem = 79
attr = S, HA
damage = 40, 4
AnimType = Heavy
getpower = 0,0
givepower = 3,1
Guardflag = M
Hitflag = MAF
pauseTime = 3,3
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,-50-20*(AnimElem = 79)
HitSound = S5,5
GuardSound = S6,0
ground.Type = Low
ground.SlideTime = 20
ground.HitTime  = 20
ground.Velocity = 0
Air.Velocity = 0
Ground.cornerpush.veloff = 0;0
Air.cornerpush.veloff = 0;0
Kill = 0
ID = 3300
EnvShake.Time = 10

[State 200, Finisher]
Type = HitDef
Trigger1 = AnimElem = 41
attr = S, HA
damage = 40, 4
AnimType = Heavy
getpower = 0,0
givepower = 3,1
Guardflag = M
Hitflag = MAF
pauseTime = 3,15
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,-85
HitSound = S5,6
GuardSound = S6,0
ground.Type = High
ground.SlideTime = 17
ground.HitTime  = 17
ground.Velocity = 0
Air.Velocity = 0
Ground.cornerpush.veloff = 0;0
Air.cornerpush.veloff = 0;0
Kill = 0
ID = 3300
EnvShake.Time = 15

[State 3020, 2]
Type = TargetState
Trigger1 = MoveHit
Trigger1 = Target, StateNo != [6200,6250]
Value = 6200
ignoreHitpause = 1

[State 3020, 2]
Type = MovehitReset
Trigger1 = Movecontact

[State 3020, 2]
Type = Velset
Trigger1 = AnimElem = 48
x = -7

[State 3020, 2]
Type = playSND
Trigger1 = AnimElem = 48
Value = 105,0
Channel = 3

[State 3020, 2]
Type = VelMul
Trigger1 = AnimElem = 49, >= 0
Trigger1 = AnimElem = 50, < 0
x = .8

[State 3020, 2]
Type = VelSet
Trigger1 = AnimElem = 50
x = 0

[State 1000, Karate Voice]
type = PlaySnd
Trigger1 = AnimElem = 50
value = 3000,0
Channel = 1

[State -3, HSK appears]
type = Explod
Trigger1 = AnimElem = 54
anim = 3030
pos = 50,-75
bindtime = 1
ownpal = 1
sprpriority = 3
RemoveonGetHit = 1

[State 1000, Hadouken FX sound]
type = PlaySnd
trigger1 = AnimElem = 55
value = 3050,0
Channel = 3

[State 1000, 3]
type = Projectile
trigger1 = AnimElem = 55
attr = S, HP
ownpal = 1
damage = 235,23
animtype = Up
getpower = 0,0
givepower = 30,15
guardflag = M
hitflag = MAF
pausetime = 3,12
sparkno = S8002
guard.sparkno = S8012
sparkxy = 20,-5
hitsound = S5,7
guardsound = S6,0
ground.type = High
air.type = low
ground.slidetime = 17
ground.hittime  = 17
guard.slidetime = 17
guard.hittime = 17
air.hittime = 30
guard.ctrltime = 17
ground.velocity = -5.5, -8.5
air.velocity = -5.5, -7.5
yaccel = .5
projanim = 3055
projhitanim = 3070
projremanim = 3070
projcancelanim = 3070
velocity = 8
offset = 65,-75
projid = 4250
projpriority = 9999
Fall = 1
Fall.Recover = 0
ID = 1000
EnvShake.time = 15

[State 1000, 9]
type = ChangeState
Trigger1 = !AnimTime
value = 0
Ctrl = 1

;-----------------------------------
;--- Chou Haoh Shikoken startup ----
;-----------------------------------
[Statedef 4200]
Type = S
MoveType = A
Physics = N
Anim = ifelse(var(1) = 1, 3000, 4200+(var(1) = 3))
VelSet = 0, 0
Ctrl = 0
PowerAdd = 0
Juggle = 0

[State 3000,SCancel1]
type = Explod
triggerAll = time = 10
Trigger1 = prevstateno = [1000,2000]
Trigger2 = prevstateno = [200,730]
Trigger2 = var(1) = 3
anim = 11100+10*(prevstateno = 1000)
pos = 65,75
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -1
bindtime = -1
ownpal = 1
removeongethit = 1

[State 3000,SCancel2]
type = Explod
triggerAll = !time
Trigger1 = prevstateno = [1000,2000]
Trigger2 = prevstateno = [200,730]
Trigger2 = var(1) = 3
anim = 11101
pos = 0,75
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -2
bindtime = -1
ownpal = 1
removeongethit = 1

[State 3000,SCancel3]
type = Explod
triggerAll = !time
Trigger1 = prevstateno = [1100,2000]
Trigger2 = prevstateno = [200,730]
Trigger2 = var(1) = 3
anim = 11102
pos = 0,75
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -3
bindtime = -1
ownpal = 1
removeongethit = 1


[State 3000,Dcancel1]
type = Explod
trigger1 = !time && prevstateno = [3000,4000]
anim = 11200
pos = 0,85
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -1
bindtime = -1
ownpal = 1
removeongethit = 1

[State 3000,Dcancel2]
type = Explod
trigger1 = !time && prevstateno = [3000,4000]
anim = 11201
pos = 0,85
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -2
bindtime = -1
ownpal = 1
removeongethit = 1

[State 3000,Dcancel3]
type = Explod
trigger1 = !time && prevstateno = [3000,4000]
anim = 11202
pos = 0,85
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -3
bindtime = -1
ownpal = 1
removeongethit = 1

[State -1, Cancel Combo]
Type = Poweradd
TriggerAll = !time
Trigger1 = prevstateno = [1000, 3999]
Trigger2 = prevstateno = [200,730]
Trigger2 = var(1) = 3
IgnoreHitPause = 1
value = -1000

[State 3000, PALFX]
type = PalFX
TriggerAll = gametime%2 = 0
TriggerAll = time <= 15
Trigger1 = prevstateno = [1000, 3999]
Trigger2 = prevstateno = [200,730]
Trigger2 = var(1) = 3
time = 1
add = 255,255,255
sinadd = -100,-100,-100, 2
ignorehitpause = 1

[State 3000, SDM Set]
Type = AssertSpecial
Trigger1 = AnimElem = 1, = 1
Flag = NoBG
Flag2 = NoFG
time = 26+16*((PrevStateNo = [1000, 3999]) || (var(1) = 3 && prevStateNo = [200,730]))

[State 3000, SDM Set]
Type = EnvColor
Trigger1 = AnimElem = 1, = 1
Value = 255*(prevstateno = [1000,1010]),0,0
Under = 1
time = 26+16*((PrevStateNo = [1000, 3999]) || (var(1) = 3 && prevStateNo = [200,730]))

[State 1000, buffer setting2]
Type = varSet
Trigger1 = !Time
Trigger1 = helper(2000),var(2) >= helper(2000), var(1)
Trigger1 = helper(2000),var(2) >= helper(2000), var(3)
var(2) = 1

[State 1000, buffer setting1]
Type = varSet
Trigger1 = !Time
Trigger1 = helper(2000),var(1) >= helper(2000), var(2)
Trigger1 = helper(2000),var(1) >= helper(2000), var(3)
var(2) = 0

[State 1000, buffer setting3]
Type = varSet
Trigger1 = !Time
Trigger1 = helper(2000),var(3) >= helper(2000), var(1)
Trigger1 = helper(2000),var(3) >= helper(2000), var(2)
var(2) = 2

[State 1000, power Set]
Type = varSet
TriggerAll = !Time
Trigger1 = command = "x"
Trigger2 = command = "y"
Trigger3 = command = "z"
var(2) = IfElse((command = "z"||var(9)),2,IfElse(Command = "x",0,1))

[State 1000, power Set]
Type = varSet
Trigger1 = !Time
Trigger1 = var(9)
Trigger1 = prevStateNo = [1000,1999]
var(2) = 0

[State 3000, SDM Set]
Type = BgPalFx
Trigger1 = var(1) = 3
InvertAll = 1
Color = 6
Time = 3
IgnoreHitPause = 1

[State 3020, After Set]
type = AfterImagetime
trigger1 = 1
time = 2
ignorehitpause = 1

[State 3000, SDM Set]
Type = PowerAdd
Trigger1 = !Time
Trigger1 = !var(15)
value = -2000+1000*(prevstateNo = [3000,3999])

[State 3000, SDM Set]
Type = VarSet
Trigger1 = !Time
var(15) = 1

[State 1000, Invincible]
type = NotHitBy
Trigger1 = animelem = 8, <= -1
value = SCA
IgnoreHitPause = 1

[State 3000,HSDM BG]
type = Helper
trigger1 = time = 28
trigger1 = var(1) != 3
stateno = 9994
Ownpal = 1
pos = 0,0
name = "HSDM BG"
id = 9994
IgnoreHitPause = 1

[State 3000, DM Pause]
type = superpause
trigger1 = animelem = 1, = 1
time = 26+16*((PrevStateNo = [1000, 3999]) || (var(1) = 3 && prevStateNo = [200,730]))
anim = -1
darken = 1
poweradd = -1000
movetime = 26
persistent = 0
ontop = 1
p2defmul = 1

[State 1000, Karate Voice]
type = PlaySnd
Trigger1 = var(1) = 2
Trigger1 = AnimElem = 2
value = 4200,0
Channel = 1

[State 3000, Ashura FX SND]
type = PlaySnd
Trigger1 = AnimElem = 1, = 1
Value = 8000, 2-(var(1) = 3)
Channel = 5
IgnoreHitPause = 1

[State 1000, Karate Voice]
type = PlaySnd
Trigger1 = var(1) = 1
Trigger1 = AnimElem = 2
value = 3000,0
Channel = 1

[State 3000, DM FX1]
Type = Explod
trigger1 = animelem = 1, = 1
anim = 8120-10*(var(1) = 3)
PosType = p1
Ownpal = 1
SprPriority = -2
BindTime = -1
IgnoreHitPause = 1
Pos = -45+55*(var(1) != 1),-55-30*(var(1) != 1)
RemoveOnGetHit = 1
PauseMoveTime = 99
SuperMoveTime = 99

[State 3000, DM FX 2]
Type = Explod
trigger1 = animelem = 1, = 1
anim = 8121-10*(var(1) = 3)
PosType = p1
Ownpal = 1
SprPriority = 2
BindTime = -1
IgnoreHitPause = 1
Pos = -45+55*(var(1) != 1),-55-30*(var(1) != 1)
RemoveOnGetHit = 1
PauseMoveTime = 99
SuperMoveTime = 99

[State 1000, Posadds]
type = PosAdd
Trigger1 = AnimElem = 3
x = -20

[State 1000, Posadds]
type = PosAdd
Trigger1 = AnimElem = 4
x = -10

[State 1000, Posadds]
type = PosAdd
Trigger1 = AnimElem = 5
x = -5

[State 1000, 9]
type = VarSet
trigger1 = !Time
var(4) = 0

[State 1000, 9]
type = VarAdd
triggerAll = var(1) = 3
trigger1 = Time = 60
trigger2 = Time = 73
trigger3 = Time = 86
trigger4 = Time = 99
trigger5 = Time = 110
var(4) = 1

[State 1000, 9]
type = ChangeState
triggerAll = AnimElem = 8, >= -1
triggerAll = var(9)
trigger1 = Time >= 110
trigger2 = prevStateNo = 1450
trigger2 = time >= 57
trigger3 = var(1) = 2 || var(1) = 4
trigger3 = NumTarget(1210)
trigger3 = prevStateNo = 160
trigger4 = p2StateNo = 5120
trigger4 = EnemyNear, AnimTime = [-36,-26]
trigger5 = p2StateType != L
trigger5 = p2StateType != A
trigger6 = p2MoveType = A
trigger7 = p2StateType = A
trigger7 = p2MoveType != H
trigger8 = p2StateNo = 40
trigger9 = p2StateType != A
trigger9 = p2StateType != L
trigger9 = p2MoveType = H
trigger10 = time >= 63
trigger10 = prevStateNo = 1100 || prevStateNo = 1800
trigger11 = var(1) = 1
value = 4210+10*(var(1) = 1)

[State 1000, 9]
type = ChangeState
triggerAll = AnimElem = 8, >= -1
triggerAll = !var(9)
trigger1 = Time >= 110
trigger2 = Command != "holdx"
trigger2 = Command != "holdy"
trigger2 = Command != "holdz"
trigger3 = var(1) = 1
value = 4210+10*(var(1) = 1)

;-----------------------------------
;---- Chou Haoh Shikoken launch ----
;-----------------------------------
[Statedef 4210]
Type = S
MoveType = A
Physics = S
Anim = 4210
VelSet = 0, 0
Ctrl = 0
PowerAdd = 0
SprPriority = 1

[State 3000, SDM Set]
Type = BgPalFx
Trigger1 = var(1) = 3
InvertAll = 1
Color = 6
Time = 3
IgnoreHitPause = 1

[State 1000, Karate Voice]
type = PlaySnd
Trigger1 = AnimElem = 1, = 1
value = 4200,(var(1) = 3)+1
Channel = 1

[State 1000, Invincible]
type = NotHitBy
Trigger1 = !var(4)
Trigger1 = var(1) = 2
Trigger1 = animelem = 10, < 0
value = SCA
IgnoreHitPause = 1

[State 1000, Posadds]
type = PosAdd
Trigger1 = AnimElem = 3
x = 37

[State 1000, Posadds]
type = PosAdd
TriggerAll = var(1) = 3
Trigger1 = AnimElem = 6
Trigger2 = AnimElem = 12
x = 25

[State 1000, Hadouken FX sound]
type = PlaySnd
trigger1 = AnimElem = 3, = 1
trigger2 = var(2)
trigger2 = AnimElem = 8, = 1
trigger3 = var(2)
trigger3 = AnimElem = 14, = 1
value = 3050,0
Channel = 3

[State 1000, 3]
type = Projectile
trigger1 = AnimElem = 3, = 1
trigger2 = AnimElem = 9, = 1
attr = S, HP
ownpal = 1
damage = 200-96*(var(1) = 3),20-10*(var(1) = 3)
animtype = High
getpower = 0,0
givepower = 30,15
guardflag = M
hitflag = MA
pausetime = 3,12
sparkno = S8002
guard.sparkno = S8012
sparkxy = 20,-5
hitsound = S5,6
guardsound = S6,0
ground.type = High
air.type = low
ground.slidetime = 17
ground.hittime  = 17
guard.slidetime = 17
guard.hittime = 17
air.hittime = 30
guard.ctrltime = 17
ground.velocity = 0
air.velocity = -4.5, -5.5
yaccel = .5
projanim = 4250
projhitanim = 3070
projremanim = 3070
projcancelanim = 3070
velocity = 6+4*var(2)
offset = 65,-75
projid = 4000
projpriority = 9999
Air.Fall = 1
Fall.Recover = 0
ID = 1000
EnvShake.time = 15
ProjHits = 1+(var(1) = 3)

[State 1000, 3]
type = Projectile
triggerAll = AnimElem = 15, = 1
trigger1 = var(1) = 2
trigger2 = var(1) = 3
trigger2 = var(4) < 5
attr = S, HP
ownpal = 1
damage = 133-103*(var(1) = 3),13-10*(var(1) = 3)
animtype = DiagUp
getpower = 0,0
givepower = 30,15
guardflag = M
hitflag = MA
pausetime = 3,12
sparkno = S8002
guard.sparkno = S8012
sparkxy = 20,-5
hitsound = S5,7
guardsound = S6,0
ground.type = High
air.type = low
ground.slidetime = 17
ground.hittime  = 17
guard.slidetime = 17
guard.hittime = 17
air.hittime = 30
guard.ctrltime = 17
ground.velocity = -5.5, -8.5
guard.velocity = -10
air.velocity = -5.5, -7.5
yaccel = .5
projanim = 4250
projhitanim = 3070
projremanim = 3070
projcancelanim = 3070
velocity = 6+4*var(2)
offset = 65,-75
projid = 4250
projpriority = 9999
Fall = 1
Fall.Recover = 0
ID = 1000
EnvShake.time = 15
ProjHits = 1+(var(1) = 3)

[State 1000, 3]
type = Projectile
trigger1 = AnimElem = 15, = 1
trigger1 = var(1) = 3
trigger1 = var(4) >= 5
attr = S, HP
ownpal = 1
damage = 30,3
animtype = DiagUp
getpower = 0,0
givepower = 30,15
guardflag =
hitflag = MA
pausetime = 3,12
sparkno = S8002
guard.sparkno = S8012
sparkxy = 20,-5
hitsound = S5,7
guardsound = S6,0
ground.type = High
air.type = low
ground.slidetime = 17
ground.hittime  = 17
guard.slidetime = 17
guard.hittime = 17
air.hittime = 30
guard.ctrltime = 17
ground.velocity = -5.5, -8.5
air.velocity = -5.5, -7.5
yaccel = .5
projanim = 4250
projhitanim = 3070
projremanim = 3070
projcancelanim = 3070
velocity = 6+4*var(2)
offset = 65,-75
projid = 4250
projpriority = 9999
Fall = 1
Fall.Recover = 0
ID = 1000
EnvShake.time = 15
ProjHits = 2

[State 1000, 9]
type = ChangeState
trigger1 = !AnimTime
value = 0
ctrl = 1

;-----------------------------------
;---- Suburu Ou Shikoken launch ----
;-----------------------------------
[Statedef 4220]
Type = S
MoveType = A
Physics = S
Anim = 4220
VelSet = 0
Ctrl = 0
PowerAdd = 0
SprPriority = 1

[State 1000, Hadouken FX sound]
type = PlaySnd
trigger1 = AnimElem = 1
value = 4100,0
Channel = 2

[State 1000, Hadouken FX sound]
type = PlaySnd
trigger1 = AnimElem = 5
value = 3050,0
Channel = 3

[State 1000, Posadds]
type = PosAdd
Trigger1 = AnimElem = 9
x = 37

[State 1000, 9]
type = varset
Trigger1 = !Time
Trigger2 = AnimElem = 20
var(7) = 0
ignorehitpause = 1

[State 1000, 9]
type = varset
Trigger1 = AnimElem = 11, >= 0
Trigger1 = AnimElem = 20, < 0
var(7) = 1
ignorehitpause = 1

[State 3000, DM FX 2]
Type = Explod
trigger1 = AnimElem = 3
anim = 4230
ID = 4230
PosType = p1
Ownpal = 1
SprPriority = -3
BindTime = 1
IgnoreHitPause = 1
Pos = 0,0

[State 3000, DM FX 2]
Type = Explod
trigger1 = AnimElem = 10
anim = 4235
ID = 4235
PosType = p1
Ownpal = 1
SprPriority = 5
BindTime = -1
IgnoreHitPause = 1
Pos = 0,0
removetime = -1

[State 1100, Hit]
Type = Projectile
TriggerAll = !Numtarget(1210)
Trigger1 = AnimElem = 11
Trigger2 = AnimElem = 13
Trigger3 = AnimElem = 15
Trigger4 = AnimElem = 17
Trigger5 = AnimElem = 19
attr = S, HP
damage = 50, 5
animtype = Heavy
Fall.animtype = Heavy
getpower = 0,0
givepower = 5,3
guardflag = M
hitflag = MAFD
pausetime = 0,1
sparkno = S8002
guard.sparkno = S8012
sparkxy = 15+ceil(p2dist x),-85
hitsound = S5,4
guardsound = S6,0
ground.type = High
ground.SlideTime = 17
ground.hittime  = 20
guard.slidetime = 15
guard.hittime = 15
guard.ctrltime = 15
guard.velocity = 0
ground.velocity = 0
ground.cornerpush.veloff = 0;0
guard.cornerpush.veloff = 0;0
air.velocity = 0, -5
yaccel = .5
projanim = 4260
projhitanim = 4260
projremanim = 4260
projcancelanim = 4260
velocity = 0
offset = 0,0
projid = 4000
projpriority = 9999
Projremovetime = 2
Air.fall = 1
fall.recover = 0
ID = 1000

[State 1100, Hit]
Type = Projectile
TriggerAll = !Numtarget(1210)
Trigger1 = AnimElem = 12
Trigger2 = AnimElem = 14
Trigger3 = AnimElem = 16
Trigger4 = AnimElem = 18
attr = S, HP
damage = 50, 5
animtype = Heavy
Fall.animtype = Heavy
getpower = 0,0
givepower = 5,3
guardflag = M
hitflag = MAFD
pausetime = 0,1
sparkno = S8002
guard.sparkno = S8012
sparkxy = 5+ceil(p2dist x),-40
hitsound = S5,2
guardsound = S6,0
ground.type = Low
ground.SlideTime = 17
ground.hittime  = 20
guard.slidetime = 15
guard.hittime = 15
guard.ctrltime = 15
guard.velocity = 0
ground.velocity = 0
ground.cornerpush.veloff = 0;0
guard.cornerpush.veloff = 0;0
air.velocity = 0, -5
yaccel = .5
projanim = 4260
projhitanim = 4260
projremanim = 4260
projcancelanim = 4260
velocity = 0
offset = 0,0
projid = 4000
projpriority = 9999
Projremovetime = 2
Air.fall = 1
fall.recover = 0
ID = 1000

[State 1100, Hit]
Type = Projectile
TriggerAll = !Numtarget(1210)
Trigger1 = AnimElem = 20
attr = S, HP
damage = 100, 5
animtype = diagup
getpower = 0,0
givepower = 5,3
guardflag = M
hitflag = MAFD
pausetime = 0,6
guard.pausetime = 0,6
sparkno = S8002
guard.sparkno = S8012
sparkxy = 20+ceil(p2dist x),-65
hitsound = S5,6
guardsound = S6,0
ground.type = Low
ground.SlideTime = 17
ground.hittime  = 20
guard.slidetime = 15
guard.hittime = 15
guard.ctrltime = 15
guard.velocity = -9
ground.velocity = -5, -7
ground.cornerpush.veloff = 0;0
guard.cornerpush.veloff = 0;0
air.velocity = -5, -6.5
Yaccel = .5
projanim = 4260
projhitanim = 4260
projremanim = 4260
projcancelanim = 4260
velocity = 0
offset = 0,0
projid = 4250
projpriority = 9999
Projremovetime = 2
Fall = 1
Fall.recover = 0
ID = 1000

[State 3000, DM FX 2]
Type = RemoveExplod
trigger1 = AnimElem = 21
ID = 4235

[State 3000, DM FX 2]
Type = Explod
trigger1 = AnimElem = 21
anim = 4236
PosType = p1
Ownpal = 1
SprPriority = 5
BindTime = 1
Pos = 0,0
PauseMoveTime = 99
SuperMoveTime = 99
velocity = 1,0

[State 1000, 9]
type = ChangeState
trigger1 = !AnimTime
value = 0
ctrl = 1

;-----------------------------------
;-------- Chou Ryuko Rambu ---------
;-----------------------------------
[Statedef 4300]
Type = S
MoveType = A
Physics = N
Anim = 4300
VelSet = 0, 0
Ctrl = 0
PowerAdd = 0
Juggle = 8

[State 3000,SCancel1]
type = Explod
triggerAll = time = 16
Trigger1 = prevstateno = [200,730]
Trigger2 = prevstateno = [1000,2000]
anim = 11100+10*(prevstateno = [1000,1010])
pos = 65,75
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -1
bindtime = -1
ownpal = 1
removeongethit = 1

[State 3000,SCancel2]
type = Explod
triggerAll = Time = 6
Trigger1 = prevstateno = [200,730]
Trigger2 = prevstateno = [1000,2000]
anim = 11101
pos = 0,75
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -2
bindtime = -1
ownpal = 1
removeongethit = 1

[State 3000,SCancel3]
type = Explod
triggerAll = time = 6
Trigger1 = prevstateno = [200,730]
Trigger2 = prevstateno = [1100,2000]
anim = 11102
pos = 0,75
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -3
bindtime = -1
ownpal = 1
removeongethit = 1

[State 3000,Dcancel1]
type = Explod
trigger1 = time = 6 && prevstateno = [3000,4000]
anim = 11200
pos = 0,85
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -1
bindtime = -1
ownpal = 1
removeongethit = 1

[State 3000,Dcancel2]
type = Explod
trigger1 = time = 6 && prevstateno = [3000,4000]
anim = 11201
pos = 0,85
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -2
bindtime = -1
ownpal = 1
removeongethit = 1

[State 3000,Dcancel3]
type = Explod
trigger1 = time = 6 && prevstateno = [3000,4000]
anim = 11202
pos = 0,85
postype = left
supermove = 1
supermovetime = 9999
sprpriority = -3
bindtime = -1
ownpal = 1
removeongethit = 1

[State -1, Cancel Combo]
Type = Poweradd
triggerAll = !time
Trigger1 = prevstateno = [200,730]
Trigger2 = prevstateno = [1000,3999]
IgnoreHitPause = 1
value = -1000

[State 3000, PALFX]
type = PalFX
TriggerAll = gametime%2 = 0
TriggerAll = time <= 15
Trigger1 = prevstateno = [200,730]
Trigger2 = prevstateno = [1000,3999]
ignorehitpause = 1
time = 1
add = 255,255,255
sinadd = -100,-100,-100, 2
ignorehitpause = 1

[State 3000, SDM Set]
Type = AssertSpecial
Trigger1 = AnimElem = 2
Flag = NoBG
Flag2 = NoFG
time = 26+16*((prevStateNo = [200,730]) || (PrevStateNo = [1000, 3999]))

[State 3000, SDM Set]
Type = EnvColor
Trigger1 = AnimElem = 2
Value = 255*(prevstateno = [1000,1010]),0,0
Under = 1
time = 26+16*((prevStateNo = [200,730]) || (PrevStateNo = [1000, 3999]))

[State 3000, After]
type = AfterImage
trigger1 = AnimElem = 5
time = 2
palmul = .65,.65,.75
palbright = 30,30,30
palcontrast = 120,120,220
timegap = 1
framegap = 3
length = 10
Trans = add1
color = 6

[State 3020, After Set]
type = AfterImagetime
trigger1 = AnimElem = 5, > 0
time = 2
ignorehitpause = 1

[State 3000, SDM Set]
Type = PowerAdd
Trigger1 = !Time
value = -1000

[State 3000, SDM Set]
Type = PowerAdd
Trigger1 = !Time
Trigger1 = !var(15)
value = -1000-1000*(prevStateNo != [3000,4000])

[State 3000, SDM Set]
Type = VarSet
Trigger1 = !Time
var(15) = 1

[State 3000,HSDM BG]
type = Helper
trigger1 = Time = 35
stateno = 9994
Ownpal = 1
pos = 0,0
name = "HSDM BG"
id = 9994
IgnoreHitPause = 1

[State 3000, DM Pause]
type = superpause
trigger1 = animelem = 2
time = 26+16*((prevStateNo = [200,730]) || (PrevStateNo = [1000, 3999]))
anim = -1
darken = 1
poweradd = 0
movetime = 26
persistent = 0
ontop = 1
p2defmul = 1

[State 3000, Takuma voice]
type = PlaySnd
Trigger1 = AnimElem = 2
Value = 4300,0
Channel = 1
IgnoreHitPause = 1

[State 3000, DM FX SND]
type = PlaySnd
Trigger1 = AnimElem = 2
Value = 8000,2
Channel = 5
IgnoreHitPause = 1

[State 3000, DM FX1]
Type = Explod
trigger1 = animelem = 2
anim = 8120
PosType = p1
Ownpal = 1
SprPriority = -2
BindTime = -1
IgnoreHitPause = 1
Pos = 10,-85
RemoveOnGetHit = 1
PauseMoveTime = 99
SuperMoveTime = 99

[State 3000, DM FX 2]
Type = Explod
trigger1 = animelem = 2
anim = 8121
PosType = p1
Ownpal = 1
SprPriority = 2
BindTime = -1
IgnoreHitPause = 1
Pos = 10,-85
RemoveOnGetHit = 1
PauseMoveTime = 99
SuperMoveTime = 99


[State 301, Stateset]
type = StateTypeSet
Trigger1 = AnimElem = 5
StateType = A

[State 3000, Dash snd]
type = PlaySnd
Trigger1 = AnimElem = 5
Value = 50, 1
Channel = 3
IgnoreHitPause = 1

[State 301, Dash]
type = VelSet
Trigger1 = AnimElem = 5
x = 10
y = -1.5

[State 301, Gravity]
type = VelAdd
Trigger1 = AnimElem = 5, > 0
y = .1

[State 3100, First Hits]
Type = HitDef
Trigger1 = AnimElem = 5
attr = S, HA
damage = 0
animtype = Heavy
Fall.animtype = Heavy
getpower = 0,0
givepower = 0,15
guardflag =
hitflag = MA
pausetime = 3,12
sparkno = S8002
guard.sparkno = S8012
sparkxy = -15,-70
hitsound = S5,4
guardsound = S6,0
ground.type = Low
ground.slidetime = 17
ground.hittime  = 17
air.hittime = 30
guard.slidetime = 17
guard.hittime = 17
guard.ctrltime = 17
guard.velocity = -9.5
ground.velocity = 0
ground.cornerpush.veloff = 0;0
guard.cornerpush.veloff = 0;-11.3
air.velocity = -5,-5.5
yAccel = .5
Fall = 1
Fall.Recover = !var(55)
Fall.RecoverTime = 35
ID = 4300
Kill = 0
guard.kill = 1
NoChainID = 1210

[State 301, Escape Enemy]
type = targetstate
Trigger1 = MoveHit
trigger1 = Numtarget(4300)
trigger1 = Target, alive
Value = 6200

[State 301, Escape Enemy]
type = Changestate
Trigger1 = MoveHit
trigger1 = Numtarget(4300)
trigger1 = Target, alive
Value = 4310

[State 1000, 9]
type = ChangeState
Trigger1 = !AnimTime
Trigger2 = Moveguarded
Trigger3 = MoveHit
trigger3 = !Numtarget(4300)
Trigger4 = MoveHit
trigger4 = Numtarget(4300)
trigger4 = !Target, alive
value = 3310

;-----------------------------------
;------- Ryuko Rambu SDM Hit -------
;-----------------------------------
[Statedef 4310]
Type = S
MoveType = A
Physics = N
Anim = 4310
VelSet = 0, 0
Ctrl = 0
PowerAdd = 0

[State 1000, 9]
type = Posset
Trigger1 = !Time
y = 0

[State 810, Bind 1]
type = NotHitBy
trigger1 = 1
Value = SCA
Ignorehitpause = 1

[State 810, Bind 1]
type = Width
trigger1 = !Time
Edge = 65,0

[State 810, Bind 1]
type = TargetBind
trigger1 = AnimElem = 1
pos = 65, 0

[State 200, light low]
Type = HitDef
Trigger1 = AnimElem = 5
attr = S, HA
damage = 24, 2
AnimType = Light
getpower = 0,0
givepower = 3,1
Guardflag = M
Hitflag = MAF
pauseTime = 1,1
SparkNo = S8000
Guard.SparkNo = S8010
sparkxy = -15,-60
HitSound = S5,0
GuardSound = S6,0
ground.Type = low
ground.SlideTime = 20
ground.HitTime  = 20
ground.Velocity = 0
Air.Velocity = 0
Ground.cornerpush.veloff = 0;0
Air.cornerpush.veloff = 0;0
Kill = 0
ID = 3300

[State 200, light high]
Type = HitDef
Trigger1 = AnimElem = 7
Trigger2 = AnimElem = 31
Trigger3 = AnimElem = 57
Trigger4 = AnimElem = 89
attr = S, HA
damage = 20, 2
AnimType = Light
getpower = 0,0
givepower = 3,1
Guardflag = M
Hitflag = MAF
pauseTime = 1,1
SparkNo = S8000
Guard.SparkNo = S8010
sparkxy = -15,-85-15*(AnimElem = 89)+15*(AnimElem = 57)
HitSound = S5,(AnimElem = 56, > 0)
GuardSound = S6,0
ground.Type = High
ground.SlideTime = 20
ground.HitTime  = 20
ground.Velocity = 0
Air.Velocity = 0
Ground.cornerpush.veloff = 0;0
Air.cornerpush.veloff = 0;0
Kill = 0
ID = 3300

[State 200, medium Low]
Type = HitDef
Trigger1 = AnimElem = 41
Trigger2 = AnimElem = 49
Trigger3 = AnimElem = 83
Trigger4 = AnimElem = 99
attr = S, HA
damage = 20, 2
AnimType = Medium
getpower = 0,0
givepower = 3,1
Guardflag = M
Hitflag = MAF
pauseTime = 1,1
SparkNo = S8001
Guard.SparkNo = S8011
sparkxy = -15,-90+25*(AnimElem = 48, > 0 && AnimElem = 99, < 0)
HitSound = S5,2+(AnimElem = 48, > 0 && AnimElem = 99, < 0)
GuardSound = S6,0
ground.Type = High
ground.SlideTime = 20
ground.HitTime  = 20
ground.Velocity = 0
Air.Velocity = 0
Ground.cornerpush.veloff = 0;0
Air.cornerpush.veloff = 0;0
Kill = 0
ID = 3300

[State 200, medium High]
Type = HitDef
Trigger1 = AnimElem = 53
attr = S, HA
damage = 20, 2
AnimType = Medium
getpower = 0,0
givepower = 3,1
Guardflag = M
Hitflag = MAF
pauseTime = 1,1
SparkNo = S8001
Guard.SparkNo = S8011
sparkxy = -15,-85
HitSound = S5,2
GuardSound = S6,0
ground.Type = High
ground.SlideTime = 20
ground.HitTime  = 20
ground.Velocity = 0
Air.Velocity = 0
Ground.cornerpush.veloff = 0;0
Air.cornerpush.veloff = 0;0
Kill = 0
ID = 3300

[State 200, Strong high]
Type = HitDef
Trigger1 = AnimElem = 12
Trigger2 = AnimElem = 17
Trigger3 = AnimElem = 36
Trigger4 = AnimElem = 63
Trigger5 = AnimElem = 67
Trigger6 = AnimElem = 106
attr = S, HA
damage = 20, 2
AnimType = Heavy
getpower = 0,0
givepower = 3,1
Guardflag = M
Hitflag = MAF
pauseTime = 1,1
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,-75-5*(animElem = 17 || AnimElem = 63)-10*(AnimElem = 67 || AnimElem = 106)
HitSound = S5,4+2*(AnimElem = 106)
GuardSound = S6,0
ground.Type = High
ground.SlideTime = 20
ground.HitTime  = 20
ground.Velocity = 0
Air.Velocity = 0
Ground.cornerpush.veloff = 0;0
Air.cornerpush.veloff = 0;0
Kill = 0
ID = 3300

[State 200, Strong Low]
Type = HitDef
Trigger1 = AnimElem = 24
Trigger2 = AnimElem = 79
attr = S, HA
damage = 20, 2
AnimType = Heavy
getpower = 0,0
givepower = 3,1
Guardflag = M
Hitflag = MAF
pauseTime = 1,1
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,-50-20*(AnimElem = 79)
HitSound = S5,4+2*(AnimElem = 79)
GuardSound = S6,0
ground.Type = High
ground.SlideTime = 20
ground.HitTime  = 20
ground.Velocity = 0
Air.Velocity = 0
Ground.cornerpush.veloff = 0;0
Air.cornerpush.veloff = 0;0
Kill = 0
ID = 3300

[State 200, Finisher]
Type = HitDef
Trigger1 = AnimElem = 107
attr = S, HA
damage = 20, 2
AnimType = Heavy
getpower = 0,0
givepower = 3,1
Guardflag = M
Hitflag = MAF
pauseTime = 10,15
SparkNo = S8002
Guard.SparkNo = S8012
sparkxy = -15,-85
HitSound = S5,6
GuardSound = S6,0
ground.Type = High
ground.SlideTime = 17
ground.HitTime  = 17
ground.Velocity = 0
Air.Velocity = 0
Ground.cornerpush.veloff = 0;0
Air.cornerpush.veloff = 0;0
Kill = 0
ID = 3300

[State 3020, 2]
Type = TargetState
Trigger1 = MoveHit
Trigger1 = Target, StateNo != [6200,6250]
Value = 6200
ignoreHitpause = 1

[State 3020, 2]
Type = StateTypeSet
Trigger1 = AnimElem = 111, = 3
StateType = A
ignoreHitpause = 1

[State 3020, 2]
Type = Velset
Trigger1 = AnimElem = 111, = 3
x = -9
y = -4

[State 3020, 2]
Type = playSND
Trigger1 = AnimElem = 111, = 3
Value = 105,0
Channel = 3

[State 3020, 2]
Type = gravity
Trigger1 = AnimElem = 111, > 3

[State 3000, After]
type = AfterImage
trigger1 = AnimElem = 112
time = 2
palmul = .65,.65,.75
palbright = 30,30,30
palcontrast = 120,120,220
timegap = 1
framegap = 3
length = 10
Trans = add1
color = 6

[State 3020, After Set]
type = AfterImagetime
trigger1 = AnimElem = 112, > 0
time = 2
ignorehitpause = 1

[State 3020, 2]
Type = MovehitReset
Trigger1 = Movecontact

[State 1000, 9]
type = ChangeState
Trigger1 = pos y >= 0
Trigger1 = vel y > 0
trigger1 = AnimElem = 112, > 0
value = 4320

;-----------------------------------
;-------- Ryuko Rambu Finish -------
;-----------------------------------
[Statedef 4320]
Type = S
MoveType = A
Physics = S
Anim = 3361
VelSet = vel x, 0
Ctrl = 0
PowerAdd = 0
SprPriority = 1

[State 1000, Karate Voice]
type = PlaySnd
Trigger1 = AnimElem = 1, = 1
value = 4300,1
Channel = 1

[State 1000, Hadouken FX sound]
type = PlaySnd
trigger1 = AnimElem = 3, = 1
trigger2 = var(2)
trigger2 = AnimElem = 8, = 1
trigger3 = var(2)
trigger3 = AnimElem = 14, = 1
value = 3050,0
Channel = 3

[State 1000, 3]
type = Projectile
trigger1 = AnimElem = 3, = 1
trigger2 = AnimElem = 8, = 1
attr = S, HP
ownpal = 1
damage = 28,3
animtype = High
getpower = 0,0
givepower = 30,15
guardflag = M
hitflag = MAF
pausetime = 3,12
sparkno = S8002
guard.sparkno = S8012
sparkxy = 20,-5
hitsound = S5,6
guardsound = S6,0
ground.type = High
air.type = low
ground.slidetime = 17
ground.hittime  = 17
guard.slidetime = 17
guard.hittime = 17
air.hittime = 30
guard.ctrltime = 17
ground.velocity = 0
air.velocity = -4.5, -5.5
yaccel = .5
projanim = 4250
projhitanim = 3070
projremanim = 3070
projcancelanim = 3070
velocity = 12
offset = 65,-75
projid = 4000
projpriority = 9999
Air.Fall = 1
Fall.Recover = 0
ID = 1000
EnvShake.time = 15
ProjHits = 2

[State 1000, 3]
type = Projectile
trigger1 = AnimElem = 14, = 1
attr = S, HP
ownpal = 1
damage = 30,3
animtype = DiagUp
getpower = 0,0
givepower = 30,15
guardflag = M
hitflag = MAF
pausetime = 3,12
sparkno = S8002
guard.sparkno = S8012
sparkxy = 20,-5
hitsound = S5,7
guardsound = S6,0
ground.type = High
air.type = low
ground.slidetime = 17
ground.hittime  = 17
guard.slidetime = 17
guard.hittime = 17
air.hittime = 30
guard.ctrltime = 17
ground.velocity = -5.5, -7.5
air.velocity = -5.5, -6.5
yaccel = .5
projanim = 4250
projhitanim = 3070
projremanim = 3070
projcancelanim = 3070
velocity = 12
offset = 65,-75
projid = 4250
projpriority = 9999
Fall = 1
Fall.Recover = 0
ID = 1000
EnvShake.time = 15
ProjHits = 2

[State 1000, 9]
type = ChangeState
trigger1 = !AnimTime
value = 0
ctrl = 1

;============================================================================
; Custom Gethit States
;============================================================================
;-----------------------------------
;----------- Guard Kill ------------
;-----------------------------------
[Statedef 5950]
type = U
movetype = H
physics = S
ctrl = 0
velset = 0, 0

[State 5950,Invincible]
type = NotHitBy
trigger1 = 1
value = SCA

[State 5950, GUARDING]
type = ChangeAnim
trigger1 = !HitOver
value = 150+var(27)

[State 5950, collapse]
type = ChangeAnim
Trigger1 = HitOver
Trigger1 = anim != 5950
value = 5950

[State 5950, Ouch]
type = PalFX
trigger1 = anim = 5950
trigger1 = AnimElem = 1
time = 1

[State 5950, Ouch]
type = PlaySnd
trigger1 = anim = 5950
trigger1 = AnimElem = 1
value = 5000+(var(1) > 1), 3

[State 5950, dead]
type = ChangeState
Trigger1 = AnimElem = 9
trigger1 = anim = 5950
value = 5150
ctrl = 0

;-----------------------------------
;-------- Juggle Type Fall ---------
;-----------------------------------
[Statedef 6000]
type    = A
movetype= H
physics = N
velset = 0,0

[State 6000, Change by HitType1]
type = ChangeAnim
trigger1 = !Time
trigger1 = GetHitVar(animtype) != [3,5]
value = ifelse((GetHitVar(airtype) = 1),5000,5010) + GetHitVar(animtype)

[State 6000, Change by HitType2]
type = ChangeAnim
trigger1 = !Time
trigger1 = GetHitVar(animtype) = [3,5]
value = 5012

[State 6000, Change by HitType3]
type = ChangeAnim
trigger1 = !Time
trigger1 = (GetHitVar(animtype) = [4,5]) && (SelfAnimExist(5047 + GetHitVar(animtype)))
value = 5047 + GetHitVar(animtype) ;5051 - 4 + type

[State 6000, Change by HitType4]
type = ChangeAnim
trigger1 = Time > 0
value = anim

[State 6000, NOT Falling]
type = hitfallset
trigger1 = Time > 0
value = 0
ignorehitpause = 1

[State 6000, end]
type = ChangeState
trigger1 = HitShakeOver
value = 6001

[State 6000, FFB Light]
type = ForceFeedback
trigger1 = anim = 5000
trigger2 = anim = 5010
persistent = 0
time = 6
waveform = square

[State 6000, FFB Medium]
type = ForceFeedback
trigger1 = anim = 5001
trigger2 = anim = 5011
persistent = 0
time = 8
waveform = sinesquare
ampl = 110,-1,-.3

[State 6000, FFB Hard]
type = ForceFeedback
trigger1 = anim = 5012
trigger2 = anim = 5002
trigger3 = anim = 5030
trigger4 = anim = [5051,5059]
persistent = 0
time = 15
waveform = sinesquare
ampl = 140

;---------------------------------------------------------------------------
[Statedef 6001]
type    = A
movetype= H
physics = N
ctrl = 0

[State 6001, NOT Falling]
type = hitfallset
trigger1 = !Time
value = 0
ignorehitpause = 1

[State 6001, Change by HitType1]
type = Changeanim
trigger1 = !Time
trigger1 = anim = 5012
value = 5030

[State 6001, HitVelAdd]
type = VelAdd
trigger1 = 1
y = GetHitVar(yaccel)

[State 6001, HitVelSet]
type = HitVelSet
trigger1 = !Time
x = 1
y = 1

[State 6000, End]
type = SelfState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
value = 5100

[State 6001, end2]
type = ChangeState
trigger1 = AnimTime = 0
value = 6002

;---------------------------------------------------------------------------
[Statedef 6002]
type    = A
movetype= H
physics = N

[State 6002, NOT Falling]
type = hitfallset
trigger1 = !Time
value = 0
ignorehitpause = 1


[State 6000, Change by HitType1]
type = ChangeAnim
trigger1 = !Time
trigger1 = SelfAnimExist(5035)
trigger1 = Anim != [5051,5059]
trigger1 = Anim != 5090
value = 5035

[State 6002, HitVelAdd]
type = VelAdd
trigger1 = 1
y = GetHitVar(yaccel)

[State 6000, Falling]
type = hitfallset
trigger1 = Vel Y > 0
trigger1 = Pos Y >= -20
value = 1
ignorehitpause = 1

[State 6000, End]
type = SelfState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
value = 5100

[State 6003, End2]
type = ChangeState
trigger1 = HitOver
trigger2 = AnimTime = 0
trigger3 = Time = 0
trigger3 = Anim != 5035
value = 6003

;---------------------------------------------------------------------------

[Statedef 6003]
type    = A
movetype= H
physics = N

[State 6000, Change by HitType1]
type = ChangeAnim
trigger1 = AnimTime = 0
trigger1 = Anim = 5035
trigger2 = Time = 0
trigger2 = Anim != 5035
trigger2 = (Anim != [5051, 5059]) && (Anim != [5061, 5069])
trigger2 = Anim != 5090
value = 5050

[State 6000, Change by HitType2]
type = ChangeAnim
trigger1 = anim = [5050,5059]
trigger1 = Vel Y >= ifelse(anim = 5050, 1, -2)
trigger1 = SelfAnimExist(anim+10)
value = anim+10
persistent = 0

[State 6003, HitVelAdd]
type = VelAdd
trigger1 = 1
y = GetHitVar(yaccel)

[State 6003, NOT Falling]
type = HitFallSet
trigger1 = !Time
value = 0

[State 6000, End]
type = SelfState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
value = 5100

;-----------------------------------
;----- Juggle Type Fall (proj) -----
;-----------------------------------
[Statedef 6005]
type    = A
movetype= H
physics = N
velset = 0,0

[State 6000, Change by HitType1]
type = ChangeAnim
trigger1 = !Time
trigger1 = GetHitVar(animtype) != [3,5]
value = ifelse((GetHitVar(airtype) = 1),5000,5010) + GetHitVar(animtype)

[State 6000, Change by HitType2]
type = ChangeAnim
trigger1 = !Time
trigger1 = GetHitVar(animtype) = [3,5]
value = 5012

[State 6000, Change by HitType3]
type = ChangeAnim
trigger1 = !Time
trigger1 = (GetHitVar(animtype) = [4,5]) && (SelfAnimExist(5047 + GetHitVar(animtype)))
value = 5047 + GetHitVar(animtype) ;5051 - 4 + type

[State 6000, Change by HitType4]
type = ChangeAnim
trigger1 = Time > 0
value = anim

[State 6000, NOT Falling]
type = hitfallset
trigger1 = Time > 0
value = 0
ignorehitpause = 1

[State 6000, end]
type = ChangeState
trigger1 = HitShakeOver
value = 6006

[State 6000, FFB Light]
type = ForceFeedback
trigger1 = anim = 5000
trigger2 = anim = 5010
persistent = 0
time = 6
waveform = square

[State 6000, FFB Medium]
type = ForceFeedback
trigger1 = anim = 5001
trigger2 = anim = 5011
persistent = 0
time = 8
waveform = sinesquare
ampl = 110,-1,-.3

[State 6000, FFB Hard]
type = ForceFeedback
trigger1 = anim = 5012
trigger2 = anim = 5002
trigger3 = anim = 5030
trigger4 = anim = [5051,5059]
persistent = 0
time = 15
waveform = sinesquare
ampl = 140

;---------------------------------------------------------------------------
[Statedef 6006]
type    = A
movetype= H
physics = N
ctrl = 0

[State 6001, NOT Falling]
type = hitfallset
trigger1 = !Time
value = 0
ignorehitpause = 1

[State 6000, Invincible]
type = NotHitBy
trigger1 = vel y > 0
value = SCA
ignorehitpause = 1

[State 6001, Change by HitType1]
type = Changeanim
trigger1 = !Time
trigger1 = anim = 5012
value = 5030

[State 6001, HitVelAdd]
type = VelAdd
trigger1 = 1
y = GetHitVar(yaccel)

[State 6001, HitVelSet]
type = HitVelSet
trigger1 = !Time
x = 1
y = 1

[State 6000, Falling]
type = hitfallset
trigger1 = Vel Y > 0
trigger1 = Pos Y >= -20
value = 1
ignorehitpause = 1

[State 6000, End]
type = SelfState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
value = 5100

[State 6001, end2]
type = ChangeState
trigger1 = AnimTime = 0
value = 6007

;---------------------------------------------------------------------------
[Statedef 6007]
type    = A
movetype= H
physics = N

[State 6002, NOT Falling]
type = hitfallset
trigger1 = !Time
value = 0
ignorehitpause = 1

[State 6000, Change by HitType1]
type = ChangeAnim
trigger1 = !Time
trigger1 = SelfAnimExist(5035)
trigger1 = Anim != [5051,5059]
trigger1 = Anim != 5090
value = 5035

[State 6002, HitVelAdd]
type = VelAdd
trigger1 = 1
y = GetHitVar(yaccel)

[State 6000, Invincible]
type = NotHitBy
trigger1 = vel y > 0
value = SCA
ignorehitpause = 1

[State 6000, Falling]
type = hitfallset
trigger1 = Vel Y > 0
trigger1 = Pos Y >= -20
value = 1
ignorehitpause = 1

[State 6000, End]
type = SelfState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
value = 5100

[State 6003, End2]
type = ChangeState
trigger1 = HitOver
trigger2 = AnimTime = 0
trigger3 = Time = 0
trigger3 = Anim != 5035
value = 6008

;---------------------------------------------------------------------------

[Statedef 6008]
type    = A
movetype= H
physics = N

[State 6000, Change by HitType1]
type = ChangeAnim
trigger1 = AnimTime = 0
trigger1 = Anim = 5035
trigger2 = Time = 0
trigger2 = Anim != 5035
trigger2 = (Anim != [5051, 5059]) && (Anim != [5061, 5069])
trigger2 = Anim != 5090
value = 5050

[State 6000, Change by HitType2]
type = ChangeAnim
trigger1 = anim = [5050,5059]
trigger1 = Vel Y >= ifelse(anim = 5050, 1, -2)
trigger1 = SelfAnimExist(anim+10)
value = anim+10
persistent = 0

[State 6003, HitVelAdd]
type = VelAdd
trigger1 = 1
y = GetHitVar(yaccel)

[State 6000, Invincible]
type = NotHitBy
trigger1 = vel y > 0
value = SCA
ignorehitpause = 1

[State 6003, NOT Falling]
type = HitFallSet
trigger1 = !Time
value = 0

[State 6000, End]
type = SelfState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
value = 5100

;-----------------------------------
;---- Don't Juggle Type Air Hit ----
;-----------------------------------
; HITA_SHAKE
[Statedef 6010]
type    = A
movetype= H
physics = N
velset = 0,0

[State 5040, 3]
type = nothitby
trigger1 = 1
value = sca
ignorehitpause = 1

[State 5020, 1] ;Anim for HIT_LIGHT to HIT_HARD
type = ChangeAnim
trigger1 = Time = 0
trigger1 = GetHitVar(animtype) != [3,5]
value = ifelse((GetHitVar(airtype) = 1),5000,5010) + GetHitVar(animtype)

[State 5020, 2] ;Anim for HIT_BACK
type = ChangeAnim
trigger1 = Time = 0
trigger1 = GetHitVar(animtype) = [3,5]
value = 5030

[State 5020, 3] ;Anim for HIT_UP/HIT_DIAGUP (only if it exists)
type = ChangeAnim
trigger1 = Time = 0
trigger1 = (GetHitVar(animtype) = [4,5]) && (SelfAnimExist(5047 + GetHitVar(animtype)))
value = 5047 + GetHitVar(animtype) ;5051 - 4 + type

[State 5020, 4] ;Freeze anim
type = ChangeAnim
trigger1 = Time > 0
value = anim

[State 5020, 5]
type = ChangeState
trigger1 = HitShakeOver
value = 6011

[State 5020, FFB Light]
type = ForceFeedback
trigger1 = anim = 5000
trigger2 = anim = 5010
persistent = 0
time = 6
waveform = square

[State 5020, FFB Medium]
type = ForceFeedback
trigger1 = anim = 5001
trigger2 = anim = 5011
persistent = 0
time = 8
waveform = sinesquare
ampl = 110,-1,-.3

[State 5020, FFB Hard]
type = ForceFeedback
trigger1 = anim = 5012
trigger2 = anim = 5002
trigger3 = anim = 5030
trigger4 = anim = [5051,5059]
persistent = 0
time = 15
waveform = sinesquare
ampl = 140

;---------------------------------------------------------------------------
; HITA_UP
[Statedef 6011]
type    = A
movetype= H
physics = N
ctrl = 0

[State 5040, 3]
type = nothitby
trigger1 = 1
value = sca

[State 5030, 1]
type = VelAdd
trigger1 = 1
y = GetHitVar(yaccel)

[State 5030, 2]
type = HitVelSet
trigger1 = Time = 0
x = 1
y = 1

[State 5030, 3]
type = ChangeState
trigger1 = HitOver
trigger2 = Vel Y > 0    ;Hit ground
trigger2 = Pos Y >= 10  ;.
value = 6013 ;HITA_RECOV

[State 5030, 5]
type = ChangeState
trigger1 = AnimTime = 0
value = 6012 ;HITA_UP (transition)

;---------------------------------------------------------------------------
; HITA_UP_T (transition)
[Statedef 6012]
type    = A
movetype= H
physics = N

[State 5040, 3]
type = nothitby
trigger1 = 1
value = sca

[State 5035, 1]
type = ChangeAnim
trigger1 = Time = 0
trigger1 = SelfAnimExist(5035)
trigger1 = Anim != [5051,5059] ;Not if in hit up anim
trigger1 = Anim != 5090 ;Not if hit off ground anim
value = 5035

[State 5635, 2]
type = VelAdd
trigger1 = 1
y = GetHitVar(yaccel)

[State 5635, 3]
type = ChangeState
trigger1 = HitOver  ;Hit is over
trigger2 = AnimTime = 0 ;Animation over
trigger3 = Vel Y > 0    ;Hit ground
trigger3 = Pos Y >= 10  ;.
trigger4 = Time = 0     ;No transition anim
trigger4 = Anim != 5035 ;.
value = 6013

;---------------------------------------------------------------------------
; HITA_RECOV (recovering in air, not falling)
[Statedef 6013]
type    = A
movetype= H
physics = N

[State 5040, 1]
type = selfState
trigger1 = !Alive
value = 5050

[State 5040, 2]
type = ChangeAnim
trigger1 = AnimTime = 0
trigger1 = Anim != 5040
trigger2 = Time = 0
trigger2 = Anim != 5035
value = 5040

[State 5040, 3]
type = nothitby
trigger1 = 1
value = sca


[State 5040, 5]
type = VelAdd
trigger1 = 1
y = GetHitVar(yaccel)

[State 5040, 6]
type = ChangeState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
value = 6014

;---------------------------------------------------------------------------
; End State
[Statedef 6014]
type    = S
movetype= H
physics = S
ctrl = 0
anim = 47
facep2 = 1

[State 6013, Invencibility]
type = nothitby
trigger1 = 1
value = sca

[State 52, 1]
type = VelSet
trigger1 = Time = 0
y = 0

[State 52, 2]
type = PosSet
trigger1 = Time = 0
y = 0

[State 52, 4]
type = SelfState
trigger1 = Time = 3
value = 0
ctrl = 1

;-----------------------------------
;--------- Dizzy Type Fall ---------
;-----------------------------------
[Statedef 6100]
type    = A
movetype= H
physics = N
velset = 0,0

[State 3318, 6]
type = varset
trigger1 = 1
var(13) = 0
IgnoreHitPause = 1

[State 3318, 6]
type = pause
trigger1 = timemod = 2, 0
time = 1
IgnoreHitPause = 1

[State 6000, Change by HitType1]
type = ChangeAnim
trigger1 = !Time
trigger1 = GetHitVar(animtype) != [3,5]
value = ifelse((GetHitVar(airtype) = 1),5000,5010) + GetHitVar(animtype)

[State 6000, Change by HitType2]
type = ChangeAnim
trigger1 = !Time
trigger1 = GetHitVar(animtype) = [3,5]
value = 5012

[State 6000, Change by HitType3]
type = ChangeAnim
trigger1 = !Time
trigger1 = (GetHitVar(animtype) = [4,5]) && (SelfAnimExist(5047 + GetHitVar(animtype)))
value = 5047 + GetHitVar(animtype) ;5051 - 4 + type

[State 6000, Change by HitType4]
type = ChangeAnim
trigger1 = Time > 0
value = anim

[State 6000, Invincible]
type = NotHitBy
trigger1 = 1
value = SCA

[State 6000, end]
type = ChangeState
trigger1 = HitShakeOver
value = 6101

[State 6000, FFB Light]
type = ForceFeedback
trigger1 = anim = 5000
trigger2 = anim = 5010
persistent = 0
time = 6
waveform = square

[State 6000, FFB Medium]
type = ForceFeedback
trigger1 = anim = 5001
trigger2 = anim = 5011
persistent = 0
time = 8
waveform = sinesquare
ampl = 110,-1,-.3

[State 6000, FFB Hard]
type = ForceFeedback
trigger1 = anim = 5012
trigger2 = anim = 5002
trigger3 = anim = 5030
trigger4 = anim = [5051,5059]
persistent = 0
time = 15
waveform = sinesquare
ampl = 140

;---------------------------------------------------------------------------
[Statedef 6101]
type    = A
movetype= H
physics = N
ctrl = 0

[State 3318, 6]
type = pause
trigger1 = timemod = 2, 0
time = 1
IgnoreHitPause = 1

[State 6000, Invincible]
type = NotHitBy
trigger1 = 1
value = SCA

[State 6001, Change by HitType1]
type = Changeanim
trigger1 = !Time
trigger1 = anim = 5012
value = 5030

[State 6001, HitVelAdd]
type = VelAdd
trigger1 = 1
y = GetHitVar(yaccel)

[State 6001, HitVelSet]
type = HitVelSet
trigger1 = !Time
x = 1
y = 1

[State 6001, HitVelSet]
type = VelSet
trigger1 = !Time
trigger1 = Vel x < -4
x = -4

[State 6001, HitVelSet]
type = VelSet
triggerAll = !Time
trigger1 = Vel x > 4
x = 4

[State 6001, HitVelSet]
type = VelSet
trigger1 = !Time
trigger1 = Vel y > -5
y = -5

[State 6001, end1]
type = ChangeState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
value = 6110

[State 6001, end2]
type = ChangeState
trigger1 = AnimTime = 0
value = 6102

;---------------------------------------------------------------------------
[Statedef 6102]
type    = A
movetype= H
physics = N

[State 3318, 6]
type = pause
trigger1 = timemod = 2, 0
time = 1
IgnoreHitPause = 1

[State 6000, Invincible]
type = NotHitBy
trigger1 = 1
value = SCA

[State 6000, Change by HitType1]
type = ChangeAnim
trigger1 = !Time
trigger1 = SelfAnimExist(5035)
trigger1 = Anim != [5051,5059]
trigger1 = Anim != 5090
value = 5035

[State 6002, HitVelAdd]
type = VelAdd
trigger1 = 1
y = GetHitVar(yaccel)

[State 6000, Falling]
type = hitfallset
trigger1 = Vel Y > 0
trigger1 = Pos Y >= -20
value = 1
ignorehitpause = 1

[State 6003, End1]
type = ChangeState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
value = 6110

[State 6003, End2]
type = ChangeState
trigger1 = HitOver
trigger2 = AnimTime = 0
trigger3 = Time = 0
trigger3 = Anim != 5035
value = 6103

;---------------------------------------------------------------------------
[Statedef 6103]
type    = A
movetype= H
physics = N

[State 3318, 6]
type = pause
trigger1 = timemod = 2, 0
time = 1
IgnoreHitPause = 1

[State 6000, Change by HitType1]
type = ChangeAnim
trigger1 = AnimTime = 0
trigger1 = Anim = 5035
trigger2 = Time = 0
trigger2 = Anim != 5035
trigger2 = (Anim != [5051, 5059]) && (Anim != [5061, 5069])
trigger2 = Anim != 5090
value = 5050

[State 6000, Change by HitType2]
type = ChangeAnim
trigger1 = anim = [5050,5059]
trigger1 = Vel Y >= ifelse(anim = 5050, 1, -2)
trigger1 = SelfAnimExist(anim+10)
value = anim+10
persistent = 0

[State 6003, HitVelAdd]
type = VelAdd
trigger1 = 1
y = GetHitVar(yaccel)

[State 6000, Invincible]
type = NotHitBy
trigger1 = 1
value = SCA

[State 6000, End]
type = ChangeState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
value = 6110

[Statedef 6110]
type    = L
movetype= H
physics = N

[State 1004, 1]
type = nothitby
trigger1 = 1
value = SCA
ignorehitpause = 1

[State 5302, 1.1]
type = Velset
trigger1 = time = 0
y = -5.5

[State 5302, 1.2]
type = Velmul
trigger1 = timemod = 2,3
trigger1 = time > 3
x = .98

[State 5302, 2.1]
type = Changeanim
trigger1 = time < 3
value = 5160

[State 5302, 3.1]
type = posset
trigger1 = time = 0
y = 20

[State 5302, 4]
type = PlaySnd
trigger1 = Time = 0
value = F7,0

[State 5302, 5]
type = GameMakeAnim
trigger1 = Time = 0
value = 60
pos = 0, -20
under = 1

[State 5302, 6]
type = posfreeze
trigger1 = time < 3

[State 5302, 7]
type = Gravity
trigger1 = time > 3

[State 5302, 8]
type = ChangeState
trigger1 = time > 3
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
value = 6111

[Statedef 6111]
type    = L
movetype= H
physics = N
velset = 0,0
anim = 5110

[State 5302, 4]
type = PlaySnd
trigger1 = !Time
value = 5000,3
ignorehitpause = 1

[State 5303, 2]
type = posset
trigger1 = time = 0
y = 0

[State 5303, 6]
type = PlaySnd
trigger1 = Time = 0
value = F7,0

[State 5303, 7]
type = GameMakeAnim
trigger1 = Time = 0
value = 60
pos = 0, 0
under = 1

[State 5303, 3.1] ;If just died
type = ChangeState
trigger1 = !alive
trigger1 = !Time
value = 5150

[State 5303, 3.2] ;If alive
type = ChangeState
triggerall = alive
trigger1 = Time = 45
value = 6120

[State 5303, 16]
type = Nothitby
trigger1 = 1
value = SCA

[Statedef 6120]
type    = L
movetype= I
physics = N
anim = 5120
velset = 0,0

[State 5302, 4]
type = PlaySnd
trigger1 = !Time
value = 5300,0
ignorehitpause = 1

[State 3318, 6]
type = varset
trigger1 = !Time
var(13) = 0
IgnoreHitPause = 1

[State 5304, 1]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

[State 5304, 2]
type = ChangeState
trigger1 = AnimTime = 0
value = 5300
ctrl = 0


[Statedef 5300]
type    = S
movetype= I
physics = S
anim = 5300
ctrl = 0

[State 3318, 6]
type = varset
trigger1 = !time
var(14) = 250

[State 3318, 6]
type = varadd
trigger1 = command ="x"
trigger2 = command ="y"
trigger3 = command ="x"
trigger4 = command ="a"
trigger5 = command ="b"
trigger6 = command ="c"
var(14) = -10

[State 3318, 6]
type = varset
trigger1 = var(14) <= 0
var(14) = 0

[State 5305, 1];back to normal
type = ChangeState
trigger1 = time >= 30+var(14)
value = 0
ctrl = 1

;-----------------------------------
;--------- Forced to Stand ---------
;-----------------------------------
[Statedef 6200]
type    = S
movetype= H
physics = N
velset = 0,0

[State 6000, 1]
type = hitfallset
trigger1 = 1
value = 0
ignorehitpause = 1

[State 6000, 1]
type = Playerpush
trigger1 = 1
value = 0

[State 6000, 1]
type = hitby
trigger1 = 1
value = SCA,HA, HP, HT
ignorehitpause = 1

[State 6000, 1]
type = PosSet
trigger1 = Time = 0
y = 0

[State 6000, 1]
type = VelSet
trigger1 = Time = 0
y = 0

[State 6000, 1]
type = ChangeAnim
trigger1 = Time = 0
trigger1 = GetHitVar(animtype) != [3,5]
value = ifelse((GetHitVar(groundtype) = 1),5000,5010) + GetHitVar(animtype)

[State 6000, 1]
type = ChangeAnim
trigger1 = Time = 0
trigger1 = GetHitVar(animtype) = [3,5]
value = 5030

[State 6000, 1]
type = ChangeAnim
trigger1 = Time = 0
trigger1 = (GetHitVar(animtype) = [4,5]) && (SelfAnimExist(5047 + GetHitVar(animtype)))
value = 5047 + GetHitVar(animtype) ;5051 - 4 + type

[State 6000, 1]
type = ChangeAnim
trigger1 = Time > 0
value = anim

[State 6000, 1]
type = ChangeState
trigger1 = HitShakeOver
value = 6201

[State 6000, 1]
type = ForceFeedback
trigger1 = anim = 5000
trigger2 = anim = 5010
persistent = 0
time = 6
waveform = square

[State 6000, 1]
type = ForceFeedback
trigger1 = anim = 5001
trigger2 = anim = 5011
persistent = 0
time = 8
waveform = sinesquare
ampl = 110,-1,-.3

[State 6000, 1]
type = ForceFeedback
trigger1 = anim = 5012
trigger2 = anim = 5002
trigger3 = anim = 5030
persistent = 0
time = 15
waveform = sinesquare
ampl = 140

;---------------------------------------------------------------------------
; HITG_SLIDE
[Statedef 6201]
type    = S
movetype= H
physics = S

[State 6000, 1]
type = hitfallset
trigger1 = 1
value = 0
ignorehitpause = 1

[State 6000, 1]
type = hitby
trigger1 = 1
value = SCA,HA, HP, HT
ignorehitpause = 1

[State 6000, 1]
type = Playerpush
trigger1 = 1
value = 0

[State 6000, 1]
type = HitVelSet
trigger1 = Time = 0
x = 1
ignorehitpause = 1

[State 6000, 1]
type = ChangeAnim
trigger1 = AnimTime = 0
value = 5005 + GetHitVar(animtype) + (GetHitVar(groundtype)=2)*10

[State 6000, 1]
type = VelMul
trigger1 = Time >= GetHitVar(slidetime)
x = .6

[State 6000, 1]
type = VelSet
trigger1 = HitOver
x = 0

[State 6000, 1]
type = ChangeState
trigger1 = HitOver
value = 6202


;---------------------------------------------------------------------------
; DIZZYED
[Statedef 6202]
type = S
ctrl = 0
movetype = H
velset = 0,0,0

[State 6000, 1]
type = hitby
trigger1 = 1
value = SCA,HA, HP, HT
ignorehitpause = 1

[State 6000, 1]
type=changeanim
trigger1 = time = 0
trigger1 = selfanimexist(5300)
value = 5300

[State 6000, 1]
type = changeanim2
trigger1 = time = 0 && !selfanimexist(5300)
value = 5301

[State 6000, 1]
type = defencemulset
trigger1 = time = 100
value = 1

[State 6000, 1]
type = Selfstate
trigger1 = time = 100
value = 0
ctrl = 1

;-----------------------------------
;-------- Gethit Wire Type ---------
;-----------------------------------
[Statedef 6400]
type = A
movetype= H
physics = N
velset = 0,0

[State 1027, Anim]
type = ChangeAnim2
trigger1 = !Time
value = 6400

[State 6000, end]
type = ChangeState
trigger1 = HitShakeOver
value = 6401

;---------------------------------------------------------------------------
[Statedef 6401]
type = A
movetype= H
physics = N

[State 200, 1]
type = HitDef
trigger1 = !Time = 0
attr = A, NA
damage = 100,10
getpower = 0
givepower = 100
guardflag = MA
hitflag = MAFD
pausetime = 15,15
sparkno = 3
guard.sparkno = 42
sparkxy = -15,-75
hitsound = F5,4
guardsound = F6,0
ground.type = High
ground.slidetime = 10
ground.hittime = 17
ground.velocity = 6,-9.5
air.velocity = 6,-8
affectteam = f
fall = 1
fall.recover = 0
fall.envshaketime = 15

[STate 3044, no push]
type = playerpush
trigger1 = 1
value = 0

[State 1026, Velocity]
type = VelSet
trigger1 = !Time
x = -13
y = -1

[State 1026, Hit wall]
type = ChangeState
trigger1 = movecontact
trigger2 = BackEdgeBodyDist <= 20
trigger3 = FrontEdgeBodyDist <= 20
value = 6402

;---------------------------------------------------------------------------
[Statedef 6402]
type = A
movetype= H
physics = N

[State 1028, 1]
type = NotHitBy
trigger1 = 1
value = sca

[State 1027, Turn]
type = Turn
trigger1 = !Time = 0
Trigger1 = FrontEdgeBodyDist <= 30

[State 1027, Pos]
type = PosAdd
trigger1 = !Time
x = 15 - BackEdgeBodyDist

[State 1027, Stop moving]
type = PosFreeze
trigger1 = 1

[State 1027, No scroll]
type = ScreenBound
trigger1 = 1
value = 1
movecamera = 0,1

[State 1027, Anim]
type = ChangeAnim2
trigger1 = !Time
value = 6410

[State 1027, Sound]
type = PlaySnd
trigger1 = Time = 0
value = F7,2

[State 1027, Sound]
type = EnvShake
trigger1 = !Time
Ampl = -6
Time = 7

[State 1027, Sound]
type = Explod
trigger1 = !Time
anim = F72
Ontop = 1
IgnoreHitpause = 1
Pos = -15, -65

[State 1028, Vel Y]
type = VelSet
trigger1 = Time = 4
x = 2.5
y = -9.5


[State 1027, State]
type = ChangeState
trigger1 = Time = 5
value = 6002

;-----------------------------------
;--------- Power Attack'ed ---------
;-----------------------------------
[Statedef 6500]
type    = S
movetype= H
physics = N
velset = 0,0

[State 6000, 1]
type = changeState
trigger1 = !Alive
value = 6400
ignorehitpause = 1

[State 6000, 1]
type = hitfallset
trigger1 = 1
value = 0
ignorehitpause = 1

[State 6000, 1]
type = Playerpush
trigger1 = 1
value = 0

[State 6000, 1]
type = PosSet
trigger1 = Time = 0
y = 0

[State 6000, 1]
type = VelSet
trigger1 = Time = 0
y = 0

[State 6000, 1]
type = ChangeAnim
trigger1 = Time = 0
trigger1 = GetHitVar(animtype) != [3,5]
value = ifelse((GetHitVar(groundtype) = 1),5000,5010) + GetHitVar(animtype)

[State 6000, 1]
type = ChangeAnim
trigger1 = Time = 0
trigger1 = GetHitVar(animtype) = [3,5]
value = 5030

[State 6000, 1]
type = ChangeAnim
trigger1 = Time = 0
trigger1 = (GetHitVar(animtype) = [4,5]) && (SelfAnimExist(5047 + GetHitVar(animtype)))
value = 5047 + GetHitVar(animtype) ;5051 - 4 + type

[State 6000, 1]
type = ChangeAnim
trigger1 = Time > 0
value = anim

[State 6000, 1]
type = ChangeState
trigger1 = HitShakeOver
value = 6501

[State 6000, 1]
type = ForceFeedback
trigger1 = anim = 5000
trigger2 = anim = 5010
persistent = 0
time = 6
waveform = square

[State 6000, 1]
type = ForceFeedback
trigger1 = anim = 5001
trigger2 = anim = 5011
persistent = 0
time = 8
waveform = sinesquare
ampl = 110,-1,-.3

[State 6000, 1]
type = ForceFeedback
trigger1 = anim = 5012
trigger2 = anim = 5002
trigger3 = anim = 5030
persistent = 0
time = 15
waveform = sinesquare
ampl = 140

;---------------------------------------------------------------------------
; HITG_SLIDE
[Statedef 6501]
type    = S
movetype= H
physics = S

[State 6000, 1]
type = hitfallset
trigger1 = 1
value = 0
ignorehitpause = 1

[State 6000, 1]
type = Playerpush
trigger1 = 1
value = 0

[State 6000, 1]
type = HitVelSet
trigger1 = Time = 0
x = 1
ignorehitpause = 1

[State 6000, 1]
type = ChangeAnim
trigger1 = AnimTime = 0
value = 5005 + GetHitVar(animtype) + (GetHitVar(groundtype)=2)*10

[State 6000, 1]
type = VelMul
trigger1 = Time >= GetHitVar(slidetime)
x = .6

[State 6000, 1]
type = VelSet
trigger1 = HitOver
x = 0

[State 6000, 1]
type = ChangeState
trigger1 = HitOver
value = 6502

; DIZZYED--------------------------------
[Statedef 6502]
type = S
ctrl = 0
movetype = I
velset = 0,0,0

[State 6000, 1]
type=changeanim
trigger1 = time = 0
trigger1 = selfanimexist(5950)
value = 5950

[State 6000, 1]
type = changeanim2
trigger1 = time = 0 && !selfanimexist(5950)
value = 5951

[State 6000, 1]
type = defencemulset
trigger1 = !time
value = 1

[State 6000, 1]
type = StateTypeSet
trigger1 = time = 35
StateType = C

[State 6000, 1]
type = StateTypeSet
trigger1 = time = 57
StateType = L

[State 6000, 1]
type = Selfstate
trigger1 = time = 80
value = 5120


;----------------------------
;----- P2 Guard crushed -----
;----------------------------
[Statedef 6600]
type = S
movetype = H
physics = S
ctrl = 0
Velset = 0,0,0

[State 1610, idle]
Type = StateTypeSet
trigger1 = Time = 1
movetype = I
ignorehitpause = 1

[State 9100, 2]
type = ChangeAnim
trigger1 = !Time
trigger1 = AuthorName = "Don Drago"
trigger1 = SelfAnimExist(900)
value = 900
ignorehitpause = 1

[State 9100, 2]
type = ChangeAnim
trigger1 = !Time
trigger1 = AuthorName = "Sander71113"
trigger1 = SelfAnimExist(307)
value = 307
ignorehitpause = 1

[State 9100, 2]
type = ChangeAnim
trigger1 = !Time
trigger1 = AuthorName = "zzzasd"
trigger1 = SelfAnimExist(811)
value = 311
ignorehitpause = 1

[State 9100, 2]
type = ChangeAnim2
trigger1 = !Time
trigger1 = Anim != 307
trigger1 = Anim != 811
trigger1 = Anim != 900
value = 6600
ignorehitpause = 1

[State 9100, 2]
type = Envcolor
trigger1 = Time = 0
value = 248,248,248
time = 3
under = 1
ignorehitpause = 1

[State 9100, 5]
type = Velset
trigger1 = time = 3
x = -10
ignorehitpause = 1

[State 9100, 6]
type = SelfState
trigger1 = !AnimTime
trigger2 = Time > 30
value = 0
ctrl = 1
ignorehitpause = 1

;---------------------------------------------------------------------------
; Edited HIT_LIEDOWN
[Statedef 6700]
type    = L
movetype= H
physics = N

[State 5110, Var]
type = HitFallset
trigger1 = 1
value = 1

[State 5110, EnvShake]
type = FallEnvShake
trigger1 = Time = 0

[State 5110, 1] ;For hit up/up-diag type (from state 5081)
type = ChangeAnim
persistent = 0
trigger1 = SelfAnimExist(5110 + (anim % 10))
trigger1 = anim = [5081,5089]
value = 5110 + (anim % 10)

[State 5110, 2] ;Hit ground anim (normal)
type = ChangeAnim
triggerall = time = 0
triggerall = anim != [5110,5119] ;Not already changed anim
trigger1 = anim != [5161,5169]
trigger2 = !SelfAnimExist(5170 + (anim % 10))
value = 5170

[State 5110, 3] ;Hit ground anim (for hit up)
type = ChangeAnim
triggerall = time = 0
triggerall = anim != [5110,5119] ;Not already changed anim
trigger1 = anim = [5161,5169]
trigger1 = SelfAnimExist(5170 + (anim % 10))
value = 5170 + (anim % 10)

[State 5110, 4]
type = HitFallDamage
trigger1 = Time = 0

[State 5110, 5]
type = PosSet
trigger1 = Time = 0
y = 0

[State 5110, Var] ;Get fall velocity
type = VarSet
trigger1 = Time = 0
trigger1 = GetHitVar(fall.yvel) != 0
sysvar(1) = floor(vel y)

[State 5110, 6]
type = PlaySnd
trigger1 = Time = 0
trigger1 = !SysVar(0)
value = F7, (sysvar(1) > 5) + (sysvar(1) > 14)

[State 5110, 7]
type = GameMakeAnim
trigger1 = Time = 0
trigger1 = !SysVar(0)
value = 60 + (sysvar(1) > 5) + (sysvar(1) > 14)
pos = 0, 0
under = sysvar(1) <= 14

[State 5110, 8]
type = VelSet
trigger1 = Time = 0
y = 0

[State 5110, 9] ;For hit up type
type = ChangeAnim
persistent = 0
triggerall = anim = [5171,5179]
triggerall = SelfAnimExist(5110 + (anim % 10))
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground anim
value = 5110 + (anim % 10)

[State 5110, 10] ;For normal
type = ChangeAnim
persistent = 0
triggerall = Anim != [5111,5119]
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
value = 5110

[State 5110, 11] ;If just died
type = ChangeState
triggerall = !alive
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
trigger3 = Anim = [5110,5119]
value = 5150

[State 5110, 12]
type = VarSet
trigger1 = SysVar(0)
trigger1 = Time = 0
sysvar(0) = 0

[State 5110, 13] ;Friction
type = VelMul
trigger1 = 1
x = 0.85

[State 5110, 14]
type = ForceFeedback
trigger1 = alive
trigger1 = Time = 0
time = 8
ampl = 240
waveform = sine

[State 5110, 15]
type = ForceFeedback
trigger1 = !alive
trigger1 = Time = 0
ampl = 200, 7, -.467
time = 30
waveform = sine

[State 5110, 11] ;return
type = SelfState
trigger1 = alive
trigger1 = Time >= 15
value = 5120

;-----------------------------------
;------- Personality Chip 1 --------
;-----------------------------------

;------- type 1 --------
[Statedef 7000]
Type    = S
MoveType = I
Physics = S
Anim = 100
SprPriority = 0
Velset = 0,0
Ctrl = 0

[State 100, walk]
Type = changestate
Trigger1 = !Time
Trigger1 = var(9) < 3
value = 7001

[State 100, Velocity]
Type = VelSet
Trigger1 = AnimElemTime(2) >= 0
x = Const(Velocity.Run.Fwd.x)+.5*(var(1)= 3)

[State 100, Sound]
Type = PlaySnd
Trigger1 = AnimElem = 3 || AnimElem = 6
Value = 100,0
Channel = 3

[State 100, AI End]
type = ChangeState
triggerall = var(9)
triggerall = !var(25)
triggerall = inguarddist
trigger1 = p2statetype = S
trigger2 = p2statetype = C
value = 700

[State -1, HGrab 1]
type = ChangeState
value = 3200
TriggerAll = var(9) > 2
TriggerAll = var(1) < 2
TriggerAll = Random < 500
triggerAll = p2dist x = [0,60]
triggerAll = p2statetype != A
triggerAll = p2statetype != L
Trigger1 = var(15)
Trigger2 = power >= 1000
Trigger2 = p2life >= 150

[State -1, HGrab 2]
type = ChangeState
TriggerAll = var(9) > 2
TriggerAll = var(1) = 3
TriggerAll = Random < 500
TriggerAll = var(32)
triggerAll = p2dist x = [1,60]
triggerAll = p2statetype != A
triggerAll = p2statetype != L
Trigger1 = var(15)
Trigger2 = power >= 1000
Trigger2 = p2life >= 150
value = 3220

[State -1, SGrab 1]
type = ChangeState
Trigger1 = var(9) > 2
Trigger1 = var(1) = 3
Trigger1 = Random < 500
trigger1 = p2dist x = [1,60]
trigger1 = p2statetype != A
trigger1 = p2statetype != L
value = 1900

[State -1, SGrab 2]
type = ChangeState
Trigger1 = var(9) > 2
Trigger1 = var(1) = 4
Trigger1 = Random < 500
trigger1 = p2dist x = [1,60]
trigger1 = p2statetype != A
trigger1 = p2statetype != L
value = 1550

[State 100, AI End]
type = ChangeState
trigger1 = var(9)
trigger1 = Time > 10
trigger1 = p2bodydist x =[0,10]
trigger1 = p2statetype != A
trigger1 = p2statetype != L
value = 950+10*(random < 500)

[State 100, AI End]
type = ChangeState
triggerall = var(9)
triggerall = Time > 10
trigger1 = !var(25)
trigger1 = inguarddist
trigger2 = p2statetype != S
trigger2 = p2statetype != C
trigger3 = p2dist x < 0
value = 103

;------- type 2 --------
[Statedef 7001]
Type    = S
Physics = S
SprPriority = 0

[State 20, 1]
Type = VelSet
Trigger1 = 1
x = Const(Velocity.Walk.Fwd.x)+.5*(var(1)= 3)

[State 20, 3]
Type = ChangeAnim
TriggerAll = Vel x > 0
Trigger1 = Anim != 20 && Anim != 5
Trigger2 = Anim = 5 && !AnimTime
Value = 20


[State 100, AI End]
type = ChangeState
triggerall = var(9)
triggerall = !var(25)
triggerall = inguarddist
trigger1 = p2statetype = S
trigger2 = p2statetype = C
value = 700

[State -1, HGrab 1]
type = ChangeState
value = 3200
TriggerAll = var(9) > 2
TriggerAll = var(1) < 2
TriggerAll = Random < 500
triggerAll = p2dist x = [0,60]
triggerAll = p2statetype != A
triggerAll = p2statetype != L
Trigger1 = var(15)
Trigger2 = power >= 1000
Trigger2 = p2life >= 150

[State -1, HGrab 2]
type = ChangeState
TriggerAll = var(9) > 2
TriggerAll = var(1) = 3
TriggerAll = Random < 500
TriggerAll = var(32)
triggerAll = p2dist x = [1,60]
triggerAll = p2statetype != A
triggerAll = p2statetype != L
Trigger1 = var(15)
Trigger2 = power >= 1000
Trigger2 = p2life >= 150
value = 3220

[State -1, SGrab 1]
type = ChangeState
Trigger1 = var(9) > 2
Trigger1 = var(1) = 3
trigger1 = p2statetype != A
trigger1 = p2statetype != L
trigger1 = p2dist x = [1,60]
Trigger1 = Random < 500
value = 1900

[State -1, SGrab 2]
type = ChangeState
Trigger1 = var(9) > 2
Trigger1 = var(1) = 4
trigger1 = p2statetype != A
trigger1 = p2statetype != L
trigger1 = p2dist x = [1,60]
Trigger1 = Random < 500
value = 1550

[State 100, AI End]
type = ChangeState
trigger1 = var(9)
trigger1 = Time > 10
trigger1 = p2statetype != A
trigger1 = p2statetype != L
trigger1 = p2bodydist x =[0,10]
value = 950+10*(random < 500)

[State 100, AI End]
type = ChangeState
triggerall = var(9)
triggerall = Time > 10
trigger1 = !var(25)
trigger1 = inguarddist
trigger2 = p2statetype != S
trigger2 = p2statetype != C
trigger3 = p2dist x < 0
value = 0
ctrl = 1

;============================================================================
; Helpers
;============================================================================
;>>>>>>>>>>>>>>>>>>>>>>>=====================<<<<<<<<<<<<<<<<<<<<<<<|
;|||||||||||||||||||||||Command Buffer Helper||||||||||||||||||||||||
;>>>>>>>>>>>>>>>>>>>>>>>=====================<<<<<<<<<<<<<<<<<<<<<<<|
;===================================================================|
;                             var List                              |
;===================================================================|
;var(1) = weak punch buffer                                         |
;var(2) = medium punch buffer                                       |
;var(3) = strong punch buffer                                       |
;var(4) = weak kick buffer                                          |
;var(5) = medium kick buffer                                        |
;var(6) = strong kick buffer                                        |
;var(7) = 2 punches buffer                                          |
;var(8) = 2 kicks buffer                                            |
;===================================================================|
[Statedef 2000]
anim = 9999
ctrl = 0

[State 2100, Safety]
type = SelfState
trigger1 = !IsHelper
value = 0

;-----------------------------------------------------------------
;Main buffers
;-----------------------------------------------------------------
[State 2100, buffer]
type = VarSet
trigger1 = Root, Command = "x"
var(1) = 15

[State 2100, buffer]
type = VarSet
trigger1 = Root, Command = "y"
var(2) = 15

[State 2100, buffer]
type = VarSet
trigger1 = Root, Command = "z"
var(3) = 15

[State 2100, buffer]
type = VarSet
trigger1 = Root, Command = "a"
var(4) = 15

[State 2100, buffer]
type = VarSet
trigger1 = Root, Command = "b"
var(5) = 15

[State 2100, buffer]
type = VarSet
trigger1 = Root, Command = "c"
var(6) = 15

[State 2100, buffer]
type = VarSet
trigger1 = Root, Command = "2punches"
var(7) = 15

[State 2100, buffer]
type = VarSet
trigger1 = Root, Command = "2kicks"
var(8) = 15

;-----------------------------------------------------------------
;buffer countdown
;-----------------------------------------------------------------
[State 2100, buffercountdown]
type = VarAdd
trigger1 = var(1)
var(1) = -1

[State 2100, buffercountdown]
type = VarAdd
trigger1 = var(2)
var(2) = -1

[State 2100, buffercountdown]
type = VarAdd
trigger1 = var(3)
var(3) = -1

[State 2100, buffercountdown]
type = VarAdd
trigger1 = var(4)
var(4) = -1

[State 2100, buffercountdown]
type = VarAdd
trigger1 = var(5)
var(5) = -1

[State 2100, buffercountdown]
type = VarAdd
trigger1 = var(6)
var(6) = -1

[State 2100, buffercountdown]
type = VarAdd
trigger1 = var(7)
var(7) = -1

[State 2100, buffercountdown]
type = VarAdd
trigger1 = var(8)
var(8) = -1

;-----------------------------------
;----------- HSDM Helper -----------
;-----------------------------------
[Statedef 9994]
ctrl = 0
anim = 11000
movetype = I
Sprpriority = -6

[State 9994, Black BG]
type = EnvColor
trigger1 = 1
time = 2
Value = 0,0,0
Under = 1

[State 9996, Pos Set]
type = PosSet
trigger1 = 1
x = 0
y = 0
IgnoreHitPause = 1

[State -2, 3]
type = Explod
trigger1 = !Time
anim = 11001
ID = 11001
postype = left
pos = 160,120
bindtime = -1
ownpal = 1
Sprpriority = -6
ignorehitpause = 1
pausemovetime = 300
supermovetime = 300

[State 3000, DM FX 2]
Type = Explod
trigger1 = !Time
ID = 11001
anim = 7950
PosType = Left
Ownpal = 1
SprPriority = -8
BindTime = -1
IgnoreHitPause = 1
Pos = 0,-10
PauseMoveTime = 99
SuperMoveTime = 99
Scale = 1, 3
Removetime = -1

[State 9996, BG out]
type = BgPalFX
trigger1 = parent, stateno != [4000,4999]
trigger2 = parent, MoveType = H
trigger3 = Parent, Numhelper(9996)
trigger4 = RoundState >= 3
add = -255,-255,-255
sinadd = 255,255,255, 120
Time = 30
IgnoreHitPause = 1

[State 9996, DestroySelf]
type = RemoveExplod
ID = 11001
trigger1 = parent, stateno != [4000,4999]
trigger2 = parent, MoveType = H
trigger3 = Parent, Numhelper(9996)
trigger4 = RoundState >= 3
IgnoreHitPause = 1

[State 9996, DestroySelf]
type = DestroySelf
trigger1 = parent, stateno != [4000,4999]
trigger2 = parent, MoveType = H
trigger3 = Parent, Numhelper(9996)
trigger4 = RoundState >= 3
IgnoreHitPause = 1

;-----------------------------------
;------- Super Finish Helper -------
;-----------------------------------
[Statedef 9995]
ctrl = 0
anim = 9999
movetype = A

[State 191, 1]
Type = Pause
Trigger1 = !time
Time = 15
MoveTime = 15

[State 191, 1]
Type = PlaySnd
Trigger1 = !time
Value = 9995, 0
Channel = 5

[State 9996, BgPalFX]
type = BGPalFX
trigger1 = !Time
time = 60
add = 0,0,0
mul = 255,255,255
sinadd = 100,100,100,120
invertall = 0
color = 6

;-----------------------------------
;------- Hyper Finish Helper -------
;-----------------------------------
[Statedef 9996]
ctrl = 0
anim = 9999
movetype = A

[State 191, 1]
Type = Pause
Trigger1 = time = 1
Time = 15
MoveTime = 15

[State 9996, AllPalFX]
type = AssertSpecial
trigger1 = Time < 110
flag = NoBG
flag2 = NoFG

[State 9996, AllPalFX]
type = AssertSpecial
trigger1 = Time < 110
flag = NoBarDisplay
flag2 = GlobalNoShadow

[State 3000, DM FX 2]
Type = Explod
trigger1 = !Time
anim = 7950
PosType = Left
Ownpal = 1
SprPriority = -8
BindTime = -1
IgnoreHitPause = 1
Pos = 0,-10
PauseMoveTime = 99
SuperMoveTime = 99
Scale = 1, 3
Removetime = 110

[State -2, 3]
type = Explod
trigger1 = !Time
anim = 10000
postype = left
pos = 160,120
bindtime = -1
ownpal = 1
Sprpriority = -6
ignorehitpause = 1
pausemovetime = 300
supermovetime = 300

[State -2, 3]
type = Explod
trigger1 = Time = 2
anim = 10500
postype = left
pos = 160,115
bindtime = -1
ownpal = 1
Sprpriority = -5
ignorehitpause = 1
pausemovetime = 300
supermovetime = 300
Scale = 1, 1.1

[State 191, 1]
Type = PlaySnd
Trigger1 = !time
Value = 9995, 1
Channel = 5

[State 191, 1]
Type = PlaySnd
Trigger1 = !time
Value = 9995, 2
Channel = 6

;-----------------------------------
;--------- Counter Helper ----------
;-----------------------------------
[Statedef 9997]
ctrl = 0
anim = 9999
movetype = A

[State 9000, Assert]
type = NotHitBy
trigger1 = 1
Value = SCA
ignorehitpause = 1
under = 1

[State -2, 3]
type = Explod
triggerAll = Parent, var(10) = 1
triggerAll = p2movetype = H
trigger1 = Parent, movehit
Trigger2 = projhit = 1
anim = 8200
ID = 8200
postype = left
bindtime = -1
ownpal = 1
ontop = 1
persistent = 0
ignorehitpause = 1
pos = 60,60

[State -2, 3]
type = Explod
triggerAll = Parent, var(10) = 2
triggerAll = p2movetype = H
trigger1 = Parent, movehit
Trigger2 = projhit = 1
anim = 8200
ID = 8200
postype = right
bindtime = -1
ownpal = 1
ontop = 1
persistent = 0
ignorehitpause = 1
pos = -60,60

[State 9000, Assert]
type = envshake
triggerAll = p2movetype = H
trigger1 = Parent, movehit
Trigger2 = projhit = 1
time = 5
ampl = -6
ignorehitpause = 1
persistent = 0

[State 9000, Assert]
type = envcolor
triggerAll = p2movetype = H
trigger1 = Parent, movehit
Trigger2 = projhit = 1
time = 2
value = 255,255,255
under = 1
ignorehitpause = 1
persistent = 0

[State 9000, Effect]
type = destroyself
trigger1 = p2movetype != A && p2movetype != H
trigger2 = p2StateNo = [6000, 6005]
trigger2 = p2movetype = H
trigger3 = p2movetype = H
trigger3 = p2Statetype != A
trigger4 = RoundState != 2
trigger5 = Parent, movetype = H
ignorehitpause = 1

;--------------------------------
; Win the Match
;--------------------------------
[Statedef 9998]
type = S
movetype = I
anim = 9999

[State 2000, Time for win screen]
type = AssertSpecial
trigger1 = time = [0,500]
flag = RoundNotOver

[State 2000, Silence]
type = AssertSpecial
trigger1 = time = [110,520]
flag = NoMusic

[State 2000, Music]
type = PlaySnd
trigger1 = Time = 145
value = 8500,0

[State 9990, Bg]
type = AssertSpecial
trigger1 = Time >= 100
flag = NoBarDisplay

[State 9000, BG]
type = BGPalFx
trigger1 = Time >= 100
time = 1
Add = -40,-40,120
Color = 0
ignorehitpause = 1

[State 9990, BG]
trigger1 = time = 100
type = Explod
ownpal = 1
anim = 8500
postype = left
pos = 160,240
bindtime = -1
ID = 2020
ontop =1

[State 9990, portrait]
trigger1 = time = 130
type = Explod
ownpal = 1
anim = 7800+parent,var(1)
postype = left
pos = 160,240
bindtime = -1
ID = 7800
ontop =1

[State 9990, TEXT]
type = Explod
trigger1 = time = 160
Trigger1 = !Parent, var(1)
ownpal = 1
anim = 8510+(Parent, StateNo = 181)+2*(Parent, StateNo = 182)+20*parent,var(26)
postype = left
pos = 160,240
bindtime = -1
ID = 8510
ontop =1

[State 9990, TEXT]
type = Explod
trigger1 = time = 160
Trigger1 = Parent, var(1) = 1
ownpal = 1
anim = 8513+(Parent, StateNo = 181)+2*(Parent, StateNo = 182)+20*parent,var(26)
postype = left
pos = 160,240
bindtime = -1
ID = 8510
ontop =1

[State 9990, TEXT]
type = Explod
trigger1 = time = 160
Trigger1 = Parent, var(1) = 2
ownpal = 1
anim = 8516+(Parent, StateNo = 181)+2*(Parent, StateNo = 182)+20*parent,var(26)
postype = left
pos = 160,240
bindtime = -1
ID = 8510
ontop =1

[State 9990, TEXT]
type = Explod
trigger1 = time = 160
Trigger1 = Parent, var(1) = 3
ownpal = 1
anim = 8519+(Parent, StateNo = 181)+2*(Parent, StateNo = 182)+20*parent,var(26)
postype = left
pos = 160,240
bindtime = -1
ID = 8510
ontop =1

[State 9990, TEXT]
type = Explod
trigger1 = time = 160
Trigger1 = Parent, var(1) = 4
ownpal = 1
anim = 8522+(Parent, StateNo = 181)+2*(Parent, StateNo = 182)+20*parent,var(26)
postype = left
pos = 160,240
bindtime = -1
ID = 8510
ontop =1

;-------------------------------------
; AI Helper
;-------------------------------------

[Statedef 9999]
anim = 9999
ctrl = 0

[State 9741, Safety]; Just in case your opponent is very poorly coded.
type = SelfState
trigger1 = !IsHelper
value = 0

[State 9741, PauseCheck]
type = VarSet
trigger1 = (GameTime>(Parent,var(57)))
trigger2 = !(Parent,Alive)
trigger3 = (RoundState != 2)
trigger4 = Parent,var(58)
trigger5 = (var(3):=0)
var(2) = (var(3):=1)+(var(4):=0)

[State 9741, Facing]
type = Turn
trigger1 = (var(9):=(Facing != Parent,Facing))

[State 9741, DirTurnOnAI]
type = ParentVarSet
triggerall = !var(3)
triggerall = !var(9)
trigger1 = (Parent,command = "holdfwd")
trigger2 = (Parent,command = "holdback")
trigger3 = (Parent,command = "holdup")
trigger4 = (Parent,command = "holddown")
trigger5 = !(var(4):=1)
var(58) = var(4)

[State 9741, DirTurnOffAI]
type = ParentVarSet
triggerall = !var(3)
triggerall = Parent,var(58)
trigger1 = (command = "holdfwd")
trigger1 = (Parent,command = "holdfwd")
trigger2 = (command = "holdback")
trigger2 = (Parent,command = "holdback")
trigger3 = (command = "holdup")
trigger3 = (Parent,command = "holdup")
trigger4 = (command = "holddown")
trigger4 = (Parent,command = "holddown")
var(58) = (var(4):=0)

[State 9741, ButtonTurnOnAI]
type = ParentVarSet
triggerall = var(1)
triggerall = !var(2)
trigger1 = (Parent,command = "a")
trigger2 = (Parent,command = "b")
trigger3 = (Parent,command = "c")
trigger4 = (Parent,command = "x")
trigger5 = (Parent,command = "y")
trigger6 = (Parent,command = "z")
trigger7 = (Parent,command = "start")
var(58) = 1

[State 9741, ButtonTurnOffAI]
type = ParentVarSet
triggerall = !var(2)
trigger1 = (command = "a")
trigger1 = (Parent,command = "a")
trigger2 = (command = "b")
trigger2 = (Parent,command = "b")
trigger3 = (command = "c")
trigger3 = (Parent,command = "c")
trigger4 = (command = "x")
trigger4 = (Parent,command = "x")
trigger5 = (command = "y")
trigger5 = (Parent,command = "y")
trigger6 = (command = "z")
trigger6 = (Parent,command = "z")
trigger7 = (command = "start")
trigger7 = (Parent,command = "start")
var(58) = -1

[State 9741, UnPauseCheck]
type = VarSet
triggerall = var(2)
trigger1 = (Parent,command = "a")
trigger2 = (Parent,command = "b")
trigger3 = (Parent,command = "c")
trigger4 = (Parent,command = "x")
trigger5 = (Parent,command = "y")
trigger6 = (Parent,command = "z")
trigger7 = (Parent,command = "start")
trigger8 = (var(2) = 2)
trigger8 = (var(2):=0)
var(2) = 2



[State 9741, ButtonTurnOffAI]
type = ParentVarSet
trigger1 = Parent,var(58) = 1
var(9) = var(21)+(var(21) && RoundsExisted)

[State 9741, ButtonTurnOffAI]
type = ParentVarSet
trigger1 = Parent,var(58) != 1
var(9) = 0

[State 9741, Goodbye]
type = DestroySelf
triggerall = (var(1):=1)
trigger1 = Parent,var(58)
trigger2 = !(Parent,Alive)
trigger3 = (RoundState != 2)

;============================================================================
; Override Common States
;============================================================================
;-----------------------------------
;-------------- Stand --------------
;-----------------------------------
[Statedef 0]
Type = S
MoveType = I
Physics = S
SprPriority = 0

[State 180, 1]
Type = varset
Trigger1 = !Time
Trigger1 = PalNo = [1,3]
var(1) = ifelse(var(0) > 4 || var(0) < 0, 1, var(0))

[State 180, 1]
Type = varset
Trigger1 = !Time
Trigger1 = PalNo = [4,6]
var(1) = ifelse(var(0) > 4 || var(0) < 0, 4*var(20), var(0))

[State 180, 1]
Type = varset
Trigger1 = !Time
Trigger1 = PalNo = [10,12]
var(1) = ifelse(var(0) > 4 || var(0) < 0, 2, var(0))

[State 180, 1]
Type = varset
Trigger1 = !Time
Trigger1 = PalNo = [7,9]
var(1) = ifelse(var(0) > 4 || var(0) < 0, 3, var(0))

[State 0, 1]
Type = ChangeAnim
Trigger1 = Anim != 5 && Anim != (var(1) = 3)
Trigger2 = Anim = 5 && !AnimTime
Value = (var(1) = 3)

[State 0, 2]
Type = VelSet
Trigger1 = Time = 0
y = 0

[State 0, 3]
Type = VelSet
Trigger1 = abs(Vel x) < 2
Trigger2 = Time = 4
x = 0

;-----------------------------------
;-------------- Walk ---------------
;-----------------------------------
[Statedef 20]
Type    = S
Physics = S
SprPriority = 0

[State 20, 1]
Type = VelSet
Trigger1 = Command = "holdfwd"
x = Const(Velocity.Walk.Fwd.x)+.5*(var(1)= 3)

[State 20, 2]
Type = VelSet
Trigger1 = Command = "holdback"
x = Const(Velocity.Walk.Back.x)-.5*(var(1)= 3)

[State 20, 3]
Type = ChangeAnim
TriggerAll = Vel x > 0
Trigger1 = Anim != 20+2*(var(1) = 3) && Anim != 5
Trigger2 = Anim = 5 && !AnimTime
Value = 20+2*(var(1) = 3)

[State 20, 4]
Type = ChangeAnim
TriggerAll = Vel x < 0
Trigger1 = Anim != 21+2*(var(1) = 3) && Anim != 5
Trigger2 = Anim = 5 && !AnimTime
Value = 21+2*(var(1) = 3)

;-----------------------------------
;----------- jump Start ------------
;-----------------------------------
[Statedef 40]
Type    = S
Physics = S
Anim = 40
Ctrl = 0
SprPriority = 0
velocity = 0,0

[State 40, 1]
Type = ChangeState
TriggerAll = !Time
TriggerAll = var(9)
Trigger1 = p2MoveType = H
Trigger1 = p2bodydist x < 160
Trigger2 = P2StateType = A
Trigger3 = p2StateType = L
Trigger4 = p2StateNo = [5120,5210]
Value = 0
Ctrl = 1

[State 40, 1]
Type = varSet
Trigger1 = Time = 0
Sysvar(1) = 0

[State 40, 1]
Type = varset
Trigger1 = Time = 0
var(2) = 0

[State 40, 1]
Type = varset
Trigger1 = Time = 0
var(4) = 0

[State 40, 3]
Type = varSet
Trigger1 = Command = "holdback"
Sysvar(1) = -1

[State 40, 2]
Type = varSet
Trigger1 = Command = "holdfwd"
Trigger2 = var(9)
Sysvar(1) = 1

[State 40, 4]
Type = varset
Trigger1 = !var(9)
Trigger1 = Command != "holdup"
Trigger2 = var(9)
Trigger2 = P2Bodydist x < 100
var(4) = 1

[State 40, 3]
Type = varSet
Trigger1 = !var(9)
Trigger1 = Command = "longjump"
Trigger2 = prevStateNo = 100 && Command = "holdfwd"
Trigger3 = var(9)
Trigger3 = P2Bodydist x > 50
var(2) = 1

[State 40, 4]
Type = VelSet
Trigger1 = !AnimTime
x = ifelse(Sysvar(1)=0, Const(Velocity.jump.Neu.x), ifelse(Sysvar(1)=1, Const(Velocity.jump.Fwd.x), Const(Velocity.jump.Back.x)))
y = Const(Velocity.jump.y)


[State 40, 5]
Type = VelSet
Trigger1 = !AnimTime
Trigger1 = var(2)
Trigger1 = Sysvar(1) = 1
x = Const(Velocity.Runjump.Fwd.x)

[State 40, 5]
Type = VelSet
Trigger1 = !AnimTime
Trigger1 = var(2)
Trigger1 = Sysvar(1) = -1
x = Const(Velocity.Runjump.Back.x)

[State 260, 3]
type = Afterimage
Trigger1 = var(2)
Time = 8
length = 5
palbright = 0,0,0
palcontrast = 250,250,250
timegap = 2
framegap = 1
trans = none

[State 40, 4]
Type = Velmul
Trigger1 = var(4) && !AnimTime
y = .7

[State 40, 6]
Type = ChangeState
Trigger1 = !AnimTime
Value = 50
Ctrl = 1

;-----------------------------------
;-------- AI high jump fwd ---------
;-----------------------------------
[Statedef 41]
Type    = S
Physics = S
Anim = 40
Ctrl = 0
SprPriority = 0
facep2 = 1
velocity = 0,0

[State 40, 1]
Type = varSet
Trigger1 = Time = 0
Sysvar(1) = 1

[State 40, 1]
Type = varset
Trigger1 = Time = 0
var(2) = 0

[State 40, 1]
Type = varset
Trigger1 = Time = 0
var(4) = 0

[State 40, 3]
Type = varSet
Trigger1 = !Time
var(2) = 1

[State 40, 4]
Type = VelSet
Trigger1 = !AnimTime
x = Const(Velocity.Runjump.Fwd.x)
y = Const(Velocity.runjump.y)

[State 260, 3]
type = Afterimage
Trigger1 = 1
Time = 8
length = 5
palbright = 0,0,0
palcontrast = 250,250,250
timegap = 2
framegap = 1
trans = none

[State 40, 6]
Type = ChangeState
Trigger1 = !AnimTime
Value = 50
Ctrl = 1

;-----------------------------------
;----- AI high short jump Start ----
;-----------------------------------
[Statedef 42]
Type    = S
Physics = S
Anim = 40
Ctrl = 0
SprPriority = 0
facep2 = 1
velocity = 0,0

[State 40, 1]
Type = varset
Trigger1 = Time = 0
var(2) = 1

[State 40, 1]
Type = varset
Trigger1 = Time = 0
var(4) = 1

[State 40, 2]
Type = varSet
Trigger1 = !Time
Trigger2 = var(9)
Sysvar(1) = 1

[State 40, 4]
Type = VelSet
Trigger1 = !AnimTime
x = Const(Velocity.Runjump.Fwd.x)
y = Const(Velocity.runjump.y)


[State 260, 3]
type = Afterimage
Trigger1 = var(2)
Time = 8
length = 5
palbright = 0,0,0
palcontrast = 250,250,250
timegap = 2
framegap = 1
trans = none

[State 40, 4]
Type = Velmul
Trigger1 = !AnimTime
y = .7

[State 40, 6]
Type = ChangeState
Trigger1 = !AnimTime
Value = 50
Ctrl = 1

;-----------------------------------
; AI high short jump neutral Start -
;-----------------------------------
[Statedef 43]
Type    = S
Physics = S
Anim = 40
Ctrl = 0
SprPriority = 0
facep2 = 1
velocity = 0,0

[State 40, 1]
Type = varset
Trigger1 = Time = 0
var(2) = 1

[State 40, 1]
Type = varset
Trigger1 = Time = 0
var(4) = 1

[State 40, 2]
Type = varSet
Trigger1 = !Time
Trigger2 = var(9)
Sysvar(1) = 0

[State 40, 4]
Type = VelSet
Trigger1 = !AnimTime
x = Const(Velocity.jump.neu.x)
y = Const(Velocity.runjump.y)


[State 260, 3]
type = Afterimage
Trigger1 = var(2)
Time = 8
length = 5
palbright = 0,0,0
palcontrast = 250,250,250
timegap = 2
framegap = 1
trans = none

[State 40, 4]
Type = Velmul
Trigger1 = !AnimTime
y = .7

[State 40, 6]
Type = ChangeState
Trigger1 = !AnimTime
Value = 50
Ctrl = 1

;-----------------------------------
;---- AI short jump back Start -----
;-----------------------------------
[Statedef 44]
Type    = S
Physics = S
Anim = 40
Ctrl = 0
SprPriority = 0
facep2 = 1
velocity = 0,0

[State 40, 1]
Type = varset
TriggerAll = Time = 0
Trigger1 = var(1) != 3
Trigger2 = Random < 300
var(4) = 1

[State 40, 2]
Type = varSet
Trigger1 = !Time
Trigger2 = var(9)
Sysvar(1) = -1

[State 40, 4]
Type = VelSet
Trigger1 = !AnimTime
x = Const(Velocity.Runjump.back.x)
y = Const(Velocity.runjump.y)


[State 40, 4]
Type = Velmul
Trigger1 = !AnimTime
Trigger1 = var(4) = 1
y = .7

[State 40, 6]
Type = ChangeState
Trigger1 = !AnimTime
Value = 50
Ctrl = 1

;-----------------------------------
;------- AI short jump Start -------
;-----------------------------------
[Statedef 45]
Type    = S
Physics = S
Anim = 40
Ctrl = 0
SprPriority = 0
facep2 = 1
Velset = 0,0

[State 40, 1]
Type = varset
Trigger1 = Time = 0
var(2) = 0

[State 40, 1]
Type = varset
Trigger1 = Time = 0
var(4) = 1

[State 40, 2]
Type = varSet
Trigger1 = !Time
Sysvar(1) = 1

[State 40, 4]
Type = VelSet
Trigger1 = !AnimTime
x = Const(Velocity.Jump.Fwd.x)
y = Const(Velocity.Jump.y)


[State 40, 4]
Type = Velmul
Trigger1 = !AnimTime
y = .7

[State 40, 6]
Type = ChangeState
Trigger1 = !AnimTime
Value = 50
Ctrl = 1

;-----------------------------------
;------------- Run Fwd -------------
;-----------------------------------
[Statedef 100]
Type    = S
MoveType = I
Physics = S
Anim = 100
SprPriority = 2
Velset = 0,0
Ctrl = 0

[State 100, Velocity]
Type = VelSet
Trigger1 = AnimElemTime(2) >= 0
x = Const(Velocity.Run.Fwd.x)+.5*(var(1)= 3)

[State 100, jump]
Type = ChangeState
trigger1 = !var(9)
Trigger1 = Command = "holdup"
Value = 40

[State 100, Sound]
Type = PlaySnd
Trigger1 = AnimElem = 3 || AnimElem = 6
Value = 100,0
Channel = 3

[State 100, AI End]
type = ChangeState
triggerall = var(9)
triggerall = Time > 10
trigger1 = !var(25)
trigger1 = P2bodydist X <= 70-30*(var(53) = 3)
trigger1 = p2movetype != A && p2movetype != H
trigger2 = !var(25)
trigger2 = p2movetype = A
trigger3 = p2bodydist x < 10
value = 103

[State 100, 9]
Type = ChangeState
triggerall = Time > 10
trigger1 = !var(9)
Trigger1 = Command != "holdfwd"
Value = 103

;-----------------------------------
;------------- GC Dash -------------
;-----------------------------------
[Statedef 101]
Type    = S
MoveType = I
Physics = S
Anim = 101
SprPriority = -2
Velset = 0,0
Ctrl = 0
Poweradd = -500

[State 700, Cancel0]
type = VarAdd
Trigger1 = !Time
var(16) = -500

[State 260, 3]
type = Afterimage
Trigger1 = !Time
Time = 2
length = 8
FrameGap = 3
paladd = 128,128,164

[State 260, 3]
type = AfterImageTime
Trigger1 = Time
Time = 2

[State 3000, PALFX]
type = PalFX
Trigger1 = timemod = 2,0
Trigger1 = time <= 7
ignorehitpause = 1
time = 1
add = 255,255,255
sinadd = -100,-100,-100, 2
ignorehitpause = 1

[State 100, Velocity]
Type = VelSet
Trigger1 = AnimElem = 2, > 0
Trigger1 = AnimElem = 3, < 0
x = 9

[State 100, Velocity]
Type = NotHitBy
Trigger1 = !Time
value = SCA
Time = 12

[State 100, Sound]
Type = PlaySnd
Trigger1 = AnimElem = 2
Value = 105,0
Channel = 3

[State 100, 9]
Type = ChangeState
Trigger1 = !AnimTime
Value = 103

;-----------------------------------
;---------- Run/Dash end -----------
;-----------------------------------
[Statedef 103]
Type    = S
MoveType = I
Physics = S
Anim = 103
SprPriority = -2
Velset = 0
Ctrl = 0

[State 260, 3]
type = AfterimageTime
Trigger1 = !Time
Time = 0

[State 100, 9]
Type = ChangeState
Trigger1 = !AnimTime
Value = 0
Ctrl = 1

;-----------------------------------
;------------ Back Hop -------------
;-----------------------------------
[Statedef 105]
Type = A
Movetype = I
Physics = N
Anim = 105
Velset = 0
Ctrl = 0


[State 105, Invincible]
Type = NotHitBy
Trigger1 = AnimElem = 2, < 0
Value = sca

[State 105, Sound Set]
Type = PlaySnd
Trigger1 = AnimElem = 2
Value = 105, 0
Channel = 3

[State 105, VelSet]
type = velset
trigger1 = AnimElem = 2
x = const(velocity.run.back.x)
y = const(velocity.run.back.y)

[State 106, 3]
Type = velmul
Trigger1 = animelem = 2, > 0
x = .9

[State 106, 3]
Type = Gravity
Trigger1 = animelem = 2, > 0

[State 105, 4]
type = ChangeState
trigger1 = Pos Y >= 0 && Vel Y > 0
value = 106

;-----------------------------------
;-------- Back Hop Landing ---------
;-----------------------------------
[Statedef 106]
type = S
movetype = I
physics = S
anim = 106


[State 106, 1]
type = VelSet
trigger1 = !Time
y = 0

[State 106, 1]
type = PosSet
trigger1 = !Time
y = 0

[State 106, 1]
type = MakeDust
trigger1 = Vel x != 0
pos = -8, 0
spacing = 5

[State 106, 9]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;-----------------------------------
;--- Guard State Modifyed for AI ---
;-----------------------------------
;GUARD (start)
[Statedef 120]
type = U    ;Leave state type unchanged
physics = U ;Leave physics unchanged


[State 120, 1]
type = VarSet
trigger1 = !Time
var(27) = 0
ignorehitpause = 1

[State 120, 1]
type = Ctrlset
trigger1 = !Time
Trigger1 = var(9)
Trigger1 = enemy, numproj > 0
Trigger1 = statetype != A
value = 0
ignorehitpause = 1

[State 120, 1]
type = ChangeAnim
trigger1 = Time = 0
value = 120 + (statetype = C) + (statetype = A)*2

[State 120, 2]
type = StateTypeSet
triggerall = Time = 0
trigger1 = statetype = S && !var(9)
trigger2 = statetype != A && p2statetype != C && var(9)
physics = S

[State 120, 3]
type = StateTypeSet
triggerall = !Time
trigger1 = statetype = C && !var(9)
trigger2 = statetype != A && p2statetype = C && var(9)
physics = C

[State 120, 4]
type = StateTypeSet
trigger1 = !Time && statetype = A
physics = A

[State 120, Hi to Lo]
type = StateTypeSet
triggerall = statetype = S
trigger1 = command = "holddown" && !var(9)
trigger2 = p2statetype = C && var(9)
statetype = C
physics = C

[State 120, Lo to Hi]
type = StateTypeSet
triggerall = statetype = C
trigger1 = command != "holddown" && !var(9)
trigger2 = p2statetype != C && var(9)
statetype = S
physics = S

[State 120, 1]
type = VarSet
trigger1 = Time
var(27) = StateType = C
ignorehitpause = 1

[State 120, 5]
type = ChangeState
trigger1 = AnimTime = 0
value = 130 + (statetype = C) + (statetype = A)*2

[State 120, Stop Guarding]
type = ChangeState
trigger1 = command != "holdback" && var(9) = 0
trigger2 = !inguarddist
trigger3 = var(9) && enemy, moveguarded
value = 140

;---------------------------------------------------------------------------
; STAND GUARD (guarding)
[Statedef 130]
type    = S
physics = S

[State 120, 1]
type = VarSet
trigger1 = !Time
var(27) = 0
ignorehitpause = 1

[State 120, 1]
type = Ctrlset
trigger1 = Time = 0 && var(9) && enemy, numproj > 0
value = 0
ignorehitpause = 1

[State 130, 1]
type = ChangeAnim
trigger1 = Anim != 130
value = 130

[State 130, Hi to Lo]
type = ChangeState
trigger1 = command = "holddown" && !var(9)
trigger2 = p2statetype = C && var(9)
value = 131

[State 130, Stop Guarding]
type = ChangeState
trigger1 = command != "holdback" && var(9) = 0
trigger2 = !inguarddist
trigger3 = var(9) && enemy, moveguarded
value = 140

;---------------------------------------------------------------------------
; CROUCH GUARD (guarding)
[Statedef 131]
type    = C
physics = C

[State 120, 1]
type = VarSet
trigger1 = !Time
var(27) = 1
ignorehitpause = 1

[State 120, 1]
type = Ctrlset
trigger1 = Time = 0 && var(9) && enemy, numproj > 0
value = 0
ignorehitpause = 1

[State 131, 1]
type = ChangeAnim
trigger1 = Anim != 131
value = 131

[State 131, Lo to Hi]
type = ChangeState
trigger1 = command != "holddown" && !var(9)
trigger2 = p2statetype != C && var(9)
value = 130

[State 131, Stop Guarding]
type = ChangeState
trigger1 = command != "holdback" && var(9) = 0
trigger2 = !inguarddist
trigger3 = var(9) && enemy, moveguarded
value = 140

;---------------------------------------------------------------------------
; AIR GUARD (guarding)
[Statedef 132]
type    = A
physics = N

[State 132, 1]
type = ChangeAnim
trigger1 = Anim != 132
value = 132

[State 132, 2]
type = VelAdd
trigger1 = 1
y = Const(movement.yaccel)

[State 132, 3]
type = VarSet
trigger1 = 1
sysvar(0) = (pos y >= 0) && (vel y > 0)

[State 132, 4]
type = VelSet
trigger1 = sysvar(0)
y = 0

[State 132, 5]
type = PosSet
trigger1 = sysvar(0)
y = 0

[State 132, 6]
type = ChangeState
trigger1 = sysvar(0)
trigger1 = command = "holdback" || var(9)
trigger1 = inguarddist
value = 130

[State 132, 7]
type = ChangeState
trigger1 = sysvar(0)
value = 52

[State 132, Stop Guarding]
type = ChangeState
trigger1 = command != "holdback" && var(9) = 0
trigger2 = !inguarddist
value = 140

;---------------------------------------------------------------------------
;---------------------------------------------------------------------------
; SGUARDHIT (shaking)
[Statedef 150]
type    = S
movetype= H
physics = N
velset = 0,0

[State 150, 1]
type = ChangeAnim
trigger1 = 1
value = 150

[State 150, 2]
type = ChangeState
trigger1 = HitShakeOver
value = 151 + 2*(command = "holddown"|| (var(9) && p2statetype = C))

[State 150, Hi to Lo]
type = StateTypeSet
triggerall = statetype = S
trigger1 = command = "holddown" && var(9) = 0
trigger2 = var(9) && p2statetype = C
statetype = C
physics = C

[State 150, Lo to Hi]
type = StateTypeSet
trigger1 = statetype = C && command != "holddown" && var(9) = 0
trigger2 = var(9) && p2statetype != C
statetype = S
physics = S

[State 120, 1]
type = VarSet
trigger1 = 1
var(27) = StateType = C
ignorehitpause = 1

[State 150, 3]
type = ForceFeedback
trigger1 = time = 0
waveform = square
time = 3

;---------------------------------------------------------------------------
; SGUARDHIT2 (knocked back)
[Statedef 151]
type    = S
movetype= H
physics = S
anim = 150

[State 151, 1]
type = HitVelSet
trigger1 = Time = 0
x = 1

[State 151, 2]
type = VelSet
trigger1 = Time = GetHitVar(slidetime)
trigger2 = HitOver
x = 0

[State 151, 3]
type = CtrlSet
trigger1 = Time = GetHitVar(ctrltime)
value = 1

[State 150, Hi to Lo]
type = StateTypeSet
triggerall = statetype = S
trigger1 = command = "holddown" && var(9) = 0
trigger2 = var(9) && p2statetype = C
statetype = C
physics = C

[State 150, Lo to Hi]
type = StateTypeSet
trigger1 = statetype = C && command != "holddown" && var(9) = 0
trigger2 = var(9) && p2statetype != C
statetype = S
physics = S

[State 120, 1]
type = VarSet
trigger1 = 1
var(27) = StateType = C
ignorehitpause = 1

[State 151, 4]
type = ChangeState
trigger1 = HitOver
value = 130+(statetype = C)
ctrl = 1

;---------------------------------------------------------------------------
; CGUARDHIT (shaking)
[Statedef 152]
type    = C
movetype= H
physics = N
velset = 0,0

[State 152, 1]
type = ChangeAnim
trigger1 = 1
value = 151

[State 150, 2]
type = ChangeState
trigger1 = HitShakeOver
value = 151 + 2*(command = "holddown"|| (var(9) && p2statetype = C))

[State 150, Hi to Lo]
type = StateTypeSet
triggerall = statetype = S
trigger1 = command = "holddown" && var(9) = 0
trigger2 = var(9) && p2statetype = C
statetype = C
physics = C

[State 150, Lo to Hi]
type = StateTypeSet
trigger1 = statetype = C && command != "holddown" && var(9) = 0
trigger2 = var(9) && p2statetype != C
statetype = S
physics = S

[State 120, 1]
type = VarSet
trigger1 = 1
var(27) = StateType = C
ignorehitpause = 1

[State 152, 4]
type = ForceFeedback
trigger1 = time = 0
waveform = square
time = 4

;---------------------------------------------------------------------------
; CGUARDHIT2 (knocked back)
[Statedef 153]
type    = C
movetype= H
physics = C
anim = 151

[State 120, 1]
type = VarSet
trigger1 = !Time
var(27) = 1
ignorehitpause = 1

[State 153, 1]
type = HitVelSet
trigger1 = Time = 0
x = 1

[State 153, 2]
type = VelSet
trigger1 = Time = GetHitVar(slidetime)
trigger2 = HitOver
x = 0

[State 153, 3]
type = CtrlSet
trigger1 = Time = GetHitVar(ctrltime)
value = 1

[State 150, Hi to Lo]
type = StateTypeSet
triggerall = statetype = S
trigger1 = command = "holddown" && var(9) = 0
trigger2 = var(9) && p2statetype = C
statetype = C
physics = C

[State 150, Lo to Hi]
type = StateTypeSet
trigger1 = statetype = C && command != "holddown" && var(9) = 0
trigger2 = var(9) && p2statetype != C
statetype = S
physics = S

[State 120, 1]
type = VarSet
trigger1 = 1
var(27) = StateType = C
ignorehitpause = 1

[State 153, 4]
type = ChangeState
trigger1 = HitOver
value = 130+(statetype = C)
ctrl = 1

;---------------------------------------------------------------------------
; AGUARDHIT2 (knocked away)
[Statedef 155]
type    = A
movetype= H
physics = N
anim = 152

[State 155, 1]
type = HitVelSet
trigger1 = Time = 0
x = 1
y = 1

[State 155, 2]
type = VelAdd
trigger1 = 1
y = Const(movement.yaccel)

[State 155, 4]
type = VarSet
trigger1 = 1
sysvar(0) = (pos y >= 0) && (vel y > 0)

[State 155, 5]
type = VelSet
trigger1 = sysvar(0)
y = 0

[State 155, 6]
type = PosSet
trigger1 = sysvar(0)
y = 0

[State 155, 6]
type = ChangeState
trigger1 = sysvar(0)
trigger1 = command = "holdback" || var(9)
trigger1 = inguarddist
value = 130

[State 155, 7]
type = ChangeState
trigger1 = sysvar(0)
value = 52

;-----------------------------------
;----- Lose for Time over pose -----
;-----------------------------------
[Statedef 170]
Type = S
Ctrl = 0
Anim = 170
Velset = 0,0

[State 170, 1]
Type = NotHitBy
Trigger1 = Time = 0
Value = SCA
Time = 1

;-----------------------------------
;----------- Pre - Intro -----------
;-----------------------------------
[Statedef 190]
Type = S
Ctrl = 0
Velset = 0,0

[State 190, 1]
Type = ChangeAnim
Trigger1 = SelfAnimExist(190)
Value = 190

[State 180, 1]
Type = varset
Trigger1 = Time = 1
Trigger1 = PalNo = [1,3]
var(1) = ifelse(var(0) > 4 || var(0) < 0, 1, var(0))

[State 180, 1]
Type = varset
Trigger1 = Time = 1
Trigger1 = PalNo = [4,6]
var(1) = ifelse(var(0) > 4 || var(0) < 0, 4*var(20), var(0))

[State 180, 1]
Type = varset
Trigger1 = Time = 1
Trigger1 = PalNo = [10,12]
var(1) = ifelse(var(0) > 4 || var(0) < 0, 2, var(0))

[State 180, 1]
Type = varset
Trigger1 = Time = 1
Trigger1 = PalNo = [7,9]
var(1) = ifelse(var(0) > 4 || var(0) < 0, 3, var(0))

[State 190, 2] ;Go straight to intro.
Type = ChangeState
Trigger1 = Time = 1
Value = 191

;-----------------------------------
;-------- KOF Recovery Roll --------
;-----------------------------------
[Statedef 5201]
type    = L
movetype= H
physics = N
anim = 5200
ctrl = 0

[State 5100, EnvShake]
type = FallEnvShake
trigger1 = !Time

[State 5100, 8]
type = GameMakeAnim
trigger1 = !Time
value = 60 + (sysvar(1) > 5) + (sysvar(1) > 14)
pos = 0, 0
under = sysvar(1) <= 10

[State 5100, 10]
type = PlaySnd
trigger1 = !Time
value = F7, (sysvar(1) > 5) + (sysvar(1) > 14)

[State 5100, 13]
type = ForceFeedback
trigger1 = Time = 0
waveform = sinesquare
ampl = 128,-3,-.2,.005
time = 2

[State 5201, 1] ;Turn if not facing opponent
type = Turn
trigger1 = Time = 0
trigger1 = P2Dist X < -5

[State 5201, 2]
type = VelSet
trigger1 = !Time
y = 0

[State 5201, 2.1]
type = VelSet
trigger1 = Time >= 0
trigger1 = Time <= 12
x = -4

[State 5201, 3]
type = PosSet
trigger1 = !Time
y = 0

[State 5201, 4]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

[State 5201, 3]
type = statetypeset
trigger1 = Time = 1
statetype = S
movetype= I
physics = S

[State 701, 1]
type = PlaySnd
trigger1 = Time = 1
value = 2*(var(1) = [2,3]),1
Channel = 1

[State 5201, 6]
type = ChangeState
trigger1 = !AnimTime
value = 0
ctrl = 1

;-----------------------------------
;------ CAPCOM Recovery Roll -------
;-----------------------------------
[Statedef 5202]
type    = L
movetype= H
physics = N
anim = 5201
ctrl = 0

[State 1000, buffer setting1]
Type = varSet
Trigger1 = !Time
Trigger1 = helper(2000),var(1) > helper(2000), var(2)
Trigger1 = helper(2000),var(1) > helper(2000), var(3)
var(2) = 0

[State 1000, buffer setting2]
Type = varSet
Trigger1 = !Time
Trigger1 = helper(2000),var(2) > helper(2000), var(1)
Trigger1 = helper(2000),var(2) > helper(2000), var(3)
var(2) = 1

[State 1000, buffer setting3]
Type = varSet
Trigger1 = !Time
Trigger1 = helper(2000),var(3) > helper(2000), var(1)
Trigger1 = helper(2000),var(3) > helper(2000), var(2)
var(2) = 2

[State 1000, Power Set]
Type = varSet
TriggerAll = !Time
Trigger1 = command="x"
Trigger2 = command="y"
Trigger3 = command="z"
var(2) = IfElse(command = "y",1,IfElse(Command = "z",2,0))

[State 1000, Power set]
Type = varSet
Trigger1 = !Time
Trigger1 = var(9)
var(2) = 0

[State 1000, Power set]
Type = varSet
Trigger1 = !Time
var(50) = 1

[State 1000, Power set]
Type = varSet
Trigger1 = !Time
Trigger1 = var(9)
var(2) = (p2bodydist x > 30)+(p2bodydist x > 100)

[State 5100, EnvShake]
type = FallEnvShake
trigger1 = !Time

[State 5100, 8]
type = GameMakeAnim
trigger1 = !Time
value = 60 + (sysvar(1) > 5) + (sysvar(1) > 14)
pos = 0, 0
under = sysvar(1) <= 10

[State 5100, 10]
type = PlaySnd
trigger1 = !Time
value = F7, (sysvar(1) > 5) + (sysvar(1) > 14)

[State 5100, 13]
type = ForceFeedback
trigger1 = !Time
waveform = sinesquare
ampl = 128,-3,-.2,.005
time = 2

[State 5201, 1]
type = changestate
trigger1 = !Time && !alive
value = 5101

[State 5201, 1]
type = Turn
trigger1 = !Time
trigger1 = P2Dist X < -5

[State 5201, 3]
type = PosSet
trigger1 = !Time
y = 0

[State 5201, 2]
type = VelSet
trigger1 = !Time
x = 0
y = 0

[State 5201, 3]
type = statetypeset
trigger1 = animelem = 2
statetype = S
movetype= I
physics = N

[State 5201, 2]
type = VelSet
trigger1 = time = 10
x = 4*var(2)

[State 5100, 8]
type = Playerpush
trigger1 = 1
value = 0

[State 5201, 6]
type = ChangeState
trigger1 = Time >= 24+var(2)*6
value = 0
ctrl = 1

;-----------------------------------
;----------- Hit Liedead -----------
;-----------------------------------
; HIT_LIEDEAD
[Statedef 5150]
type    = L
movetype= H
physics = N
sprpriority = -3

[State 5150, 1] ;Normal anim
type = ChangeAnim
triggerall = Time = 0
triggerall = SelfAnimExist(5140)
trigger1 = (anim != [5111,5119]) && (anim != [5171,5179])
trigger2 = !SelfAnimExist(5140 + (anim % 10))
value = 5140

[State 5150, 3] ;Hit up type anim
type = ChangeAnim
trigger1 = Time = 0
trigger1 = (anim = [5111,5119]) || (anim = [5171,5179])
trigger1 = SelfAnimExist(5140 + (anim % 10))
value = 5140 + (anim % 10)

[State 5150, 4] ;Match over anim
type = ChangeAnim
persistent = 0
trigger1 = MatchOver = 1
trigger1 = Anim = [5140,5149]
trigger1 = SelfAnimExist(anim+10)
value = anim+10

[State 5150, 5] ;Switch to 5110 if liedead anim does not exist
type = ChangeAnim
trigger1 = Time = 0
trigger1 = Anim != [5140,5159]
trigger1 = Anim != [5110,5119]
value = 5110

[State 5150, 6] ;Friction
type = VelMul
trigger1 = 1
x = 0.85

[State 5150, 7] ;Friction
type = VelSet
trigger1 = Vel x < .05
persistent = 0
x = 0

[State 5950, Changeanim]
type = ChangeAnim
trigger1 = !Time
trigger1 = PrevStateno = 5950
value = 5171

[State 5150, 8]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

;-----------------------------------
;--------- Initializing... ---------
;-----------------------------------
[Statedef 5900]
Type = S
Anim = (var(1) = 3)

[State 5900, 1] ;Clear All int variables
Type = varRangeSet
Trigger1 = RoundNo = 1
Trigger2 = TeamMode = turns
Trigger2 = RoundNo > 1
Trigger2 = Roundsexisted <= 0
Trigger2 = RoundState = 0
Value = 0

[State 5900, 2] ;Clear All float variables
Type = varRangeSet
Trigger1 = RoundNo = 1
Trigger2 = TeamMode = turns
Trigger2 = RoundNo > 1
Trigger2 = Roundsexisted <= 0
Trigger2 = RoundState = 0
fValue = 0

[State 5900, LR start]
type = VarSet
trigger1 = var(2)
var(2) = 0

[State 5900, LR start]
type = VarSet
trigger1 = !var(10)
var(10) = teamside

[State 5900, Guard Crush Reset]
type = VarSet
trigger1 = var(11)
var(11) = 0

[State 5900, Dizzy Reset]
type = VarSet
trigger1 = var(13)
var(13) = 0

[State 5900, MAX Reset]
type = VarSet
trigger1 = var(15)
var(15) = 0

[State 5900, MAX bar Reset]
type = VarSet
trigger1 = var(17)
var(17) = 0

[State 5900, Spec intro reset]
type = VarSet
trigger1 = var(29)
var(29) = 0

[State 191, 1]
Type = Changestate
TriggerAll = Time = 2
TriggerAll = RoundNo > 1
TriggerAll = Enemy, Teammode = Turns
TriggerAll = Enemy, Roundsexisted <= 0
TriggerAll = !Numpartner
TriggerAll = var(1) != [2,3]
TriggerAll = NumEnemy < 2
Trigger1 = p2Name = "Robert"
Trigger2 = p2Name = "Robert Garcia"
Trigger3 = p2Name = "Ryo"
Trigger4 = p2Name = "Ryo Sakazaki"
Trigger5 = p2Name = "Yuri"
Trigger6 = p2Name = "Yuri Sakazaki"
value = 192

[State 5900, 3] ;Intro
Type = ChangeState
Trigger1 = RoundNo = 1
Trigger2 = TeamMode = turns
Trigger2 = RoundNo > 1
Trigger2 = Roundsexisted <= 0
Trigger2 = RoundState = 0
Value = 190


;============================================================================
; States that are always executed (use Statedef -2)
;============================================================================
[Statedef -2]

[State -2, Display]
type = DisplayToClipboard
trigger1 = 1
ignorehitpause = 1
text = "p2dist x = %d"
params = floor(p2dist x)

; Special finish effect --------------------------------------------------------------
[State -2, Special Finish]
type = Helper
triggerall = WinKo && !NumHelper(9995)
trigger1 = movecontact && hitdefattr = SCA,SA,SP,ST
trigger2 = projcontact1000 = 1, = [1,5]
trigger3 = projcontact1600 = 1, = [1,5]
trigger4 = projcontact1750 = 1, = [1,5]
ID = 9995
stateno = 9995
postype = left
pos = 0,0
pausemovetime = 9999
ignorehitpause = 1

; DM/SDM finish effect --------------------------------------------------------------

[State -2, DM/SDM Finish]
type = Helper
triggerall = WinKo && !NumHelper(9996)
trigger1 = movecontact && hitdefattr = SCA,HA,HP,HT
trigger2 = projcontact3000 = 1, = [1,5]
trigger3 = projcontact3300 = 1, = [1,5]
trigger4 = projcontact4000 = 1, = [1,5]
trigger5 = projcontact4250 = 1, = [1,5]
trigger6 = StateNo = 4010
trigger6 = MoveType = A
ID = 9996
stateno = 9996
postype = left
pos = 0,0
pausemovetime = 9999
ignorehitpause = 1

[State 9996, Remove BG for Hyper finish]
type = RemoveExplod
trigger1 = numexplod(11000)
trigger1 = numhelper(9996)
ID = 11000
ignorehitpause = 1

; KOF Juggle State Optimization ----------------------------------------------
[State 9000, Assert]
type = AssertSpecial
triggerAll = p2MoveType = H
trigger1 = p2StateNo = [6000,6700]
trigger2 = p2StateNo = [5080,5119]
trigger3 = p2StateNo = [1460,1490]
Flag = NoJuggleCheck
ignorehitpause = 1
persistent = 1

; AI De-activate coding ------------------------------------------------------

[State -2, AI Desactivate]
type = VarSet
trigger1 = var(9) > 0 && RoundState = 3
var(9) = 0

; KOF MAX timer coding --------------------------------------------------------------

[State -2, set powerbar]
type = powerset
trigger1 = RoundState = 2
trigger1 = var(15) && !NumPartner
trigger1 = !NumPartner
trigger1 = stateno != [3000,4999]
trigger1 = stateno != 750
value = var(16)
ignorehitpause = 1

[State -2, 8]
type = VarAdd
trigger1 = Var(15)
trigger1 = StateNo != 750
var(15) = -1
ignorehitpause = 1

[State -2, 8]
type = VarSet
trigger1 = Var(15) < 0
trigger1 = StateNo != 750
var(15) = 0
ignorehitpause = 1

[State -2, powerbar]
type = ModifyExplod
trigger1 = Var(15)
ID = 8231
scale = (Var(15)) / 1000.0,1
ignorehitpause = 1

[State -2, powerbar]
type = removeExplod
trigger1 = NumExplod(8231)
trigger1 = !Var(15)
ID = 8230
ignorehitpause = 1

[State -2, powerbar]
type = removeExplod
trigger1 = !Var(15)
ID = 8231
ignorehitpause = 1

[State -2, 9]
type = varadd
trigger1 = Var(17) > 0 && !Var(15)
var(17) = -1
ignorehitpause = 1

[State 714, 5]
type = Explod
trigger1 = var(10) = 1
trigger1 = !var(15) && var(17) && var(17) != 20
scale =1,(1-(0.05*(20-var(17))))
anim = 8230
postype = left
pos = 25,210
bindtime = -1
removetime = 1
ontop = 1
ignorehitpause = 1

[State 714, 5]
type = Explod
trigger1 = var(10) = 2
trigger1 = !var(15) && var(17) && var(17) != 20
scale =1,(1-(0.05*(20-var(17))))
anim = 8231
postype = Right
pos = -25,210
bindtime = -1
removetime = 1
ontop = 1
ignorehitpause = 1

[State -2, 11]
type = PalFX
trigger1 = MoveType != H
trigger1 = (GameTime%2)=0
trigger1 = var(15)
time = 1
add = 70,70,70
ignorehitpause = 1

; Projectile Effects --------------------------------------------------------

[State -2, KOF Projectile & Burn pause]
Type = Pause
Trigger1 = RoundState = 2
Trigger1 = (GameTime%4) = 1
Trigger1 = ProjHitTime(0) = [1,20]
Trigger1 = var(1)
Time = 1
MoveTime = 0
IgnoreHitPause = 1

[State -2, SDM Proj envcolor]
type = EnvColor
Trigger1 = ProjHitTime(3000) = 1
Trigger2 = ProjHitTime(3010) = 1
Trigger3 = ProjHitTime(3200) = 1
Value = 255, 255, 255
Time = 2
Under = 1
IgnoreHitPause = 1

[State -1]
type = Helper
triggerAll = !ishelper
trigger1 = NumHelper(9997) = 0
trigger1 = roundstate = 2 && p2movetype = A
name = "counter hit"
id = 9997
helpertype = normal
pos = 0,0
postype = p1
stateno = 9997
keyctrl = 0
ownpal = 1
pausemovetime = 9999999
supermovetime = 9999999

;   Throw limitter   ------------------------------------------------------

[State -2, single]
type = VarSet
trigger1 = MoveContact||projcontact = 1
trigger2 = p2stateno = [5020,5120]
trigger3 = p2stateno = [5620,5690]
trigger4 = p2stateno = 1036 && p2movetype = H
trigger5 = p2stateno = 843 && p2movetype = H
var(6) = 18
ignorehitpause = 1

[State -2, single]
type = VarAdd
trigger1 = var(6) >= 1
trigger1 = p2movetype != H
var(6) = -1
ignorehitpause = 1

[State -2, single]
type = VarSet
trigger1 = p2movetype = A
var(6) = 0
ignorehitpause = 1

[State -2, super]
type = VarSet
trigger1 = MoveGuarded
trigger2 = projguarded = 1
trigger3 = p2stateno = [5020,5120]
Trigger4 = P2MoveType = H
trigger4 = p2stateno = [6000,6200]
Trigger5 = P2MoveType = H
Trigger5 = EnemyNear, Hitover
var(19) = 10
ignorehitpause = 1

[State -2, super]
type = VarSet
trigger1 = p2movetype = A
trigger2 = MoveHit
trigger2 = EnemyNear, HitShakeover = 0
var(19) = 0
ignorehitpause = 1

[State -2, super]
type = VarAdd
trigger1 = var(19) >= 1
trigger1 = p2movetype != H
var(19) = -1
ignorehitpause = 1

; Dizzy countdown -------------------------------------------------------------
[State -2, Dizzy count ]
type = Varadd
trigger1 = var(13) > 0
trigger1 = movetype != H
var(13) = -1
Ignorehitpause = 1

; Guard Crush Countdown -------------------------------------------------------------
[State -2, GCrushCount ]
type = Varadd
trigger1 = var(11) > 0
trigger1 = movetype != H
var(11) = -1
ignorehitpause = 1

; Guard Crush Countdown Adjust 1 ----------------------------------------------------
[State -3, GCrushAdjust1 ]
type = Varset
trigger1 = var(11) < 0
var(11) = 0
ignorehitpause = 1

; Dizzy increasing value coding -----------------------------------------------
[State -2, DizzyIncreasing]
type = Varadd
triggerall = gethitvar(damage) > 0 && gethitvar(hitcount) > 0
triggerall = StateNo = [5000,5100]
trigger1 = enemy,movehit
trigger2 = enemy,projhit = 1
var(13) = floor((ifelse(GetHitVar(damage) <= 100,GetHitVar(damage),100))/gethitvar(hitcount))*2
ignorehitpause = 1
persistent = 0

; Stop sound when getting hit -------------------------------------------------
[State -3, Stop Sound]
type = StopSnd
trigger1 = Movetype = H
Channel = 1

; Remove Chou Haoh Shikouken --------------------------------------------------
[State 3000, end FX]
Type = Explod
trigger1 = NumExplod(4235)
trigger1 = StateNo != 4220
anim = 4236
PosType = p1
Ownpal = 1
SprPriority = 5
BindTime = 1
Pos = 0,0
PauseMoveTime = 99
SuperMoveTime = 99
ignorehitpause = 1
velocity = 1,0

[State 3000, remove main FX]
Type = RemoveExplod
trigger1 = NumExplod(4235)
trigger1 = StateNo != 4220
ID = 4235
ignorehitpause = 1

; FIX zzzasd throw bug --------------------------------------------------------
[State -2, zzzasd bugfix]
type = ChangeAnim
trigger1 = StateNo = 812
trigger1 = Anim = 200
value = 306
ignorehitpause = 1


; Remove Power Charging Effects -----------------------------------------------
[State -2, RemoveBG]
type = removeExplod
trigger1 = NumExplod(8400)
trigger1 = StateNo != 770
ID = 8400
ignorehitpause = 1

[State -2, StopchargeSnd1]
type = stopsnd
trigger1 = StateNo != 770
trigger1 = StateNo != [1950,1960]
Channel = 6

[State -2, StopchargeSnd2]
type = stopsnd
trigger1 = StateNo != 770
channel = 7

; Increase Defensive Power when life < 50% ----------------------------------------------

[State -3,def up]
type = DefenceMulSet
trigger1 = !var(9)
trigger1 = Life > LifeMax/2
value = 1+.5*(var(1) = 3)
ignorehitpause = 1

[State -3,def up]
type = DefenceMulSet
trigger1 = var(9)
trigger1 = Life > LifeMax/2
value = 1-.2*(var(1) = 3)
ignorehitpause = 1

[State -3,def up]
type = DefenceMulSet
trigger1 = !var(9)
trigger1 = Life <= LifeMax/2
value = ifelse(life <= LifeMax/4,.7,.8)+.5*(var(1) = 3)
ignorehitpause = 1

[State -3,def up]
type = DefenceMulSet
trigger1 = var(9)
trigger1 = Life <= LifeMax/2
value = ifelse(life <= LifeMax/4,.7,.8)-.2*(var(1) = 3)
ignorehitpause = 1

;-------------------------------------------------------------------------------
;------------------------- KOF Cornerpush by YongMing --------------------------
;------------------------------ Modifyed by Elix -------------------------------
;---------------------- Revised and Upgraded by Don Drago ----------------------
;-------------------------------------------------------------------------------
; Main Changes:
; 1 - Added Custom States Support
; 2 - All possible var(x) = 0 changed to !var(x) (faster to process)
; 3 - Removed the needing of Explod(3000) to control SuperPause
; 4 - Fixed the Movetype = H landing bug (in the original code, when the opponent
;     lands in a custom state, being MoveType = H, you could get a little corner
;     push. Fixed in this new version
; 5 - Elix used !hitpausetime in his version of the code. The old Target,
;     Gethitvar(HitShakeTime) proved to be far more useful (unless you use the same
;     amount of pausetime in your hitdefs, like 11,11 or 13,13.

[State -2, HitShakeOver VelSet]
type = VarSet
triggerall = NumTarget
triggerall = (target, BackEdgeBodyDist <= 0) || (target, FrontEdgeBodyDist <= 0)
triggerall = target, MoveType = H
triggerall = target, Vel y = 0
triggerall = !Numtarget(1000)
triggerall = StateType != A
triggerAll = target,StateNo != [6000, 6099]; DGroove Custom States
trigger1 = target, StateType = S
trigger2 = target, StateType = C
fvar(0) = ifelse(target, BackEdgeBodyDist <= 0,target, Vel X,-target, Vel X)

[State -2, HitShake VelSet]
type = VarSet
triggerall = NumTarget
triggerall = !fvar(0)
triggerall = (target, BackEdgeBodyDist <= 0) || (target, FrontEdgeBodyDist <= 0)
triggerall = target, GetHitVar(HitShakeTime) = 0
triggerall = target, GetHitVar(yvel) = 0
triggerall = !Numtarget(1000)
triggerAll = target,StateNo != [6000, 6099]; DGroove Custom States
trigger1 = target, StateNo = 5000
trigger2 = target, StateNo = 5010
trigger3 = target, StateNo = 150
trigger4 = target, StateNo = 152
IgnoreHitPause = 1
fvar(0) = ifelse(facing = -1 && target, BackEdgeBodyDist <= 0,target, GetHitVar(xvel),-target, GetHitVar(xvel))

[State -2, Corner Push]
type = PosAdd
trigger1 = NumTarget
trigger1 = target,StateNo != [5200, 5299]; Recovery rolls
trigger1 = !(Time <= 28 && StateNo = [3100, 4290]); This avoids the creation of explods.
trigger1 = HitShakeOver
trigger1 = fvar(0)
trigger1 = !(Time >= 4 && Time <= 32 && StateNo = 3000 && var(1))
trigger1 = !(Time <= 28 && StateNo = 3000 && !var(1))
trigger1 = !(Time >= 6 && Time <= 36 && StateNo = 4300)
x = fvar(0)

[State -2, Velocity Reset]
type = VarSet
triggerall = fvar(0)
trigger1 = !NumTarget
trigger2 = target,HitShakeOver
trigger3 = target,StateNo = [6000, 6099]
fvar(0) = 0

; Hien Shippu Kyaku bug fix thread ---------------------------------------------------
[State -2, Hien Charging]
type = varAdd
trigger1 = command = "holddown"
trigger1 = command = "holdback"
trigger1 = var(28) < 15
var(28) = 1
IgnoreHitpause = 1

[State -2, Hien Loosing Charge]
type = varAdd
triggerAll = var(28) > 0
trigger1 = command != "holddown"
trigger2 = command != "holdback"
var(28) = -1

; Power Charge Optimizer thread ------------------------------------------------------
[State -2, Charging]
type = varAdd
trigger1 = command = "holdx"
trigger1 = command = "holdy"
trigger1 = var(51) < 5
var(51) = 1
IgnoreHitpause = 1

[State -2, NOT charging]
type = varSet
triggerAll = var(51)
trigger1 = command != "holdx"
trigger2 = command != "holdy"
var(51) = 0
IgnoreHitpause = 1

;  AI optimization code 6: Atemi Nage Optimizer -----------------------------------------
[State -3, Atemi 1 - a ]
type = Varset
triggerall = !var(30)
triggerall = var(9)
trigger1 = enemy,hitdefattr = A,NA && enemy,vel y < 0
trigger2 = enemy,hitdefattr = A,SA && enemy,vel y < -4
trigger3 = p2dist x < 0
var(30) = 1

[State -3, Atemi 1 - b ]
type = Varset
triggerall = var(30)
triggerall = var(9)
trigger1 = p2movetype != A
trigger2 = p2statetype != A
var(30) = 0

[State -3, Atemi 2 - a]
type = VarAdd
trigger1 = var(9)
trigger1 = Enemynear, hitdefattr = SA,NA,SA,HA
var(31) = 1
ignorehitpause = 1

[State -3, Atemi 2 - b]
type = Varset
trigger1 = var(31)
trigger1 = var(9)
trigger1 = Enemynear, hitdefattr != SA,NA,SA,HA
var(31) = 0
